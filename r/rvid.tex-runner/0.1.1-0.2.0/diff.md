# Comparing `tmp/rvid.tex_runner-0.1.1-py3-none-any.whl.zip` & `tmp/rvid.tex_runner-0.2.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,11 +1,11 @@
-Zip file size: 5067 bytes, number of entries: 9
+Zip file size: 5596 bytes, number of entries: 9
 -rw-r--r--  2.0 unx     1042 b- defN 23-Apr-20 18:15 rvid/tex_runner/__init__.py
--rw-r--r--  2.0 unx      160 b- defN 23-Apr-20 18:31 rvid/tex_runner/__version__.py
+-rw-r--r--  2.0 unx      160 b- defN 23-Apr-23 20:50 rvid/tex_runner/__version__.py
 -rw-r--r--  2.0 unx     3169 b- defN 23-Apr-05 21:14 rvid/tex_runner/external_resources.py
--rw-r--r--  2.0 unx     1422 b- defN 23-Apr-20 18:12 rvid/tex_runner/latex.py
+-rw-r--r--  2.0 unx     2182 b- defN 23-Apr-23 20:45 rvid/tex_runner/latex.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 10:48 rvid/tex_runner/py.typed
--rw-r--r--  2.0 unx     1992 b- defN 23-Apr-20 18:31 rvid.tex_runner-0.1.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-20 18:31 rvid.tex_runner-0.1.1.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Apr-20 18:31 rvid.tex_runner-0.1.1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx      752 b- defN 23-Apr-20 18:31 rvid.tex_runner-0.1.1.dist-info/RECORD
-9 files, 8634 bytes uncompressed, 3757 bytes compressed:  56.5%
+-rw-r--r--  2.0 unx     2615 b- defN 23-Apr-23 20:50 rvid.tex_runner-0.2.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-23 20:50 rvid.tex_runner-0.2.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Apr-23 20:50 rvid.tex_runner-0.2.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx      752 b- defN 23-Apr-23 20:50 rvid.tex_runner-0.2.0.dist-info/RECORD
+9 files, 10017 bytes uncompressed, 4286 bytes compressed:  57.2%
```

## zipnote {}

```diff
@@ -9,20 +9,20 @@
 
 Filename: rvid/tex_runner/latex.py
 Comment: 
 
 Filename: rvid/tex_runner/py.typed
 Comment: 
 
-Filename: rvid.tex_runner-0.1.1.dist-info/METADATA
+Filename: rvid.tex_runner-0.2.0.dist-info/METADATA
 Comment: 
 
-Filename: rvid.tex_runner-0.1.1.dist-info/WHEEL
+Filename: rvid.tex_runner-0.2.0.dist-info/WHEEL
 Comment: 
 
-Filename: rvid.tex_runner-0.1.1.dist-info/top_level.txt
+Filename: rvid.tex_runner-0.2.0.dist-info/top_level.txt
 Comment: 
 
-Filename: rvid.tex_runner-0.1.1.dist-info/RECORD
+Filename: rvid.tex_runner-0.2.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## rvid/tex_runner/__version__.py

```diff
@@ -1,4 +1,4 @@
 # file generated by setuptools_scm
 # don't change, don't track in version control
-__version__ = version = '0.1.1'
-__version_tuple__ = version_tuple = (0, 1, 1)
+__version__ = version = '0.2.0'
+__version_tuple__ = version_tuple = (0, 2, 0)
```

## rvid/tex_runner/latex.py

```diff
@@ -5,39 +5,60 @@
 from pathlib import Path
 from typing import Sequence
 
 from .external_resources import ExternalResources
 
 
 def make_pdf_in_tempdir(
-    tex_file_content: str,
-    external_resource_sequence: Sequence[ExternalResources],
-    silent: bool = True,
+        tex_file_content: str,
+        external_resource_sequence: Sequence[ExternalResources],
+        silent: bool = True,
 ) -> bytes:
     with tempfile.TemporaryDirectory() as work_dir:
         for ext_res in external_resource_sequence:
             ext_res.clone_into_directory(Path(work_dir))
 
         tex_file_path = tempfile.mkstemp(dir=work_dir, suffix=".tex")[1]
         pdf_file_path = os.path.splitext(tex_file_path)[0] + ".pdf"
 
         with open(tex_file_path, "w") as tex_file_fd:
             tex_file_fd.write(tex_file_content)
 
-        run_xelatex(tex_file_path=tex_file_path, silent=silent)
+        success = run_xelatex(tex_file_path=tex_file_path, silent=silent)
+        if not success:
+            raise RuntimeError("Failure during XeLaTeX-run. Giving up. Logs above may not be "
+                               "helpful. Try a manual run to get full context of what went wrong.")
 
         with open(pdf_file_path, "rb") as pdf_file:
             return pdf_file.read()
 
 
-def run_xelatex(tex_file_path: str, rerun: bool = True, silent: bool = True) -> None:
+def run_xelatex(tex_file_path: str, rerun: bool = True, silent: bool = True) -> bool:
     xelatex = shutil.which("xelatex")
     if not xelatex:
         raise RuntimeError("xelatex is not on path")
 
     work_dir = os.path.dirname(tex_file_path)
 
-    subprocess.run([xelatex, tex_file_path], cwd=work_dir, check=True, capture_output=silent)
+    success = _do_run_run(xelatex=xelatex, tex_file_path=tex_file_path, work_dir=work_dir,
+                          silent=silent)
 
-    if rerun:
-        # For some things LaTeX needs a second pass, so we run it again (but don't log output).
-        subprocess.run([xelatex, tex_file_path], cwd=work_dir, check=True, capture_output=silent)
+    if rerun and success:
+        # For some things LaTeX needs a second pass, so we run it again
+        success = _do_run_run(xelatex=xelatex, tex_file_path=tex_file_path, work_dir=work_dir,
+                              silent=silent)
+
+    return success
+
+
+def _do_run_run(xelatex, tex_file_path, work_dir, silent) -> bool:
+    command_list = [xelatex, "-interaction=nonstopmode", tex_file_path]
+    if silent:
+        try:
+            subprocess.check_output(command_list, cwd=work_dir)
+        except subprocess.CalledProcessError as cpe:
+            print(cpe.output)
+            return False
+    else:
+        subprocess.run(command_list, cwd=work_dir, check=True)
+
+    return True
```

## Comparing `rvid.tex_runner-0.1.1.dist-info/METADATA` & `rvid.tex_runner-0.2.0.dist-info/METADATA`

 * *Files 16% similar despite different names*

```diff
@@ -1,37 +1,55 @@
 Metadata-Version: 2.1
 Name: rvid.tex-runner
-Version: 0.1.1
-Summary: Utility functions for rendering XeLaTeX documents frmo Python
+Version: 0.2.0
+Summary: Utility functions for rendering XeLaTeX documents from Python
 Author-email: Arvid MÃ¼llern-Aspegren <kontakt@rvid.se>
 Project-URL: homepage, https://hg.sr.ht/~rvid/rvid.tex-runner
 Requires-Python: >=3.11
 Description-Content-Type: text/markdown
 Provides-Extra: dev
 Requires-Dist: black ; extra == 'dev'
 Requires-Dist: mypy[reports] ; extra == 'dev'
 Requires-Dist: isort ; extra == 'dev'
 
 # rvid.tex-runner
-A small utility to ease programmatic usage of LaTeX from Python.
 
+A small utility to ease programmatic usage of LaTeX from Python.
 
 ## Calling XeLaTeX on output
 
 If you just run the `xelatex` command, you'll get a bunch of temp files output
-to your current working directory. 
+to your current working directory. You also get a few screenfulls of debug out that
+you only really want to see if something goes wrong. No big deal, but a bit of faff.
 
-The function `rvid.tex_runner.make_pdf_at_path()` finds the xelatex-command, creates a 
-temp-directory, runs the command, moves the PDF-file into the location you 
+The function `rvid.tex_runner.make_pdf_at_path()` finds the xelatex-command, creates a
+temp-directory, runs the command, moves the PDF-file into the location you
 specified and then cleans up all the temp files.
 
+```
+def make_pdf_at_path(
+    tex_content=a_string_that_holds_tex_source,
+    target_path="/home/apa/bepa.pdf"
+) 
+```
+
+If you want the resulting PDF returned as a bytestream instead written to disk, just
+use `rvid.tex_runner.make_pdf_as_bytestream()` instead.
+
+## When there is an error
+
+XeLaTeX is run in nonstop mode and will not drop to an interactive prompt if there is a
+problem. If a non-zero exit code is returned, the XeLaTeX output will be dumped to
+stdout, even in silent mode.
+
 ## Handling paths to external resources
-To handle external resources that are needed to build your PDF files, tex-runner has a 
-concept of `ExternalResource`. This is a Python object that contains a sequence of 
-absolute file paths and a relative target path (`basedir`) where your .tex files expect 
+
+To handle external resources that are needed to build your PDF files, tex-runner has a
+concept of `ExternalResource`. This is a Python object that contains a sequence of
+absolute file paths and a relative target path (`basedir`) where your .tex files expect
 to be able to include them from. For example:
 
 ```
 ExternalResource(
     basedir="images",
     files=[
         "/Users/sean.banan/tex/img1.png",
@@ -40,17 +58,20 @@
 )
 ```
 
 This concept also comes in handy if you have differing paths in different deployment
 environments, since it allows you to abstract that away programmatically.
 
 ### Auto-generating ExternalResource-libraries
+
 There is a utility function for auto-generating ExternalResource-objects from filesystem
 paths:
+
 ```
 >>> make_external_resource_library(source_directory="c:/pix", relative_target_directory="img")
 ExternalResource(basedir="img", files=["c:/pix/q1.jpg"])
 ```
 
 ## Debugging
-Change rvid.tex_runner.latex:make_pdf_in_tempdir() so that it doesn't delete
+
+Change `rvid.tex_runner.latex:make_pdf_in_tempdir()` so that it doesn't delete
 the tempdir after finishing the run.
```

