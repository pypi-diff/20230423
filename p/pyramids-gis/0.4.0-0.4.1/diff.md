# Comparing `tmp/pyramids-gis-0.4.0.tar.gz` & `tmp/pyramids-gis-0.4.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pyramids-gis-0.4.0.tar", last modified: Tue Apr 11 20:27:12 2023, max compression
+gzip compressed data, was "pyramids-gis-0.4.1.tar", last modified: Sun Apr 23 10:28:21 2023, max compression
```

## Comparing `pyramids-gis-0.4.0.tar` & `pyramids-gis-0.4.1.tar`

### file list

```diff
@@ -1,27 +1,27 @@
-drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.319140 pyramids-gis-0.4.0/
--rw-rw-rw-   0        0        0      173 2023-01-23 00:40:23.000000 pyramids-gis-0.4.0/AUTHORS.rst
--rw-rw-rw-   0        0        0    35591 2023-01-23 00:40:23.000000 pyramids-gis-0.4.0/LICENSE.md
--rw-rw-rw-   0        0        0    10198 2023-04-11 20:27:12.318136 pyramids-gis-0.4.0/PKG-INFO
--rw-rw-rw-   0        0        0     7038 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/README.md
-drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.264345 pyramids-gis-0.4.0/pyramids/
--rw-rw-rw-   0        0        0     1036 2023-01-23 00:40:23.000000 pyramids-gis-0.4.0/pyramids/__init__.py
--rw-rw-rw-   0        0        0   131171 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/dataset.py
--rw-rw-rw-   0        0        0    29271 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/dem.py
--rw-rw-rw-   0        0        0     1222 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/errors.py
--rw-rw-rw-   0        0        0    38123 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/featurecollection.py
--rw-rw-rw-   0        0        0     5701 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/gdal_drivers.yaml
--rw-rw-rw-   0        0        0     8336 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/io.py
--rw-rw-rw-   0        0        0     6285 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/ogr_drivers.yaml
--rw-rw-rw-   0        0        0     5624 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/utils.py
-drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.309763 pyramids-gis-0.4.0/pyramids_gis.egg-info/
--rw-rw-rw-   0        0        0    10198 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      484 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0      145 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/requires.txt
--rw-rw-rw-   0        0        0        9 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2023-04-11 20:27:12.319140 pyramids-gis-0.4.0/setup.cfg
--rw-rw-rw-   0        0        0     1752 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/setup.py
-drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.314632 pyramids-gis-0.4.0/tests/
--rw-rw-rw-   0        0        0     4742 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/tests/test_io.py
--rw-rw-rw-   0        0        0     1104 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/tests/test_utils.py
+drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.981789 pyramids-gis-0.4.1/
+-rw-rw-rw-   0        0        0      173 2023-01-23 00:40:23.000000 pyramids-gis-0.4.1/AUTHORS.rst
+-rw-rw-rw-   0        0        0    35591 2023-01-23 00:40:23.000000 pyramids-gis-0.4.1/LICENSE.md
+-rw-rw-rw-   0        0        0    10664 2023-04-23 10:28:21.980820 pyramids-gis-0.4.1/PKG-INFO
+-rw-rw-rw-   0        0        0     7028 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/README.md
+drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.966210 pyramids-gis-0.4.1/pyramids/
+-rw-rw-rw-   0        0        0     1036 2023-01-23 00:40:23.000000 pyramids-gis-0.4.1/pyramids/__init__.py
+-rw-rw-rw-   0        0        0     1222 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/_errors.py
+-rw-rw-rw-   0        0        0     8542 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/_io.py
+-rw-rw-rw-   0        0        0     7101 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/_utils.py
+-rw-rw-rw-   0        0        0   141798 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/dataset.py
+-rw-rw-rw-   0        0        0    22445 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/dem.py
+-rw-rw-rw-   0        0        0    38125 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/featurecollection.py
+-rw-rw-rw-   0        0        0     5701 2023-04-11 20:12:29.000000 pyramids-gis-0.4.1/pyramids/gdal_drivers.yaml
+-rw-rw-rw-   0        0        0     6285 2023-04-11 20:12:29.000000 pyramids-gis-0.4.1/pyramids/ogr_drivers.yaml
+drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.973258 pyramids-gis-0.4.1/pyramids_gis.egg-info/
+-rw-rw-rw-   0        0        0    10664 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      487 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0      145 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        9 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2023-04-23 10:28:21.981789 pyramids-gis-0.4.1/setup.cfg
+-rw-rw-rw-   0        0        0     1752 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.977793 pyramids-gis-0.4.1/tests/
+-rw-rw-rw-   0        0        0     4744 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/tests/test_io.py
+-rw-rw-rw-   0        0        0     1453 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/tests/test_utils.py
```

### Comparing `pyramids-gis-0.4.0/LICENSE.md` & `pyramids-gis-0.4.1/LICENSE.md`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.0/PKG-INFO` & `pyramids-gis-0.4.1/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyramids-gis
-Version: 0.4.0
+Version: 0.4.1
 Summary: GIS utility package
 Home-page: https://github.com/MAfarrag/pyramids
 Author: Mostafa Farrag
 Author-email: moah.farag@gmail.come
 License: GNU General Public License v3
 Keywords: GIS,gdal
 Classifier: Development Status :: 5 - Production/Stable
@@ -33,27 +33,27 @@
 ![GitHub last commit](https://img.shields.io/github/last-commit/MAfarrag/pyramids)
 ![GitHub forks](https://img.shields.io/github/forks/MAfarrag/pyramids?style=social)
 ![GitHub Repo stars](https://img.shields.io/github/stars/MAfarrag/pyramids?style=social)
 [![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graph/badge.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
 [![Codacy Badge](https://app.codacy.com/project/badge/Grade/5e3aa4d0acc843d1a91caf33545ecf03)](https://www.codacy.com/gh/Serapieum-of-alex/pyramids/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Serapieum-of-alex/pyramids&amp;utm_campaign=Badge_Grade)
 
 
-![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.2.1?include_prereleases&style=plastic)
+![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.4.1?include_prereleases&style=plastic)
 ![GitHub last commit](https://img.shields.io/github/last-commit/mafarrag/pyramids)
 
 Current release info
 ====================
 
 | Name                                                                                                                 | Downloads                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Version                                                                                                                                                                                                                                                                                                                                                 | Platforms |
 |----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --- |
 | [![Conda Recipe](https://img.shields.io/badge/recipe-pyramids-green.svg)](https://anaconda.org/conda-forge/pyramids) | [![Conda Downloads](https://img.shields.io/conda/dn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![Downloads](https://pepy.tech/badge/pyramids-gis)](https://pepy.tech/project/pyramids-gis) [![Downloads](https://pepy.tech/badge/pyramids-gis/month)](https://pepy.tech/project/pyramids-gis)  [![Downloads](https://pepy.tech/badge/pyramids-gis/week)](https://pepy.tech/project/pyramids-gis)  ![PyPI - Downloads](https://img.shields.io/pypi/dd/pyramids-gis?color=blue&style=flat-square) | [![Conda Version](https://img.shields.io/conda/vn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![PyPI version](https://badge.fury.io/py/pyramids-gis.svg)](https://badge.fury.io/py/pyramids-gis)  | [![Conda Platforms](https://img.shields.io/conda/pn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![Join the chat at https://gitter.im/Hapi-Nile/Hapi](https://badges.gitter.im/Hapi-Nile/Hapi.svg)](https://gitter.im/Hapi-Nile/Hapi?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge) |
 
 pyramids - GIS utility package
 =====================================================================
-**pyramids** is a GIS utility package using gdal, rasterio, ....
+**pyramids** is a GIS utility package using gdal, ....
 
 pyramids
 
 Main Features
 -------------
   - GIS modules to enable the modeler to fully prepare the meteorological inputs and do all the preprocessing
     needed to build the model (align rasters with the DEM), in addition to various methods to manipulate and
@@ -68,15 +68,15 @@
 
 Installing pyramids
 ===============
 
 Installing `pyramids` from the `conda-forge` channel can be achieved by:
 
 ```
-conda install -c conda-forge pyramids=0.3.3
+conda install -c conda-forge pyramids=0.4.1
 ```
 
 It is possible to list all of the versions of `pyramids` available on your platform with:
 
 ```
 conda search pyramids --channel conda-forge
 ```
@@ -86,15 +86,15 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.4.0
+pip install pyramids-gis==0.4.1
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
@@ -166,7 +166,17 @@
 * Add class for multiple Dataset "DataCube".
 * Link both Dataset and FeatureCollection to convert between raster and vector data types.
 * Remove rasterio and netcdf from dependencies and depend only on gdal.
 * Test read rasters/netcdf from virtual file systems (aws, compressed)
 * Add dunder methods for all classes.
 * add plotting functionality and cleopatra (plotting package) as an optional package.
 * remove loops and replace it with ufunc from numpy.
+
+0.4.1 (2023-04-23)
+------------------
+* adjust all spatial operation functions to work with multi-band rasters.
+* use gdal exceptions to capture runtime error of not finding the the file.
+* add cluster method to dataset class.
+* time_stamp attribute returns None if there is no time_stamp.
+* restructure the no_data_value related functions.
+* plot function can plot rgb imagr for multi-band rasters.
+* to_file detect the driver type from the extension in the path.
```

### Comparing `pyramids-gis-0.4.0/README.md` & `pyramids-gis-0.4.1/README.md`

 * *Files 1% similar despite different names*

```diff
@@ -9,27 +9,27 @@
 ![GitHub last commit](https://img.shields.io/github/last-commit/MAfarrag/pyramids)
 ![GitHub forks](https://img.shields.io/github/forks/MAfarrag/pyramids?style=social)
 ![GitHub Repo stars](https://img.shields.io/github/stars/MAfarrag/pyramids?style=social)
 [![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graph/badge.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
 [![Codacy Badge](https://app.codacy.com/project/badge/Grade/5e3aa4d0acc843d1a91caf33545ecf03)](https://www.codacy.com/gh/Serapieum-of-alex/pyramids/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Serapieum-of-alex/pyramids&amp;utm_campaign=Badge_Grade)
 
 
-![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.2.1?include_prereleases&style=plastic)
+![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.4.1?include_prereleases&style=plastic)
 ![GitHub last commit](https://img.shields.io/github/last-commit/mafarrag/pyramids)
 
 Current release info
 ====================
 
 | Name                                                                                                                 | Downloads                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Version                                                                                                                                                                                                                                                                                                                                                 | Platforms |
 |----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --- |
 | [![Conda Recipe](https://img.shields.io/badge/recipe-pyramids-green.svg)](https://anaconda.org/conda-forge/pyramids) | [![Conda Downloads](https://img.shields.io/conda/dn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![Downloads](https://pepy.tech/badge/pyramids-gis)](https://pepy.tech/project/pyramids-gis) [![Downloads](https://pepy.tech/badge/pyramids-gis/month)](https://pepy.tech/project/pyramids-gis)  [![Downloads](https://pepy.tech/badge/pyramids-gis/week)](https://pepy.tech/project/pyramids-gis)  ![PyPI - Downloads](https://img.shields.io/pypi/dd/pyramids-gis?color=blue&style=flat-square) | [![Conda Version](https://img.shields.io/conda/vn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![PyPI version](https://badge.fury.io/py/pyramids-gis.svg)](https://badge.fury.io/py/pyramids-gis)  | [![Conda Platforms](https://img.shields.io/conda/pn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![Join the chat at https://gitter.im/Hapi-Nile/Hapi](https://badges.gitter.im/Hapi-Nile/Hapi.svg)](https://gitter.im/Hapi-Nile/Hapi?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge) |
 
 pyramids - GIS utility package
 =====================================================================
-**pyramids** is a GIS utility package using gdal, rasterio, ....
+**pyramids** is a GIS utility package using gdal, ....
 
 pyramids
 
 Main Features
 -------------
   - GIS modules to enable the modeler to fully prepare the meteorological inputs and do all the preprocessing
     needed to build the model (align rasters with the DEM), in addition to various methods to manipulate and
@@ -44,15 +44,15 @@
 
 Installing pyramids
 ===============
 
 Installing `pyramids` from the `conda-forge` channel can be achieved by:
 
 ```
-conda install -c conda-forge pyramids=0.3.3
+conda install -c conda-forge pyramids=0.4.1
 ```
 
 It is possible to list all of the versions of `pyramids` available on your platform with:
 
 ```
 conda search pyramids --channel conda-forge
 ```
@@ -62,15 +62,15 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.4.0
+pip install pyramids-gis==0.4.1
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
```

### Comparing `pyramids-gis-0.4.0/pyramids/__init__.py` & `pyramids-gis-0.4.1/pyramids/__init__.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.0/pyramids/dataset.py` & `pyramids-gis-0.4.1/pyramids/dataset.py`

 * *Files 3% similar despite different names*

```diff
@@ -35,8165 +35,8829 @@
 00000220: 7461 4672 616d 652c 2044 6174 6146 7261  taFrame, DataFra
 00000230: 6d65 0d0a 6672 6f6d 206f 7367 656f 2069  me..from osgeo i
 00000240: 6d70 6f72 7420 6764 616c 2c20 6f73 722c  mport gdal, osr,
 00000250: 206f 6772 2020 2320 6764 616c 636f 6e73   ogr  # gdalcons
 00000260: 742c 0d0a 6672 6f6d 206f 7367 656f 2e6f  t,..from osgeo.o
 00000270: 7372 2069 6d70 6f72 7420 5370 6174 6961  sr import Spatia
 00000280: 6c52 6566 6572 656e 6365 0d0a 6672 6f6d  lReference..from
-00000290: 2070 7972 616d 6964 732e 7574 696c 7320   pyramids.utils 
-000002a0: 696d 706f 7274 2028 0d0a 2020 2020 6764  import (..    gd
-000002b0: 616c 5f74 6f5f 6f67 725f 6474 7970 652c  al_to_ogr_dtype,
-000002c0: 0d0a 2020 2020 494e 5445 5250 4f4c 4154  ..    INTERPOLAT
-000002d0: 494f 4e5f 4d45 5448 4f44 532c 0d0a 2020  ION_METHODS,..  
-000002e0: 2020 4e55 4d50 595f 4744 414c 5f44 4154    NUMPY_GDAL_DAT
-000002f0: 415f 5459 5045 532c 0d0a 2020 2020 6764  A_TYPES,..    gd
-00000300: 616c 5f74 6f5f 6e75 6d70 795f 6474 7970  al_to_numpy_dtyp
-00000310: 652c 0d0a 2020 2020 6e75 6d70 795f 746f  e,..    numpy_to
-00000320: 5f67 6461 6c5f 6474 7970 652c 0d0a 2020  _gdal_dtype,..  
-00000330: 2020 6372 6561 7465 5f74 696d 655f 636f    create_time_co
-00000340: 6e76 6572 7369 6f6e 5f66 756e 632c 0d0a  nversion_func,..
-00000350: 2020 2020 4361 7461 6c6f 672c 0d0a 2020      Catalog,..  
-00000360: 2020 696d 706f 7274 5f63 6c65 6f70 6174    import_cleopat
-00000370: 7261 2c0d 0a29 0d0a 6672 6f6d 2070 7972  ra,..)..from pyr
-00000380: 616d 6964 732e 6572 726f 7273 2069 6d70  amids.errors imp
-00000390: 6f72 7420 280d 0a20 2020 2052 6561 644f  ort (..    ReadO
-000003a0: 6e6c 7945 7272 6f72 2c0d 0a20 2020 2044  nlyError,..    D
-000003b0: 6174 6173 6574 4e6f 466f 756e 6445 7272  atasetNoFoundErr
-000003c0: 6f72 2c0d 0a20 2020 204e 6f44 6174 6156  or,..    NoDataV
-000003d0: 616c 7565 4572 726f 722c 0d0a 2020 2020  alueError,..    
-000003e0: 416c 6967 6e6d 656e 7445 7272 6f72 2c0d  AlignmentError,.
-000003f0: 0a20 2020 2044 7269 7665 724e 6f74 4578  .    DriverNotEx
-00000400: 6973 7445 7272 6f72 2c0d 0a29 0d0a 0d0a  istError,..)....
-00000410: 7472 793a 0d0a 2020 2020 6672 6f6d 206f  try:..    from o
-00000420: 7367 656f 5f75 7469 6c73 2069 6d70 6f72  sgeo_utils impor
-00000430: 7420 6764 616c 5f6d 6572 6765 0d0a 6578  t gdal_merge..ex
-00000440: 6365 7074 204d 6f64 756c 654e 6f74 466f  cept ModuleNotFo
-00000450: 756e 6445 7272 6f72 3a0d 0a20 2020 206c  undError:..    l
-00000460: 6f67 6765 722e 7761 726e 696e 6728 0d0a  ogger.warning(..
-00000470: 2020 2020 2020 2020 226f 7367 656f 5f75          "osgeo_u
-00000480: 7469 6c73 206d 6f64 756c 6520 646f 6573  tils module does
-00000490: 206e 6f74 2065 7869 7374 2074 7279 2069   not exist try i
-000004a0: 6e73 7461 6c6c 2070 6970 2069 6e73 7461  nstall pip insta
-000004b0: 6c6c 206f 7367 656f 2d75 7469 6c73 2022  ll osgeo-utils "
-000004c0: 0d0a 2020 2020 290d 0a0d 0a66 726f 6d20  ..    )....from 
-000004d0: 6870 632e 6669 6c74 6572 2069 6d70 6f72  hpc.filter impor
-000004e0: 7420 6765 745f 7069 7865 6c73 2c20 6765  t get_pixels, ge
-000004f0: 745f 696e 6469 6365 7332 2c20 6765 745f  t_indices2, get_
-00000500: 7069 7865 6c73 322c 206c 6f63 6174 655f  pixels2, locate_
-00000510: 7661 6c75 6573 0d0a 6672 6f6d 2070 7972  values..from pyr
-00000520: 616d 6964 732e 6665 6174 7572 6563 6f6c  amids.featurecol
-00000530: 6c65 6374 696f 6e20 696d 706f 7274 2046  lection import F
-00000540: 6561 7475 7265 436f 6c6c 6563 7469 6f6e  eatureCollection
-00000550: 0d0a 6672 6f6d 2070 7972 616d 6964 7320  ..from pyramids 
-00000560: 696d 706f 7274 2069 6f0d 0a0d 0a44 4546  import io....DEF
-00000570: 4155 4c54 5f4e 4f5f 4441 5441 5f56 414c  AULT_NO_DATA_VAL
-00000580: 5545 203d 202d 3939 3939 0d0a 4341 5441  UE = -9999..CATA
-00000590: 4c4f 4720 3d20 4361 7461 6c6f 6728 7261  LOG = Catalog(ra
-000005a0: 7374 6572 5f64 7269 7665 723d 5472 7565  ster_driver=True
-000005b0: 290d 0a0d 0a23 2042 7920 6465 6661 756c  )....# By defaul
-000005c0: 742c 2074 6865 2047 4441 4c20 616e 6420  t, the GDAL and 
-000005d0: 4f47 5220 5079 7468 6f6e 2062 696e 6469  OGR Python bindi
-000005e0: 6e67 7320 646f 206e 6f74 2072 6169 7365  ngs do not raise
-000005f0: 2065 7863 6570 7469 6f6e 7320 7768 656e   exceptions when
-00000600: 2065 7272 6f72 7320 6f63 6375 722e 2049   errors occur. I
-00000610: 6e73 7465 6164 2074 6865 7920 7265 7475  nstead they retu
-00000620: 726e 2061 6e20 6572 726f 720d 0a23 2076  rn an error..# v
-00000630: 616c 7565 2073 7563 6820 6173 204e 6f6e  alue such as Non
-00000640: 6520 616e 6420 7772 6974 6520 616e 2065  e and write an e
-00000650: 7272 6f72 206d 6573 7361 6765 2074 6f20  rror message to 
-00000660: 7379 732e 7374 646f 7574 2c20 746f 2072  sys.stdout, to r
-00000670: 6570 6f72 7420 6572 726f 7273 2062 7920  eport errors by 
-00000680: 7261 6973 696e 6720 6578 6365 7074 696f  raising exceptio
-00000690: 6e73 2e20 596f 7520 6361 6e20 656e 6162  ns. You can enab
-000006a0: 6c65 0d0a 2320 7468 6973 2062 6568 6176  le..# this behav
-000006b0: 696f 7220 696e 2047 4441 4c20 616e 6420  ior in GDAL and 
-000006c0: 4f47 5220 6279 2063 616c 6c69 6e67 2074  OGR by calling t
-000006d0: 6865 2055 7365 4578 6365 7074 696f 6e73  he UseExceptions
-000006e0: 2829 0d0a 6764 616c 2e55 7365 4578 6365  ()..gdal.UseExce
-000006f0: 7074 696f 6e73 2829 0d0a 2320 6764 616c  ptions()..# gdal
-00000700: 2e45 7272 6f72 5265 7365 7428 290d 0a0d  .ErrorReset()...
-00000710: 0a0d 0a63 6c61 7373 2044 6174 6173 6574  ...class Dataset
-00000720: 3a0d 0a20 2020 2022 2222 4461 7461 7365  :..    """Datase
-00000730: 7420 636c 6173 7320 636f 6e74 6169 6e73  t class contains
-00000740: 206d 6574 686f 6473 2074 6f20 6465 616c   methods to deal
-00000750: 2077 6974 6820 7261 7374 6572 7320 616e   with rasters an
-00000760: 6420 6e65 7463 6466 2066 696c 6573 2c20  d netcdf files, 
-00000770: 6368 616e 6765 2070 726f 6a65 6374 696f  change projectio
-00000780: 6e20 616e 6420 636f 6f72 6469 6e61 7465  n and coordinate
-00000790: 2073 7973 7465 6d73 2e22 2222 0d0a 0d0a   systems."""....
-000007a0: 2020 2020 6465 6661 756c 745f 6e6f 5f64      default_no_d
-000007b0: 6174 615f 7661 6c75 6520 3d20 4445 4641  ata_value = DEFA
-000007c0: 554c 545f 4e4f 5f44 4154 415f 5641 4c55  ULT_NO_DATA_VALU
-000007d0: 450d 0a0d 0a20 2020 2064 6566 205f 5f69  E....    def __i
-000007e0: 6e69 745f 5f28 7365 6c66 2c20 7372 633a  nit__(self, src:
-000007f0: 2067 6461 6c2e 4461 7461 7365 7429 3a0d   gdal.Dataset):.
-00000800: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00000810: 6973 696e 7374 616e 6365 2873 7263 2c20  isinstance(src, 
-00000820: 6764 616c 2e44 6174 6173 6574 293a 0d0a  gdal.Dataset):..
-00000830: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00000840: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
-00000850: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00000860: 7263 2073 686f 756c 6420 6265 2072 6561  rc should be rea
-00000870: 6420 7573 696e 6720 6764 616c 2028 6764  d using gdal (gd
-00000880: 616c 2064 6174 6173 6574 2070 6c65 6173  al dataset pleas
-00000890: 6520 7265 6164 2069 7420 7573 696e 6720  e read it using 
-000008a0: 6764 616c 220d 0a20 2020 2020 2020 2020  gdal"..         
-000008b0: 2020 2020 2020 2066 2220 6c69 6272 6172         f" librar
-000008c0: 7929 2067 6976 656e 207b 7479 7065 2873  y) given {type(s
-000008d0: 7263 297d 220d 0a20 2020 2020 2020 2020  rc)}"..         
-000008e0: 2020 2029 0d0a 2020 2020 2020 2020 7365     )..        se
-000008f0: 6c66 2e5f 7261 7374 6572 203d 2073 7263  lf._raster = src
-00000900: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00000910: 6765 6f74 7261 6e73 666f 726d 203d 2073  geotransform = s
-00000920: 7263 2e47 6574 4765 6f54 7261 6e73 666f  rc.GetGeoTransfo
-00000930: 726d 2829 0d0a 2020 2020 2020 2020 7365  rm()..        se
-00000940: 6c66 2e5f 6365 6c6c 5f73 697a 6520 3d20  lf._cell_size = 
-00000950: 7365 6c66 2e67 656f 7472 616e 7366 6f72  self.geotransfor
-00000960: 6d5b 315d 0d0a 2020 2020 2020 2020 7365  m[1]..        se
-00000970: 6c66 2e5f 6d65 7461 5f64 6174 6120 3d20  lf._meta_data = 
-00000980: 7372 632e 4765 744d 6574 6164 6174 6128  src.GetMetadata(
-00000990: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000009a0: 5f66 696c 655f 6e61 6d65 203d 2073 7263  _file_name = src
-000009b0: 2e47 6574 4465 7363 7269 7074 696f 6e28  .GetDescription(
-000009c0: 290d 0a20 2020 2020 2020 2023 2070 726f  )..        # pro
-000009d0: 6a65 6374 696f 6e20 6461 7461 0d0a 2020  jection data..  
-000009e0: 2020 2020 2020 2320 7468 6520 6570 7367        # the epsg
-000009f0: 2070 726f 7065 7274 7920 7265 7475 726e   property return
-00000a00: 7320 7468 6520 7661 6c75 6520 6f66 2074  s the value of t
-00000a10: 6865 205f 6570 7367 2061 7474 7269 6275  he _epsg attribu
-00000a20: 7465 2073 6f20 6966 2074 6865 2070 726f  te so if the pro
-00000a30: 6a65 6374 696f 6e20 6368 616e 6765 7320  jection changes 
-00000a40: 696e 2061 6e79 2066 756e 6374 696f 6e20  in any function 
-00000a50: 7468 650d 0a20 2020 2020 2020 2023 2066  the..        # f
-00000a60: 756e 6374 696f 6e20 7368 6f75 6c64 2061  unction should a
-00000a70: 6c73 6f20 6368 616e 6765 2074 6865 2076  lso change the v
-00000a80: 616c 7565 206f 6620 7468 6520 5f65 7073  alue of the _eps
-00000a90: 6720 6174 7472 6962 7574 652e 0d0a 2020  g attribute...  
-00000aa0: 2020 2020 2020 7365 6c66 2e5f 6570 7367        self._epsg
-00000ab0: 203d 2073 656c 662e 5f67 6574 5f65 7073   = self._get_eps
-00000ac0: 6728 290d 0a20 2020 2020 2020 2023 2076  g()..        # v
-00000ad0: 6172 6961 626c 6573 2061 6e64 2073 7562  ariables and sub
-00000ae0: 7365 7473 0d0a 2020 2020 2020 2020 7365  sets..        se
-00000af0: 6c66 2e73 7562 7365 7473 203d 2073 7263  lf.subsets = src
-00000b00: 2e47 6574 5375 6244 6174 6173 6574 7328  .GetSubDatasets(
-00000b10: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00000b20: 5f76 6172 6961 626c 6573 203d 2073 656c  _variables = sel
-00000b30: 662e 6765 745f 7661 7269 6162 6c65 7328  f.get_variables(
-00000b40: 290d 0a20 2020 2020 2020 2023 2061 7272  )..        # arr
-00000b50: 6179 2061 6e64 2064 696d 656e 7369 6f6e  ay and dimension
-00000b60: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
-00000b70: 5f72 6f77 7320 3d20 7372 632e 5261 7374  _rows = src.Rast
-00000b80: 6572 5953 697a 650d 0a20 2020 2020 2020  erYSize..       
-00000b90: 2073 656c 662e 5f63 6f6c 756d 6e73 203d   self._columns =
-00000ba0: 2073 7263 2e52 6173 7465 7258 5369 7a65   src.RasterXSize
-00000bb0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00000bc0: 6261 6e64 5f63 6f75 6e74 203d 2073 7263  band_count = src
-00000bd0: 2e52 6173 7465 7243 6f75 6e74 0d0a 2020  .RasterCount..  
-00000be0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00000bf0: 662e 7375 6273 6574 7329 203e 2030 3a0d  f.subsets) > 0:.
-00000c00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00000c10: 662e 5f74 696d 655f 7374 616d 7020 3d20  f._time_stamp = 
-00000c20: 7365 6c66 2e5f 6765 745f 7469 6d65 5f76  self._get_time_v
-00000c30: 6172 6961 626c 6528 290d 0a20 2020 2020  ariable()..     
-00000c40: 2020 2020 2020 2073 656c 662e 5f6c 6174         self._lat
-00000c50: 2c20 7365 6c66 2e5f 6c6f 6e20 3d20 7365  , self._lon = se
-00000c60: 6c66 2e5f 6765 745f 6c61 745f 6c6f 6e28  lf._get_lat_lon(
-00000c70: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
-00000c80: 662e 5f6e 6f5f 6461 7461 5f76 616c 7565  f._no_data_value
-00000c90: 203d 205b 0d0a 2020 2020 2020 2020 2020   = [..          
-00000ca0: 2020 7372 632e 4765 7452 6173 7465 7242    src.GetRasterB
-00000cb0: 616e 6428 6929 2e47 6574 4e6f 4461 7461  and(i).GetNoData
-00000cc0: 5661 6c75 6528 2920 666f 7220 6920 696e  Value() for i in
-00000cd0: 2072 616e 6765 2831 2c20 7365 6c66 2e62   range(1, self.b
-00000ce0: 616e 645f 636f 756e 7420 2b20 3129 0d0a  and_count + 1)..
-00000cf0: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
-00000d00: 2020 2073 656c 662e 5f64 7479 7065 203d     self._dtype =
-00000d10: 205b 0d0a 2020 2020 2020 2020 2020 2020   [..            
-00000d20: 7372 632e 4765 7452 6173 7465 7242 616e  src.GetRasterBan
-00000d30: 6428 6929 2e44 6174 6154 7970 6520 666f  d(i).DataType fo
-00000d40: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
-00000d50: 7365 6c66 2e62 616e 645f 636f 756e 7420  self.band_count 
-00000d60: 2b20 3129 0d0a 2020 2020 2020 2020 5d0d  + 1)..        ].
-00000d70: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00000d80: 5f62 616e 645f 6e61 6d65 7320 3d20 7365  _band_names = se
-00000d90: 6c66 2e67 6574 5f62 616e 645f 6e61 6d65  lf.get_band_name
-00000da0: 7328 290d 0a0d 0a20 2020 2064 6566 205f  s()....    def _
-00000db0: 5f73 7472 5f5f 2873 656c 6629 3a0d 0a20  _str__(self):.. 
-00000dc0: 2020 2020 2020 206d 6573 7361 6765 203d         message =
-00000dd0: 2066 2222 220d 0a20 2020 2020 2020 2020   f"""..         
-00000de0: 2020 2046 696c 653a 207b 7365 6c66 2e66     File: {self.f
-00000df0: 696c 655f 6e61 6d65 7d0d 0a20 2020 2020  ile_name}..     
-00000e00: 2020 2020 2020 2043 656c 6c20 7369 7a65         Cell size
-00000e10: 3a20 7b73 656c 662e 6365 6c6c 5f73 697a  : {self.cell_siz
-00000e20: 657d 0d0a 2020 2020 2020 2020 2020 2020  e}..            
-00000e30: 4550 5347 3a20 7b73 656c 662e 6570 7367  EPSG: {self.epsg
-00000e40: 7d0d 0a20 2020 2020 2020 2020 2020 2056  }..            V
-00000e50: 6172 6961 626c 6573 3a20 7b73 656c 662e  ariables: {self.
-00000e60: 7661 7269 6162 6c65 737d 0d0a 2020 2020  variables}..    
-00000e70: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-00000e80: 6620 4261 6e64 733a 207b 7365 6c66 2e62  f Bands: {self.b
-00000e90: 616e 645f 636f 756e 747d 0d0a 2020 2020  and_count}..    
-00000ea0: 2020 2020 2020 2020 4261 6e64 206e 616d          Band nam
-00000eb0: 6573 3a20 7b73 656c 662e 6261 6e64 5f6e  es: {self.band_n
-00000ec0: 616d 6573 7d0d 0a20 2020 2020 2020 2020  ames}..         
-00000ed0: 2020 2044 696d 656e 7369 6f6e 3a20 7b73     Dimension: {s
-00000ee0: 656c 662e 726f 7773 202a 2073 656c 662e  elf.rows * self.
-00000ef0: 636f 6c75 6d6e 737d 0d0a 2020 2020 2020  columns}..      
-00000f00: 2020 2020 2020 4d61 736b 3a20 7b73 656c        Mask: {sel
-00000f10: 662e 5f6e 6f5f 6461 7461 5f76 616c 7565  f._no_data_value
-00000f20: 5b30 5d7d 0d0a 2020 2020 2020 2020 2020  [0]}..          
-00000f30: 2020 4461 7461 2074 7970 653a 207b 7365    Data type: {se
-00000f40: 6c66 2e64 7479 7065 5b30 5d7d 0d0a 2020  lf.dtype[0]}..  
-00000f50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00000f60: 2020 2072 6574 7572 6e20 6d65 7373 6167     return messag
-00000f70: 650d 0a0d 0a20 2020 2064 6566 205f 5f72  e....    def __r
-00000f80: 6570 725f 5f28 7365 6c66 293a 0d0a 2020  epr__(self):..  
-00000f90: 2020 2020 2020 6d65 7373 6167 6520 3d20        message = 
-00000fa0: 2222 220d 0a20 2020 2020 2020 2020 2020  """..           
-00000fb0: 2046 696c 653a 207b 307d 0d0a 2020 2020   File: {0}..    
-00000fc0: 2020 2020 2020 2020 4365 6c6c 2073 697a          Cell siz
-00000fd0: 653a 207b 317d 0d0a 2020 2020 2020 2020  e: {1}..        
-00000fe0: 2020 2020 4550 5347 3a20 7b32 7d0d 0a20      EPSG: {2}.. 
-00000ff0: 2020 2020 2020 2020 2020 2056 6172 6961             Varia
-00001000: 626c 6573 3a20 7b33 7d0d 0a20 2020 2020  bles: {3}..     
-00001010: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-00001020: 2042 616e 6473 3a20 7b34 7d0d 0a20 2020   Bands: {4}..   
-00001030: 2020 2020 2020 2020 2042 616e 6420 6e61           Band na
-00001040: 6d65 733a 207b 357d 0d0a 2020 2020 2020  mes: {5}..      
-00001050: 2020 2020 2020 4469 6d65 6e73 696f 6e3a        Dimension:
-00001060: 207b 367d 202a 207b 377d 0d0a 2020 2020   {6} * {7}..    
-00001070: 2020 2020 2020 2020 4d61 736b 3a20 7b38          Mask: {8
-00001080: 7d0d 0a20 2020 2020 2020 2020 2020 2044  }..            D
-00001090: 6174 6120 7479 7065 3a20 7b39 7d0d 0a20  ata type: {9}.. 
-000010a0: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-000010b0: 6374 696f 6e3a 207b 3130 7d0d 0a20 2020  ction: {10}..   
-000010c0: 2020 2020 2020 2020 204d 6574 6164 6174           Metadat
-000010d0: 613a 207b 3131 7d0d 0a20 2020 2020 2020  a: {11}..       
-000010e0: 2022 2222 2e66 6f72 6d61 7428 0d0a 2020   """.format(..  
-000010f0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00001100: 696c 655f 6e61 6d65 2c0d 0a20 2020 2020  ile_name,..     
-00001110: 2020 2020 2020 2073 656c 662e 6365 6c6c         self.cell
-00001120: 5f73 697a 652c 0d0a 2020 2020 2020 2020  _size,..        
-00001130: 2020 2020 7365 6c66 2e65 7073 672c 0d0a      self.epsg,..
-00001140: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001150: 2e76 6172 6961 626c 6573 2c0d 0a20 2020  .variables,..   
-00001160: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00001170: 6e64 5f63 6f75 6e74 2c0d 0a20 2020 2020  nd_count,..     
-00001180: 2020 2020 2020 2073 656c 662e 6261 6e64         self.band
-00001190: 5f6e 616d 6573 2c0d 0a20 2020 2020 2020  _names,..       
-000011a0: 2020 2020 2073 656c 662e 726f 7773 2c0d       self.rows,.
-000011b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000011c0: 662e 636f 6c75 6d6e 732c 0d0a 2020 2020  f.columns,..    
-000011d0: 2020 2020 2020 2020 7365 6c66 2e5f 6e6f          self._no
-000011e0: 5f64 6174 615f 7661 6c75 655b 305d 2c0d  _data_value[0],.
-000011f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00001200: 662e 6474 7970 655b 305d 2c0d 0a20 2020  f.dtype[0],..   
-00001210: 2020 2020 2020 2020 2073 656c 662e 6372           self.cr
-00001220: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-00001230: 7365 6c66 2e6d 6574 615f 6461 7461 2c0d  self.meta_data,.
-00001240: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
-00001250: 2020 2020 7265 7475 726e 206d 6573 7361      return messa
-00001260: 6765 0d0a 0d0a 2020 2020 4070 726f 7065  ge....    @prope
-00001270: 7274 790d 0a20 2020 2064 6566 2072 6173  rty..    def ras
-00001280: 7465 7228 7365 6c66 2920 2d3e 2067 6461  ter(self) -> gda
-00001290: 6c2e 4461 7461 7365 743a 0d0a 2020 2020  l.Dataset:..    
-000012a0: 2020 2020 2222 2247 4441 4c20 4461 7461      """GDAL Data
-000012b0: 7365 7422 2222 0d0a 2020 2020 2020 2020  set"""..        
-000012c0: 7265 7475 726e 2073 656c 662e 5f72 6173  return self._ras
-000012d0: 7465 720d 0a0d 0a20 2020 2040 7261 7374  ter....    @rast
-000012e0: 6572 2e73 6574 7465 720d 0a20 2020 2064  er.setter..    d
-000012f0: 6566 2072 6173 7465 7228 7365 6c66 2c20  ef raster(self, 
-00001300: 7661 6c75 653a 2067 6461 6c2e 4461 7461  value: gdal.Data
-00001310: 7365 7429 3a0d 0a20 2020 2020 2020 2073  set):..        s
-00001320: 656c 662e 5f72 6173 7465 7220 3d20 7661  elf._raster = va
-00001330: 6c75 650d 0a0d 0a20 2020 2040 7072 6f70  lue....    @prop
-00001340: 6572 7479 0d0a 2020 2020 6465 6620 7661  erty..    def va
-00001350: 6c75 6573 2873 656c 6629 202d 3e20 6e70  lues(self) -> np
-00001360: 2e6e 6461 7272 6179 3a0d 0a20 2020 2020  .ndarray:..     
-00001370: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
-00001380: 6561 645f 6172 7261 7928 6261 6e64 3d4e  ead_array(band=N
-00001390: 6f6e 6529 0d0a 0d0a 2020 2020 4070 726f  one)....    @pro
-000013a0: 7065 7274 790d 0a20 2020 2064 6566 2072  perty..    def r
-000013b0: 6f77 7328 7365 6c66 2920 2d3e 2069 6e74  ows(self) -> int
-000013c0: 3a0d 0a20 2020 2020 2020 2022 2222 4e75  :..        """Nu
-000013d0: 6d62 6572 206f 6620 726f 7773 2069 6e20  mber of rows in 
-000013e0: 7468 6520 7261 7374 6572 2061 7272 6179  the raster array
-000013f0: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
-00001400: 7475 726e 2073 656c 662e 5f72 6f77 730d  turn self._rows.
-00001410: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
-00001420: 0d0a 2020 2020 6465 6620 636f 6c75 6d6e  ..    def column
-00001430: 7328 7365 6c66 2920 2d3e 2069 6e74 3a0d  s(self) -> int:.
-00001440: 0a20 2020 2020 2020 2022 2222 4e75 6d62  .        """Numb
-00001450: 6572 206f 6620 636f 6c75 6d6e 7320 696e  er of columns in
-00001460: 2074 6865 2072 6173 7465 7220 6172 7261   the raster arra
-00001470: 792e 2222 220d 0a20 2020 2020 2020 2072  y."""..        r
-00001480: 6574 7572 6e20 7365 6c66 2e5f 636f 6c75  eturn self._colu
-00001490: 6d6e 730d 0a0d 0a20 2020 2040 7072 6f70  mns....    @prop
-000014a0: 6572 7479 0d0a 2020 2020 6465 6620 7368  erty..    def sh
-000014b0: 6170 6528 7365 6c66 293a 0d0a 2020 2020  ape(self):..    
-000014c0: 2020 2020 2222 2244 6174 6173 6574 2073      """Dataset s
-000014d0: 6861 7065 2222 220d 0a20 2020 2020 2020  hape"""..       
-000014e0: 2072 6574 7572 6e20 7365 6c66 2e62 616e   return self.ban
-000014f0: 645f 636f 756e 742c 2073 656c 662e 726f  d_count, self.ro
-00001500: 7773 2c20 7365 6c66 2e63 6f6c 756d 6e73  ws, self.columns
-00001510: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-00001520: 790d 0a20 2020 2064 6566 2067 656f 7472  y..    def geotr
-00001530: 616e 7366 6f72 6d28 7365 6c66 293a 0d0a  ansform(self):..
-00001540: 2020 2020 2020 2020 2222 2257 4b54 2070          """WKT p
-00001550: 726f 6a65 6374 696f 6e2e 2222 220d 0a20  rojection.""".. 
-00001560: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00001570: 6c66 2e5f 6765 6f74 7261 6e73 666f 726d  lf._geotransform
-00001580: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-00001590: 790d 0a20 2020 2064 6566 2070 6976 6f74  y..    def pivot
-000015a0: 5f70 6f69 6e74 2873 656c 6629 3a0d 0a20  _point(self):.. 
-000015b0: 2020 2020 2020 2022 2222 546f 7020 6c65         """Top le
-000015c0: 6674 2063 6f72 6e65 7220 636f 6f72 6469  ft corner coordi
-000015d0: 6e61 7465 732e 2222 220d 0a20 2020 2020  nates."""..     
-000015e0: 2020 2078 6d69 6e2c 205f 2c20 5f2c 2079     xmin, _, _, y
-000015f0: 6d61 782c 205f 2c20 5f20 3d20 7365 6c66  max, _, _ = self
-00001600: 2e5f 6765 6f74 7261 6e73 666f 726d 0d0a  ._geotransform..
-00001610: 2020 2020 2020 2020 7265 7475 726e 2078          return x
-00001620: 6d69 6e2c 2079 6d61 780d 0a0d 0a20 2020  min, ymax....   
-00001630: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
-00001640: 6465 6620 626f 756e 6473 2873 656c 6629  def bounds(self)
-00001650: 202d 3e20 4765 6f44 6174 6146 7261 6d65   -> GeoDataFrame
-00001660: 3a0d 0a20 2020 2020 2020 2022 2222 626f  :..        """bo
-00001670: 756e 6473 2222 220d 0a20 2020 2020 2020  unds"""..       
-00001680: 2072 6574 7572 6e20 7365 6c66 2e5f 6361   return self._ca
-00001690: 6c63 756c 6174 655f 626f 756e 6473 2829  lculate_bounds()
-000016a0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-000016b0: 790d 0a20 2020 2064 6566 2062 626f 7828  y..    def bbox(
-000016c0: 7365 6c66 2920 2d3e 204c 6973 743a 0d0a  self) -> List:..
-000016d0: 2020 2020 2020 2020 2222 225b 786d 696e          """[xmin
-000016e0: 2c20 796d 696e 2c20 786d 6178 2c20 796d  , ymin, xmax, ym
-000016f0: 6178 5d22 2222 0d0a 2020 2020 2020 2020  ax]"""..        
+00000290: 2070 7972 616d 6964 732e 5f75 7469 6c73   pyramids._utils
+000002a0: 2069 6d70 6f72 7420 280d 0a20 2020 2067   import (..    g
+000002b0: 6461 6c5f 746f 5f6f 6772 5f64 7479 7065  dal_to_ogr_dtype
+000002c0: 2c0d 0a20 2020 2049 4e54 4552 504f 4c41  ,..    INTERPOLA
+000002d0: 5449 4f4e 5f4d 4554 484f 4453 2c0d 0a20  TION_METHODS,.. 
+000002e0: 2020 204e 554d 5059 5f47 4441 4c5f 4441     NUMPY_GDAL_DA
+000002f0: 5441 5f54 5950 4553 2c0d 0a20 2020 2067  TA_TYPES,..    g
+00000300: 6461 6c5f 746f 5f6e 756d 7079 5f64 7479  dal_to_numpy_dty
+00000310: 7065 2c0d 0a20 2020 206e 756d 7079 5f74  pe,..    numpy_t
+00000320: 6f5f 6764 616c 5f64 7479 7065 2c0d 0a20  o_gdal_dtype,.. 
+00000330: 2020 2063 7265 6174 655f 7469 6d65 5f63     create_time_c
+00000340: 6f6e 7665 7273 696f 6e5f 6675 6e63 2c0d  onversion_func,.
+00000350: 0a20 2020 2043 6174 616c 6f67 2c0d 0a20  .    Catalog,.. 
+00000360: 2020 2069 6d70 6f72 745f 636c 656f 7061     import_cleopa
+00000370: 7472 612c 0d0a 290d 0a66 726f 6d20 7079  tra,..)..from py
+00000380: 7261 6d69 6473 2e5f 6572 726f 7273 2069  ramids._errors i
+00000390: 6d70 6f72 7420 280d 0a20 2020 2052 6561  mport (..    Rea
+000003a0: 644f 6e6c 7945 7272 6f72 2c0d 0a20 2020  dOnlyError,..   
+000003b0: 2044 6174 6173 6574 4e6f 466f 756e 6445   DatasetNoFoundE
+000003c0: 7272 6f72 2c0d 0a20 2020 204e 6f44 6174  rror,..    NoDat
+000003d0: 6156 616c 7565 4572 726f 722c 0d0a 2020  aValueError,..  
+000003e0: 2020 416c 6967 6e6d 656e 7445 7272 6f72    AlignmentError
+000003f0: 2c0d 0a29 0d0a 0d0a 7472 793a 0d0a 2020  ,..)....try:..  
+00000400: 2020 6672 6f6d 206f 7367 656f 5f75 7469    from osgeo_uti
+00000410: 6c73 2069 6d70 6f72 7420 6764 616c 5f6d  ls import gdal_m
+00000420: 6572 6765 0d0a 6578 6365 7074 204d 6f64  erge..except Mod
+00000430: 756c 654e 6f74 466f 756e 6445 7272 6f72  uleNotFoundError
+00000440: 3a0d 0a20 2020 206c 6f67 6765 722e 7761  :..    logger.wa
+00000450: 726e 696e 6728 0d0a 2020 2020 2020 2020  rning(..        
+00000460: 226f 7367 656f 5f75 7469 6c73 206d 6f64  "osgeo_utils mod
+00000470: 756c 6520 646f 6573 206e 6f74 2065 7869  ule does not exi
+00000480: 7374 2074 7279 2069 6e73 7461 6c6c 2070  st try install p
+00000490: 6970 2069 6e73 7461 6c6c 206f 7367 656f  ip install osgeo
+000004a0: 2d75 7469 6c73 2022 0d0a 2020 2020 290d  -utils "..    ).
+000004b0: 0a0d 0a66 726f 6d20 6870 632e 696e 6465  ...from hpc.inde
+000004c0: 7869 6e67 2069 6d70 6f72 7420 6765 745f  xing import get_
+000004d0: 7069 7865 6c73 2c20 6765 745f 696e 6469  pixels, get_indi
+000004e0: 6365 7332 2c20 6765 745f 7069 7865 6c73  ces2, get_pixels
+000004f0: 322c 206c 6f63 6174 655f 7661 6c75 6573  2, locate_values
+00000500: 0d0a 6672 6f6d 2070 7972 616d 6964 732e  ..from pyramids.
+00000510: 6665 6174 7572 6563 6f6c 6c65 6374 696f  featurecollectio
+00000520: 6e20 696d 706f 7274 2046 6561 7475 7265  n import Feature
+00000530: 436f 6c6c 6563 7469 6f6e 0d0a 6672 6f6d  Collection..from
+00000540: 2070 7972 616d 6964 7320 696d 706f 7274   pyramids import
+00000550: 205f 696f 0d0a 0d0a 4445 4641 554c 545f   _io....DEFAULT_
+00000560: 4e4f 5f44 4154 415f 5641 4c55 4520 3d20  NO_DATA_VALUE = 
+00000570: 2d39 3939 390d 0a43 4154 414c 4f47 203d  -9999..CATALOG =
+00000580: 2043 6174 616c 6f67 2872 6173 7465 725f   Catalog(raster_
+00000590: 6472 6976 6572 3d54 7275 6529 0d0a 0d0a  driver=True)....
+000005a0: 2320 4279 2064 6566 6175 6c74 2c20 7468  # By default, th
+000005b0: 6520 4744 414c 2061 6e64 204f 4752 2050  e GDAL and OGR P
+000005c0: 7974 686f 6e20 6269 6e64 696e 6773 2064  ython bindings d
+000005d0: 6f20 6e6f 7420 7261 6973 6520 6578 6365  o not raise exce
+000005e0: 7074 696f 6e73 2077 6865 6e20 6572 726f  ptions when erro
+000005f0: 7273 206f 6363 7572 2e20 496e 7374 6561  rs occur. Instea
+00000600: 6420 7468 6579 2072 6574 7572 6e20 616e  d they return an
+00000610: 2065 7272 6f72 0d0a 2320 7661 6c75 6520   error..# value 
+00000620: 7375 6368 2061 7320 4e6f 6e65 2061 6e64  such as None and
+00000630: 2077 7269 7465 2061 6e20 6572 726f 7220   write an error 
+00000640: 6d65 7373 6167 6520 746f 2073 7973 2e73  message to sys.s
+00000650: 7464 6f75 742c 2074 6f20 7265 706f 7274  tdout, to report
+00000660: 2065 7272 6f72 7320 6279 2072 6169 7369   errors by raisi
+00000670: 6e67 2065 7863 6570 7469 6f6e 732e 2059  ng exceptions. Y
+00000680: 6f75 2063 616e 2065 6e61 626c 650d 0a23  ou can enable..#
+00000690: 2074 6869 7320 6265 6861 7669 6f72 2069   this behavior i
+000006a0: 6e20 4744 414c 2061 6e64 204f 4752 2062  n GDAL and OGR b
+000006b0: 7920 6361 6c6c 696e 6720 7468 6520 5573  y calling the Us
+000006c0: 6545 7863 6570 7469 6f6e 7328 290d 0a67  eExceptions()..g
+000006d0: 6461 6c2e 5573 6545 7863 6570 7469 6f6e  dal.UseException
+000006e0: 7328 290d 0a23 2067 6461 6c2e 4572 726f  s()..# gdal.Erro
+000006f0: 7252 6573 6574 2829 0d0a 0d0a 0d0a 636c  rReset()......cl
+00000700: 6173 7320 4461 7461 7365 743a 0d0a 2020  ass Dataset:..  
+00000710: 2020 2222 2244 6174 6173 6574 2063 6c61    """Dataset cla
+00000720: 7373 2063 6f6e 7461 696e 7320 6d65 7468  ss contains meth
+00000730: 6f64 7320 746f 2064 6561 6c20 7769 7468  ods to deal with
+00000740: 2072 6173 7465 7273 2061 6e64 206e 6574   rasters and net
+00000750: 6364 6620 6669 6c65 732c 2063 6861 6e67  cdf files, chang
+00000760: 6520 7072 6f6a 6563 7469 6f6e 2061 6e64  e projection and
+00000770: 2063 6f6f 7264 696e 6174 6520 7379 7374   coordinate syst
+00000780: 656d 732e 2222 220d 0a0d 0a20 2020 2064  ems."""....    d
+00000790: 6566 6175 6c74 5f6e 6f5f 6461 7461 5f76  efault_no_data_v
+000007a0: 616c 7565 203d 2044 4546 4155 4c54 5f4e  alue = DEFAULT_N
+000007b0: 4f5f 4441 5441 5f56 414c 5545 0d0a 0d0a  O_DATA_VALUE....
+000007c0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+000007d0: 2873 656c 662c 2073 7263 3a20 6764 616c  (self, src: gdal
+000007e0: 2e44 6174 6173 6574 293a 0d0a 2020 2020  .Dataset):..    
+000007f0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00000800: 7461 6e63 6528 7372 632c 2067 6461 6c2e  tance(src, gdal.
+00000810: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
+00000820: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00000830: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
+00000840: 2020 2020 2020 2020 2022 7372 6320 7368           "src sh
+00000850: 6f75 6c64 2062 6520 7265 6164 2075 7369  ould be read usi
+00000860: 6e67 2067 6461 6c20 2867 6461 6c20 6461  ng gdal (gdal da
+00000870: 7461 7365 7420 706c 6561 7365 2072 6561  taset please rea
+00000880: 6420 6974 2075 7369 6e67 2067 6461 6c22  d it using gdal"
+00000890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000008a0: 2020 6622 206c 6962 7261 7279 2920 6769    f" library) gi
+000008b0: 7665 6e20 7b74 7970 6528 7372 6329 7d22  ven {type(src)}"
+000008c0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+000008d0: 0a20 2020 2020 2020 2073 656c 662e 5f72  .        self._r
+000008e0: 6173 7465 7220 3d20 7372 630d 0a20 2020  aster = src..   
+000008f0: 2020 2020 2073 656c 662e 5f67 656f 7472       self._geotr
+00000900: 616e 7366 6f72 6d20 3d20 7372 632e 4765  ansform = src.Ge
+00000910: 7447 656f 5472 616e 7366 6f72 6d28 290d  tGeoTransform().
+00000920: 0a20 2020 2020 2020 2073 656c 662e 5f63  .        self._c
+00000930: 656c 6c5f 7369 7a65 203d 2073 656c 662e  ell_size = self.
+00000940: 6765 6f74 7261 6e73 666f 726d 5b31 5d0d  geotransform[1].
+00000950: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+00000960: 6574 615f 6461 7461 203d 2073 7263 2e47  eta_data = src.G
+00000970: 6574 4d65 7461 6461 7461 2829 0d0a 2020  etMetadata()..  
+00000980: 2020 2020 2020 7365 6c66 2e5f 6669 6c65        self._file
+00000990: 5f6e 616d 6520 3d20 7372 632e 4765 7444  _name = src.GetD
+000009a0: 6573 6372 6970 7469 6f6e 2829 0d0a 2020  escription()..  
+000009b0: 2020 2020 2020 2320 7072 6f6a 6563 7469        # projecti
+000009c0: 6f6e 2064 6174 610d 0a20 2020 2020 2020  on data..       
+000009d0: 2023 2074 6865 2065 7073 6720 7072 6f70   # the epsg prop
+000009e0: 6572 7479 2072 6574 7572 6e73 2074 6865  erty returns the
+000009f0: 2076 616c 7565 206f 6620 7468 6520 5f65   value of the _e
+00000a00: 7073 6720 6174 7472 6962 7574 6520 736f  psg attribute so
+00000a10: 2069 6620 7468 6520 7072 6f6a 6563 7469   if the projecti
+00000a20: 6f6e 2063 6861 6e67 6573 2069 6e20 616e  on changes in an
+00000a30: 7920 6675 6e63 7469 6f6e 2074 6865 0d0a  y function the..
+00000a40: 2020 2020 2020 2020 2320 6675 6e63 7469          # functi
+00000a50: 6f6e 2073 686f 756c 6420 616c 736f 2063  on should also c
+00000a60: 6861 6e67 6520 7468 6520 7661 6c75 6520  hange the value 
+00000a70: 6f66 2074 6865 205f 6570 7367 2061 7474  of the _epsg att
+00000a80: 7269 6275 7465 2e0d 0a20 2020 2020 2020  ribute...       
+00000a90: 2073 656c 662e 5f65 7073 6720 3d20 7365   self._epsg = se
+00000aa0: 6c66 2e5f 6765 745f 6570 7367 2829 0d0a  lf._get_epsg()..
+00000ab0: 2020 2020 2020 2020 2320 7661 7269 6162          # variab
+00000ac0: 6c65 7320 616e 6420 7375 6273 6574 730d  les and subsets.
+00000ad0: 0a20 2020 2020 2020 2073 656c 662e 7375  .        self.su
+00000ae0: 6273 6574 7320 3d20 7372 632e 4765 7453  bsets = src.GetS
+00000af0: 7562 4461 7461 7365 7473 2829 0d0a 2020  ubDatasets()..  
+00000b00: 2020 2020 2020 7365 6c66 2e5f 7661 7269        self._vari
+00000b10: 6162 6c65 7320 3d20 7365 6c66 2e67 6574  ables = self.get
+00000b20: 5f76 6172 6961 626c 6573 2829 0d0a 2020  _variables()..  
+00000b30: 2020 2020 2020 2320 6172 7261 7920 616e        # array an
+00000b40: 6420 6469 6d65 6e73 696f 6e73 0d0a 2020  d dimensions..  
+00000b50: 2020 2020 2020 7365 6c66 2e5f 726f 7773        self._rows
+00000b60: 203d 2073 7263 2e52 6173 7465 7259 5369   = src.RasterYSi
+00000b70: 7a65 0d0a 2020 2020 2020 2020 7365 6c66  ze..        self
+00000b80: 2e5f 636f 6c75 6d6e 7320 3d20 7372 632e  ._columns = src.
+00000b90: 5261 7374 6572 5853 697a 650d 0a20 2020  RasterXSize..   
+00000ba0: 2020 2020 2073 656c 662e 5f62 616e 645f       self._band_
+00000bb0: 636f 756e 7420 3d20 7372 632e 5261 7374  count = src.Rast
+00000bc0: 6572 436f 756e 740d 0a20 2020 2020 2020  erCount..       
+00000bd0: 2069 6620 6c65 6e28 7365 6c66 2e73 7562   if len(self.sub
+00000be0: 7365 7473 2920 3e20 303a 0d0a 2020 2020  sets) > 0:..    
+00000bf0: 2020 2020 2020 2020 7365 6c66 2e5f 7469          self._ti
+00000c00: 6d65 5f73 7461 6d70 203d 2073 656c 662e  me_stamp = self.
+00000c10: 5f67 6574 5f74 696d 655f 7661 7269 6162  _get_time_variab
+00000c20: 6c65 2829 0d0a 2020 2020 2020 2020 2020  le()..          
+00000c30: 2020 7365 6c66 2e5f 6c61 742c 2073 656c    self._lat, sel
+00000c40: 662e 5f6c 6f6e 203d 2073 656c 662e 5f67  f._lon = self._g
+00000c50: 6574 5f6c 6174 5f6c 6f6e 2829 0d0a 0d0a  et_lat_lon()....
+00000c60: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
+00000c70: 7661 6c75 6520 3d20 5b0d 0a20 2020 2020  value = [..     
+00000c80: 2020 2020 2020 2073 7263 2e47 6574 5261         src.GetRa
+00000c90: 7374 6572 4261 6e64 2869 292e 4765 744e  sterBand(i).GetN
+00000ca0: 6f44 6174 6156 616c 7565 2829 2066 6f72  oDataValue() for
+00000cb0: 2069 2069 6e20 7261 6e67 6528 312c 2073   i in range(1, s
+00000cc0: 656c 662e 6261 6e64 5f63 6f75 6e74 202b  elf.band_count +
+00000cd0: 2031 290d 0a20 2020 2020 2020 205d 0d0a   1)..        ]..
+00000ce0: 2020 2020 2020 2020 2320 6e6f 5f64 6174          # no_dat
+00000cf0: 615f 7661 6c75 6520 3d20 5b6e 702e 6e61  a_value = [np.na
+00000d00: 6e20 6966 2069 2069 7320 4e6f 6e65 2065  n if i is None e
+00000d10: 6c73 6520 6920 666f 7220 6920 696e 206e  lse i for i in n
+00000d20: 6f5f 6461 7461 5f76 616c 7565 205d 0d0a  o_data_value ]..
+00000d30: 2020 2020 2020 2020 7365 6c66 2e5f 6e6f          self._no
+00000d40: 5f64 6174 615f 7661 6c75 6520 3d20 6e6f  _data_value = no
+00000d50: 5f64 6174 615f 7661 6c75 650d 0a20 2020  _data_value..   
+00000d60: 2020 2020 2073 656c 662e 5f64 7479 7065       self._dtype
+00000d70: 203d 205b 0d0a 2020 2020 2020 2020 2020   = [..          
+00000d80: 2020 7372 632e 4765 7452 6173 7465 7242    src.GetRasterB
+00000d90: 616e 6428 6929 2e44 6174 6154 7970 6520  and(i).DataType 
+00000da0: 666f 7220 6920 696e 2072 616e 6765 2831  for i in range(1
+00000db0: 2c20 7365 6c66 2e62 616e 645f 636f 756e  , self.band_coun
+00000dc0: 7420 2b20 3129 0d0a 2020 2020 2020 2020  t + 1)..        
+00000dd0: 5d0d 0a0d 0a20 2020 2020 2020 2073 656c  ]....        sel
+00000de0: 662e 5f62 616e 645f 6e61 6d65 7320 3d20  f._band_names = 
+00000df0: 7365 6c66 2e67 6574 5f62 616e 645f 6e61  self.get_band_na
+00000e00: 6d65 7328 290d 0a0d 0a20 2020 2064 6566  mes()....    def
+00000e10: 205f 5f73 7472 5f5f 2873 656c 6629 3a0d   __str__(self):.
+00000e20: 0a20 2020 2020 2020 206d 6573 7361 6765  .        message
+00000e30: 203d 2066 2222 220d 0a20 2020 2020 2020   = f"""..       
+00000e40: 2020 2020 2046 696c 653a 207b 7365 6c66       File: {self
+00000e50: 2e66 696c 655f 6e61 6d65 7d0d 0a20 2020  .file_name}..   
+00000e60: 2020 2020 2020 2020 2043 656c 6c20 7369           Cell si
+00000e70: 7a65 3a20 7b73 656c 662e 6365 6c6c 5f73  ze: {self.cell_s
+00000e80: 697a 657d 0d0a 2020 2020 2020 2020 2020  ize}..          
+00000e90: 2020 4550 5347 3a20 7b73 656c 662e 6570    EPSG: {self.ep
+00000ea0: 7367 7d0d 0a20 2020 2020 2020 2020 2020  sg}..           
+00000eb0: 2056 6172 6961 626c 6573 3a20 7b73 656c   Variables: {sel
+00000ec0: 662e 7661 7269 6162 6c65 737d 0d0a 2020  f.variables}..  
+00000ed0: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
+00000ee0: 206f 6620 4261 6e64 733a 207b 7365 6c66   of Bands: {self
+00000ef0: 2e62 616e 645f 636f 756e 747d 0d0a 2020  .band_count}..  
+00000f00: 2020 2020 2020 2020 2020 4261 6e64 206e            Band n
+00000f10: 616d 6573 3a20 7b73 656c 662e 6261 6e64  ames: {self.band
+00000f20: 5f6e 616d 6573 7d0d 0a20 2020 2020 2020  _names}..       
+00000f30: 2020 2020 2044 696d 656e 7369 6f6e 3a20       Dimension: 
+00000f40: 7b73 656c 662e 726f 7773 202a 2073 656c  {self.rows * sel
+00000f50: 662e 636f 6c75 6d6e 737d 0d0a 2020 2020  f.columns}..    
+00000f60: 2020 2020 2020 2020 4d61 736b 3a20 7b73          Mask: {s
+00000f70: 656c 662e 5f6e 6f5f 6461 7461 5f76 616c  elf._no_data_val
+00000f80: 7565 5b30 5d7d 0d0a 2020 2020 2020 2020  ue[0]}..        
+00000f90: 2020 2020 4461 7461 2074 7970 653a 207b      Data type: {
+00000fa0: 7365 6c66 2e64 7479 7065 5b30 5d7d 0d0a  self.dtype[0]}..
+00000fb0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00000fc0: 2020 2020 2072 6574 7572 6e20 6d65 7373       return mess
+00000fd0: 6167 650d 0a0d 0a20 2020 2064 6566 205f  age....    def _
+00000fe0: 5f72 6570 725f 5f28 7365 6c66 293a 0d0a  _repr__(self):..
+00000ff0: 2020 2020 2020 2020 6d65 7373 6167 6520          message 
+00001000: 3d20 2222 220d 0a20 2020 2020 2020 2020  = """..         
+00001010: 2020 2046 696c 653a 207b 307d 0d0a 2020     File: {0}..  
+00001020: 2020 2020 2020 2020 2020 4365 6c6c 2073            Cell s
+00001030: 697a 653a 207b 317d 0d0a 2020 2020 2020  ize: {1}..      
+00001040: 2020 2020 2020 4550 5347 3a20 7b32 7d0d        EPSG: {2}.
+00001050: 0a20 2020 2020 2020 2020 2020 2056 6172  .            Var
+00001060: 6961 626c 6573 3a20 7b33 7d0d 0a20 2020  iables: {3}..   
+00001070: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+00001080: 6f66 2042 616e 6473 3a20 7b34 7d0d 0a20  of Bands: {4}.. 
+00001090: 2020 2020 2020 2020 2020 2042 616e 6420             Band 
+000010a0: 6e61 6d65 733a 207b 357d 0d0a 2020 2020  names: {5}..    
+000010b0: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+000010c0: 6e3a 207b 367d 202a 207b 377d 0d0a 2020  n: {6} * {7}..  
+000010d0: 2020 2020 2020 2020 2020 4d61 736b 3a20            Mask: 
+000010e0: 7b38 7d0d 0a20 2020 2020 2020 2020 2020  {8}..           
+000010f0: 2044 6174 6120 7479 7065 3a20 7b39 7d0d   Data type: {9}.
+00001100: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00001110: 6a65 6374 696f 6e3a 207b 3130 7d0d 0a20  jection: {10}.. 
+00001120: 2020 2020 2020 2020 2020 204d 6574 6164             Metad
+00001130: 6174 613a 207b 3131 7d0d 0a20 2020 2020  ata: {11}..     
+00001140: 2020 2022 2222 2e66 6f72 6d61 7428 0d0a     """.format(..
+00001150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001160: 2e66 696c 655f 6e61 6d65 2c0d 0a20 2020  .file_name,..   
+00001170: 2020 2020 2020 2020 2073 656c 662e 6365           self.ce
+00001180: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
+00001190: 2020 2020 2020 7365 6c66 2e65 7073 672c        self.epsg,
+000011a0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000011b0: 6c66 2e76 6172 6961 626c 6573 2c0d 0a20  lf.variables,.. 
+000011c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000011d0: 6261 6e64 5f63 6f75 6e74 2c0d 0a20 2020  band_count,..   
+000011e0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+000011f0: 6e64 5f6e 616d 6573 2c0d 0a20 2020 2020  nd_names,..     
+00001200: 2020 2020 2020 2073 656c 662e 726f 7773         self.rows
+00001210: 2c0d 0a20 2020 2020 2020 2020 2020 2073  ,..            s
+00001220: 656c 662e 636f 6c75 6d6e 732c 0d0a 2020  elf.columns,..  
+00001230: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00001240: 6e6f 5f64 6174 615f 7661 6c75 655b 305d  no_data_value[0]
+00001250: 2c0d 0a20 2020 2020 2020 2020 2020 2073  ,..            s
+00001260: 656c 662e 6474 7970 655b 305d 2c0d 0a20  elf.dtype[0],.. 
+00001270: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001280: 6372 732c 0d0a 2020 2020 2020 2020 2020  crs,..          
+00001290: 2020 7365 6c66 2e6d 6574 615f 6461 7461    self.meta_data
+000012a0: 2c0d 0a20 2020 2020 2020 2029 0d0a 2020  ,..        )..  
+000012b0: 2020 2020 2020 7265 7475 726e 206d 6573        return mes
+000012c0: 7361 6765 0d0a 0d0a 2020 2020 4070 726f  sage....    @pro
+000012d0: 7065 7274 790d 0a20 2020 2064 6566 2072  perty..    def r
+000012e0: 6173 7465 7228 7365 6c66 2920 2d3e 2067  aster(self) -> g
+000012f0: 6461 6c2e 4461 7461 7365 743a 0d0a 2020  dal.Dataset:..  
+00001300: 2020 2020 2020 2222 2247 4441 4c20 4461        """GDAL Da
+00001310: 7461 7365 7422 2222 0d0a 2020 2020 2020  taset"""..      
+00001320: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+00001330: 6173 7465 720d 0a0d 0a20 2020 2040 7261  aster....    @ra
+00001340: 7374 6572 2e73 6574 7465 720d 0a20 2020  ster.setter..   
+00001350: 2064 6566 2072 6173 7465 7228 7365 6c66   def raster(self
+00001360: 2c20 7661 6c75 653a 2067 6461 6c2e 4461  , value: gdal.Da
+00001370: 7461 7365 7429 3a0d 0a20 2020 2020 2020  taset):..       
+00001380: 2073 656c 662e 5f72 6173 7465 7220 3d20   self._raster = 
+00001390: 7661 6c75 650d 0a0d 0a20 2020 2040 7072  value....    @pr
+000013a0: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+000013b0: 7661 6c75 6573 2873 656c 6629 202d 3e20  values(self) -> 
+000013c0: 6e70 2e6e 6461 7272 6179 3a0d 0a20 2020  np.ndarray:..   
+000013d0: 2020 2020 2022 2222 6172 7261 7920 7661       """array va
+000013e0: 6c75 6573 2e22 2222 0d0a 2020 2020 2020  lues."""..      
+000013f0: 2020 7265 7475 726e 2073 656c 662e 7265    return self.re
+00001400: 6164 5f61 7272 6179 2862 616e 643d 4e6f  ad_array(band=No
+00001410: 6e65 290d 0a0d 0a20 2020 2040 7072 6f70  ne)....    @prop
+00001420: 6572 7479 0d0a 2020 2020 6465 6620 726f  erty..    def ro
+00001430: 7773 2873 656c 6629 202d 3e20 696e 743a  ws(self) -> int:
+00001440: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
+00001450: 6265 7220 6f66 2072 6f77 7320 696e 2074  ber of rows in t
+00001460: 6865 2072 6173 7465 7220 6172 7261 792e  he raster array.
+00001470: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
+00001480: 7572 6e20 7365 6c66 2e5f 726f 7773 0d0a  urn self._rows..
+00001490: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
+000014a0: 0a20 2020 2064 6566 2063 6f6c 756d 6e73  .    def columns
+000014b0: 2873 656c 6629 202d 3e20 696e 743a 0d0a  (self) -> int:..
+000014c0: 2020 2020 2020 2020 2222 224e 756d 6265          """Numbe
+000014d0: 7220 6f66 2063 6f6c 756d 6e73 2069 6e20  r of columns in 
+000014e0: 7468 6520 7261 7374 6572 2061 7272 6179  the raster array
+000014f0: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
+00001500: 7475 726e 2073 656c 662e 5f63 6f6c 756d  turn self._colum
+00001510: 6e73 0d0a 0d0a 2020 2020 4070 726f 7065  ns....    @prope
+00001520: 7274 790d 0a20 2020 2064 6566 2073 6861  rty..    def sha
+00001530: 7065 2873 656c 6629 3a0d 0a20 2020 2020  pe(self):..     
+00001540: 2020 2022 2222 4461 7461 7365 7420 7368     """Dataset sh
+00001550: 6170 6522 2222 0d0a 2020 2020 2020 2020  ape"""..        
+00001560: 7265 7475 726e 2073 656c 662e 6261 6e64  return self.band
+00001570: 5f63 6f75 6e74 2c20 7365 6c66 2e72 6f77  _count, self.row
+00001580: 732c 2073 656c 662e 636f 6c75 6d6e 730d  s, self.columns.
+00001590: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+000015a0: 0d0a 2020 2020 6465 6620 6765 6f74 7261  ..    def geotra
+000015b0: 6e73 666f 726d 2873 656c 6629 3a0d 0a20  nsform(self):.. 
+000015c0: 2020 2020 2020 2022 2222 574b 5420 7072         """WKT pr
+000015d0: 6f6a 6563 7469 6f6e 2e22 2222 0d0a 2020  ojection."""..  
+000015e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000015f0: 662e 5f67 656f 7472 616e 7366 6f72 6d0d  f._geotransform.
+00001600: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+00001610: 0d0a 2020 2020 6465 6620 7069 766f 745f  ..    def pivot_
+00001620: 706f 696e 7428 7365 6c66 293a 0d0a 2020  point(self):..  
+00001630: 2020 2020 2020 2222 2254 6f70 206c 6566        """Top lef
+00001640: 7420 636f 726e 6572 2063 6f6f 7264 696e  t corner coordin
+00001650: 6174 6573 2e22 2222 0d0a 2020 2020 2020  ates."""..      
+00001660: 2020 786d 696e 2c20 5f2c 205f 2c20 796d    xmin, _, _, ym
+00001670: 6178 2c20 5f2c 205f 203d 2073 656c 662e  ax, _, _ = self.
+00001680: 5f67 656f 7472 616e 7366 6f72 6d0d 0a20  _geotransform.. 
+00001690: 2020 2020 2020 2072 6574 7572 6e20 786d         return xm
+000016a0: 696e 2c20 796d 6178 0d0a 0d0a 2020 2020  in, ymax....    
+000016b0: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+000016c0: 6566 2062 6f75 6e64 7328 7365 6c66 2920  ef bounds(self) 
+000016d0: 2d3e 2047 656f 4461 7461 4672 616d 653a  -> GeoDataFrame:
+000016e0: 0d0a 2020 2020 2020 2020 2222 2262 6f75  ..        """bou
+000016f0: 6e64 7322 2222 0d0a 2020 2020 2020 2020  nds"""..        
 00001700: 7265 7475 726e 2073 656c 662e 5f63 616c  return self._cal
-00001710: 6375 6c61 7465 5f62 626f 7828 290d 0a0d  culate_bbox()...
-00001720: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
-00001730: 2020 2020 6465 6620 6570 7367 2873 656c      def epsg(sel
-00001740: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
-00001750: 574b 5420 7072 6f6a 6563 7469 6f6e 2e22  WKT projection."
-00001760: 2222 0d0a 2020 2020 2020 2020 7265 7475  ""..        retu
-00001770: 726e 2073 656c 662e 5f65 7073 670d 0a0d  rn self._epsg...
-00001780: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
-00001790: 2020 2020 6465 6620 6c6f 6e28 7365 6c66      def lon(self
-000017a0: 293a 0d0a 2020 2020 2020 2020 2222 224c  ):..        """L
-000017b0: 6f6e 6769 7475 6465 2063 6f6f 7264 696e  ongitude coordin
-000017c0: 6174 6573 2222 220d 0a20 2020 2020 2020  ates"""..       
-000017d0: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
-000017e0: 7365 6c66 2c20 225f 6c6f 6e22 293a 0d0a  self, "_lon"):..
-000017f0: 2020 2020 2020 2020 2020 2020 7069 766f              pivo
-00001800: 745f 7820 3d20 7365 6c66 2e70 6976 6f74  t_x = self.pivot
-00001810: 5f70 6f69 6e74 5b30 5d0d 0a20 2020 2020  _point[0]..     
-00001820: 2020 2020 2020 2063 656c 6c5f 7369 7a65         cell_size
-00001830: 203d 2073 656c 662e 6365 6c6c 5f73 697a   = self.cell_siz
-00001840: 650d 0a20 2020 2020 2020 2020 2020 2078  e..            x
-00001850: 5f63 6f6f 7264 7320 3d20 5b0d 0a20 2020  _coords = [..   
-00001860: 2020 2020 2020 2020 2020 2020 2070 6976               piv
-00001870: 6f74 5f78 202b 2069 202a 2063 656c 6c5f  ot_x + i * cell_
-00001880: 7369 7a65 202b 2063 656c 6c5f 7369 7a65  size + cell_size
-00001890: 202f 2032 2066 6f72 2069 2069 6e20 7261   / 2 for i in ra
-000018a0: 6e67 6528 7365 6c66 2e63 6f6c 756d 6e73  nge(self.columns
-000018b0: 290d 0a20 2020 2020 2020 2020 2020 205d  )..            ]
-000018c0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000018d0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-000018e0: 6e20 6361 7365 2074 6865 206c 6174 2061  n case the lat a
-000018f0: 6e64 206c 6f6e 2061 7265 2072 6561 6420  nd lon are read 
-00001900: 6672 6f6d 2074 6865 206e 6574 6364 6620  from the netcdf 
-00001910: 6669 6c65 206a 7573 7420 7265 6164 2074  file just read t
-00001920: 6865 2076 616c 7565 7320 6672 6f6d 2074  he values from t
-00001930: 6865 2066 696c 650d 0a20 2020 2020 2020  he file..       
-00001940: 2020 2020 2078 5f63 6f6f 7264 7320 3d20       x_coords = 
-00001950: 7365 6c66 2e5f 6c6f 6e0d 0a20 2020 2020  self._lon..     
-00001960: 2020 2072 6574 7572 6e20 6e70 2e61 7272     return np.arr
-00001970: 6179 2878 5f63 6f6f 7264 7329 0d0a 0d0a  ay(x_coords)....
-00001980: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-00001990: 2020 2064 6566 206c 6174 2873 656c 6629     def lat(self)
-000019a0: 3a0d 0a20 2020 2020 2020 2022 2222 4c61  :..        """La
-000019b0: 7469 7475 6465 2d63 6f6f 7264 696e 6174  titude-coordinat
-000019c0: 6522 2222 0d0a 2020 2020 2020 2020 6966  e"""..        if
-000019d0: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-000019e0: 662c 2022 5f6c 6174 2229 3a0d 0a20 2020  f, "_lat"):..   
-000019f0: 2020 2020 2020 2020 2070 6976 6f74 5f79           pivot_y
-00001a00: 203d 2073 656c 662e 7069 766f 745f 706f   = self.pivot_po
-00001a10: 696e 745b 315d 0d0a 2020 2020 2020 2020  int[1]..        
-00001a20: 2020 2020 6365 6c6c 5f73 697a 6520 3d20      cell_size = 
-00001a30: 7365 6c66 2e63 656c 6c5f 7369 7a65 0d0a  self.cell_size..
-00001a40: 2020 2020 2020 2020 2020 2020 795f 636f              y_co
-00001a50: 6f72 6473 203d 205b 0d0a 2020 2020 2020  ords = [..      
-00001a60: 2020 2020 2020 2020 2020 7069 766f 745f            pivot_
-00001a70: 7920 2d20 6920 2a20 6365 6c6c 5f73 697a  y - i * cell_siz
-00001a80: 6520 2d20 6365 6c6c 5f73 697a 6520 2f20  e - cell_size / 
-00001a90: 3220 666f 7220 6920 696e 2072 616e 6765  2 for i in range
-00001aa0: 2873 656c 662e 726f 7773 290d 0a20 2020  (self.rows)..   
-00001ab0: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
-00001ac0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00001ad0: 2020 2020 2020 2023 2069 6e20 6361 7365         # in case
-00001ae0: 2074 6865 206c 6174 2061 6e64 206c 6f6e   the lat and lon
-00001af0: 2061 7265 2072 6561 6420 6672 6f6d 2074   are read from t
-00001b00: 6865 206e 6574 6364 6620 6669 6c65 206a  he netcdf file j
-00001b10: 7573 7420 7265 6164 2074 6865 2076 616c  ust read the val
-00001b20: 7565 7320 6672 6f6d 2074 6865 2066 696c  ues from the fil
-00001b30: 650d 0a20 2020 2020 2020 2020 2020 2079  e..            y
-00001b40: 5f63 6f6f 7264 7320 3d20 7365 6c66 2e5f  _coords = self._
-00001b50: 6c61 740d 0a20 2020 2020 2020 2072 6574  lat..        ret
-00001b60: 7572 6e20 6e70 2e61 7272 6179 2879 5f63  urn np.array(y_c
-00001b70: 6f6f 7264 7329 0d0a 0d0a 2020 2020 4070  oords)....    @p
-00001b80: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
-00001b90: 2078 2873 656c 6629 3a0d 0a20 2020 2020   x(self):..     
-00001ba0: 2020 2022 2222 782d 636f 6f72 6469 6e61     """x-coordina
-00001bb0: 7465 2222 220d 0a20 2020 2020 2020 2023  te"""..        #
-00001bc0: 2058 5f63 6f6f 7264 696e 6174 6520 3d20   X_coordinate = 
-00001bd0: 7570 7065 726c 6566 7420 636f 726e 6572  upperleft corner
-00001be0: 2078 202b 2069 6e64 6578 202a 2063 656c   x + index * cel
-00001bf0: 6c20 7369 7a65 202b 2063 656c 7369 7a65  l size + celsize
-00001c00: 2f32 0d0a 2020 2020 2020 2020 6966 206e  /2..        if n
-00001c10: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
-00001c20: 2022 5f6c 6f6e 2229 3a0d 0a20 2020 2020   "_lon"):..     
-00001c30: 2020 2020 2020 2070 6976 6f74 5f78 203d         pivot_x =
-00001c40: 2073 656c 662e 7069 766f 745f 706f 696e   self.pivot_poin
-00001c50: 745b 305d 0d0a 2020 2020 2020 2020 2020  t[0]..          
-00001c60: 2020 6365 6c6c 5f73 697a 6520 3d20 7365    cell_size = se
-00001c70: 6c66 2e63 656c 6c5f 7369 7a65 0d0a 2020  lf.cell_size..  
-00001c80: 2020 2020 2020 2020 2020 785f 636f 6f72            x_coor
-00001c90: 6473 203d 205b 0d0a 2020 2020 2020 2020  ds = [..        
-00001ca0: 2020 2020 2020 2020 7069 766f 745f 7820          pivot_x 
-00001cb0: 2b20 6920 2a20 6365 6c6c 5f73 697a 6520  + i * cell_size 
-00001cc0: 2b20 6365 6c6c 5f73 697a 6520 2f20 3220  + cell_size / 2 
-00001cd0: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
-00001ce0: 656c 662e 636f 6c75 6d6e 7329 0d0a 2020  elf.columns)..  
-00001cf0: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
-00001d00: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00001d10: 2020 2020 2020 2020 2320 696e 2063 6173          # in cas
-00001d20: 6520 7468 6520 6c61 7420 616e 6420 6c6f  e the lat and lo
-00001d30: 6e20 6172 6520 7265 6164 2066 726f 6d20  n are read from 
-00001d40: 7468 6520 6e65 7463 6466 2066 696c 6520  the netcdf file 
-00001d50: 6a75 7374 2072 6561 6420 7468 6520 7661  just read the va
-00001d60: 6c75 6573 2066 726f 6d20 7468 6520 6669  lues from the fi
-00001d70: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
-00001d80: 785f 636f 6f72 6473 203d 2073 656c 662e  x_coords = self.
-00001d90: 5f6c 6f6e 0d0a 2020 2020 2020 2020 7265  _lon..        re
-00001da0: 7475 726e 206e 702e 6172 7261 7928 785f  turn np.array(x_
-00001db0: 636f 6f72 6473 290d 0a0d 0a20 2020 2040  coords)....    @
-00001dc0: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
-00001dd0: 6620 7928 7365 6c66 293a 0d0a 2020 2020  f y(self):..    
-00001de0: 2020 2020 2222 2279 2d63 6f6f 7264 696e      """y-coordin
-00001df0: 6174 6522 2222 0d0a 2020 2020 2020 2020  ate"""..        
-00001e00: 2320 585f 636f 6f72 6469 6e61 7465 203d  # X_coordinate =
-00001e10: 2075 7070 6572 6c65 6674 2063 6f72 6e65   upperleft corne
-00001e20: 7220 7820 2b20 696e 6465 7820 2a20 6365  r x + index * ce
-00001e30: 6c6c 2073 697a 6520 2b20 6365 6c73 697a  ll size + celsiz
-00001e40: 652f 320d 0a20 2020 2020 2020 2069 6620  e/2..        if 
-00001e50: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
-00001e60: 2c20 225f 6c61 7422 293a 0d0a 2020 2020  , "_lat"):..    
-00001e70: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
-00001e80: 3d20 7365 6c66 2e70 6976 6f74 5f70 6f69  = self.pivot_poi
-00001e90: 6e74 5b31 5d0d 0a20 2020 2020 2020 2020  nt[1]..         
-00001ea0: 2020 2063 656c 6c5f 7369 7a65 203d 2073     cell_size = s
-00001eb0: 656c 662e 6365 6c6c 5f73 697a 650d 0a20  elf.cell_size.. 
-00001ec0: 2020 2020 2020 2020 2020 2079 5f63 6f6f             y_coo
-00001ed0: 7264 7320 3d20 5b0d 0a20 2020 2020 2020  rds = [..       
-00001ee0: 2020 2020 2020 2020 2070 6976 6f74 5f79           pivot_y
-00001ef0: 202d 2069 202a 2063 656c 6c5f 7369 7a65   - i * cell_size
-00001f00: 202d 2063 656c 6c5f 7369 7a65 202f 2032   - cell_size / 2
-00001f10: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00001f20: 7365 6c66 2e72 6f77 7329 0d0a 2020 2020  self.rows)..    
-00001f30: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
-00001f40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00001f50: 2020 2020 2020 2320 696e 2063 6173 6520        # in case 
-00001f60: 7468 6520 6c61 7420 616e 6420 6c6f 6e20  the lat and lon 
-00001f70: 6172 6520 7265 6164 2066 726f 6d20 7468  are read from th
-00001f80: 6520 6e65 7463 6466 2066 696c 6520 6a75  e netcdf file ju
-00001f90: 7374 2072 6561 6420 7468 6520 7661 6c75  st read the valu
-00001fa0: 6573 2066 726f 6d20 7468 6520 6669 6c65  es from the file
-00001fb0: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
-00001fc0: 636f 6f72 6473 203d 2073 656c 662e 5f6c  coords = self._l
-00001fd0: 6174 0d0a 2020 2020 2020 2020 7265 7475  at..        retu
-00001fe0: 726e 206e 702e 6172 7261 7928 795f 636f  rn np.array(y_co
-00001ff0: 6f72 6473 290d 0a0d 0a20 2020 2040 7072  ords)....    @pr
-00002000: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
-00002010: 6372 7328 7365 6c66 2920 2d3e 2073 7472  crs(self) -> str
-00002020: 3a0d 0a20 2020 2020 2020 2022 2222 436f  :..        """Co
-00002030: 6f72 6469 6e61 7465 2072 6566 6572 656e  ordinate referen
-00002040: 6365 2073 7973 7465 6d2e 2222 220d 0a20  ce system.""".. 
-00002050: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00002060: 6c66 2e5f 6765 745f 6372 7328 290d 0a0d  lf._get_crs()...
-00002070: 0a20 2020 2040 6372 732e 7365 7474 6572  .    @crs.setter
-00002080: 0d0a 2020 2020 6465 6620 6372 7328 7365  ..    def crs(se
-00002090: 6c66 2c20 7661 6c75 653a 2073 7472 293a  lf, value: str):
+00001710: 6375 6c61 7465 5f62 6f75 6e64 7328 290d  culate_bounds().
+00001720: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+00001730: 0d0a 2020 2020 6465 6620 6262 6f78 2873  ..    def bbox(s
+00001740: 656c 6629 202d 3e20 4c69 7374 3a0d 0a20  elf) -> List:.. 
+00001750: 2020 2020 2020 2022 2222 5b78 6d69 6e2c         """[xmin,
+00001760: 2079 6d69 6e2c 2078 6d61 782c 2079 6d61   ymin, xmax, yma
+00001770: 785d 2222 220d 0a20 2020 2020 2020 2072  x]"""..        r
+00001780: 6574 7572 6e20 7365 6c66 2e5f 6361 6c63  eturn self._calc
+00001790: 756c 6174 655f 6262 6f78 2829 0d0a 0d0a  ulate_bbox()....
+000017a0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+000017b0: 2020 2064 6566 2065 7073 6728 7365 6c66     def epsg(self
+000017c0: 293a 0d0a 2020 2020 2020 2020 2222 2257  ):..        """W
+000017d0: 4b54 2070 726f 6a65 6374 696f 6e2e 2222  KT projection.""
+000017e0: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+000017f0: 6e20 7365 6c66 2e5f 6570 7367 0d0a 0d0a  n self._epsg....
+00001800: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00001810: 2020 2064 6566 206c 6f6e 2873 656c 6629     def lon(self)
+00001820: 3a0d 0a20 2020 2020 2020 2022 2222 4c6f  :..        """Lo
+00001830: 6e67 6974 7564 6520 636f 6f72 6469 6e61  ngitude coordina
+00001840: 7465 7322 2222 0d0a 2020 2020 2020 2020  tes"""..        
+00001850: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
+00001860: 656c 662c 2022 5f6c 6f6e 2229 3a0d 0a20  elf, "_lon"):.. 
+00001870: 2020 2020 2020 2020 2020 2070 6976 6f74             pivot
+00001880: 5f78 203d 2073 656c 662e 7069 766f 745f  _x = self.pivot_
+00001890: 706f 696e 745b 305d 0d0a 2020 2020 2020  point[0]..      
+000018a0: 2020 2020 2020 6365 6c6c 5f73 697a 6520        cell_size 
+000018b0: 3d20 7365 6c66 2e63 656c 6c5f 7369 7a65  = self.cell_size
+000018c0: 0d0a 2020 2020 2020 2020 2020 2020 785f  ..            x_
+000018d0: 636f 6f72 6473 203d 205b 0d0a 2020 2020  coords = [..    
+000018e0: 2020 2020 2020 2020 2020 2020 7069 766f              pivo
+000018f0: 745f 7820 2b20 6920 2a20 6365 6c6c 5f73  t_x + i * cell_s
+00001900: 697a 6520 2b20 6365 6c6c 5f73 697a 6520  ize + cell_size 
+00001910: 2f20 3220 666f 7220 6920 696e 2072 616e  / 2 for i in ran
+00001920: 6765 2873 656c 662e 636f 6c75 6d6e 7329  ge(self.columns)
+00001930: 0d0a 2020 2020 2020 2020 2020 2020 5d0d  ..            ].
+00001940: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00001950: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00001960: 2063 6173 6520 7468 6520 6c61 7420 616e   case the lat an
+00001970: 6420 6c6f 6e20 6172 6520 7265 6164 2066  d lon are read f
+00001980: 726f 6d20 7468 6520 6e65 7463 6466 2066  rom the netcdf f
+00001990: 696c 6520 6a75 7374 2072 6561 6420 7468  ile just read th
+000019a0: 6520 7661 6c75 6573 2066 726f 6d20 7468  e values from th
+000019b0: 6520 6669 6c65 0d0a 2020 2020 2020 2020  e file..        
+000019c0: 2020 2020 785f 636f 6f72 6473 203d 2073      x_coords = s
+000019d0: 656c 662e 5f6c 6f6e 0d0a 2020 2020 2020  elf._lon..      
+000019e0: 2020 7265 7475 726e 206e 702e 6172 7261    return np.arra
+000019f0: 7928 785f 636f 6f72 6473 290d 0a0d 0a20  y(x_coords).... 
+00001a00: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
+00001a10: 2020 6465 6620 6c61 7428 7365 6c66 293a    def lat(self):
+00001a20: 0d0a 2020 2020 2020 2020 2222 224c 6174  ..        """Lat
+00001a30: 6974 7564 652d 636f 6f72 6469 6e61 7465  itude-coordinate
+00001a40: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
+00001a50: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
+00001a60: 2c20 225f 6c61 7422 293a 0d0a 2020 2020  , "_lat"):..    
+00001a70: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
+00001a80: 3d20 7365 6c66 2e70 6976 6f74 5f70 6f69  = self.pivot_poi
+00001a90: 6e74 5b31 5d0d 0a20 2020 2020 2020 2020  nt[1]..         
+00001aa0: 2020 2063 656c 6c5f 7369 7a65 203d 2073     cell_size = s
+00001ab0: 656c 662e 6365 6c6c 5f73 697a 650d 0a20  elf.cell_size.. 
+00001ac0: 2020 2020 2020 2020 2020 2079 5f63 6f6f             y_coo
+00001ad0: 7264 7320 3d20 5b0d 0a20 2020 2020 2020  rds = [..       
+00001ae0: 2020 2020 2020 2020 2070 6976 6f74 5f79           pivot_y
+00001af0: 202d 2069 202a 2063 656c 6c5f 7369 7a65   - i * cell_size
+00001b00: 202d 2063 656c 6c5f 7369 7a65 202f 2032   - cell_size / 2
+00001b10: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00001b20: 7365 6c66 2e72 6f77 7329 0d0a 2020 2020  self.rows)..    
+00001b30: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00001b40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00001b50: 2020 2020 2020 2320 696e 2063 6173 6520        # in case 
+00001b60: 7468 6520 6c61 7420 616e 6420 6c6f 6e20  the lat and lon 
+00001b70: 6172 6520 7265 6164 2066 726f 6d20 7468  are read from th
+00001b80: 6520 6e65 7463 6466 2066 696c 6520 6a75  e netcdf file ju
+00001b90: 7374 2072 6561 6420 7468 6520 7661 6c75  st read the valu
+00001ba0: 6573 2066 726f 6d20 7468 6520 6669 6c65  es from the file
+00001bb0: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
+00001bc0: 636f 6f72 6473 203d 2073 656c 662e 5f6c  coords = self._l
+00001bd0: 6174 0d0a 2020 2020 2020 2020 7265 7475  at..        retu
+00001be0: 726e 206e 702e 6172 7261 7928 795f 636f  rn np.array(y_co
+00001bf0: 6f72 6473 290d 0a0d 0a20 2020 2040 7072  ords)....    @pr
+00001c00: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+00001c10: 7828 7365 6c66 293a 0d0a 2020 2020 2020  x(self):..      
+00001c20: 2020 2222 2278 2d63 6f6f 7264 696e 6174    """x-coordinat
+00001c30: 6522 2222 0d0a 2020 2020 2020 2020 2320  e"""..        # 
+00001c40: 585f 636f 6f72 6469 6e61 7465 203d 2075  X_coordinate = u
+00001c50: 7070 6572 6c65 6674 2063 6f72 6e65 7220  pperleft corner 
+00001c60: 7820 2b20 696e 6465 7820 2a20 6365 6c6c  x + index * cell
+00001c70: 2073 697a 6520 2b20 6365 6c73 697a 652f   size + celsize/
+00001c80: 320d 0a20 2020 2020 2020 2069 6620 6e6f  2..        if no
+00001c90: 7420 6861 7361 7474 7228 7365 6c66 2c20  t hasattr(self, 
+00001ca0: 225f 6c6f 6e22 293a 0d0a 2020 2020 2020  "_lon"):..      
+00001cb0: 2020 2020 2020 7069 766f 745f 7820 3d20        pivot_x = 
+00001cc0: 7365 6c66 2e70 6976 6f74 5f70 6f69 6e74  self.pivot_point
+00001cd0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+00001ce0: 2063 656c 6c5f 7369 7a65 203d 2073 656c   cell_size = sel
+00001cf0: 662e 6365 6c6c 5f73 697a 650d 0a20 2020  f.cell_size..   
+00001d00: 2020 2020 2020 2020 2078 5f63 6f6f 7264           x_coord
+00001d10: 7320 3d20 5b0d 0a20 2020 2020 2020 2020  s = [..         
+00001d20: 2020 2020 2020 2070 6976 6f74 5f78 202b         pivot_x +
+00001d30: 2069 202a 2063 656c 6c5f 7369 7a65 202b   i * cell_size +
+00001d40: 2063 656c 6c5f 7369 7a65 202f 2032 2066   cell_size / 2 f
+00001d50: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
+00001d60: 6c66 2e63 6f6c 756d 6e73 290d 0a20 2020  lf.columns)..   
+00001d70: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
+00001d80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00001d90: 2020 2020 2020 2023 2069 6e20 6361 7365         # in case
+00001da0: 2074 6865 206c 6174 2061 6e64 206c 6f6e   the lat and lon
+00001db0: 2061 7265 2072 6561 6420 6672 6f6d 2074   are read from t
+00001dc0: 6865 206e 6574 6364 6620 6669 6c65 206a  he netcdf file j
+00001dd0: 7573 7420 7265 6164 2074 6865 2076 616c  ust read the val
+00001de0: 7565 7320 6672 6f6d 2074 6865 2066 696c  ues from the fil
+00001df0: 650d 0a20 2020 2020 2020 2020 2020 2078  e..            x
+00001e00: 5f63 6f6f 7264 7320 3d20 7365 6c66 2e5f  _coords = self._
+00001e10: 6c6f 6e0d 0a20 2020 2020 2020 2072 6574  lon..        ret
+00001e20: 7572 6e20 6e70 2e61 7272 6179 2878 5f63  urn np.array(x_c
+00001e30: 6f6f 7264 7329 0d0a 0d0a 2020 2020 4070  oords)....    @p
+00001e40: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+00001e50: 2079 2873 656c 6629 3a0d 0a20 2020 2020   y(self):..     
+00001e60: 2020 2022 2222 792d 636f 6f72 6469 6e61     """y-coordina
+00001e70: 7465 2222 220d 0a20 2020 2020 2020 2023  te"""..        #
+00001e80: 2058 5f63 6f6f 7264 696e 6174 6520 3d20   X_coordinate = 
+00001e90: 7570 7065 726c 6566 7420 636f 726e 6572  upperleft corner
+00001ea0: 2078 202b 2069 6e64 6578 202a 2063 656c   x + index * cel
+00001eb0: 6c20 7369 7a65 202b 2063 656c 7369 7a65  l size + celsize
+00001ec0: 2f32 0d0a 2020 2020 2020 2020 6966 206e  /2..        if n
+00001ed0: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
+00001ee0: 2022 5f6c 6174 2229 3a0d 0a20 2020 2020   "_lat"):..     
+00001ef0: 2020 2020 2020 2070 6976 6f74 5f79 203d         pivot_y =
+00001f00: 2073 656c 662e 7069 766f 745f 706f 696e   self.pivot_poin
+00001f10: 745b 315d 0d0a 2020 2020 2020 2020 2020  t[1]..          
+00001f20: 2020 6365 6c6c 5f73 697a 6520 3d20 7365    cell_size = se
+00001f30: 6c66 2e63 656c 6c5f 7369 7a65 0d0a 2020  lf.cell_size..  
+00001f40: 2020 2020 2020 2020 2020 795f 636f 6f72            y_coor
+00001f50: 6473 203d 205b 0d0a 2020 2020 2020 2020  ds = [..        
+00001f60: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
+00001f70: 2d20 6920 2a20 6365 6c6c 5f73 697a 6520  - i * cell_size 
+00001f80: 2d20 6365 6c6c 5f73 697a 6520 2f20 3220  - cell_size / 2 
+00001f90: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
+00001fa0: 656c 662e 726f 7773 290d 0a20 2020 2020  elf.rows)..     
+00001fb0: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
+00001fc0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00001fd0: 2020 2020 2023 2069 6e20 6361 7365 2074       # in case t
+00001fe0: 6865 206c 6174 2061 6e64 206c 6f6e 2061  he lat and lon a
+00001ff0: 7265 2072 6561 6420 6672 6f6d 2074 6865  re read from the
+00002000: 206e 6574 6364 6620 6669 6c65 206a 7573   netcdf file jus
+00002010: 7420 7265 6164 2074 6865 2076 616c 7565  t read the value
+00002020: 7320 6672 6f6d 2074 6865 2066 696c 650d  s from the file.
+00002030: 0a20 2020 2020 2020 2020 2020 2079 5f63  .            y_c
+00002040: 6f6f 7264 7320 3d20 7365 6c66 2e5f 6c61  oords = self._la
+00002050: 740d 0a20 2020 2020 2020 2072 6574 7572  t..        retur
+00002060: 6e20 6e70 2e61 7272 6179 2879 5f63 6f6f  n np.array(y_coo
+00002070: 7264 7329 0d0a 0d0a 2020 2020 4070 726f  rds)....    @pro
+00002080: 7065 7274 790d 0a20 2020 2064 6566 2063  perty..    def c
+00002090: 7273 2873 656c 6629 202d 3e20 7374 723a  rs(self) -> str:
 000020a0: 0d0a 2020 2020 2020 2020 2222 2243 6f6f  ..        """Coo
 000020b0: 7264 696e 6174 6520 7265 6665 7265 6e63  rdinate referenc
 000020c0: 6520 7379 7374 656d 2e22 2222 0d0a 2020  e system."""..  
-000020d0: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
-000020e0: 7273 2876 616c 7565 290d 0a0d 0a20 2020  rs(value)....   
-000020f0: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
-00002100: 6465 6620 6365 6c6c 5f73 697a 6528 7365  def cell_size(se
-00002110: 6c66 2920 2d3e 2069 6e74 3a0d 0a20 2020  lf) -> int:..   
-00002120: 2020 2020 2022 2222 4365 6c6c 2073 697a       """Cell siz
-00002130: 652e 2222 220d 0a20 2020 2020 2020 2072  e."""..        r
-00002140: 6574 7572 6e20 7365 6c66 2e5f 6365 6c6c  eturn self._cell
-00002150: 5f73 697a 650d 0a0d 0a20 2020 2040 7072  _size....    @pr
-00002160: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
-00002170: 6261 6e64 5f63 6f75 6e74 2873 656c 6629  band_count(self)
-00002180: 3a0d 0a20 2020 2020 2020 2022 2222 4e75  :..        """Nu
-00002190: 6d62 6572 206f 6620 6261 6e64 7320 696e  mber of bands in
-000021a0: 2074 6865 2072 6173 7465 722e 2222 220d   the raster.""".
-000021b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000021c0: 7365 6c66 2e5f 6261 6e64 5f63 6f75 6e74  self._band_count
-000021d0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-000021e0: 790d 0a20 2020 2064 6566 2062 616e 645f  y..    def band_
-000021f0: 6e61 6d65 7328 7365 6c66 293a 0d0a 2020  names(self):..  
-00002200: 2020 2020 2020 2222 2242 616e 6420 6e61        """Band na
-00002210: 6d65 732e 2222 220d 0a20 2020 2020 2020  mes."""..       
-00002220: 2072 6574 7572 6e20 7365 6c66 2e5f 6261   return self._ba
-00002230: 6e64 5f6e 616d 6573 0d0a 0d0a 2020 2020  nd_names....    
-00002240: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
-00002250: 6566 2076 6172 6961 626c 6573 2873 656c  ef variables(sel
-00002260: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
-00002270: 5661 7269 6162 6c65 7320 696e 2074 6865  Variables in the
-00002280: 2072 6173 7465 7220 2872 6573 616d 626c   raster (resambl
-00002290: 6573 2074 6865 2076 6172 6961 626c 6573  es the variables
-000022a0: 2069 6e20 6e65 7463 6466 2066 696c 6573   in netcdf files
-000022b0: 2e29 2222 220d 0a20 2020 2020 2020 2072  .)"""..        r
-000022c0: 6574 7572 6e20 7365 6c66 2e5f 7661 7269  eturn self._vari
-000022d0: 6162 6c65 730d 0a0d 0a20 2020 2040 7072  ables....    @pr
-000022e0: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
-000022f0: 6e6f 5f64 6174 615f 7661 6c75 6528 7365  no_data_value(se
-00002300: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
-00002310: 224e 6f20 6461 7461 2076 616c 7565 2074  "No data value t
-00002320: 6861 7420 6d61 726b 7320 7468 6520 6365  hat marks the ce
-00002330: 6c6c 7320 6f75 7420 6f66 2074 6865 2064  lls out of the d
-00002340: 6f6d 6169 6e22 2222 0d0a 2020 2020 2020  omain"""..      
-00002350: 2020 7265 7475 726e 2073 656c 662e 5f6e    return self._n
-00002360: 6f5f 6461 7461 5f76 616c 7565 0d0a 0d0a  o_data_value....
-00002370: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-00002380: 2020 2064 6566 206d 6574 615f 6461 7461     def meta_data
-00002390: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-000023a0: 2022 2222 4d65 7461 2064 6174 6122 2222   """Meta data"""
-000023b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000023c0: 2073 656c 662e 5f6d 6574 615f 6461 7461   self._meta_data
-000023d0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-000023e0: 790d 0a20 2020 2064 6566 2064 7479 7065  y..    def dtype
-000023f0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00002400: 2022 2222 4461 7461 2054 7970 6522 2222   """Data Type"""
-00002410: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00002420: 2073 656c 662e 5f64 7479 7065 0d0a 0d0a   self._dtype....
-00002430: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-00002440: 2020 2064 6566 2066 696c 655f 6e61 6d65     def file_name
-00002450: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00002460: 2022 2222 6669 6c65 206e 616d 6522 2222   """file name"""
-00002470: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00002480: 662e 5f66 696c 655f 6e61 6d65 2e73 7461  f._file_name.sta
-00002490: 7274 7377 6974 6828 224e 4554 4344 4622  rtswith("NETCDF"
-000024a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000024b0: 6e61 6d65 203d 2073 656c 662e 5f66 696c  name = self._fil
-000024c0: 655f 6e61 6d65 2e73 706c 6974 2822 3a22  e_name.split(":"
-000024d0: 295b 315d 5b31 3a2d 315d 0d0a 2020 2020  )[1][1:-1]..    
-000024e0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-000024f0: 2020 2020 2020 206e 616d 6520 3d20 7365         name = se
-00002500: 6c66 2e5f 6669 6c65 5f6e 616d 650d 0a20  lf._file_name.. 
-00002510: 2020 2020 2020 2072 6574 7572 6e20 6e61         return na
-00002520: 6d65 0d0a 0d0a 2020 2020 4070 726f 7065  me....    @prope
-00002530: 7274 790d 0a20 2020 2064 6566 2074 696d  rty..    def tim
-00002540: 655f 7374 616d 7028 7365 6c66 293a 0d0a  e_stamp(self):..
-00002550: 2020 2020 2020 2020 2222 2254 696d 6520          """Time 
-00002560: 7374 616d 7022 2222 0d0a 2020 2020 2020  stamp"""..      
-00002570: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
-00002580: 696d 655f 7374 616d 700d 0a0d 0a20 2020  ime_stamp....   
-00002590: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
-000025a0: 6465 6620 6472 6976 6572 5f74 7970 6528  def driver_type(
-000025b0: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
-000025c0: 2222 2244 7269 7665 7220 5479 7065 2222  """Driver Type""
-000025d0: 220d 0a20 2020 2020 2020 2064 7269 7665  "..        drive
-000025e0: 725f 7479 7065 203d 2073 656c 662e 7261  r_type = self.ra
-000025f0: 7374 6572 2e47 6574 4472 6976 6572 2829  ster.GetDriver()
-00002600: 2e47 6574 4465 7363 7269 7074 696f 6e28  .GetDescription(
-00002610: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00002620: 6e20 4341 5441 4c4f 472e 6765 745f 6472  n CATALOG.get_dr
-00002630: 6976 6572 5f6e 616d 6528 6472 6976 6572  iver_name(driver
-00002640: 5f74 7970 6529 0d0a 0d0a 2020 2020 4063  _type)....    @c
-00002650: 6c61 7373 6d65 7468 6f64 0d0a 2020 2020  lassmethod..    
-00002660: 6465 6620 7265 6164 5f66 696c 6528 636c  def read_file(cl
-00002670: 732c 2070 6174 683a 2073 7472 2c20 7265  s, path: str, re
-00002680: 6164 5f6f 6e6c 793d 5472 7565 293a 0d0a  ad_only=True):..
-00002690: 2020 2020 2020 2020 2222 2272 6561 6420          """read 
-000026a0: 6669 6c65 2e0d 0a0d 0a20 2020 2020 2020  file.....       
-000026b0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-000026c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-000026d0: 0a20 2020 2020 2020 2070 6174 6820 3a20  .        path : 
-000026e0: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
-000026f0: 2020 2050 6174 6820 6f66 2066 696c 6520     Path of file 
-00002700: 746f 206f 7065 6e28 776f 726b 7320 666f  to open(works fo
-00002710: 7220 6173 6369 692c 2067 656f 7469 6666  r ascii, geotiff
-00002720: 292e 0d0a 2020 2020 2020 2020 7265 6164  )...        read
-00002730: 5f6f 6e6c 7920 3a20 5b62 6f6f 6c5d 0d0a  _only : [bool]..
-00002740: 2020 2020 2020 2020 2020 2020 4669 6c65              File
-00002750: 206d 6f64 652c 2073 6574 2074 6f20 4661   mode, set to Fa
-00002760: 6c73 6520 746f 206f 7065 6e20 696e 2022  lse to open in "
-00002770: 7570 6461 7465 2220 6d6f 6465 2e0d 0a0d  update" mode....
-00002780: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00002790: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-000027a0: 2d0d 0a20 2020 2020 2020 2047 4441 4c20  -..        GDAL 
-000027b0: 6461 7461 7365 740d 0a20 2020 2020 2020  dataset..       
-000027c0: 2022 2222 0d0a 2020 2020 2020 2020 7372   """..        sr
-000027d0: 6320 3d20 696f 2e72 6561 645f 6669 6c65  c = io.read_file
-000027e0: 2870 6174 682c 2072 6561 645f 6f6e 6c79  (path, read_only
-000027f0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00002800: 6e20 636c 7328 7372 6329 0d0a 0d0a 2020  n cls(src)....  
-00002810: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
-00002820: 2020 2020 6465 6620 5f63 7265 6174 655f      def _create_
-00002830: 656d 7074 795f 6472 6976 6572 280d 0a20  empty_driver(.. 
-00002840: 2020 2020 2020 2063 6c73 2c20 7372 633a         cls, src:
-00002850: 2067 6461 6c2e 4461 7461 7365 742c 2070   gdal.Dataset, p
-00002860: 6174 683a 2073 7472 203d 204e 6f6e 652c  ath: str = None,
-00002870: 2062 616e 6473 3a20 696e 7420 3d20 312c   bands: int = 1,
-00002880: 206e 6f5f 6461 7461 5f76 616c 7565 3d4e   no_data_value=N
-00002890: 6f6e 650d 0a20 2020 2029 3a0d 0a20 2020  one..    ):..   
-000028a0: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
-000028b0: 206e 6577 2065 6d70 7479 2064 7269 7665   new empty drive
-000028c0: 7220 6672 6f6d 2061 6e6f 7468 6572 2064  r from another d
-000028d0: 6174 6173 6574 2e0d 0a0d 0a20 2020 2020  ataset.....     
-000028e0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-000028f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00002900: 2d0d 0a20 2020 2020 2020 2073 7263 203a  -..        src :
-00002910: 205b 6764 616c 2e44 6174 6163 7562 655d   [gdal.Datacube]
-00002920: 0d0a 2020 2020 2020 2020 2020 2020 6764  ..            gd
-00002930: 616c 2064 6174 6173 6574 0d0a 2020 2020  al dataset..    
-00002940: 2020 2020 7061 7468 203a 2073 7472 0d0a      path : str..
-00002950: 2020 2020 2020 2020 6261 6e64 7320 3a20          bands : 
-00002960: 696e 7420 6f72 204e 6f6e 650d 0a20 2020  int or None..   
-00002970: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-00002980: 6f66 2062 616e 6473 2074 6f20 6372 6561  of bands to crea
-00002990: 7465 2069 6e20 7468 6520 6f75 7470 7574  te in the output
-000029a0: 2072 6173 7465 722e 0d0a 2020 2020 2020   raster...      
-000029b0: 2020 6e6f 5f64 6174 615f 7661 6c75 6520    no_data_value 
-000029c0: 3a20 666c 6f61 7420 6f72 204e 6f6e 650d  : float or None.
-000029d0: 0a20 2020 2020 2020 2020 2020 204e 6f20  .            No 
-000029e0: 6461 7461 2076 616c 7565 2c20 6966 204e  data value, if N
-000029f0: 6f6e 6520 7573 6573 2074 6865 2073 616d  one uses the sam
-00002a00: 6520 6173 2060 6073 7263 6060 2e0d 0a0d  e as ``src``....
-00002a10: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00002a20: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00002a30: 2d0d 0a20 2020 2020 2020 2067 6461 6c2e  -..        gdal.
-00002a40: 4461 7461 5365 740d 0a20 2020 2020 2020  DataSet..       
-00002a50: 2022 2222 0d0a 2020 2020 2020 2020 6261   """..        ba
-00002a60: 6e64 7320 3d20 696e 7428 6261 6e64 7329  nds = int(bands)
-00002a70: 2069 6620 6261 6e64 7320 6973 206e 6f74   if bands is not
-00002a80: 204e 6f6e 6520 656c 7365 2073 7263 2e52   None else src.R
-00002a90: 6173 7465 7243 6f75 6e74 0d0a 2020 2020  asterCount..    
-00002aa0: 2020 2020 2320 6372 6561 7465 2074 6865      # create the
-00002ab0: 206f 6268 6563 740d 0a20 2020 2020 2020   obhect..       
-00002ac0: 2073 7263 5f6f 626a 203d 2063 6c73 2873   src_obj = cls(s
-00002ad0: 7263 290d 0a20 2020 2020 2020 2023 2043  rc)..        # C
-00002ae0: 7265 6174 6520 7468 6520 6472 6976 6572  reate the driver
-00002af0: 2e0d 0a20 2020 2020 2020 2064 7374 203d  ...        dst =
-00002b00: 2073 7263 5f6f 626a 2e5f 6372 6561 7465   src_obj._create
-00002b10: 5f67 6461 6c5f 6461 7461 7365 7428 0d0a  _gdal_dataset(..
-00002b20: 2020 2020 2020 2020 2020 2020 7372 635f              src_
-00002b30: 6f62 6a2e 636f 6c75 6d6e 732c 2073 7263  obj.columns, src
-00002b40: 5f6f 626a 2e72 6f77 732c 2062 616e 6473  _obj.rows, bands
-00002b50: 2c20 7372 635f 6f62 6a2e 6474 7970 655b  , src_obj.dtype[
-00002b60: 305d 2c20 7061 7468 3d70 6174 680d 0a20  0], path=path.. 
-00002b70: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-00002b80: 2020 2020 2320 5365 7420 7468 6520 7072      # Set the pr
-00002b90: 6f6a 6563 7469 6f6e 2e0d 0a20 2020 2020  ojection...     
-00002ba0: 2020 2064 7374 2e53 6574 4765 6f54 7261     dst.SetGeoTra
-00002bb0: 6e73 666f 726d 2873 7263 5f6f 626a 2e67  nsform(src_obj.g
-00002bc0: 656f 7472 616e 7366 6f72 6d29 0d0a 2020  eotransform)..  
-00002bd0: 2020 2020 2020 6473 742e 5365 7450 726f        dst.SetPro
-00002be0: 6a65 6374 696f 6e28 7372 635f 6f62 6a2e  jection(src_obj.
-00002bf0: 7261 7374 6572 2e47 6574 5072 6f6a 6563  raster.GetProjec
-00002c00: 7469 6f6e 5265 6628 2929 0d0a 2020 2020  tionRef())..    
-00002c10: 2020 2020 6473 7420 3d20 636c 7328 6473      dst = cls(ds
-00002c20: 7429 0d0a 2020 2020 2020 2020 6966 206e  t)..        if n
-00002c30: 6f5f 6461 7461 5f76 616c 7565 2069 7320  o_data_value is 
-00002c40: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-00002c50: 2020 2020 2020 2064 7374 2e5f 7365 745f         dst._set_
-00002c60: 6e6f 5f64 6174 615f 7661 6c75 6528 6e6f  no_data_value(no
-00002c70: 5f64 6174 615f 7661 6c75 653d 666c 6f61  _data_value=floa
-00002c80: 7428 6e6f 5f64 6174 615f 7661 6c75 6529  t(no_data_value)
-00002c90: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
-00002ca0: 7572 6e20 6473 740d 0a0d 0a20 2020 2040  urn dst....    @
-00002cb0: 636c 6173 736d 6574 686f 640d 0a20 2020  classmethod..   
-00002cc0: 2064 6566 205f 6372 6561 7465 5f64 7269   def _create_dri
-00002cd0: 7665 725f 6672 6f6d 5f73 6372 6174 6368  ver_from_scratch
-00002ce0: 280d 0a20 2020 2020 2020 2063 6c73 2c0d  (..        cls,.
-00002cf0: 0a20 2020 2020 2020 2063 656c 6c5f 7369  .        cell_si
-00002d00: 7a65 3a20 696e 742c 0d0a 2020 2020 2020  ze: int,..      
-00002d10: 2020 726f 7773 3a20 696e 742c 0d0a 2020    rows: int,..  
-00002d20: 2020 2020 2020 636f 6c75 6d6e 733a 2069        columns: i
-00002d30: 6e74 2c0d 0a20 2020 2020 2020 2064 7479  nt,..        dty
-00002d40: 7065 3a20 696e 742c 0d0a 2020 2020 2020  pe: int,..      
-00002d50: 2020 6261 6e64 733a 2069 6e74 2c0d 0a20    bands: int,.. 
-00002d60: 2020 2020 2020 2074 6f70 5f6c 6566 745f         top_left_
-00002d70: 636f 6f72 6473 3a20 5475 706c 652c 0d0a  coords: Tuple,..
-00002d80: 2020 2020 2020 2020 6570 7367 3a20 696e          epsg: in
-00002d90: 742c 0d0a 2020 2020 2020 2020 6e6f 5f64  t,..        no_d
-00002da0: 6174 615f 7661 6c75 653a 2041 6e79 203d  ata_value: Any =
-00002db0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00002dc0: 7061 7468 3a20 7374 7220 3d20 4e6f 6e65  path: str = None
-00002dd0: 2c0d 0a20 2020 2029 3a0d 0a20 2020 2020  ,..    ):..     
-00002de0: 2020 2022 2222 4372 6561 7465 2061 206e     """Create a n
-00002df0: 6577 2065 6d70 7479 2064 7269 7665 7220  ew empty driver 
-00002e00: 6672 6f6d 2061 6e6f 7468 6572 2064 6174  from another dat
-00002e10: 6173 6574 2e0d 0a0d 0a20 2020 2020 2020  aset.....       
-00002e20: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00002e30: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00002e40: 0a20 2020 2020 2020 2063 656c 6c5f 7369  .        cell_si
-00002e50: 7a65 3a20 5b41 6e79 5d0d 0a20 2020 2020  ze: [Any]..     
-00002e60: 2020 2020 2020 2063 656c 6c20 7369 7a65         cell size
-00002e70: 2e0d 0a20 2020 2020 2020 2072 6f77 733a  ...        rows:
-00002e80: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
-00002e90: 2020 2020 6e75 6d62 6572 206f 6620 726f      number of ro
-00002ea0: 7773 2e0d 0a20 2020 2020 2020 2063 6f6c  ws...        col
-00002eb0: 756d 6e73 3a20 5b69 6e74 5d0d 0a20 2020  umns: [int]..   
-00002ec0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-00002ed0: 6f66 2063 6f6c 756d 6e73 2e0d 0a20 2020  of columns...   
-00002ee0: 2020 2020 2064 7479 7065 3a20 5b69 6e74       dtype: [int
-00002ef0: 5d0d 0a20 2020 2020 2020 2020 2020 2064  ]..            d
-00002f00: 6174 6120 7479 7065 2e0d 0a20 2020 2020  ata type...     
-00002f10: 2020 2062 616e 6473 203a 2069 6e74 206f     bands : int o
-00002f20: 7220 4e6f 6e65 0d0a 2020 2020 2020 2020  r None..        
-00002f30: 2020 2020 4e75 6d62 6572 206f 6620 6261      Number of ba
-00002f40: 6e64 7320 746f 2063 7265 6174 6520 696e  nds to create in
-00002f50: 2074 6865 206f 7574 7075 7420 7261 7374   the output rast
-00002f60: 6572 2e0d 0a20 2020 2020 2020 2074 6f70  er...        top
-00002f70: 5f6c 6566 745f 636f 6f72 6473 3a20 5b54  _left_coords: [T
-00002f80: 7570 6c65 5d0d 0a20 2020 2020 2020 2020  uple]..         
-00002f90: 2020 2063 6f6f 7264 696e 6174 6573 206f     coordinates o
-00002fa0: 6620 7468 6520 746f 7020 6c65 6674 2063  f the top left c
-00002fb0: 6f72 6e65 7220 706f 696e 742e 0d0a 2020  orner point...  
-00002fc0: 2020 2020 2020 6570 7367 3a20 5b69 6e74        epsg: [int
-00002fd0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00002fe0: 7073 6720 6e75 6d62 6572 2074 6f20 6964  psg number to id
-00002ff0: 656e 7469 6679 2074 6865 2070 726f 6a65  entify the proje
-00003000: 6374 696f 6e20 6f66 2074 6865 2063 6f6f  ction of the coo
-00003010: 7264 696e 6174 6573 2069 6e20 7468 6520  rdinates in the 
-00003020: 6372 6561 7465 6420 7261 7374 6572 2e0d  created raster..
-00003030: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
-00003040: 5f76 616c 7565 203a 2066 6c6f 6174 206f  _value : float o
-00003050: 7220 4e6f 6e65 0d0a 2020 2020 2020 2020  r None..        
-00003060: 2020 2020 4e6f 2064 6174 6120 7661 6c75      No data valu
-00003070: 652c 2069 6620 4e6f 6e65 2075 7365 7320  e, if None uses 
-00003080: 7468 6520 7361 6d65 2061 7320 6060 7372  the same as ``sr
-00003090: 6360 602e 0d0a 2020 2020 2020 2020 7061  c``...        pa
-000030a0: 7468 203a 205b 7374 725d 0d0a 2020 2020  th : [str]..    
-000030b0: 2020 2020 2020 2020 7061 7468 206f 6e20          path on 
-000030c0: 6469 736b 2e0d 0a0d 0a20 2020 2020 2020  disk.....       
-000030d0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-000030e0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-000030f0: 2020 2067 6461 6c2e 4461 7461 5365 740d     gdal.DataSet.
-00003100: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00003110: 2020 2020 2020 2320 4372 6561 7465 2074        # Create t
-00003120: 6865 2064 7269 7665 722e 0d0a 2020 2020  he driver...    
-00003130: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
-00003140: 742e 5f63 7265 6174 655f 6764 616c 5f64  t._create_gdal_d
-00003150: 6174 6173 6574 2863 6f6c 756d 6e73 2c20  ataset(columns, 
-00003160: 726f 7773 2c20 6261 6e64 732c 2064 7479  rows, bands, dty
-00003170: 7065 2c20 7061 7468 3d70 6174 6829 0d0a  pe, path=path)..
-00003180: 2020 2020 2020 2020 6765 6f74 7261 6e73          geotrans
-00003190: 666f 726d 203d 2028 0d0a 2020 2020 2020  form = (..      
-000031a0: 2020 2020 2020 746f 705f 6c65 6674 5f63        top_left_c
-000031b0: 6f6f 7264 735b 305d 2c0d 0a20 2020 2020  oords[0],..     
-000031c0: 2020 2020 2020 2063 656c 6c5f 7369 7a65         cell_size
-000031d0: 2c0d 0a20 2020 2020 2020 2020 2020 2030  ,..            0
-000031e0: 2c0d 0a20 2020 2020 2020 2020 2020 2074  ,..            t
-000031f0: 6f70 5f6c 6566 745f 636f 6f72 6473 5b31  op_left_coords[1
-00003200: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00003210: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
-00003220: 2d31 202a 2063 656c 6c5f 7369 7a65 2c0d  -1 * cell_size,.
-00003230: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
-00003240: 2020 2020 7372 203d 2044 6174 6173 6574      sr = Dataset
-00003250: 2e5f 6372 6561 7465 5f73 725f 6672 6f6d  ._create_sr_from
-00003260: 5f65 7073 6728 6570 7367 290d 0a0d 0a20  _epsg(epsg).... 
-00003270: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
-00003280: 2070 726f 6a65 6374 696f 6e2e 0d0a 2020   projection...  
-00003290: 2020 2020 2020 6473 742e 5365 7447 656f        dst.SetGeo
-000032a0: 5472 616e 7366 6f72 6d28 6765 6f74 7261  Transform(geotra
-000032b0: 6e73 666f 726d 290d 0a20 2020 2020 2020  nsform)..       
-000032c0: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
-000032d0: 6f6e 2873 722e 4578 706f 7274 546f 576b  on(sr.ExportToWk
-000032e0: 7428 2929 0d0a 2020 2020 2020 2020 6473  t())..        ds
-000032f0: 7420 3d20 636c 7328 6473 7429 0d0a 2020  t = cls(dst)..  
-00003300: 2020 2020 2020 6966 206e 6f5f 6461 7461        if no_data
-00003310: 5f76 616c 7565 2069 7320 6e6f 7420 4e6f  _value is not No
-00003320: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00003330: 2064 7374 2e5f 7365 745f 6e6f 5f64 6174   dst._set_no_dat
-00003340: 615f 7661 6c75 6528 6e6f 5f64 6174 615f  a_value(no_data_
-00003350: 7661 6c75 653d 6e6f 5f64 6174 615f 7661  value=no_data_va
-00003360: 6c75 6529 0d0a 0d0a 2020 2020 2020 2020  lue)....        
-00003370: 7265 7475 726e 2064 7374 0d0a 0d0a 2020  return dst....  
-00003380: 2020 6465 6620 7265 6164 5f61 7272 6179    def read_array
-00003390: 2873 656c 662c 2062 616e 643a 2069 6e74  (self, band: int
-000033a0: 203d 204e 6f6e 6529 202d 3e20 6e70 2e6e   = None) -> np.n
-000033b0: 6461 7272 6179 3a0d 0a20 2020 2020 2020  darray:..       
-000033c0: 2022 2222 5265 6164 2041 7272 6179 0d0a   """Read Array..
-000033d0: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-000033e0: 7265 6164 2074 6865 2076 616c 7565 7320  read the values 
-000033f0: 7374 6f72 6564 2069 6e20 6120 6769 7665  stored in a give
-00003400: 6e20 6261 6e64 2e0d 0a0d 0a20 2020 2020  n band.....     
-00003410: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00003420: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00003430: 2d0d 0a20 2020 2020 2020 2062 616e 6420  -..        band 
-00003440: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
-00003450: 2020 2020 2020 2020 2074 6865 2062 616e           the ban
-00003460: 6420 796f 7520 7761 6e74 2074 6f20 6765  d you want to ge
-00003470: 7420 6974 7320 6461 7461 2e20 4465 6661  t its data. Defa
-00003480: 756c 7420 6973 2030 0d0a 0d0a 2020 2020  ult is 0....    
-00003490: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-000034a0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-000034b0: 2020 2020 2020 6172 7261 7920 3a20 5b61        array : [a
-000034c0: 7272 6179 5d0d 0a20 2020 2020 2020 2020  rray]..         
-000034d0: 2020 2061 7272 6179 2077 6974 6820 616c     array with al
-000034e0: 6c20 7468 6520 7661 6c75 6573 2069 6e20  l the values in 
-000034f0: 7468 6520 7261 7374 6572 2e0d 0a20 2020  the raster...   
-00003500: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00003510: 2020 6966 2062 616e 6420 6973 204e 6f6e    if band is Non
-00003520: 6520 616e 6420 7365 6c66 2e62 616e 645f  e and self.band_
-00003530: 636f 756e 7420 3e20 313a 0d0a 2020 2020  count > 1:..    
-00003540: 2020 2020 2020 2020 6172 7220 3d20 6e70          arr = np
-00003550: 2e6f 6e65 7328 0d0a 2020 2020 2020 2020  .ones(..        
-00003560: 2020 2020 2020 2020 280d 0a20 2020 2020          (..     
-00003570: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00003580: 656c 662e 6261 6e64 5f63 6f75 6e74 2c0d  elf.band_count,.
-00003590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000035a0: 2020 2020 2073 656c 662e 726f 7773 2c0d       self.rows,.
-000035b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000035c0: 2020 2020 2073 656c 662e 636f 6c75 6d6e       self.column
-000035d0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-000035e0: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-000035f0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
-00003600: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00003610: 2873 656c 662e 6261 6e64 5f63 6f75 6e74  (self.band_count
-00003620: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00003630: 2020 2020 6172 725b 692c 203a 2c20 3a5d      arr[i, :, :]
-00003640: 203d 2073 656c 662e 5f72 6173 7465 722e   = self._raster.
-00003650: 4765 7452 6173 7465 7242 616e 6428 6920  GetRasterBand(i 
-00003660: 2b20 3129 2e52 6561 6441 7341 7272 6179  + 1).ReadAsArray
-00003670: 2829 0d0a 2020 2020 2020 2020 656c 7365  ()..        else
-00003680: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00003690: 6620 6261 6e64 2069 7320 4e6f 6e65 3a0d  f band is None:.
-000036a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000036b0: 2062 616e 6420 3d20 300d 0a20 2020 2020   band = 0..     
-000036c0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000036d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000036e0: 2062 616e 6420 3e20 7365 6c66 2e62 616e   band > self.ban
-000036f0: 645f 636f 756e 7420 2d20 313a 0d0a 2020  d_count - 1:..  
-00003700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003710: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00003720: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-00003730: 2020 2020 2020 2020 2020 2020 2066 2262               f"b
-00003740: 616e 6420 696e 6465 7820 7368 6f75 6c64  and index should
-00003750: 2062 6520 6265 7477 6565 6e20 3020 616e   be between 0 an
-00003760: 6420 7b73 656c 662e 6261 6e64 5f63 6f75  d {self.band_cou
-00003770: 6e74 202d 2031 7d22 0d0a 2020 2020 2020  nt - 1}"..      
-00003780: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00003790: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-000037a0: 203d 2073 656c 662e 7261 7374 6572 2e47   = self.raster.G
-000037b0: 6574 5261 7374 6572 4261 6e64 2862 616e  etRasterBand(ban
-000037c0: 6420 2b20 3129 2e52 6561 6441 7341 7272  d + 1).ReadAsArr
-000037d0: 6179 2829 0d0a 0d0a 2020 2020 2020 2020  ay()....        
-000037e0: 7265 7475 726e 2061 7272 0d0a 0d0a 2020  return arr....  
-000037f0: 2020 6465 6620 706c 6f74 2873 656c 662c    def plot(self,
-00003800: 2062 616e 643a 2069 6e74 203d 2030 2c20   band: int = 0, 
-00003810: 6578 636c 7564 655f 7661 6c75 653a 2041  exclude_value: A
-00003820: 6e79 203d 204e 6f6e 652c 202a 2a6b 7761  ny = None, **kwa
-00003830: 7267 7329 3a0d 0a20 2020 2020 2020 2022  rgs):..        "
-00003840: 2222 5265 6164 2041 7272 6179 0d0a 0d0a  ""Read Array....
-00003850: 2020 2020 2020 2020 2020 2020 2d20 7265              - re
-00003860: 6164 2074 6865 2076 616c 7565 7320 7374  ad the values st
-00003870: 6f72 6564 2069 6e20 6120 6769 7665 6e20  ored in a given 
-00003880: 6261 6e64 2e0d 0a0d 0a20 2020 2020 2020  band.....       
-00003890: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-000038a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-000038b0: 0a20 2020 2020 2020 2062 616e 6420 3a20  .        band : 
-000038c0: 5b69 6e74 6567 6572 5d0d 0a20 2020 2020  [integer]..     
-000038d0: 2020 2020 2020 2074 6865 2062 616e 6420         the band 
-000038e0: 796f 7520 7761 6e74 2074 6f20 6765 7420  you want to get 
-000038f0: 6974 7320 6461 7461 2e20 4465 6661 756c  its data. Defaul
-00003900: 7420 6973 2030 0d0a 2020 2020 2020 2020  t is 0..        
-00003910: 6578 636c 7564 655f 7661 6c75 653a 205b  exclude_value: [
-00003920: 416e 795d 0d0a 2020 2020 2020 2020 2020  Any]..          
-00003930: 2020 7661 6c75 6520 746f 2065 7865 636c    value to execl
-00003940: 7564 6520 6672 6f6d 2074 6865 2070 6c6f  ude from the plo
-00003950: 742e 2044 6566 6175 6c74 2069 7320 4e6f  t. Default is No
-00003960: 6e65 2e0d 0a20 2020 2020 2020 202a 2a6b  ne...        **k
-00003970: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-00003980: 2020 2070 6f69 6e74 7320 3a20 5b61 7272     points : [arr
-00003990: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
-000039a0: 2020 2020 2033 2063 6f6c 756d 6e20 6172       3 column ar
-000039b0: 7261 7920 7769 7468 2074 6865 2066 6972  ray with the fir
-000039c0: 7374 2063 6f6c 756d 6e20 6173 2074 6865  st column as the
-000039d0: 2076 616c 7565 2079 6f75 2077 616e 7420   value you want 
-000039e0: 746f 2064 6973 706c 6179 2066 6f72 2074  to display for t
-000039f0: 6865 2070 6f69 6e74 2c20 7468 6520 7365  he point, the se
-00003a00: 636f 6e64 2069 7320 7468 6520 726f 7773  cond is the rows
-00003a10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003a20: 2020 696e 6465 7820 6f66 2074 6865 2070    index of the p
-00003a30: 6f69 6e74 2069 6e20 7468 6520 6172 7261  oint in the arra
-00003a40: 792c 2061 6e64 2074 6865 2074 6869 7264  y, and the third
-00003a50: 2063 6f6c 756d 6e20 6173 2074 6865 2063   column as the c
-00003a60: 6f6c 756d 6e20 696e 6465 7820 696e 2074  olumn index in t
-00003a70: 6865 2061 7272 6179 2e0d 0a20 2020 2020  he array...     
-00003a80: 2020 2020 2020 2020 2020 202d 2074 6865             - the
-00003a90: 2073 6563 6f6e 6420 616e 6420 7468 6972   second and thir
-00003aa0: 6420 636f 6c75 6d6e 2074 656c 6c73 2074  d column tells t
-00003ab0: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
-00003ac0: 6865 2070 6f69 6e74 2069 6e20 7468 6520  he point in the 
-00003ad0: 6172 7261 792e 0d0a 2020 2020 2020 2020  array...        
-00003ae0: 2020 2020 706f 696e 745f 636f 6c6f 723a      point_color:
-00003af0: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
-00003b00: 2020 2020 2020 2020 636f 6c6f 722e 0d0a          color...
-00003b10: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-00003b20: 745f 7369 7a65 3a20 5b41 6e79 5d0d 0a20  t_size: [Any].. 
-00003b30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00003b40: 697a 6520 6f66 2074 6865 2070 6f69 6e74  ize of the point
-00003b50: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
-00003b60: 6964 5f63 6f6c 6f72 3a20 5b73 7472 5d0d  id_color: [str].
-00003b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003b80: 2074 6865 2063 6f6c 6f72 206f 6620 7468   the color of th
-00003b90: 6520 616e 6f74 6174 696f 6e20 6f66 2074  e anotation of t
-00003ba0: 6865 2070 6f69 6e74 2e20 4465 6661 756c  he point. Defaul
-00003bb0: 7420 6973 2062 6c75 652e 0d0a 2020 2020  t is blue...    
-00003bc0: 2020 2020 2020 2020 7069 645f 7369 7a65          pid_size
-00003bd0: 3a20 5b41 6e79 5d0d 0a20 2020 2020 2020  : [Any]..       
-00003be0: 2020 2020 2020 2020 2073 697a 6520 6f66           size of
-00003bf0: 2074 6865 2070 6f69 6e74 2061 6e6e 6f74   the point annot
-00003c00: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
-00003c10: 2020 2020 6669 6773 697a 6520 3a20 5b74      figsize : [t
-00003c20: 7570 6c65 5d2c 206f 7074 696f 6e61 6c0d  uple], optional.
-00003c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003c40: 2066 6967 7572 6520 7369 7a65 2e20 5468   figure size. Th
-00003c50: 6520 6465 6661 756c 7420 6973 2028 382c  e default is (8,
-00003c60: 3829 2e0d 0a20 2020 2020 2020 2020 2020  8)...           
-00003c70: 2074 6974 6c65 203a 205b 7374 725d 2c20   title : [str], 
-00003c80: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00003c90: 2020 2020 2020 2020 2020 7469 746c 6520            title 
-00003ca0: 6f66 2074 6865 2070 6c6f 742e 2054 6865  of the plot. The
-00003cb0: 2064 6566 6175 6c74 2069 7320 2754 6f74   default is 'Tot
-00003cc0: 616c 2044 6973 6368 6172 6765 272e 0d0a  al Discharge'...
-00003cd0: 2020 2020 2020 2020 2020 2020 7469 746c              titl
-00003ce0: 655f 7369 7a65 203a 205b 696e 7465 6765  e_size : [intege
-00003cf0: 725d 2c20 6f70 7469 6f6e 616c 0d0a 2020  r], optional..  
-00003d00: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-00003d10: 746c 6520 7369 7a65 2e20 5468 6520 6465  tle size. The de
-00003d20: 6661 756c 7420 6973 2031 352e 0d0a 2020  fault is 15...  
-00003d30: 2020 2020 2020 2020 2020 6f72 6965 6e74            orient
-00003d40: 6174 696f 6e20 3a20 5b73 7472 696e 675d  ation : [string]
-00003d50: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00003d60: 2020 2020 2020 2020 2020 2020 6f72 696e              orin
-00003d70: 7461 7469 6f6e 206f 6620 7468 6520 636f  tation of the co
-00003d80: 6c6f 7262 6172 2068 6f72 697a 6f6e 7461  lorbar horizonta
-00003d90: 6c2f 7665 7274 6963 616c 2e20 5468 6520  l/vertical. The 
-00003da0: 6465 6661 756c 7420 6973 2027 7665 7274  default is 'vert
-00003db0: 6963 616c 272e 0d0a 2020 2020 2020 2020  ical'...        
-00003dc0: 2020 2020 726f 7461 7469 6f6e 203a 205b      rotation : [
-00003dd0: 6e75 6d62 6572 5d2c 206f 7074 696f 6e61  number], optiona
-00003de0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-00003df0: 2020 2072 6f74 6174 696f 6e20 6f66 2074     rotation of t
-00003e00: 6865 2063 6f6c 6f72 6261 7220 6c61 6265  he colorbar labe
-00003e10: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
-00003e20: 7320 2d39 302e 0d0a 2020 2020 2020 2020  s -90...        
-00003e30: 2020 2020 6f72 6965 6e74 6174 696f 6e20      orientation 
-00003e40: 3a20 5b73 7472 696e 675d 2c20 6f70 7469  : [string], opti
-00003e50: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00003e60: 2020 2020 2020 6f72 696e 7461 7469 6f6e        orintation
-00003e70: 206f 6620 7468 6520 636f 6c6f 7262 6172   of the colorbar
-00003e80: 2068 6f72 697a 6f6e 7461 6c2f 7665 7274   horizontal/vert
-00003e90: 6963 616c 2e20 5468 6520 6465 6661 756c  ical. The defaul
-00003ea0: 7420 6973 2027 7665 7274 6963 616c 272e  t is 'vertical'.
-00003eb0: 0d0a 2020 2020 2020 2020 2020 2020 6362  ..            cb
-00003ec0: 6172 5f6c 656e 6774 6820 3a20 5b66 6c6f  ar_length : [flo
-00003ed0: 6174 5d2c 206f 7074 696f 6e61 6c0d 0a20  at], optional.. 
-00003ee0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00003ef0: 6174 696f 2074 6f20 636f 6e74 726f 6c20  atio to control 
-00003f00: 7468 6520 6865 6967 6874 206f 6620 7468  the height of th
-00003f10: 6520 636f 6c6f 7262 6172 2e20 5468 6520  e colorbar. The 
-00003f20: 6465 6661 756c 7420 6973 2030 2e37 352e  default is 0.75.
-00003f30: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
-00003f40: 636b 735f 7370 6163 696e 6720 3a20 5b69  cks_spacing : [i
-00003f50: 6e74 6567 6572 5d2c 206f 7074 696f 6e61  nteger], optiona
-00003f60: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-00003f70: 2020 2053 7061 6369 6e67 2069 6e20 7468     Spacing in th
-00003f80: 6520 636f 6c6f 7262 6172 2074 6963 6b73  e colorbar ticks
-00003f90: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-00003fa0: 2032 2e0d 0a20 2020 2020 2020 2020 2020   2...           
-00003fb0: 2063 6261 725f 6c61 6265 6c5f 7369 7a65   cbar_label_size
-00003fc0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
-00003fd0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00003fe0: 2020 2020 2020 7369 7a65 206f 6620 7468        size of th
-00003ff0: 6520 636f 6c6f 7220 6261 7220 6c61 6265  e color bar labe
-00004000: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
-00004010: 7320 3132 2e0d 0a20 2020 2020 2020 2020  s 12...         
-00004020: 2020 2063 6261 725f 6c61 6265 6c20 3a20     cbar_label : 
-00004030: 7374 722c 206f 7074 696f 6e61 6c0d 0a20  str, optional.. 
-00004040: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00004050: 6162 656c 206f 6620 7468 6520 636f 6c6f  abel of the colo
-00004060: 7220 6261 722e 2054 6865 2064 6566 6175  r bar. The defau
-00004070: 6c74 2069 7320 2744 6973 6368 6172 6765  lt is 'Discharge
-00004080: 206d 332f 7327 2e0d 0a20 2020 2020 2020   m3/s'...       
-00004090: 2020 2020 2063 6f6c 6f72 5f73 6361 6c65       color_scale
-000040a0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
-000040b0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-000040c0: 2020 2020 2020 7468 6572 6520 6172 6520        there are 
-000040d0: 3520 6f70 7469 6f6e 7320 746f 2063 6861  5 options to cha
-000040e0: 6e67 6520 7468 6520 7363 616c 6520 6f66  nge the scale of
-000040f0: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
-00004100: 2064 6566 6175 6c74 2069 7320 312e 0d0a   default is 1...
-00004110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004120: 312d 2063 6f6c 6f72 5f73 6361 6c65 2031  1- color_scale 1
-00004130: 2069 7320 7468 6520 6e6f 726d 616c 2073   is the normal s
-00004140: 6361 6c65 0d0a 2020 2020 2020 2020 2020  cale..          
-00004150: 2020 2020 2020 322d 2063 6f6c 6f72 5f73        2- color_s
-00004160: 6361 6c65 2032 2069 7320 7468 6520 706f  cale 2 is the po
-00004170: 7765 7220 7363 616c 650d 0a20 2020 2020  wer scale..     
-00004180: 2020 2020 2020 2020 2020 2033 2d20 636f             3- co
-00004190: 6c6f 725f 7363 616c 6520 3320 6973 2074  lor_scale 3 is t
-000041a0: 6865 2053 796d 4c6f 674e 6f72 6d20 7363  he SymLogNorm sc
-000041b0: 616c 650d 0a20 2020 2020 2020 2020 2020  ale..           
-000041c0: 2020 2020 2034 2d20 636f 6c6f 725f 7363       4- color_sc
-000041d0: 616c 6520 3420 6973 2074 6865 2050 6f77  ale 4 is the Pow
-000041e0: 6572 4e6f 726d 2073 6361 6c65 0d0a 2020  erNorm scale..  
-000041f0: 2020 2020 2020 2020 2020 2020 2020 352d                5-
-00004200: 2063 6f6c 6f72 5f73 6361 6c65 2035 2069   color_scale 5 i
-00004210: 7320 7468 6520 426f 756e 6461 7279 4e6f  s the BoundaryNo
-00004220: 726d 2073 6361 6c65 0d0a 2020 2020 2020  rm scale..      
-00004230: 2020 2020 2020 2020 2020 2d2d 2d2d 2d2d            ------
-00004240: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00004280: 2020 2020 2020 2020 2020 2020 2020 6761                ga
-00004290: 6d6d 6120 3a20 5b66 6c6f 6174 5d2c 206f  mma : [float], o
-000042a0: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-000042b0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000042c0: 7565 206e 6565 6465 6420 666f 7220 6f70  ue needed for op
-000042d0: 7469 6f6e 2032 202e 2054 6865 2064 6566  tion 2 . The def
-000042e0: 6175 6c74 2069 7320 312e 2f32 2e2e 0d0a  ault is 1./2....
-000042f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004300: 6c69 6e65 5f74 6872 6573 686f 6c64 203a  line_threshold :
-00004310: 205b 666c 6f61 745d 2c20 6f70 7469 6f6e   [float], option
-00004320: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-00004330: 2020 2020 2020 2020 7661 6c75 6520 6e65          value ne
-00004340: 6564 6564 2066 6f72 206f 7074 696f 6e20  eded for option 
-00004350: 332e 2054 6865 2064 6566 6175 6c74 2069  3. The default i
-00004360: 7320 302e 3030 3031 2e0d 0a20 2020 2020  s 0.0001...     
-00004370: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00004380: 7363 616c 6520 3a20 5b66 6c6f 6174 5d2c  scale : [float],
-00004390: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-000043a0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000043b0: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
-000043c0: 6f70 7469 6f6e 2033 2e20 5468 6520 6465  option 3. The de
-000043d0: 6661 756c 7420 6973 2030 2e30 3031 2e0d  fault is 0.001..
-000043e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000043f0: 2062 6f75 6e64 733a 205b 4c69 7374 5d0d   bounds: [List].
-00004400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004410: 2020 2020 2061 206c 6973 7420 6f66 206e       a list of n
-00004420: 756d 6265 7220 746f 2062 6520 7573 6564  umber to be used
-00004430: 2061 7320 6120 6469 7363 7265 7465 2062   as a discrete b
-00004440: 6f75 6e64 7320 666f 7220 7468 6520 636f  ounds for the co
-00004450: 6c6f 7220 7363 616c 6520 342e 4465 6661  lor scale 4.Defa
-00004460: 756c 7420 6973 204e 6f6e 652c 0d0a 2020  ult is None,..  
-00004470: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-00004480: 6470 6f69 6e74 203a 205b 666c 6f61 745d  dpoint : [float]
-00004490: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-000044a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000044b0: 7661 6c75 6520 6e65 6564 6564 2066 6f72  value needed for
-000044c0: 206f 7074 696f 6e20 352e 2054 6865 2064   option 5. The d
-000044d0: 6566 6175 6c74 2069 7320 302e 0d0a 2020  efault is 0...  
-000044e0: 2020 2020 2020 2020 2020 2020 2020 2d2d                --
-000044f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004530: 0d0a 2020 2020 2020 2020 2020 2020 636d  ..            cm
-00004540: 6170 203a 205b 7374 725d 2c20 6f70 7469  ap : [str], opti
-00004550: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00004560: 2020 2020 2020 636f 6c6f 7220 7374 796c        color styl
-00004570: 652e 2054 6865 2064 6566 6175 6c74 2069  e. The default i
-00004580: 7320 2763 6f6f 6c77 6172 6d5f 7227 2e0d  s 'coolwarm_r'..
-00004590: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-000045a0: 706c 6179 5f63 656c 6c5f 7661 6c75 6520  play_cell_value 
-000045b0: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
-000045c0: 2020 2020 2020 2020 2020 5472 7565 2069            True i
-000045d0: 6620 796f 7520 7761 6e74 2074 6f20 6469  f you want to di
-000045e0: 7370 6c61 7920 7468 6520 7661 6c75 6573  splay the values
-000045f0: 206f 6620 7468 6520 6365 6c6c 7320 6173   of the cells as
-00004600: 2061 2074 6578 740d 0a20 2020 2020 2020   a text..       
-00004610: 2020 2020 206e 756d 5f73 697a 6520 3a20       num_size : 
-00004620: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
-00004630: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-00004640: 2020 2073 697a 6520 6f66 2074 6865 206e     size of the n
-00004650: 756d 6265 7273 2070 6c6f 7474 6564 2069  umbers plotted i
-00004660: 6e74 6f70 206f 6620 6561 6368 2063 656c  ntop of each cel
-00004670: 6c73 2e20 5468 6520 6465 6661 756c 7420  ls. The default 
-00004680: 6973 2038 2e0d 0a20 2020 2020 2020 2020  is 8...         
-00004690: 2020 2062 6163 6b67 726f 756e 645f 636f     background_co
-000046a0: 6c6f 725f 7468 7265 7368 6f6c 6420 3a20  lor_threshold : 
-000046b0: 5b66 6c6f 6174 2f69 6e74 6567 6572 5d2c  [float/integer],
-000046c0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-000046d0: 2020 2020 2020 2020 2020 2074 6872 6573             thres
-000046e0: 686f 6c64 2076 616c 7565 2069 6620 7468  hold value if th
-000046f0: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
-00004700: 656c 6c20 6973 2067 7265 6174 6572 2c20  ell is greater, 
-00004710: 7468 6520 706c 6f74 7465 640d 0a20 2020  the plotted..   
-00004720: 2020 2020 2020 2020 2020 2020 206e 756d               num
-00004730: 6265 7273 2077 696c 6c20 6265 2062 6c61  bers will be bla
-00004740: 636b 2061 6e64 2069 6620 736d 616c 6c65  ck and if smalle
-00004750: 7220 7468 6520 706c 6f74 7465 6420 6e75  r the plotted nu
-00004760: 6d62 6572 2077 696c 6c20 6265 2077 6869  mber will be whi
-00004770: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
-00004780: 2020 2020 6966 204e 6f6e 6520 6769 7665      if None give
-00004790: 6e20 7468 6520 6d61 7876 616c 7565 2f32  n the maxvalue/2
-000047a0: 2077 696c 6c20 6265 2063 6f6e 7369 6465   will be conside
-000047b0: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
-000047c0: 2069 7320 4e6f 6e65 2e0d 0a0d 0a20 2020   is None.....   
-000047d0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-000047e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-000047f0: 2020 2020 2020 2061 7865 733a 205b 6669         axes: [fi
-00004800: 6775 7265 2061 7865 735d 2e0d 0a20 2020  gure axes]...   
-00004810: 2020 2020 2020 2020 2074 6865 2061 7865           the axe
-00004820: 7320 6f66 2074 6865 206d 6174 706c 6f74  s of the matplot
-00004830: 6c69 6220 6669 6775 7265 0d0a 2020 2020  lib figure..    
-00004840: 2020 2020 6669 673a 205b 6d61 7470 6c6f      fig: [matplo
-00004850: 746c 6962 2066 6967 7572 6520 6f62 6a65  tlib figure obje
-00004860: 6374 5d0d 0a20 2020 2020 2020 2020 2020  ct]..           
-00004870: 2074 6865 2066 6967 7572 6520 6f62 6a65   the figure obje
-00004880: 6374 0d0a 2020 2020 2020 2020 2222 220d  ct..        """.
-00004890: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
-000048a0: 636c 656f 7061 7472 6128 0d0a 2020 2020  cleopatra(..    
-000048b0: 2020 2020 2020 2020 2254 6865 2063 7572          "The cur
-000048c0: 7265 6e74 2066 756e 6372 696f 6e20 7573  rent funcrion us
-000048d0: 6573 2063 6c65 6f70 6174 7261 2070 6163  es cleopatra pac
-000048e0: 6b61 6765 2074 6f20 666f 7220 706c 6f74  kage to for plot
-000048f0: 7469 6e67 2c20 706c 6561 7365 2069 6e73  ting, please ins
-00004900: 7461 6c6c 2069 7420 6d61 6e75 616c 6c79  tall it manually
-00004910: 2c20 666f 7220 6d6f 7265 2069 6e66 6f20  , for more info 
-00004920: 220d 0a20 2020 2020 2020 2020 2020 2022  "..            "
-00004930: 6368 6563 6b20 6874 7470 733a 2f2f 6769  check https://gi
-00004940: 7468 7562 2e63 6f6d 2f53 6572 6170 6965  thub.com/Serapie
-00004950: 756d 2d6f 662d 616c 6578 2f63 6c65 6f70  um-of-alex/cleop
-00004960: 6174 7261 220d 0a20 2020 2020 2020 2029  atra"..        )
-00004970: 0d0a 2020 2020 2020 2020 6672 6f6d 2063  ..        from c
-00004980: 6c65 6f70 6174 7261 2e61 7272 6179 2069  leopatra.array i
-00004990: 6d70 6f72 7420 4172 7261 790d 0a0d 0a20  mport Array.... 
-000049a0: 2020 2020 2020 2065 7863 6c75 6465 5f76         exclude_v
-000049b0: 616c 7565 203d 2028 0d0a 2020 2020 2020  alue = (..      
-000049c0: 2020 2020 2020 5b73 656c 662e 6e6f 5f64        [self.no_d
-000049d0: 6174 615f 7661 6c75 655b 6261 6e64 5d2c  ata_value[band],
-000049e0: 2065 7863 6c75 6465 5f76 616c 7565 5d0d   exclude_value].
-000049f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00004a00: 6578 636c 7564 655f 7661 6c75 6520 6973  exclude_value is
-00004a10: 206e 6f74 204e 6f6e 650d 0a20 2020 2020   not None..     
-00004a20: 2020 2020 2020 2065 6c73 6520 5b73 656c         else [sel
-00004a30: 662e 6e6f 5f64 6174 615f 7661 6c75 655b  f.no_data_value[
-00004a40: 6261 6e64 5d5d 0d0a 2020 2020 2020 2020  band]]..        
-00004a50: 290d 0a0d 0a20 2020 2020 2020 2061 7272  )....        arr
-00004a60: 203d 2073 656c 662e 7265 6164 5f61 7272   = self.read_arr
-00004a70: 6179 2862 616e 643d 6261 6e64 290d 0a20  ay(band=band).. 
-00004a80: 2020 2020 2020 2063 6c65 6f20 3d20 4172         cleo = Ar
-00004a90: 7261 7928 6172 722c 2065 7863 6c75 6465  ray(arr, exclude
-00004aa0: 5f76 616c 7565 3d65 7863 6c75 6465 5f76  _value=exclude_v
-00004ab0: 616c 7565 290d 0a20 2020 2020 2020 2066  alue)..        f
-00004ac0: 6967 2c20 6178 203d 2063 6c65 6f2e 706c  ig, ax = cleo.pl
-00004ad0: 6f74 282a 2a6b 7761 7267 7329 0d0a 2020  ot(**kwargs)..  
-00004ae0: 2020 2020 2020 7265 7475 726e 2066 6967        return fig
-00004af0: 2c20 6178 0d0a 0d0a 2020 2020 6465 6620  , ax....    def 
-00004b00: 5f67 6574 5f74 696d 655f 7661 7269 6162  _get_time_variab
-00004b10: 6c65 2873 656c 6629 3a0d 0a20 2020 2020  le(self):..     
-00004b20: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-00004b30: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00004b40: 2020 202d 2d2d 2d2d 2d2d 0d0a 0d0a 2020     -------....  
-00004b50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00004b60: 2020 2023 2074 696d 655f 7661 7273 203d     # time_vars =
-00004b70: 205b 2869 2c20 7365 6c66 2e6d 6574 615f   [(i, self.meta_
-00004b80: 6461 7461 2e67 6574 2869 2929 2066 6f72  data.get(i)) for
-00004b90: 2069 2069 6e20 7365 6c66 2e6d 6574 615f   i in self.meta_
-00004ba0: 6461 7461 2e6b 6579 7328 2920 6966 2069  data.keys() if i
-00004bb0: 2e73 7461 7274 7377 6974 6828 2274 696d  .startswith("tim
-00004bc0: 6522 295d 0d0a 2020 2020 2020 2020 2320  e")]..        # 
-00004bd0: 7469 6d65 5f76 6172 5f6e 616d 6520 3d20  time_var_name = 
-00004be0: 7469 6d65 5f76 6172 735b 305d 5b30 5d2e  time_vars[0][0].
-00004bf0: 7370 6c69 7428 2223 2229 5b30 5d0d 0a20  split("#")[0].. 
-00004c00: 2020 2020 2020 2065 7874 7261 5f64 696d         extra_dim
-00004c10: 203d 2073 656c 662e 6d65 7461 5f64 6174   = self.meta_dat
-00004c20: 612e 6765 7428 224e 4554 4344 465f 4449  a.get("NETCDF_DI
-00004c30: 4d5f 4558 5452 4122 290d 0a20 2020 2020  M_EXTRA")..     
-00004c40: 2020 2069 6620 6578 7472 615f 6469 6d20     if extra_dim 
-00004c50: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-00004c60: 2020 2020 2020 2020 2020 7469 6d65 5f76            time_v
-00004c70: 6172 5f6e 616d 6520 3d20 6578 7472 615f  ar_name = extra_
-00004c80: 6469 6d2e 7265 706c 6163 6528 227b 222c  dim.replace("{",
-00004c90: 2022 2229 2e72 6570 6c61 6365 2822 7d22   "").replace("}"
-00004ca0: 2c20 2222 290d 0a20 2020 2020 2020 2020  , "")..         
-00004cb0: 2020 2075 6e69 7473 203d 2073 656c 662e     units = self.
-00004cc0: 6d65 7461 5f64 6174 612e 6765 7428 6622  meta_data.get(f"
-00004cd0: 7b74 696d 655f 7661 725f 6e61 6d65 7d23  {time_var_name}#
-00004ce0: 756e 6974 7322 290d 0a20 2020 2020 2020  units")..       
-00004cf0: 2020 2020 2066 756e 6320 3d20 6372 6561       func = crea
-00004d00: 7465 5f74 696d 655f 636f 6e76 6572 7369  te_time_conversi
-00004d10: 6f6e 5f66 756e 6328 756e 6974 7329 0d0a  on_func(units)..
-00004d20: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-00004d30: 5f76 616c 7320 3d20 7365 6c66 2e5f 7265  _vals = self._re
-00004d40: 6164 5f76 6172 6961 626c 6528 7469 6d65  ad_variable(time
-00004d50: 5f76 6172 5f6e 616d 6529 0d0a 2020 2020  _var_name)..    
-00004d60: 2020 2020 2020 2020 7469 6d65 5f73 7461          time_sta
-00004d70: 6d70 203d 206c 6973 7428 6d61 7028 6675  mp = list(map(fu
-00004d80: 6e63 2c20 7469 6d65 5f76 616c 735b 305d  nc, time_vals[0]
-00004d90: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
-00004da0: 3a0d 0a20 2020 2020 2020 2020 2020 2074  :..            t
-00004db0: 696d 655f 7374 616d 7020 3d20 4e6f 6e65  ime_stamp = None
-00004dc0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00004dd0: 2074 696d 655f 7374 616d 700d 0a0d 0a20   time_stamp.... 
-00004de0: 2020 2064 6566 205f 6765 745f 6c61 745f     def _get_lat_
-00004df0: 6c6f 6e28 7365 6c66 293a 0d0a 2020 2020  lon(self):..    
-00004e00: 2020 2020 6c6f 6e20 3d20 7365 6c66 2e5f      lon = self._
-00004e10: 7265 6164 5f76 6172 6961 626c 6528 226c  read_variable("l
-00004e20: 6f6e 2229 0d0a 2020 2020 2020 2020 6c61  on")..        la
-00004e30: 7420 3d20 7365 6c66 2e5f 7265 6164 5f76  t = self._read_v
-00004e40: 6172 6961 626c 6528 226c 6174 2229 0d0a  ariable("lat")..
-00004e50: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-00004e60: 6174 2c20 6c6f 6e0d 0a0d 0a20 2020 2064  at, lon....    d
-00004e70: 6566 205f 7265 6164 5f76 6172 6961 626c  ef _read_variabl
-00004e80: 6528 7365 6c66 2c20 7661 723a 2073 7472  e(self, var: str
-00004e90: 293a 0d0a 2020 2020 2020 2020 7265 7475  ):..        retu
-00004ea0: 726e 2067 6461 6c2e 4f70 656e 2866 224e  rn gdal.Open(f"N
-00004eb0: 4554 4344 463a 7b73 656c 662e 6669 6c65  ETCDF:{self.file
-00004ec0: 5f6e 616d 657d 3a7b 7661 727d 2229 2e52  _name}:{var}").R
-00004ed0: 6561 6441 7341 7272 6179 2829 0d0a 0d0a  eadAsArray()....
-00004ee0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00004ef0: 640d 0a20 2020 2064 6566 205f 6372 6561  d..    def _crea
-00004f00: 7465 5f67 6461 6c5f 6461 7461 7365 7428  te_gdal_dataset(
-00004f10: 0d0a 2020 2020 2020 2020 636f 6c73 3a20  ..        cols: 
-00004f20: 696e 742c 0d0a 2020 2020 2020 2020 726f  int,..        ro
-00004f30: 7773 3a20 696e 742c 0d0a 2020 2020 2020  ws: int,..      
-00004f40: 2020 6261 6e64 733a 2069 6e74 2c0d 0a20    bands: int,.. 
-00004f50: 2020 2020 2020 2064 7479 7065 3a20 696e         dtype: in
-00004f60: 742c 0d0a 2020 2020 2020 2020 6472 6976  t,..        driv
-00004f70: 6572 3a20 7374 7220 3d20 224d 454d 222c  er: str = "MEM",
-00004f80: 0d0a 2020 2020 2020 2020 7061 7468 3a20  ..        path: 
-00004f90: 7374 7220 3d20 4e6f 6e65 2c0d 0a20 2020  str = None,..   
-00004fa0: 2029 202d 3e20 6764 616c 2e44 6174 6173   ) -> gdal.Datas
-00004fb0: 6574 3a0d 0a20 2020 2020 2020 2022 2222  et:..        """
-00004fc0: 4372 6561 7465 2047 4441 4c20 6472 6976  Create GDAL driv
-00004fd0: 6572 2e0d 0a0d 0a20 2020 2020 2020 2020  er.....         
-00004fe0: 2020 2063 7265 6174 6573 2061 2064 7269     creates a dri
-00004ff0: 7665 7220 616e 6420 7361 7665 2069 7420  ver and save it 
-00005000: 746f 2064 6973 6b20 616e 6420 696e 206d  to disk and in m
-00005010: 656d 6f72 7920 6966 2070 6174 6820 6973  emory if path is
-00005020: 206e 6f74 2067 6976 656e 2e0d 0a0d 0a20   not given..... 
-00005030: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00005040: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00005050: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
-00005060: 6f6c 733a 205b 696e 745d 0d0a 2020 2020  ols: [int]..    
-00005070: 2020 2020 2020 2020 6e75 6d62 6572 206f          number o
-00005080: 6620 636f 6c75 6d6e 732e 0d0a 2020 2020  f columns...    
-00005090: 2020 2020 726f 7773 3a20 5b69 6e74 5d0d      rows: [int].
-000050a0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-000050b0: 6265 7220 6f66 2072 6f77 732e 0d0a 2020  ber of rows...  
-000050c0: 2020 2020 2020 6261 6e64 733a 205b 696e        bands: [in
-000050d0: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
-000050e0: 6e75 6d62 6572 206f 6620 6261 6e64 732e  number of bands.
-000050f0: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
-00005100: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-00005110: 2020 2020 2064 7269 7665 7220 7479 7065       driver type
-00005120: 205b 2247 5469 6666 222c 2022 4d45 4d22   ["GTiff", "MEM"
-00005130: 5d2e 0d0a 2020 2020 2020 2020 7061 7468  ]...        path
-00005140: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-00005150: 2020 2020 2070 6174 6820 746f 2073 6176       path to sav
-00005160: 6520 7468 6520 4754 6966 6620 6472 6976  e the GTiff driv
-00005170: 6572 2e0d 0a20 2020 2020 2020 2064 7479  er...        dty
-00005180: 7065 3a0d 0a20 2020 2020 2020 2020 2020  pe:..           
-00005190: 2067 6461 6c20 6461 7461 2074 7970 652c   gdal data type,
-000051a0: 2075 7365 2074 6865 2066 756e 6374 696f   use the functio
-000051b0: 6e73 2069 6e20 7468 6520 7574 696c 7320  ns in the utils 
-000051c0: 6d6f 6475 6c65 2074 6f20 6d61 7020 6461  module to map da
-000051d0: 7461 2074 7970 6573 2066 726f 6d20 6e75  ta types from nu
-000051e0: 6d70 7920 6f72 206f 6772 2074 6f20 6764  mpy or ogr to gd
-000051f0: 616c 2e0d 0a0d 0a20 2020 2020 2020 2052  al.....        R
-00005200: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00005210: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00005220: 2067 6461 6c20 6472 6976 6572 0d0a 2020   gdal driver..  
-00005230: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00005240: 2020 2069 6620 7061 7468 3a0d 0a20 2020     if path:..   
-00005250: 2020 2020 2020 2020 2064 7269 7665 7220           driver 
-00005260: 3d20 2247 5469 6666 2220 6966 2064 7269  = "GTiff" if dri
-00005270: 7665 7220 3d3d 2022 4d45 4d22 2065 6c73  ver == "MEM" els
-00005280: 6520 6472 6976 6572 0d0a 2020 2020 2020  e driver..      
-00005290: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-000052a0: 6e73 7461 6e63 6528 7061 7468 2c20 7374  nstance(path, st
-000052b0: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
-000052c0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-000052d0: 7272 6f72 2822 5468 6520 7061 7468 2069  rror("The path i
-000052e0: 6e70 7574 2073 686f 756c 6420 6265 2073  nput should be s
-000052f0: 7472 696e 6722 290d 0a20 2020 2020 2020  tring")..       
-00005300: 2020 2020 2069 6620 6472 6976 6572 203d       if driver =
-00005310: 3d20 2247 5469 6666 223a 0d0a 2020 2020  = "GTiff":..    
-00005320: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00005330: 6f74 2070 6174 682e 656e 6473 7769 7468  ot path.endswith
-00005340: 2822 2e74 6966 2229 3a0d 0a20 2020 2020  (".tif"):..     
-00005350: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00005360: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
-00005370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005380: 2020 2020 2020 2020 2022 5468 6520 7061           "The pa
-00005390: 7468 2074 6f20 7361 7665 2074 6865 2063  th to save the c
-000053a0: 7265 6174 6564 2072 6173 7465 7220 7368  reated raster sh
-000053b0: 6f75 6c64 2065 6e64 2077 6974 6820 2e74  ould end with .t
-000053c0: 6966 220d 0a20 2020 2020 2020 2020 2020  if"..           
-000053d0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000053e0: 2020 2020 2020 2020 2320 4c5a 5720 6973          # LZW is
-000053f0: 2061 206c 6f73 736c 6573 7320 636f 6d70   a lossless comp
-00005400: 7265 7373 696f 6e20 6d65 7468 6f64 2061  ression method a
-00005410: 6368 6965 7665 2074 6865 2068 6967 6873  chieve the highs
-00005420: 7420 636f 6d70 7265 7373 696f 6e20 6275  t compression bu
-00005430: 7420 7769 7468 206c 6f74 206f 6620 636f  t with lot of co
-00005440: 6d70 7574 6174 696f 6e0d 0a20 2020 2020  mputation..     
-00005450: 2020 2020 2020 2073 7263 203d 2067 6461         src = gda
-00005460: 6c2e 4765 7444 7269 7665 7242 794e 616d  l.GetDriverByNam
-00005470: 6528 6472 6976 6572 292e 4372 6561 7465  e(driver).Create
-00005480: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00005490: 2020 2070 6174 682c 2063 6f6c 732c 2072     path, cols, r
-000054a0: 6f77 732c 2062 616e 6473 2c20 6474 7970  ows, bands, dtyp
-000054b0: 652c 205b 2243 4f4d 5052 4553 533d 4c5a  e, ["COMPRESS=LZ
-000054c0: 5722 5d0d 0a20 2020 2020 2020 2020 2020  W"]..           
-000054d0: 2029 0d0a 2020 2020 2020 2020 656c 7365   )..        else
-000054e0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-000054f0: 2066 6f72 206d 656d 6f72 7920 6472 6976   for memory driv
-00005500: 6572 730d 0a20 2020 2020 2020 2020 2020  ers..           
-00005510: 2064 7269 7665 7220 3d20 224d 454d 220d   driver = "MEM".
-00005520: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
-00005530: 203d 2067 6461 6c2e 4765 7444 7269 7665   = gdal.GetDrive
-00005540: 7242 794e 616d 6528 6472 6976 6572 292e  rByName(driver).
-00005550: 4372 6561 7465 2822 222c 2063 6f6c 732c  Create("", cols,
-00005560: 2072 6f77 732c 2062 616e 6473 2c20 6474   rows, bands, dt
-00005570: 7970 6529 0d0a 2020 2020 2020 2020 7265  ype)..        re
-00005580: 7475 726e 2073 7263 0d0a 0d0a 2020 2020  turn src....    
-00005590: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
-000055a0: 2020 6465 6620 6372 6561 7465 5f66 726f    def create_fro
-000055b0: 6d5f 6172 7261 7928 0d0a 2020 2020 2020  m_array(..      
-000055c0: 2020 636c 732c 0d0a 2020 2020 2020 2020    cls,..        
-000055d0: 6172 723a 2055 6e69 6f6e 5b73 7472 2c20  arr: Union[str, 
-000055e0: 6764 616c 2e44 6174 6173 6574 2c20 6e70  gdal.Dataset, np
-000055f0: 2e6e 6461 7272 6179 5d2c 0d0a 2020 2020  .ndarray],..    
-00005600: 2020 2020 6765 6f3a 2055 6e69 6f6e 5b73      geo: Union[s
-00005610: 7472 2c20 7475 706c 655d 2c0d 0a20 2020  tr, tuple],..   
-00005620: 2020 2020 2065 7073 673a 2055 6e69 6f6e       epsg: Union
-00005630: 5b73 7472 2c20 696e 745d 2c0d 0a20 2020  [str, int],..   
-00005640: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
-00005650: 7565 3a20 556e 696f 6e5b 416e 792c 206c  ue: Union[Any, l
-00005660: 6973 745d 203d 2044 4546 4155 4c54 5f4e  ist] = DEFAULT_N
-00005670: 4f5f 4441 5441 5f56 414c 5545 2c0d 0a20  O_DATA_VALUE,.. 
-00005680: 2020 2029 3a0d 0a20 2020 2020 2020 2022     ):..        "
-00005690: 2222 6372 6561 7465 5f72 6173 7465 722e  ""create_raster.
-000056a0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000056b0: 2d20 6372 6561 7465 5f72 6173 7465 7220  - create_raster 
-000056c0: 6d65 7468 6f64 2063 7265 6174 6573 2061  method creates a
-000056d0: 2072 6173 7465 7220 6672 6f6d 2061 2067   raster from a g
-000056e0: 6976 656e 2061 7272 6179 2061 6e64 2067  iven array and g
-000056f0: 656f 7472 616e 7366 6f72 6d20 6461 7461  eotransform data
-00005700: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
-00005710: 6420 7361 7665 2074 6865 2074 6966 2066  d save the tif f
-00005720: 696c 6520 6966 2061 2050 6174 6820 6973  ile if a Path is
-00005730: 2067 6976 656e 206f 7220 6974 2077 696c   given or it wil
-00005740: 6c20 7265 7475 726e 2074 6865 2067 6461  l return the gda
-00005750: 6c2e 4461 7461 6375 6265 0d0a 0d0a 2020  l.Datacube....  
-00005760: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00005770: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00005780: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
-00005790: 7220 3a20 5b61 7272 6179 5d2c 206f 7074  r : [array], opt
-000057a0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-000057b0: 2020 206e 756d 7079 2061 7272 6179 2e20     numpy array. 
-000057c0: 5468 6520 6465 6661 756c 7420 6973 2027  The default is '
-000057d0: 272e 0d0a 2020 2020 2020 2020 6765 6f20  '...        geo 
-000057e0: 3a20 5b6c 6973 745d 2c20 6f70 7469 6f6e  : [list], option
-000057f0: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-00005800: 6765 6f74 7261 6e73 666f 726d 206c 6973  geotransform lis
-00005810: 7420 5b6d 696e 696d 756d 206c 6f6e 2c20  t [minimum lon, 
-00005820: 7069 7865 6c73 697a 652c 2072 6f74 6174  pixelsize, rotat
-00005830: 696f 6e2c 206d 6178 696d 756d 206c 6174  ion, maximum lat
-00005840: 2c20 726f 7461 7469 6f6e 2c0d 0a20 2020  , rotation,..   
-00005850: 2020 2020 2020 2020 2020 2020 2070 6978               pix
-00005860: 656c 7369 7a65 5d2e 2054 6865 2064 6566  elsize]. The def
-00005870: 6175 6c74 2069 7320 2727 2e0d 0a20 2020  ault is ''...   
-00005880: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
-00005890: 7565 203a 2054 5950 452c 206f 7074 696f  ue : TYPE, optio
-000058a0: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-000058b0: 2044 4553 4352 4950 5449 4f4e 2e20 5468   DESCRIPTION. Th
-000058c0: 6520 6465 6661 756c 7420 6973 202d 3939  e default is -99
-000058d0: 3939 2e0d 0a20 2020 2020 2020 2065 7073  99...        eps
-000058e0: 673a 205b 696e 7465 6765 725d 0d0a 2020  g: [integer]..  
-000058f0: 2020 2020 2020 2020 2020 696e 7465 6765            intege
-00005900: 7220 7265 6665 7265 6e63 6520 6e75 6d62  r reference numb
-00005910: 6572 2074 6f20 7468 6520 6e65 7720 7072  er to the new pr
-00005920: 6f6a 6563 7469 6f6e 2028 6874 7470 733a  ojection (https:
-00005930: 2f2f 6570 7367 2e69 6f2f 290d 0a20 2020  //epsg.io/)..   
-00005940: 2020 2020 2020 2020 2020 2020 2028 6465               (de
-00005950: 6661 756c 7420 3338 3537 2074 6865 2072  fault 3857 the r
-00005960: 6566 6572 656e 6365 206e 6f20 6f66 2057  eference no of W
-00005970: 4753 3834 2077 6562 206d 6572 6361 746f  GS84 web mercato
-00005980: 7220 290d 0a0d 0a20 2020 2020 2020 2052  r )....        R
-00005990: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-000059a0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000059b0: 2064 7374 203a 205b 4461 7461 5365 745d   dst : [DataSet]
-000059c0: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
-000059d0: 6174 6173 6574 206f 626a 6563 7420 7769  ataset object wi
-000059e0: 6c6c 2062 6520 7265 7475 726e 6564 2e0d  ll be returned..
-000059f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00005a00: 2020 2020 2020 6966 206c 656e 2861 7272        if len(arr
-00005a10: 2e73 6861 7065 2920 3d3d 2032 3a0d 0a20  .shape) == 2:.. 
-00005a20: 2020 2020 2020 2020 2020 2062 616e 6473             bands
-00005a30: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
-00005a40: 2020 726f 7773 203d 2069 6e74 2861 7272    rows = int(arr
-00005a50: 2e73 6861 7065 5b30 5d29 0d0a 2020 2020  .shape[0])..    
-00005a60: 2020 2020 2020 2020 636f 6c73 203d 2069          cols = i
-00005a70: 6e74 2861 7272 2e73 6861 7065 5b31 5d29  nt(arr.shape[1])
-00005a80: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00005a90: 0a20 2020 2020 2020 2020 2020 2062 616e  .            ban
-00005aa0: 6473 203d 2061 7272 2e73 6861 7065 5b30  ds = arr.shape[0
-00005ab0: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
-00005ac0: 6f77 7320 3d20 696e 7428 6172 722e 7368  ows = int(arr.sh
-00005ad0: 6170 655b 315d 290d 0a20 2020 2020 2020  ape[1])..       
-00005ae0: 2020 2020 2063 6f6c 7320 3d20 696e 7428       cols = int(
-00005af0: 6172 722e 7368 6170 655b 325d 290d 0a0d  arr.shape[2])...
-00005b00: 0a20 2020 2020 2020 2064 7479 7065 203d  .        dtype =
-00005b10: 206e 756d 7079 5f74 6f5f 6764 616c 5f64   numpy_to_gdal_d
-00005b20: 7479 7065 2861 7272 290d 0a20 2020 2020  type(arr)..     
-00005b30: 2020 2064 7374 5f64 7320 3d20 4461 7461     dst_ds = Data
-00005b40: 7365 742e 5f63 7265 6174 655f 6764 616c  set._create_gdal
-00005b50: 5f64 6174 6173 6574 280d 0a20 2020 2020  _dataset(..     
-00005b60: 2020 2020 2020 2063 6f6c 732c 2072 6f77         cols, row
-00005b70: 732c 2062 616e 6473 2c20 6474 7970 652c  s, bands, dtype,
-00005b80: 2064 7269 7665 723d 224d 454d 222c 2070   driver="MEM", p
-00005b90: 6174 683d 4e6f 6e65 0d0a 2020 2020 2020  ath=None..      
-00005ba0: 2020 290d 0a0d 0a20 2020 2020 2020 2073    )....        s
-00005bb0: 7273 6520 3d20 4461 7461 7365 742e 5f63  rse = Dataset._c
-00005bc0: 7265 6174 655f 7372 5f66 726f 6d5f 6570  reate_sr_from_ep
-00005bd0: 7367 2865 7073 673d 6570 7367 290d 0a20  sg(epsg=epsg).. 
-00005be0: 2020 2020 2020 2064 7374 5f64 732e 5365         dst_ds.Se
-00005bf0: 7450 726f 6a65 6374 696f 6e28 7372 7365  tProjection(srse
-00005c00: 2e45 7870 6f72 7454 6f57 6b74 2829 290d  .ExportToWkt()).
-00005c10: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
-00005c20: 203d 2063 6c73 2864 7374 5f64 7329 0d0a   = cls(dst_ds)..
-00005c30: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
-00005c40: 5f73 6574 5f6e 6f5f 6461 7461 5f76 616c  _set_no_data_val
-00005c50: 7565 286e 6f5f 6461 7461 5f76 616c 7565  ue(no_data_value
-00005c60: 3d6e 6f5f 6461 7461 5f76 616c 7565 290d  =no_data_value).
-00005c70: 0a0d 0a20 2020 2020 2020 2064 7374 5f6f  ...        dst_o
-00005c80: 626a 2e72 6173 7465 722e 5365 7447 656f  bj.raster.SetGeo
-00005c90: 5472 616e 7366 6f72 6d28 6765 6f29 0d0a  Transform(geo)..
-00005ca0: 2020 2020 2020 2020 6966 2062 616e 6473          if bands
-00005cb0: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
-00005cc0: 2020 2020 6473 745f 6f62 6a2e 7261 7374      dst_obj.rast
-00005cd0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
-00005ce0: 2831 292e 5772 6974 6541 7272 6179 2861  (1).WriteArray(a
-00005cf0: 7272 290d 0a20 2020 2020 2020 2065 6c73  rr)..        els
-00005d00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00005d10: 666f 7220 6920 696e 2072 616e 6765 2862  for i in range(b
-00005d20: 616e 6473 293a 0d0a 2020 2020 2020 2020  ands):..        
-00005d30: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
-00005d40: 7261 7374 6572 2e47 6574 5261 7374 6572  raster.GetRaster
-00005d50: 4261 6e64 2869 202b 2031 292e 5772 6974  Band(i + 1).Writ
-00005d60: 6541 7272 6179 2861 7272 5b69 2c20 3a2c  eArray(arr[i, :,
-00005d70: 203a 5d29 0d0a 0d0a 2020 2020 2020 2020   :])....        
-00005d80: 7265 7475 726e 2064 7374 5f6f 626a 0d0a  return dst_obj..
-00005d90: 0d0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-00005da0: 6f64 0d0a 2020 2020 6465 6620 6461 7461  od..    def data
-00005db0: 7365 745f 6c69 6b65 280d 0a20 2020 2020  set_like(..     
-00005dc0: 2020 2063 6c73 2c0d 0a20 2020 2020 2020     cls,..       
-00005dd0: 2073 7263 2c0d 0a20 2020 2020 2020 2061   src,..        a
-00005de0: 7272 6179 3a20 6e70 2e6e 6461 7272 6179  rray: np.ndarray
-00005df0: 2c0d 0a20 2020 2020 2020 2064 7269 7665  ,..        drive
-00005e00: 723a 2073 7472 203d 2022 4d45 4d22 2c0d  r: str = "MEM",.
-00005e10: 0a20 2020 2020 2020 2070 6174 683a 2073  .        path: s
-00005e20: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
-00005e30: 2920 2d3e 2055 6e69 6f6e 5b67 6461 6c2e  ) -> Union[gdal.
-00005e40: 4461 7461 7365 742c 204e 6f6e 655d 3a0d  Dataset, None]:.
-00005e50: 0a20 2020 2020 2020 2022 2222 7261 7374  .        """rast
-00005e60: 6572 4c69 6b65 2e0d 0a0d 0a20 2020 2020  erLike.....     
-00005e70: 2020 2072 6173 7465 724c 696b 6520 6d65     rasterLike me
-00005e80: 7468 6f64 2063 7265 6174 6573 2061 2047  thod creates a G
-00005e90: 656f 7469 6666 2072 6173 7465 7220 6c69  eotiff raster li
-00005ea0: 6b65 2061 6e6f 7468 6572 2069 6e70 7574  ke another input
-00005eb0: 2072 6173 7465 722c 206e 6577 2072 6173   raster, new ras
-00005ec0: 7465 720d 0a20 2020 2020 2020 2077 696c  ter..        wil
-00005ed0: 6c20 6861 7665 2074 6865 2073 616d 6520  l have the same 
-00005ee0: 7072 6f6a 6563 7469 6f6e 2c20 636f 6f72  projection, coor
-00005ef0: 6469 6e61 7465 7320 6f72 2074 6865 2074  dinates or the t
-00005f00: 6f70 206c 6566 7420 636f 726e 6572 206f  op left corner o
-00005f10: 6620 7468 6520 6f72 6967 696e 616c 0d0a  f the original..
-00005f20: 2020 2020 2020 2020 7261 7374 6572 2c20          raster, 
-00005f30: 6365 6c6c 2073 697a 652c 206e 6f64 6174  cell size, nodat
-00005f40: 6120 7665 6c75 652c 2061 6e64 206e 756d  a velue, and num
-00005f50: 6265 7220 6f66 2072 6f77 7320 616e 6420  ber of rows and 
-00005f60: 636f 6c75 6d6e 730d 0a20 2020 2020 2020  columns..       
-00005f70: 2074 6865 2072 6173 7465 7220 616e 6420   the raster and 
-00005f80: 7468 6520 6465 6d20 7368 6f75 6c64 2068  the dem should h
-00005f90: 6176 6520 7468 6520 7361 6d65 206e 756d  ave the same num
-00005fa0: 6265 7220 6f66 2063 6f6c 756d 6e73 2061  ber of columns a
-00005fb0: 6e64 2072 6f77 730d 0a0d 0a20 2020 2020  nd rows....     
-00005fc0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00005fd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00005fe0: 2d0d 0a20 2020 2020 2020 2073 7263 203a  -..        src :
-00005ff0: 205b 6764 616c 2e64 6174 6173 6574 5d0d   [gdal.dataset].
-00006000: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00006010: 7263 6520 7261 7374 6572 2074 6f20 6765  rce raster to ge
-00006020: 7420 7468 6520 7370 6174 6961 6c20 696e  t the spatial in
-00006030: 666f 726d 6174 696f 6e0d 0a20 2020 2020  formation..     
-00006040: 2020 2061 7272 6179 203a 205b 6e75 6d70     array : [nump
-00006050: 7920 6172 7261 795d 0d0a 2020 2020 2020  y array]..      
-00006060: 2020 2020 2020 746f 2073 746f 7265 2069        to store i
-00006070: 6e20 7468 6520 6e65 7720 7261 7374 6572  n the new raster
-00006080: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
-00006090: 3a5b 7374 725d 0d0a 2020 2020 2020 2020  :[str]..        
-000060a0: 2020 2020 6764 616c 2064 7269 7665 7220      gdal driver 
-000060b0: 7479 7065 2e20 4465 6661 756c 7420 6973  type. Default is
-000060c0: 2022 4754 6966 6622 0d0a 2020 2020 2020   "GTiff"..      
-000060d0: 2020 7061 7468 203a 205b 5374 7269 6e67    path : [String
-000060e0: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
-000060f0: 6174 6820 746f 2073 6176 6520 7468 6520  ath to save the 
-00006100: 6e65 7720 7261 7374 6572 2069 6e63 6c75  new raster inclu
-00006110: 6469 6e67 206e 6577 2072 6173 7465 7220  ding new raster 
-00006120: 6e61 6d65 2061 6e64 2065 7874 656e 7369  name and extensi
-00006130: 6f6e 2028 2e74 6966 290d 0a0d 0a20 2020  on (.tif)....   
-00006140: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00006150: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00006160: 2020 2020 2020 204e 6f6e 653a 0d0a 2020         None:..  
-00006170: 2020 2020 2020 2020 2020 6966 2074 6865            if the
-00006180: 2064 7269 7665 7220 6973 2022 4754 6966   driver is "GTif
-00006190: 6622 2074 6865 2066 756e 6374 696f 6e20  f" the function 
-000061a0: 7769 6c6c 2073 6176 6520 7468 6520 6e65  will save the ne
-000061b0: 7720 7261 7374 6572 2074 6f20 7468 6520  w raster to the 
-000061c0: 6769 7665 6e20 7061 7468 2e0d 0a20 2020  given path...   
-000061d0: 2020 2020 2044 6174 6163 7562 653a 0d0a       Datacube:..
-000061e0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-000061f0: 6865 2064 7269 7665 7220 6973 2022 4d45  he driver is "ME
-00006200: 4d22 2074 6865 2066 756e 6374 696f 6e20  M" the function 
-00006210: 7769 6c6c 2072 6574 7572 6e20 7468 6520  will return the 
-00006220: 6372 6561 7465 6420 7261 7374 6572 2069  created raster i
-00006230: 6e20 6d65 6d6f 7279 2e0d 0a0d 0a20 2020  n memory.....   
-00006240: 2020 2020 2045 7861 6d70 6c65 0d0a 2020       Example..  
-00006250: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00006260: 2020 2020 2020 203e 3e3e 2061 7272 6179         >>> array
-00006270: 203d 206e 702e 6c6f 6164 2822 5241 494e   = np.load("RAIN
-00006280: 5f35 6b2e 6e70 7922 290d 0a20 2020 2020  _5k.npy")..     
-00006290: 2020 203e 3e3e 2073 7263 203d 2067 6461     >>> src = gda
-000062a0: 6c2e 4f70 656e 2822 4445 4d2e 7469 6622  l.Open("DEM.tif"
-000062b0: 290d 0a20 2020 2020 2020 203e 3e3e 206e  )..        >>> n
-000062c0: 616d 6520 3d20 2272 6169 6e2e 7469 6622  ame = "rain.tif"
-000062d0: 0d0a 2020 2020 2020 2020 3e3e 3e20 4461  ..        >>> Da
-000062e0: 7461 7365 742e 6461 7461 7365 745f 6c69  taset.dataset_li
-000062f0: 6b65 2873 7263 2c20 6172 7261 792c 2064  ke(src, array, d
-00006300: 7269 7665 723d 2247 5469 6666 222c 2070  river="GTiff", p
-00006310: 6174 683d 6e61 6d65 290d 0a20 2020 2020  ath=name)..     
-00006320: 2020 202d 206f 7220 6372 6561 7465 2061     - or create a
-00006330: 2072 6173 7465 7220 696e 206d 656d 6f72   raster in memor
-00006340: 790d 0a20 2020 2020 2020 203e 3e3e 2061  y..        >>> a
-00006350: 7272 6179 203d 206e 702e 6c6f 6164 2822  rray = np.load("
-00006360: 5241 494e 5f35 6b2e 6e70 7922 290d 0a20  RAIN_5k.npy").. 
-00006370: 2020 2020 2020 203e 3e3e 2073 7263 203d         >>> src =
-00006380: 2067 6461 6c2e 4f70 656e 2822 4445 4d2e   gdal.Open("DEM.
-00006390: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
-000063a0: 3e3e 2064 7374 203d 2044 6174 6173 6574  >> dst = Dataset
-000063b0: 2e64 6174 6173 6574 5f6c 696b 6528 7372  .dataset_like(sr
-000063c0: 632c 2061 7272 6179 2c20 6472 6976 6572  c, array, driver
-000063d0: 3d22 4d45 4d22 290d 0a20 2020 2020 2020  ="MEM")..       
-000063e0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-000063f0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00006400: 6172 7261 792c 206e 702e 6e64 6172 7261  array, np.ndarra
-00006410: 7929 3a0d 0a20 2020 2020 2020 2020 2020  y):..           
-00006420: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00006430: 2822 6172 7261 7920 7368 6f75 6c64 2062  ("array should b
-00006440: 6520 6f66 2074 7970 6520 6e75 6d70 7920  e of type numpy 
-00006450: 6172 7261 7922 290d 0a0d 0a20 2020 2020  array")....     
-00006460: 2020 2069 6620 6c65 6e28 6172 7261 792e     if len(array.
-00006470: 7368 6170 6529 203d 3d20 323a 0d0a 2020  shape) == 2:..  
-00006480: 2020 2020 2020 2020 2020 6261 6e64 7320            bands 
-00006490: 3d20 310d 0a20 2020 2020 2020 2065 6c73  = 1..        els
-000064a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000064b0: 6261 6e64 7320 3d20 6172 7261 792e 7368  bands = array.sh
-000064c0: 6170 655b 305d 0d0a 0d0a 2020 2020 2020  ape[0]....      
-000064d0: 2020 6474 7970 6520 3d20 6e75 6d70 795f    dtype = numpy_
-000064e0: 746f 5f67 6461 6c5f 6474 7970 6528 6172  to_gdal_dtype(ar
-000064f0: 7261 7929 0d0a 0d0a 2020 2020 2020 2020  ray)....        
-00006500: 6473 7420 3d20 4461 7461 7365 742e 5f63  dst = Dataset._c
-00006510: 7265 6174 655f 6764 616c 5f64 6174 6173  reate_gdal_datas
-00006520: 6574 280d 0a20 2020 2020 2020 2020 2020  et(..           
-00006530: 2073 7263 2e63 6f6c 756d 6e73 2c20 7372   src.columns, sr
-00006540: 632e 726f 7773 2c20 6261 6e64 732c 2064  c.rows, bands, d
-00006550: 7479 7065 2c20 6472 6976 6572 3d64 7269  type, driver=dri
-00006560: 7665 722c 2070 6174 683d 7061 7468 0d0a  ver, path=path..
-00006570: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-00006580: 2020 2020 2064 7374 2e53 6574 4765 6f54       dst.SetGeoT
-00006590: 7261 6e73 666f 726d 2873 7263 2e67 656f  ransform(src.geo
-000065a0: 7472 616e 7366 6f72 6d29 0d0a 2020 2020  transform)..    
-000065b0: 2020 2020 6473 742e 5365 7450 726f 6a65      dst.SetProje
-000065c0: 6374 696f 6e28 7372 632e 6372 7329 0d0a  ction(src.crs)..
-000065d0: 2020 2020 2020 2020 2320 7365 7474 696e          # settin
-000065e0: 6720 7468 6520 4e6f 4461 7461 5661 6c75  g the NoDataValu
-000065f0: 6520 646f 6573 206e 6f74 2061 6363 6570  e does not accep
-00006600: 7420 646f 7562 6c65 2070 7265 6369 7369  t double precisi
-00006610: 6f6e 206e 756d 6265 7273 0d0a 2020 2020  on numbers..    
-00006620: 2020 2020 6473 745f 6f62 6a20 3d20 636c      dst_obj = cl
-00006630: 7328 6473 7429 0d0a 2020 2020 2020 2020  s(dst)..        
-00006640: 6473 745f 6f62 6a2e 5f73 6574 5f6e 6f5f  dst_obj._set_no_
-00006650: 6461 7461 5f76 616c 7565 286e 6f5f 6461  data_value(no_da
-00006660: 7461 5f76 616c 7565 3d73 7263 2e6e 6f5f  ta_value=src.no_
-00006670: 6461 7461 5f76 616c 7565 5b30 5d29 0d0a  data_value[0])..
-00006680: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
-00006690: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
-000066a0: 6572 4261 6e64 2831 292e 5772 6974 6541  erBand(1).WriteA
-000066b0: 7272 6179 2861 7272 6179 290d 0a20 2020  rray(array)..   
-000066c0: 2020 2020 2069 6620 7061 7468 2069 7320       if path is 
-000066d0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-000066e0: 2020 2020 2020 2064 7374 5f6f 626a 2e72         dst_obj.r
-000066f0: 6173 7465 722e 466c 7573 6843 6163 6865  aster.FlushCache
-00006700: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00006710: 6473 745f 6f62 6a20 3d20 4e6f 6e65 0d0a  dst_obj = None..
-00006720: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00006730: 2064 7374 5f6f 626a 0d0a 0d0a 2020 2020   dst_obj....    
-00006740: 6465 6620 5f67 6574 5f63 7273 2873 656c  def _get_crs(sel
-00006750: 6629 202d 3e20 7374 723a 0d0a 2020 2020  f) -> str:..    
-00006760: 2020 2020 2222 2247 6574 2063 6f6f 7264      """Get coord
-00006770: 696e 6174 6520 7265 6665 7265 6e63 6520  inate reference 
-00006780: 7379 7374 656d 2e22 2222 0d0a 2020 2020  system."""..    
-00006790: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000067a0: 7261 7374 6572 2e47 6574 5072 6f6a 6563  raster.GetProjec
-000067b0: 7469 6f6e 2829 0d0a 0d0a 2020 2020 6465  tion()....    de
-000067c0: 6620 7365 745f 6372 7328 7365 6c66 2c20  f set_crs(self, 
-000067d0: 6372 733a 204f 7074 696f 6e61 6c20 3d20  crs: Optional = 
-000067e0: 4e6f 6e65 2c20 6570 7367 3a20 696e 7420  None, epsg: int 
-000067f0: 3d20 4e6f 6e65 293a 0d0a 2020 2020 2020  = None):..      
-00006800: 2020 2222 2273 6574 5f63 7273 2e0d 0a0d    """set_crs....
-00006810: 0a20 2020 2020 2020 2020 2020 2053 6574  .            Set
-00006820: 2074 6865 2043 6f6f 7264 696e 6174 6520   the Coordinate 
-00006830: 5265 6665 7265 6e63 6520 5379 7374 656d  Reference System
-00006840: 2028 4352 5329 206f 6620 610d 0a0d 0a20   (CRS) of a.... 
-00006850: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00006860: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00006870: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
-00006880: 7273 3a20 5b73 7472 5d0d 0a20 2020 2020  rs: [str]..     
-00006890: 2020 2020 2020 206f 7074 696f 6e61 6c20         optional 
-000068a0: 6966 2065 7073 6720 6973 2073 7065 6369  if epsg is speci
-000068b0: 6669 6564 0d0a 2020 2020 2020 2020 2020  fied..          
-000068c0: 2020 574b 5420 7374 7269 6e67 2e0d 0a20    WKT string... 
-000068d0: 2020 2020 2020 2020 2020 2069 2e65 2e20             i.e. 
-000068e0: 2747 454f 4743 535b 2257 4753 2038 3422  'GEOGCS["WGS 84"
-000068f0: 2c44 4154 554d 5b22 5747 535f 3139 3834  ,DATUM["WGS_1984
-00006900: 222c 5350 4845 524f 4944 5b22 5747 5320  ",SPHEROID["WGS 
-00006910: 3834 222c 3633 3738 3133 372c 3239 382e  84",6378137,298.
-00006920: 3235 3732 3233 3536 332c 4155 5448 4f52  257223563,AUTHOR
-00006930: 4954 595b 2245 5053 4722 2c22 3730 3330  ITY["EPSG","7030
-00006940: 225d 5d2c 0d0a 2020 2020 2020 2020 2020  "]],..          
-00006950: 2020 4155 5448 4f52 4954 595b 2245 5053    AUTHORITY["EPS
-00006960: 4722 2c22 3633 3236 225d 5d2c 5052 494d  G","6326"]],PRIM
-00006970: 454d 5b22 4772 6565 6e77 6963 6822 2c30  EM["Greenwich",0
-00006980: 2c41 5554 484f 5249 5459 5b22 4550 5347  ,AUTHORITY["EPSG
-00006990: 222c 2238 3930 3122 5d5d 2c55 4e49 545b  ","8901"]],UNIT[
-000069a0: 2264 6567 7265 6522 2c0d 0a20 2020 2020  "degree",..     
-000069b0: 2020 2020 2020 2030 2e30 3137 3435 3332         0.0174532
-000069c0: 3932 3531 3939 3433 332c 4155 5448 4f52  925199433,AUTHOR
-000069d0: 4954 595b 2245 5053 4722 2c22 3931 3232  ITY["EPSG","9122
-000069e0: 225d 5d2c 4158 4953 5b22 4c61 7469 7475  "]],AXIS["Latitu
-000069f0: 6465 222c 4e4f 5254 485d 2c41 5849 535b  de",NORTH],AXIS[
-00006a00: 224c 6f6e 6769 7475 6465 222c 4541 5354  "Longitude",EAST
-00006a10: 5d2c 4155 5448 4f52 4954 595b 2245 5053  ],AUTHORITY["EPS
-00006a20: 4722 2c22 3433 3236 225d 5d27 0d0a 2020  G","4326"]]'..  
-00006a30: 2020 2020 2020 6570 7367 3a20 5b69 6e74        epsg: [int
-00006a40: 5d0d 0a20 2020 2020 2020 2020 2020 206f  ]..            o
-00006a50: 7074 696f 6e61 6c20 6966 2063 7273 2069  ptional if crs i
-00006a60: 7320 7370 6563 6966 6965 640d 0a20 2020  s specified..   
-00006a70: 2020 2020 2020 2020 2045 5053 4720 636f           EPSG co
-00006a80: 6465 2073 7065 6369 6679 696e 6720 7468  de specifying th
-00006a90: 6520 7072 6f6a 6563 7469 6f6e 2e0d 0a20  e projection... 
-00006aa0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00006ab0: 2020 2020 2320 6669 7273 7420 6368 616e      # first chan
-00006ac0: 6765 2074 6865 2070 726f 6a65 6374 696f  ge the projectio
-00006ad0: 6e20 6f66 2074 6865 2067 6461 6c20 6461  n of the gdal da
-00006ae0: 7461 7365 7420 6f62 6a65 6374 0d0a 2020  taset object..  
-00006af0: 2020 2020 2020 2320 7365 636f 6e64 2063        # second c
-00006b00: 6861 6e67 6520 7468 6520 6570 7367 2061  hange the epsg a
-00006b10: 7474 7269 6275 7465 206f 6620 7468 6520  ttribute of the 
-00006b20: 4461 7461 7365 7420 6f62 6a65 6374 0d0a  Dataset object..
-00006b30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00006b40: 6472 6976 6572 5f74 7970 6520 3d3d 2022  driver_type == "
-00006b50: 6173 6369 6922 3a0d 0a20 2020 2020 2020  ascii":..       
-00006b60: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00006b70: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
-00006b80: 2020 2020 2020 2022 5365 7474 696e 6720         "Setting 
-00006b90: 4352 5320 666f 7220 4153 4349 4920 6669  CRS for ASCII fi
-00006ba0: 6c65 2069 7320 6e6f 7420 706f 7373 6962  le is not possib
-00006bb0: 6c65 2c20 796f 7520 6361 6e20 7361 7665  le, you can save
-00006bc0: 2074 6865 2066 696c 6573 2074 6f20 6120   the files to a 
-00006bd0: 6765 6f74 6966 6620 616e 6420 7468 656e  geotiff and then
-00006be0: 2072 6573 6574 2074 6865 2063 7273 220d   reset the crs".
-00006bf0: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
-00006c00: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00006c10: 2020 2020 2020 2020 2020 2069 6620 6372             if cr
-00006c20: 7320 6973 206e 6f74 204e 6f6e 653a 0d0a  s is not None:..
-00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c40: 7365 6c66 2e72 6173 7465 722e 5365 7450  self.raster.SetP
-00006c50: 726f 6a65 6374 696f 6e28 6372 7329 0d0a  rojection(crs)..
-00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c70: 7365 6c66 2e5f 6570 7367 203d 2046 6561  self._epsg = Fea
-00006c80: 7475 7265 436f 6c6c 6563 7469 6f6e 2e67  tureCollection.g
-00006c90: 6574 5f65 7073 675f 6672 6f6d 5f50 726a  et_epsg_from_Prj
-00006ca0: 2863 7273 290d 0a20 2020 2020 2020 2020  (crs)..         
-00006cb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00006cc0: 2020 2020 2020 2020 2020 7372 203d 2044            sr = D
-00006cd0: 6174 6173 6574 2e5f 6372 6561 7465 5f73  ataset._create_s
-00006ce0: 725f 6672 6f6d 5f65 7073 6728 6570 7367  r_from_epsg(epsg
-00006cf0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00006d00: 2020 2073 656c 662e 7261 7374 6572 2e53     self.raster.S
-00006d10: 6574 5072 6f6a 6563 7469 6f6e 2873 722e  etProjection(sr.
-00006d20: 4578 706f 7274 546f 576b 7428 2929 0d0a  ExportToWkt())..
-00006d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d40: 7365 6c66 2e5f 6570 7367 203d 2065 7073  self._epsg = eps
-00006d50: 670d 0a0d 0a20 2020 2064 6566 205f 6765  g....    def _ge
-00006d60: 745f 6570 7367 2873 656c 6629 202d 3e20  t_epsg(self) -> 
-00006d70: 696e 743a 0d0a 2020 2020 2020 2020 2222  int:..        ""
-00006d80: 2247 6574 4550 5347 2e0d 0a0d 0a20 2020  "GetEPSG.....   
-00006d90: 2020 2020 2020 2020 2054 6869 7320 6675           This fu
-00006da0: 6e63 7469 6f6e 2072 6561 6473 2074 6865  nction reads the
-00006db0: 2070 726f 6a65 6374 696f 6e20 6f66 2061   projection of a
-00006dc0: 2047 454f 4743 5320 6669 6c65 206f 7220   GEOGCS file or 
-00006dd0: 7469 6666 2066 696c 650d 0a0d 0a20 2020  tiff file....   
-00006de0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00006df0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00006e00: 2020 2020 2020 2065 7073 6720 3a20 5b69         epsg : [i
-00006e10: 6e74 6567 6572 5d0d 0a20 2020 2020 2020  nteger]..       
-00006e20: 2020 2020 2065 7073 6720 6e75 6d62 6572       epsg number
-00006e30: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00006e40: 2020 2020 2020 2070 726a 203d 2073 656c         prj = sel
-00006e50: 662e 5f67 6574 5f63 7273 2829 0d0a 2020  f._get_crs()..  
-00006e60: 2020 2020 2020 6570 7367 203d 2046 6561        epsg = Fea
-00006e70: 7475 7265 436f 6c6c 6563 7469 6f6e 2e67  tureCollection.g
-00006e80: 6574 5f65 7073 675f 6672 6f6d 5f50 726a  et_epsg_from_Prj
-00006e90: 2870 726a 290d 0a0d 0a20 2020 2020 2020  (prj)....       
-00006ea0: 2072 6574 7572 6e20 6570 7367 0d0a 0d0a   return epsg....
-00006eb0: 2020 2020 6465 6620 6765 745f 7661 7269      def get_vari
-00006ec0: 6162 6c65 7328 7365 6c66 293a 0d0a 2020  ables(self):..  
-00006ed0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-00006ee0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00006ef0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a0d        -------...
-00006f00: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00006f10: 2020 2020 2020 7661 7269 6162 6c65 7320        variables 
-00006f20: 3d20 7b7d 0d0a 2020 2020 2020 2020 666f  = {}..        fo
-00006f30: 7220 692c 2076 6172 2069 6e20 656e 756d  r i, var in enum
-00006f40: 6572 6174 6528 7365 6c66 2e73 7562 7365  erate(self.subse
-00006f50: 7473 293a 0d0a 2020 2020 2020 2020 2020  ts):..          
-00006f60: 2020 6e61 6d65 203d 2076 6172 5b31 5d2e    name = var[1].
-00006f70: 7370 6c69 7428 2220 2229 5b31 5d0d 0a20  split(" ")[1].. 
-00006f80: 2020 2020 2020 2020 2020 2073 7263 203d             src =
-00006f90: 2067 6461 6c2e 4f70 656e 2873 656c 662e   gdal.Open(self.
-00006fa0: 7375 6273 6574 735b 695d 5b30 5d29 0d0a  subsets[i][0])..
-00006fb0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-00006fc0: 6162 6c65 735b 6e61 6d65 5d20 3d20 4461  ables[name] = Da
-00006fd0: 7461 7365 7428 7372 6329 0d0a 0d0a 2020  taset(src)....  
-00006fe0: 2020 2020 2020 7265 7475 726e 2076 6172        return var
-00006ff0: 6961 626c 6573 0d0a 0d0a 2020 2020 6465  iables....    de
-00007000: 6620 636f 756e 745f 646f 6d61 696e 5f63  f count_domain_c
-00007010: 656c 6c73 2873 656c 6629 3a0d 0a20 2020  ells(self):..   
-00007020: 2020 2020 2022 2222 436f 756e 7420 6365       """Count ce
-00007030: 6c6c 7320 696e 7369 6465 2074 6865 2064  lls inside the d
-00007040: 6f6d 6169 6e0d 0a0d 0a20 2020 2020 2020  omain....       
-00007050: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00007060: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00007070: 2020 2069 6e74 3a0d 0a20 2020 2020 2020     int:..       
-00007080: 2020 2020 204e 756d 6265 7220 6f66 2063       Number of c
-00007090: 656c 6c73 0d0a 2020 2020 2020 2020 2222  ells..        ""
-000070a0: 220d 0a20 2020 2020 2020 2023 2063 6f75  "..        # cou
-000070b0: 6e74 2063 656c 6c73 2069 6e73 6964 6520  nt cells inside 
-000070c0: 7468 6520 646f 6d61 696e 0d0a 2020 2020  the domain..    
-000070d0: 2020 2020 6172 7220 3d20 7365 6c66 2e72      arr = self.r
-000070e0: 6173 7465 722e 5265 6164 4173 4172 7261  aster.ReadAsArra
-000070f0: 7928 290d 0a20 2020 2020 2020 2064 6f6d  y()..        dom
-00007100: 6169 6e5f 636f 756e 7420 3d20 6e70 2e73  ain_count = np.s
-00007110: 697a 6528 6172 725b 3a2c 203a 5d29 202d  ize(arr[:, :]) -
-00007120: 206e 702e 636f 756e 745f 6e6f 6e7a 6572   np.count_nonzer
-00007130: 6f28 0d0a 2020 2020 2020 2020 2020 2020  o(..            
-00007140: 2861 7272 5b6e 702e 6973 636c 6f73 6528  (arr[np.isclose(
-00007150: 6172 722c 2073 656c 662e 6e6f 5f64 6174  arr, self.no_dat
-00007160: 615f 7661 6c75 655b 305d 2c20 7274 6f6c  a_value[0], rtol
-00007170: 3d30 2e30 3031 295d 290d 0a20 2020 2020  =0.001)])..     
-00007180: 2020 2029 0d0a 2020 2020 2020 2020 7265     )..        re
-00007190: 7475 726e 2064 6f6d 6169 6e5f 636f 756e  turn domain_coun
-000071a0: 740d 0a0d 0a20 2020 2040 7374 6174 6963  t....    @static
-000071b0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-000071c0: 5f63 7265 6174 655f 7372 5f66 726f 6d5f  _create_sr_from_
-000071d0: 6570 7367 2865 7073 673a 2069 6e74 203d  epsg(epsg: int =
-000071e0: 204e 6f6e 6529 202d 3e20 5370 6174 6961   None) -> Spatia
-000071f0: 6c52 6566 6572 656e 6365 3a0d 0a20 2020  lReference:..   
-00007200: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
-00007210: 2073 7061 7469 616c 2072 6566 6572 656e   spatial referen
-00007220: 6365 206f 626a 6563 7420 6672 6f6d 2065  ce object from e
-00007230: 7073 6720 6e75 6d62 6572 2e0d 0a0d 0a20  psg number..... 
-00007240: 2020 2020 2020 2068 7474 7073 3a2f 2f67         https://g
-00007250: 6461 6c2e 6f72 672f 7475 746f 7269 616c  dal.org/tutorial
-00007260: 732f 6f73 725f 6170 695f 7475 742e 6874  s/osr_api_tut.ht
-00007270: 6d6c 0d0a 0d0a 2020 2020 2020 2020 5061  ml....        Pa
-00007280: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00007290: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000072a0: 2020 2020 2020 6570 7367 3a20 5b69 6e74        epsg: [int
-000072b0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-000072c0: 7073 6720 6e75 6d62 6572 2e0d 0a0d 0a20  psg number..... 
-000072d0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-000072e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-000072f0: 0a20 2020 2020 2020 2053 7061 7469 616c  .        Spatial
-00007300: 5265 6665 7265 6e63 6520 6f62 6a65 6374  Reference object
-00007310: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00007320: 2020 2020 2020 2073 7220 3d20 6f73 722e         sr = osr.
-00007330: 5370 6174 6961 6c52 6566 6572 656e 6365  SpatialReference
-00007340: 2829 0d0a 2020 2020 2020 2020 7372 2e49  ()..        sr.I
-00007350: 6d70 6f72 7446 726f 6d45 5053 4728 696e  mportFromEPSG(in
-00007360: 7428 6570 7367 2929 0d0a 0d0a 2020 2020  t(epsg))....    
-00007370: 2020 2020 2320 6966 2065 7073 6720 6973      # if epsg is
-00007380: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00007390: 2320 2020 2020 7372 2e53 6574 5765 6c6c  #     sr.SetWell
-000073a0: 4b6e 6f77 6e47 656f 6743 5328 2257 4753  KnownGeogCS("WGS
-000073b0: 3834 2229 0d0a 2020 2020 2020 2020 2320  84")..        # 
-000073c0: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
-000073d0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-000073e0: 2020 2023 2020 2020 2020 2020 2069 6620     #         if 
-000073f0: 6e6f 7420 7372 2e53 6574 5765 6c6c 4b6e  not sr.SetWellKn
-00007400: 6f77 6e47 656f 6743 5328 6570 7367 2920  ownGeogCS(epsg) 
-00007410: 3d3d 2036 3a0d 0a20 2020 2020 2020 2023  == 6:..        #
-00007420: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
-00007430: 5365 7457 656c 6c4b 6e6f 776e 4765 6f67  SetWellKnownGeog
-00007440: 4353 2865 7073 6729 0d0a 2020 2020 2020  CS(epsg)..      
-00007450: 2020 2320 2020 2020 2020 2020 656c 7365    #         else
-00007460: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
-00007470: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
-00007480: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-00007490: 2020 2020 2020 2020 2073 722e 496d 706f           sr.Impo
-000074a0: 7274 4672 6f6d 4550 5347 2869 6e74 2865  rtFromEPSG(int(e
-000074b0: 7073 6729 290d 0a20 2020 2020 2020 2023  psg))..        #
-000074c0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-000074d0: 6570 743a 0d0a 2020 2020 2020 2020 2320  ept:..        # 
-000074e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074f0: 7372 2e49 6d70 6f72 7446 726f 6d57 6b74  sr.ImportFromWkt
-00007500: 2865 7073 6729 0d0a 2020 2020 2020 2020  (epsg)..        
-00007510: 2320 2020 2020 6578 6365 7074 3a0d 0a20  #     except:.. 
-00007520: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-00007530: 2074 7279 3a0d 0a20 2020 2020 2020 2023   try:..        #
-00007540: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
-00007550: 496d 706f 7274 4672 6f6d 4550 5347 2869  ImportFromEPSG(i
-00007560: 6e74 2865 7073 6729 290d 0a20 2020 2020  nt(epsg))..     
-00007570: 2020 2023 2020 2020 2020 2020 2065 7863     #         exc
-00007580: 6570 743a 0d0a 2020 2020 2020 2020 2320  ept:..        # 
-00007590: 2020 2020 2020 2020 2020 2020 7372 2e49              sr.I
-000075a0: 6d70 6f72 7446 726f 6d57 6b74 2865 7073  mportFromWkt(eps
-000075b0: 6729 0d0a 2020 2020 2020 2020 7265 7475  g)..        retu
-000075c0: 726e 2073 720d 0a0d 0a20 2020 2064 6566  rn sr....    def
-000075d0: 2067 6574 5f62 616e 645f 6e61 6d65 7328   get_band_names(
-000075e0: 7365 6c66 2920 2d3e 204c 6973 745b 7374  self) -> List[st
-000075f0: 725d 3a0d 0a20 2020 2020 2020 2022 2222  r]:..        """
-00007600: 4765 7420 6261 6e64 206e 616d 6573 2066  Get band names f
-00007610: 726f 6d20 6261 6e64 206d 6574 6120 6461  rom band meta da
-00007620: 7461 2069 6620 6578 6973 7473 206f 7468  ta if exists oth
-00007630: 6572 7769 7365 2077 696c 6c20 7265 7475  erwise will retu
-00007640: 726e 2069 6465 7820 5b31 2c32 2c20 2e2e  rn idex [1,2, ..
-00007650: 2e5d 0d0a 0d0a 2020 2020 2020 2020 5061  .]....        Pa
-00007660: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00007670: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a    ----------....
-00007680: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-00007690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000076a0: 0d0a 2020 2020 2020 2020 6c69 7374 5b73  ..        list[s
-000076b0: 7472 5d0d 0a20 2020 2020 2020 2022 2222  tr]..        """
-000076c0: 0d0a 2020 2020 2020 2020 6e61 6d65 7320  ..        names 
-000076d0: 3d20 5b5d 0d0a 2020 2020 2020 2020 666f  = []..        fo
-000076e0: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
-000076f0: 7365 6c66 2e72 6173 7465 722e 5261 7374  self.raster.Rast
-00007700: 6572 436f 756e 7420 2b20 3129 3a0d 0a20  erCount + 1):.. 
-00007710: 2020 2020 2020 2020 2020 2062 616e 645f             band_
-00007720: 6920 3d20 7365 6c66 2e72 6173 7465 722e  i = self.raster.
-00007730: 4765 7452 6173 7465 7242 616e 6428 6929  GetRasterBand(i)
-00007740: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00007750: 6966 2062 616e 645f 692e 4765 7444 6573  if band_i.GetDes
-00007760: 6372 6970 7469 6f6e 2829 3a0d 0a20 2020  cription():..   
-00007770: 2020 2020 2020 2020 2020 2020 2023 2055               # U
-00007780: 7365 2074 6865 2062 616e 645f 6920 6465  se the band_i de
-00007790: 7363 7269 7074 696f 6e2e 0d0a 2020 2020  scription...    
-000077a0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-000077b0: 732e 6170 7065 6e64 2862 616e 645f 692e  s.append(band_i.
-000077c0: 4765 7444 6573 6372 6970 7469 6f6e 2829  GetDescription()
-000077d0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-000077e0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000077f0: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
-00007800: 7220 6d65 7465 6461 7461 2e0d 0a20 2020  r metedata...   
-00007810: 2020 2020 2020 2020 2020 2020 2062 616e               ban
-00007820: 645f 695f 6e61 6d65 203d 2022 4261 6e64  d_i_name = "Band
-00007830: 5f7b 7d22 2e66 6f72 6d61 7428 6261 6e64  _{}".format(band
-00007840: 5f69 2e47 6574 4261 6e64 2829 290d 0a20  _i.GetBand()).. 
-00007850: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00007860: 6574 6164 6174 6120 3d20 6261 6e64 5f69  etadata = band_i
-00007870: 2e47 6574 4461 7461 7365 7428 292e 4765  .GetDataset().Ge
-00007880: 744d 6574 6164 6174 615f 4469 6374 2829  tMetadata_Dict()
-00007890: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000078a0: 2020 2020 2320 4966 2069 6e20 6d65 7461      # If in meta
-000078b0: 6461 7461 2c20 7265 7475 726e 2074 6865  data, return the
-000078c0: 206d 6574 6164 6174 6120 656e 7472 792c   metadata entry,
-000078d0: 2065 6c73 6520 4261 6e64 5f4e 2e0d 0a20   else Band_N... 
-000078e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000078f0: 6620 6261 6e64 5f69 5f6e 616d 6520 696e  f band_i_name in
-00007900: 206d 6574 6164 6174 6120 616e 6420 6d65   metadata and me
-00007910: 7461 6461 7461 5b62 616e 645f 695f 6e61  tadata[band_i_na
-00007920: 6d65 5d3a 0d0a 2020 2020 2020 2020 2020  me]:..          
-00007930: 2020 2020 2020 2020 2020 6e61 6d65 732e            names.
-00007940: 6170 7065 6e64 286d 6574 6164 6174 615b  append(metadata[
-00007950: 6261 6e64 5f69 5f6e 616d 655d 290d 0a20  band_i_name]).. 
-00007960: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00007970: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00007980: 2020 2020 2020 2020 2020 6e61 6d65 732e            names.
-00007990: 6170 7065 6e64 2862 616e 645f 695f 6e61  append(band_i_na
-000079a0: 6d65 290d 0a0d 0a20 2020 2020 2020 2072  me)....        r
-000079b0: 6574 7572 6e20 6e61 6d65 730d 0a0d 0a20  eturn names.... 
-000079c0: 2020 2064 6566 205f 7365 745f 6e6f 5f64     def _set_no_d
-000079d0: 6174 615f 7661 6c75 6528 0d0a 2020 2020  ata_value(..    
-000079e0: 2020 2020 7365 6c66 2c20 6e6f 5f64 6174      self, no_dat
-000079f0: 615f 7661 6c75 653a 2055 6e69 6f6e 5b41  a_value: Union[A
-00007a00: 6e79 2c20 6c69 7374 5d20 3d20 4445 4641  ny, list] = DEFA
-00007a10: 554c 545f 4e4f 5f44 4154 415f 5641 4c55  ULT_NO_DATA_VALU
-00007a20: 450d 0a20 2020 2029 3a0d 0a20 2020 2020  E..    ):..     
-00007a30: 2020 2022 2222 7365 744e 6f44 6174 6156     """setNoDataV
-00007a40: 616c 7565 2e0d 0a0d 0a20 2020 2020 2020  alue.....       
-00007a50: 2020 2020 202d 2053 6574 2074 6865 206e       - Set the n
-00007a60: 6f20 6461 7461 2076 616c 7565 2069 6e20  o data value in 
-00007a70: 6120 616c 6c20 7261 7374 6572 2062 616e  a all raster ban
-00007a80: 6473 2e0d 0a20 2020 2020 2020 2020 2020  ds...           
-00007a90: 202d 2046 696c 6c73 2074 6865 2077 686f   - Fills the who
-00007aa0: 6c65 2072 6173 7465 7220 7769 7468 2074  le raster with t
-00007ab0: 6865 206e 6f5f 6461 7461 5f76 616c 7565  he no_data_value
-00007ac0: 2e0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
-00007ad0: 2075 7365 6420 6f6e 6c79 2077 6865 6e20   used only when 
-00007ae0: 6372 6561 7469 6e67 2061 6e20 656d 7074  creating an empt
-00007af0: 7920 6472 6976 6572 2e0d 0a0d 0a20 2020  y driver.....   
-00007b00: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00007b10: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00007b20: 2d2d 2d0d 0a20 2020 2020 2020 206e 6f5f  ---..        no_
-00007b30: 6461 7461 5f76 616c 7565 3a20 5b6e 756d  data_value: [num
-00007b40: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
-00007b50: 2020 206e 6f20 6461 7461 2076 616c 7565     no data value
-00007b60: 2074 6f20 6669 6c6c 2074 6865 206d 6173   to fill the mas
-00007b70: 6b65 6420 7061 7274 206f 6620 7468 6520  ked part of the 
-00007b80: 6172 7261 790d 0a20 2020 2020 2020 2022  array..        "
-00007b90: 2222 0d0a 2020 2020 2020 2020 6966 206e  ""..        if n
-00007ba0: 6f74 2069 7369 6e73 7461 6e63 6528 6e6f  ot isinstance(no
-00007bb0: 5f64 6174 615f 7661 6c75 652c 206c 6973  _data_value, lis
-00007bc0: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-00007bd0: 206e 6f5f 6461 7461 5f76 616c 7565 203d   no_data_value =
-00007be0: 205b 6e6f 5f64 6174 615f 7661 6c75 655d   [no_data_value]
-00007bf0: 202a 2073 656c 662e 6261 6e64 5f63 6f75   * self.band_cou
-00007c00: 6e74 0d0a 0d0a 2020 2020 2020 2020 666f  nt....        fo
-00007c10: 7220 692c 2076 616c 2069 6e20 656e 756d  r i, val in enum
-00007c20: 6572 6174 6528 7365 6c66 2e64 7479 7065  erate(self.dtype
-00007c30: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00007c40: 6966 2067 6461 6c5f 746f 5f6e 756d 7079  if gdal_to_numpy
-00007c50: 5f64 7479 7065 2876 616c 292e 5f5f 636f  _dtype(val).__co
-00007c60: 6e74 6169 6e73 5f5f 2822 666c 6f61 7422  ntains__("float"
-00007c70: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00007c80: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-00007c90: 655b 695d 203d 2028 0d0a 2020 2020 2020  e[i] = (..      
-00007ca0: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-00007cb0: 6f61 7428 6e6f 5f64 6174 615f 7661 6c75  oat(no_data_valu
-00007cc0: 655b 695d 2920 6966 206e 6f5f 6461 7461  e[i]) if no_data
-00007cd0: 5f76 616c 7565 5b69 5d20 6973 206e 6f74  _value[i] is not
-00007ce0: 204e 6f6e 6520 656c 7365 204e 6f6e 650d   None else None.
-00007cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007d00: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00007d10: 656c 6966 2067 6461 6c5f 746f 5f6e 756d  elif gdal_to_num
-00007d20: 7079 5f64 7479 7065 2876 616c 292e 5f5f  py_dtype(val).__
-00007d30: 636f 6e74 6169 6e73 5f5f 2822 696e 7422  contains__("int"
-00007d40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00007d50: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-00007d60: 655b 695d 203d 2028 0d0a 2020 2020 2020  e[i] = (..      
-00007d70: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00007d80: 7428 6e6f 5f64 6174 615f 7661 6c75 655b  t(no_data_value[
-00007d90: 695d 2920 6966 206e 6f5f 6461 7461 5f76  i]) if no_data_v
-00007da0: 616c 7565 5b69 5d20 6973 206e 6f74 204e  alue[i] is not N
-00007db0: 6f6e 6520 656c 7365 204e 6f6e 650d 0a20  one else None.. 
-00007dc0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00007dd0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00007de0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00007df0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00007e00: 7272 6f72 2822 4e6f 4461 7461 5661 6c75  rror("NoDataValu
-00007e10: 6520 6861 7320 6120 636f 6d70 6c65 7820  e has a complex 
-00007e20: 6461 7461 2074 7970 6522 290d 0a0d 0a20  data type").... 
-00007e30: 2020 2020 2020 2066 6f72 2062 616e 6420         for band 
-00007e40: 696e 2072 616e 6765 2873 656c 662e 6261  in range(self.ba
-00007e50: 6e64 5f63 6f75 6e74 293a 0d0a 2020 2020  nd_count):..    
-00007e60: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00007e70: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00007e80: 6c66 2e5f 7365 745f 6e6f 5f64 6174 615f  lf._set_no_data_
-00007e90: 7661 6c75 655f 6261 636b 656e 6428 6261  value_backend(ba
-00007ea0: 6e64 2c20 6e6f 5f64 6174 615f 7661 6c75  nd, no_data_valu
-00007eb0: 655b 6261 6e64 5d29 0d0a 2020 2020 2020  e[band])..      
-00007ec0: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00007ed0: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
-00007ee0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00007ef0: 2073 7472 2865 292e 5f5f 636f 6e74 6169   str(e).__contai
-00007f00: 6e73 5f5f 280d 0a20 2020 2020 2020 2020  ns__(..         
-00007f10: 2020 2020 2020 2020 2020 2022 4174 7465             "Atte
-00007f20: 6d70 7420 746f 2077 7269 7465 2074 6f20  mpt to write to 
-00007f30: 7265 6164 206f 6e6c 7920 6461 7461 7365  read only datase
-00007f40: 7420 696e 2047 4441 4c52 6173 7465 7242  t in GDALRasterB
-00007f50: 616e 643a 3a46 696c 6c28 292e 220d 0a20  and::Fill().".. 
-00007f60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00007f70: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00007f80: 2020 2020 2020 2072 6169 7365 2052 6561         raise Rea
-00007f90: 644f 6e6c 7945 7272 6f72 280d 0a20 2020  dOnlyError(..   
-00007fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007fb0: 2020 2020 2022 5468 6520 4461 7461 7365       "The Datase
-00007fc0: 7420 6973 206f 7065 6e20 7769 7468 2061  t is open with a
-00007fd0: 2072 6561 6420 6f6e 6c79 2c20 706c 6561   read only, plea
-00007fe0: 7365 2072 6561 6420 7468 6520 7261 7374  se read the rast
-00007ff0: 6572 2075 7369 6e67 2075 7064 6174 6520  er using update 
-00008000: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00008010: 2020 2020 2020 2020 2020 2022 6163 6365             "acce
-00008020: 7373 206d 6f64 6522 0d0a 2020 2020 2020  ss mode"..      
-00008030: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00008040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008050: 2065 6c69 6620 7374 7228 6529 2e5f 5f63   elif str(e).__c
-00008060: 6f6e 7461 696e 735f 5f28 0d0a 2020 2020  ontains__(..    
-00008070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008080: 2269 6e20 6d65 7468 6f64 2027 4261 6e64  "in method 'Band
-00008090: 5f53 6574 4e6f 4461 7461 5661 6c75 6527  _SetNoDataValue'
-000080a0: 2c20 6172 6775 6d65 6e74 2032 206f 6620  , argument 2 of 
-000080b0: 7479 7065 2027 646f 7562 6c65 2722 0d0a  type 'double'"..
-000080c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000080d0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000080e0: 2020 2020 2020 2020 7365 6c66 2e5f 7365          self._se
-000080f0: 745f 6e6f 5f64 6174 615f 7661 6c75 655f  t_no_data_value_
-00008100: 6261 636b 656e 6428 0d0a 2020 2020 2020  backend(..      
-00008110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008120: 2020 6261 6e64 2c20 6e70 2e66 6c6f 6174    band, np.float
-00008130: 3634 286e 6f5f 6461 7461 5f76 616c 7565  64(no_data_value
-00008140: 5b62 616e 645d 290d 0a20 2020 2020 2020  [band])..       
-00008150: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-00008160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008170: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00008180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008190: 5f73 6574 5f6e 6f5f 6461 7461 5f76 616c  _set_no_data_val
-000081a0: 7565 5f62 6163 6b65 6e64 2862 616e 642c  ue_backend(band,
-000081b0: 2044 4546 4155 4c54 5f4e 4f5f 4441 5441   DEFAULT_NO_DATA
-000081c0: 5f56 414c 5545 290d 0a20 2020 2020 2020  _VALUE)..       
-000081d0: 2020 2020 2020 2020 2020 2020 206c 6f67               log
-000081e0: 6765 722e 7761 726e 696e 6728 0d0a 2020  ger.warning(..  
-000081f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008200: 2020 2020 2020 2274 6865 2074 7970 6520        "the type 
-00008210: 6f66 2074 6865 2067 6976 656e 206e 6f5f  of the given no_
-00008220: 6461 7461 5f76 616c 7565 2064 6966 6665  data_value diffe
-00008230: 7273 2066 726f 6d20 7468 6520 6474 7970  rs from the dtyp
-00008240: 6520 6f66 2074 6865 2072 6173 7465 7222  e of the raster"
-00008250: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008260: 2020 2020 2020 2020 2020 6622 6e6f 5f64            f"no_d
-00008270: 6174 615f 7661 6c75 6520 6e6f 7720 6973  ata_value now is
-00008280: 2073 6574 2074 6f20 7b44 4546 4155 4c54   set to {DEFAULT
-00008290: 5f4e 4f5f 4441 5441 5f56 414c 5545 7d20  _NO_DATA_VALUE} 
-000082a0: 696e 2074 6865 2072 6173 7465 7222 0d0a  in the raster"..
-000082b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000082c0: 2020 2020 290d 0a0d 0a20 2020 2064 6566      )....    def
-000082d0: 205f 6361 6c63 756c 6174 655f 6262 6f78   _calculate_bbox
-000082e0: 2873 656c 6629 202d 3e20 4c69 7374 3a0d  (self) -> List:.
-000082f0: 0a20 2020 2020 2020 2022 2222 6361 6c63  .        """calc
-00008300: 756c 6174 6520 626f 756e 6469 6e67 2062  ulate bounding b
-00008310: 6f78 2222 220d 0a20 2020 2020 2020 2078  ox"""..        x
-00008320: 6d69 6e2c 2079 6d61 7820 3d20 7365 6c66  min, ymax = self
-00008330: 2e70 6976 6f74 5f70 6f69 6e74 0d0a 2020  .pivot_point..  
-00008340: 2020 2020 2020 796d 696e 203d 2079 6d61        ymin = yma
-00008350: 7820 2d20 7365 6c66 2e72 6f77 7320 2a20  x - self.rows * 
-00008360: 7365 6c66 2e63 656c 6c5f 7369 7a65 0d0a  self.cell_size..
-00008370: 2020 2020 2020 2020 786d 6178 203d 2078          xmax = x
-00008380: 6d69 6e20 2b20 7365 6c66 2e63 6f6c 756d  min + self.colum
-00008390: 6e73 202a 2073 656c 662e 6365 6c6c 5f73  ns * self.cell_s
-000083a0: 697a 650d 0a20 2020 2020 2020 2072 6574  ize..        ret
-000083b0: 7572 6e20 5b78 6d69 6e2c 2079 6d69 6e2c  urn [xmin, ymin,
-000083c0: 2078 6d61 782c 2079 6d61 785d 0d0a 0d0a   xmax, ymax]....
-000083d0: 2020 2020 6465 6620 5f63 616c 6375 6c61      def _calcula
-000083e0: 7465 5f62 6f75 6e64 7328 7365 6c66 2920  te_bounds(self) 
-000083f0: 2d3e 2047 656f 4461 7461 4672 616d 653a  -> GeoDataFrame:
-00008400: 0d0a 2020 2020 2020 2020 2222 2267 6574  ..        """get
-00008410: 2074 6865 2062 626f 7820 6173 2061 2067   the bbox as a g
-00008420: 656f 6461 7461 6672 616d 6520 7769 7468  eodataframe with
-00008430: 2061 2070 6f6c 7967 6f6e 2067 656f 6d65   a polygon geome
-00008440: 7472 7922 2222 0d0a 2020 2020 2020 2020  try"""..        
-00008450: 786d 696e 2c20 796d 696e 2c20 786d 6178  xmin, ymin, xmax
-00008460: 2c20 796d 6178 203d 2073 656c 662e 5f63  , ymax = self._c
-00008470: 616c 6375 6c61 7465 5f62 626f 7828 290d  alculate_bbox().
-00008480: 0a20 2020 2020 2020 2063 6f6f 7264 7320  .        coords 
-00008490: 3d20 5b28 786d 696e 2c20 796d 6178 292c  = [(xmin, ymax),
-000084a0: 2028 786d 696e 2c20 796d 696e 292c 2028   (xmin, ymin), (
-000084b0: 786d 6178 2c20 796d 696e 292c 2028 786d  xmax, ymin), (xm
-000084c0: 6178 2c20 796d 6178 295d 0d0a 2020 2020  ax, ymax)]..    
-000084d0: 2020 2020 706f 6c79 203d 2046 6561 7475      poly = Featu
-000084e0: 7265 436f 6c6c 6563 7469 6f6e 2e63 7265  reCollection.cre
-000084f0: 6174 655f 706f 6c79 676f 6e28 636f 6f72  ate_polygon(coor
-00008500: 6473 290d 0a20 2020 2020 2020 2067 6466  ds)..        gdf
-00008510: 203d 2067 7064 2e47 656f 4461 7461 4672   = gpd.GeoDataFr
-00008520: 616d 6528 6765 6f6d 6574 7279 3d5b 706f  ame(geometry=[po
-00008530: 6c79 5d29 0d0a 2020 2020 2020 2020 6764  ly])..        gd
-00008540: 662e 7365 745f 6372 7328 6570 7367 3d73  f.set_crs(epsg=s
-00008550: 656c 662e 6570 7367 2c20 696e 706c 6163  elf.epsg, inplac
-00008560: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
-00008570: 2072 6574 7572 6e20 6764 660d 0a0d 0a20   return gdf.... 
-00008580: 2020 2064 6566 205f 7365 745f 6e6f 5f64     def _set_no_d
-00008590: 6174 615f 7661 6c75 655f 6261 636b 656e  ata_value_backen
-000085a0: 6428 7365 6c66 2c20 6261 6e64 5f69 3a20  d(self, band_i: 
-000085b0: 696e 742c 206e 6f5f 6461 7461 5f76 616c  int, no_data_val
-000085c0: 7565 3a20 416e 7929 3a0d 0a20 2020 2020  ue: Any):..     
-000085d0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000085e0: 2020 2020 2d20 6261 6e64 5f69 2073 7461      - band_i sta
-000085f0: 7274 7320 6672 6f6d 2030 2074 6f20 7468  rts from 0 to th
-00008600: 6520 6e75 6d62 6572 206f 6620 6261 6e64  e number of band
-00008610: 732d 312e 0d0a 0d0a 2020 2020 2020 2020  s-1.....        
-00008620: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00008630: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00008640: 2020 2020 2020 2020 6261 6e64 5f69 3a0d          band_i:.
-00008650: 0a20 2020 2020 2020 2020 2020 2062 616e  .            ban
-00008660: 6420 696e 6465 782c 2073 7461 7274 7320  d index, starts 
-00008670: 6672 6f6d 2030 2e0d 0a20 2020 2020 2020  from 0...       
-00008680: 206e 6f5f 6461 7461 5f76 616c 7565 3a0d   no_data_value:.
-00008690: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
-000086a0: 6572 6963 616c 2076 616c 7565 2e0d 0a20  erical value... 
-000086b0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000086c0: 2020 2020 2320 6368 6563 6b20 6966 2074      # check if t
-000086d0: 6865 2064 7479 7065 206f 6620 7468 6520  he dtype of the 
-000086e0: 6e6f 5f64 6174 615f 7661 6c75 6520 636f  no_data_value co
-000086f0: 6d70 6c79 2077 6974 6820 7468 6520 6474  mply with the dt
-00008700: 7970 6520 6f66 2074 6865 2072 6173 7465  ype of the raste
-00008710: 7220 6974 7365 6c66 2e0d 0a20 2020 2020  r itself...     
-00008720: 2020 206e 6f5f 6474 7970 6520 3d20 7374     no_dtype = st
-00008730: 7228 7479 7065 286e 6f5f 6461 7461 5f76  r(type(no_data_v
-00008740: 616c 7565 2929 2e73 706c 6974 2822 2722  alue)).split("'"
-00008750: 295b 315d 0d0a 2020 2020 2020 2020 706f  )[1]..        po
-00008760: 7465 6e74 6961 6c5f 6474 7970 6573 203d  tential_dtypes =
-00008770: 205b 0d0a 2020 2020 2020 2020 2020 2020   [..            
-00008780: 6920 666f 7220 6920 696e 206c 6973 7428  i for i in list(
-00008790: 4e55 4d50 595f 4744 414c 5f44 4154 415f  NUMPY_GDAL_DATA_
-000087a0: 5459 5045 532e 6b65 7973 2829 2920 6966  TYPES.keys()) if
-000087b0: 2069 2e5f 5f63 6f6e 7461 696e 735f 5f28   i.__contains__(
-000087c0: 6e6f 5f64 7479 7065 290d 0a20 2020 2020  no_dtype)..     
-000087d0: 2020 205d 0d0a 2020 2020 2020 2020 706f     ]..        po
-000087e0: 7465 6e74 6961 6c5f 6474 7970 6573 203d  tential_dtypes =
-000087f0: 205b 4e55 4d50 595f 4744 414c 5f44 4154   [NUMPY_GDAL_DAT
-00008800: 415f 5459 5045 532e 6765 7428 6929 2066  A_TYPES.get(i) f
-00008810: 6f72 2069 2069 6e20 706f 7465 6e74 6961  or i in potentia
-00008820: 6c5f 6474 7970 6573 5d0d 0a0d 0a20 2020  l_dtypes]....   
-00008830: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
-00008840: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
-00008850: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00008860: 6966 206e 6f74 2073 656c 662e 6474 7970  if not self.dtyp
-00008870: 655b 6261 6e64 5f69 5d20 696e 2070 6f74  e[band_i] in pot
-00008880: 656e 7469 616c 5f64 7479 7065 733a 0d0a  ential_dtypes:..
-00008890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088a0: 7261 6973 6520 4e6f 4461 7461 5661 6c75  raise NoDataValu
-000088b0: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
-000088c0: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
-000088d0: 6865 2064 7479 7065 206f 6620 7468 6520  he dtype of the 
-000088e0: 6769 7665 6e20 6e6f 5f64 6174 615f 7661  given no_data_va
-000088f0: 6c75 657b 6e6f 5f64 6174 615f 7661 6c75  lue{no_data_valu
-00008900: 657d 3a20 7b6e 6f5f 6474 7970 657d 2064  e}: {no_dtype} d
-00008910: 6966 6665 7273 2066 726f 6d20 7468 6520  iffers from the 
-00008920: 6474 7970 6520 6f66 2074 6865 2022 0d0a  dtype of the "..
-00008930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008940: 2020 2020 6622 6261 6e64 3a20 7b67 6461      f"band: {gda
-00008950: 6c5f 746f 5f6e 756d 7079 5f64 7479 7065  l_to_numpy_dtype
-00008960: 2873 656c 662e 6474 7970 655b 6261 6e64  (self.dtype[band
-00008970: 5f69 5d29 7d22 0d0a 2020 2020 2020 2020  _i])}"..        
-00008980: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-00008990: 2020 2020 2073 656c 662e 6368 616e 6765       self.change
-000089a0: 5f6e 6f5f 6461 7461 5f76 616c 7565 5f61  _no_data_value_a
-000089b0: 7474 7228 6261 6e64 5f69 2c20 6e6f 5f64  ttr(band_i, no_d
-000089c0: 6174 615f 7661 6c75 6529 0d0a 2020 2020  ata_value)..    
-000089d0: 2020 2020 2320 696e 6974 6961 6c69 7a65      # initialize
-000089e0: 2074 6865 2062 616e 6420 7769 7468 2074   the band with t
-000089f0: 6865 206e 6f64 6174 6120 7661 6c75 6520  he nodata value 
-00008a00: 696e 7374 6561 6420 6f66 2030 0d0a 2020  instead of 0..  
-00008a10: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00008a20: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
-00008a30: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-00008a40: 6428 6261 6e64 5f69 202b 2031 292e 4669  d(band_i + 1).Fi
-00008a50: 6c6c 286e 6f5f 6461 7461 5f76 616c 7565  ll(no_data_value
-00008a60: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
-00008a70: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00008a80: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00008a90: 6620 7374 7228 6529 2e5f 5f63 6f6e 7461  f str(e).__conta
-00008aa0: 696e 735f 5f28 2220 6172 6775 6d65 6e74  ins__(" argument
-00008ab0: 2032 206f 6620 7479 7065 2027 646f 7562   2 of type 'doub
-00008ac0: 6c65 2722 293a 0d0a 2020 2020 2020 2020  le'"):..        
-00008ad0: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
-00008ae0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-00008af0: 6428 6261 6e64 5f69 202b 2031 292e 4669  d(band_i + 1).Fi
-00008b00: 6c6c 286e 702e 666c 6f61 7436 3428 6e6f  ll(np.float64(no
-00008b10: 5f64 6174 615f 7661 6c75 6529 290d 0a20  _data_value)).. 
-00008b20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00008b30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008b40: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00008b50: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-00008b60: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
-00008b70: 6420 746f 2066 696c 6c20 7468 6520 6261  d to fill the ba
-00008b80: 6e64 207b 6261 6e64 5f69 7d20 7769 7468  nd {band_i} with
-00008b90: 2076 616c 7565 3a20 7b6e 6f5f 6461 7461   value: {no_data
-00008ba0: 5f76 616c 7565 7d2c 2062 6563 6175 7365  _value}, because
-00008bb0: 206f 6620 7b65 7d22 0d0a 2020 2020 2020   of {e}"..      
-00008bc0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00008bd0: 2020 2020 2023 2075 7064 6174 6520 7468       # update th
-00008be0: 6520 6e6f 5f64 6174 615f 7661 6c75 6520  e no_data_value 
-00008bf0: 696e 2074 6865 2044 6174 6173 6574 206f  in the Dataset o
-00008c00: 626a 6563 740d 0a20 2020 2020 2020 2073  bject..        s
-00008c10: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
-00008c20: 655b 6261 6e64 5f69 5d20 3d20 6e6f 5f64  e[band_i] = no_d
-00008c30: 6174 615f 7661 6c75 650d 0a0d 0a20 2020  ata_value....   
-00008c40: 2064 6566 2063 6861 6e67 655f 6e6f 5f64   def change_no_d
-00008c50: 6174 615f 7661 6c75 655f 6174 7472 2873  ata_value_attr(s
-00008c60: 656c 662c 2062 616e 643a 2069 6e74 2c20  elf, band: int, 
-00008c70: 6e6f 5f64 6174 615f 7661 6c75 6529 3a0d  no_data_value):.
-00008c80: 0a20 2020 2020 2020 2022 2222 4368 616e  .        """Chan
-00008c90: 6765 2074 6865 206e 6f5f 6461 7461 5f76  ge the no_data_v
-00008ca0: 616c 7565 2061 7474 7269 6275 7465 2e0d  alue attribute..
-00008cb0: 0a0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
-00008cc0: 2043 6861 6e67 6520 6f6e 6c79 2074 6865   Change only the
-00008cd0: 206e 6f5f 6461 7461 5f76 616c 7565 2061   no_data_value a
-00008ce0: 7474 7269 6275 7465 2069 6e20 7468 6520  ttribute in the 
-00008cf0: 6764 616c 2044 6174 6163 7562 6520 6f62  gdal Datacube ob
-00008d00: 6a65 6374 2e0d 0a20 2020 2020 2020 2020  ject...         
-00008d10: 2020 202d 2043 6861 6e67 6520 7468 6520     - Change the 
-00008d20: 6e6f 5f64 6174 615f 7661 6c75 6520 696e  no_data_value in
-00008d30: 2074 6865 2044 6174 6173 6574 206f 626a   the Dataset obj
-00008d40: 6563 7420 666f 7220 7468 6520 6769 7665  ect for the give
-00008d50: 6e20 6261 6e64 2069 6e64 6578 2e0d 0a20  n band index... 
-00008d60: 2020 2020 2020 2020 2020 202d 2054 6865             - The
-00008d70: 2063 6f72 7265 7370 6f6e 6469 6e67 2076   corresponding v
-00008d80: 616c 7565 2069 6e20 7468 6520 6172 7261  alue in the arra
-00008d90: 7920 7769 6c6c 206e 6f74 2062 6520 6368  y will not be ch
-00008da0: 616e 6765 642e 0d0a 2020 2020 2020 2020  anged...        
-00008db0: 2020 2020 2d20 4261 6e64 2069 6e64 6578      - Band index
-00008dc0: 2073 7461 7274 7320 6672 6f6d 2030 0d0a   starts from 0..
-00008dd0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00008de0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00008df0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00008e00: 2020 6261 6e64 3a20 5b69 6e74 5d0d 0a20    band: [int].. 
-00008e10: 2020 2020 2020 2020 2020 2062 616e 6420             band 
-00008e20: 696e 6465 7820 7374 6172 7473 2066 726f  index starts fro
-00008e30: 6d20 302e 0d0a 2020 2020 2020 2020 6e6f  m 0...        no
-00008e40: 5f64 6174 615f 7661 6c75 653a 205b 416e  _data_value: [An
-00008e50: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
-00008e60: 6e6f 2064 6174 6120 7661 6c75 652e 0d0a  no data value...
-00008e70: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00008e80: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00008e90: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
-00008ea0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
-00008eb0: 2862 616e 6420 2b20 3129 2e53 6574 4e6f  (band + 1).SetNo
-00008ec0: 4461 7461 5661 6c75 6528 6e6f 5f64 6174  DataValue(no_dat
-00008ed0: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
-00008ee0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00008ef0: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
-00008f00: 2020 2020 2020 6966 2073 7472 2865 292e        if str(e).
-00008f10: 5f5f 636f 6e74 6169 6e73 5f5f 280d 0a20  __contains__(.. 
-00008f20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00008f30: 4174 7465 6d70 7420 746f 2077 7269 7465  Attempt to write
-00008f40: 2074 6f20 7265 6164 206f 6e6c 7920 6461   to read only da
-00008f50: 7461 7365 7420 696e 2047 4441 4c52 6173  taset in GDALRas
-00008f60: 7465 7242 616e 643a 3a46 696c 6c28 292e  terBand::Fill().
-00008f70: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-00008f80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00008f90: 2020 2072 6169 7365 2052 6561 644f 6e6c     raise ReadOnl
-00008fa0: 7945 7272 6f72 280d 0a20 2020 2020 2020  yError(..       
-00008fb0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-00008fc0: 6520 4461 7461 7365 7420 6973 206f 7065  e Dataset is ope
-00008fd0: 6e20 7769 7468 2061 2072 6561 6420 6f6e  n with a read on
-00008fe0: 6c79 2c20 706c 6561 7365 2072 6561 6420  ly, please read 
-00008ff0: 7468 6520 7261 7374 6572 2075 7369 6e67  the raster using
-00009000: 2075 7064 6174 6520 220d 0a20 2020 2020   update "..     
-00009010: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00009020: 6163 6365 7373 206d 6f64 6522 0d0a 2020  access mode"..  
-00009030: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00009040: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00009050: 6620 7374 7228 6529 2e5f 5f63 6f6e 7461  f str(e).__conta
-00009060: 696e 735f 5f28 0d0a 2020 2020 2020 2020  ins__(..        
-00009070: 2020 2020 2020 2020 2269 6e20 6d65 7468          "in meth
-00009080: 6f64 2027 4261 6e64 5f53 6574 4e6f 4461  od 'Band_SetNoDa
-00009090: 7461 5661 6c75 6527 2c20 6172 6775 6d65  taValue', argume
-000090a0: 6e74 2032 206f 6620 7479 7065 2027 646f  nt 2 of type 'do
-000090b0: 7562 6c65 2722 0d0a 2020 2020 2020 2020  uble'"..        
-000090c0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-000090d0: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
-000090e0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-000090f0: 6428 6261 6e64 202b 2031 292e 5365 744e  d(band + 1).SetN
-00009100: 6f44 6174 6156 616c 7565 280d 0a20 2020  oDataValue(..   
-00009110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009120: 206e 702e 666c 6f61 7436 3428 6e6f 5f64   np.float64(no_d
-00009130: 6174 615f 7661 6c75 6529 0d0a 2020 2020  ata_value)..    
-00009140: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00009150: 2020 2020 2020 2073 656c 662e 6e6f 5f64         self.no_d
-00009160: 6174 615f 7661 6c75 655b 6261 6e64 5d20  ata_value[band] 
-00009170: 3d20 6e6f 5f64 6174 615f 7661 6c75 650d  = no_data_value.
-00009180: 0a0d 0a20 2020 2064 6566 2063 6861 6e67  ...    def chang
-00009190: 655f 6e6f 5f64 6174 615f 7661 6c75 6528  e_no_data_value(
-000091a0: 7365 6c66 2c20 6e65 775f 7661 6c75 653a  self, new_value:
-000091b0: 2041 6e79 2c20 6f6c 645f 7661 6c75 653a   Any, old_value:
-000091c0: 2041 6e79 203d 204e 6f6e 6529 3a0d 0a20   Any = None):.. 
-000091d0: 2020 2020 2020 2022 2222 6368 616e 6765         """change
-000091e0: 5f6e 6f5f 6461 7461 5f76 616c 7565 2e0d  _no_data_value..
-000091f0: 0a0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
-00009200: 2053 6574 2074 6865 206e 6f20 6461 7461   Set the no data
-00009210: 2076 616c 7565 2069 6e20 6120 616c 6c20   value in a all 
-00009220: 7261 7374 6572 2062 616e 6473 2e0d 0a20  raster bands... 
-00009230: 2020 2020 2020 2020 2020 202d 2046 696c             - Fil
-00009240: 6c73 2074 6865 2077 686f 6c65 2072 6173  ls the whole ras
-00009250: 7465 7220 7769 7468 2074 6865 206e 6f5f  ter with the no_
-00009260: 6461 7461 5f76 616c 7565 2e0d 0a20 2020  data_value...   
-00009270: 2020 2020 2020 2020 202d 2043 6861 6e67           - Chang
-00009280: 6520 7468 6520 6e6f 5f64 6174 615f 7661  e the no_data_va
-00009290: 6c75 6520 696e 2074 6865 2061 7272 6179  lue in the array
-000092a0: 2069 6e20 616c 6c20 6261 6e64 732e 0d0a   in all bands...
-000092b0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000092c0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-000092d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-000092e0: 2020 6e65 775f 7661 6c75 653a 205b 6e75    new_value: [nu
-000092f0: 6d65 7269 635d 0d0a 2020 2020 2020 2020  meric]..        
-00009300: 2020 2020 6e6f 2064 6174 6120 7661 6c75      no data valu
-00009310: 6520 746f 2073 6574 2069 6e20 7468 6520  e to set in the 
-00009320: 7261 7374 6572 2062 616e 6473 2e0d 0a0d  raster bands....
-00009330: 0a20 2020 2020 2020 206f 6c64 5f76 616c  .        old_val
-00009340: 7565 3a20 5b6e 756d 6572 6963 5d0d 0a20  ue: [numeric].. 
-00009350: 2020 2020 2020 2020 2020 206f 6c64 206e             old n
-00009360: 6f20 6461 7461 2076 616c 7565 2074 6861  o data value tha
-00009370: 7420 6172 6520 616c 7265 6164 7920 696e  t are already in
-00009380: 2074 6865 2072 6173 7465 7220 6261 6e64   the raster band
-00009390: 732e 0d0a 2020 2020 2020 2020 2222 220d  s...        """.
-000093a0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000093b0: 6973 696e 7374 616e 6365 286e 6577 5f76  isinstance(new_v
-000093c0: 616c 7565 2c20 6c69 7374 293a 0d0a 2020  alue, list):..  
-000093d0: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
-000093e0: 6c75 6520 3d20 5b6e 6577 5f76 616c 7565  lue = [new_value
-000093f0: 5d20 2a20 7365 6c66 2e62 616e 645f 636f  ] * self.band_co
-00009400: 756e 740d 0a0d 0a20 2020 2020 2020 2069  unt....        i
-00009410: 6620 6f6c 645f 7661 6c75 6520 6973 206e  f old_value is n
-00009420: 6f74 204e 6f6e 6520 616e 6420 6e6f 7420  ot None and not 
-00009430: 6973 696e 7374 616e 6365 286f 6c64 5f76  isinstance(old_v
-00009440: 616c 7565 2c20 6c69 7374 293a 0d0a 2020  alue, list):..  
-00009450: 2020 2020 2020 2020 2020 6f6c 645f 7661            old_va
-00009460: 6c75 6520 3d20 5b6f 6c64 5f76 616c 7565  lue = [old_value
-00009470: 5d20 2a20 7365 6c66 2e62 616e 645f 636f  ] * self.band_co
-00009480: 756e 740d 0a0d 0a20 2020 2020 2020 2064  unt....        d
-00009490: 7374 203d 2067 6461 6c2e 4765 7444 7269  st = gdal.GetDri
-000094a0: 7665 7242 794e 616d 6528 224d 454d 2229  verByName("MEM")
-000094b0: 2e43 7265 6174 6543 6f70 7928 2222 2c20  .CreateCopy("", 
-000094c0: 7365 6c66 2e72 6173 7465 722c 2030 290d  self.raster, 0).
-000094d0: 0a20 2020 2020 2020 2066 6f72 2062 616e  .        for ban
-000094e0: 6420 696e 2072 616e 6765 2873 656c 662e  d in range(self.
-000094f0: 6261 6e64 5f63 6f75 6e74 293a 0d0a 2020  band_count):..  
-00009500: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
-00009510: 7365 6c66 2e72 6561 645f 6172 7261 7928  self.read_array(
-00009520: 6261 6e64 290d 0a20 2020 2020 2020 2020  band)..         
-00009530: 2020 2061 7272 5b6e 702e 6973 636c 6f73     arr[np.isclos
-00009540: 6528 6172 722c 206f 6c64 5f76 616c 7565  e(arr, old_value
-00009550: 2c20 7274 6f6c 3d30 2e30 3031 295d 203d  , rtol=0.001)] =
-00009560: 206e 6577 5f76 616c 7565 5b62 616e 645d   new_value[band]
-00009570: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
-00009580: 742e 4765 7452 6173 7465 7242 616e 6428  t.GetRasterBand(
-00009590: 6261 6e64 202b 2031 292e 5772 6974 6541  band + 1).WriteA
-000095a0: 7272 6179 2861 7272 290d 0a0d 0a20 2020  rray(arr)....   
-000095b0: 2020 2020 2073 656c 662e 5f72 6173 7465       self._raste
-000095c0: 7220 3d20 6473 740d 0a0d 0a20 2020 2020  r = dst....     
-000095d0: 2020 2066 6f72 2062 616e 6420 696e 2072     for band in r
-000095e0: 616e 6765 2873 656c 662e 6261 6e64 5f63  ange(self.band_c
-000095f0: 6f75 6e74 293a 0d0a 2020 2020 2020 2020  ount):..        
-00009600: 2020 2020 7365 6c66 2e63 6861 6e67 655f      self.change_
-00009610: 6e6f 5f64 6174 615f 7661 6c75 655f 6174  no_data_value_at
-00009620: 7472 2862 616e 642c 206e 6577 5f76 616c  tr(band, new_val
-00009630: 7565 5b62 616e 645d 290d 0a0d 0a20 2020  ue[band])....   
-00009640: 2064 6566 2067 6574 5f63 656c 6c5f 636f   def get_cell_co
-00009650: 6f72 6473 280d 0a20 2020 2020 2020 2073  ords(..        s
-00009660: 656c 662c 206c 6f63 6174 696f 6e3a 2073  elf, location: s
-00009670: 7472 203d 2022 6365 6e74 6572 222c 206d  tr = "center", m
-00009680: 6173 6b3a 2062 6f6f 6c20 3d20 4661 6c73  ask: bool = Fals
-00009690: 650d 0a20 2020 2029 202d 3e20 6e70 2e6e  e..    ) -> np.n
-000096a0: 6461 7272 6179 3a0d 0a20 2020 2020 2020  darray:..       
-000096b0: 2022 2222 4765 7443 6f6f 7264 732e 0d0a   """GetCoords...
-000096c0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-000096d0: 7320 7468 6520 636f 6f72 6469 6e61 7465  s the coordinate
-000096e0: 7320 6f66 2074 6865 2063 656c 6c20 6365  s of the cell ce
-000096f0: 6e74 7265 7320 696e 7369 6465 2074 6865  ntres inside the
-00009700: 2064 6f6d 6169 6e20 286f 6e6c 7920 7468   domain (only th
-00009710: 6520 6365 6c6c 7320 7468 6174 0d0a 2020  e cells that..  
-00009720: 2020 2020 2020 646f 6573 206e 6f74 2068        does not h
-00009730: 6176 6520 6e6f 6461 7461 2076 616c 7565  ave nodata value
-00009740: 290d 0a0d 0a20 2020 2020 2020 2050 6172  )....        Par
-00009750: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00009760: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00009770: 2020 2020 206c 6f63 6174 696f 6e3a 205b       location: [
-00009780: 7374 725d 0d0a 2020 2020 2020 2020 2020  str]..          
-00009790: 2020 6c6f 6361 7469 6f6e 206f 6620 7468    location of th
-000097a0: 6520 636f 6f72 6469 6e61 7465 7320 2263  e coordinates "c
-000097b0: 656e 7465 7222 2066 6f72 2074 6865 2063  enter" for the c
-000097c0: 656e 7465 7220 6f66 2061 2063 656c 6c2c  enter of a cell,
-000097d0: 2063 6f72 6e65 7220 666f 7220 7468 6520   corner for the 
-000097e0: 636f 726e 6572 206f 6620 7468 6520 6365  corner of the ce
-000097f0: 6c6c 2e0d 0a20 2020 2020 2020 2020 2020  ll...           
-00009800: 2074 6865 2063 6f72 6e65 7220 6973 2074   the corner is t
-00009810: 6865 2074 6f70 206c 6566 7420 636f 726e  he top left corn
-00009820: 6572 2e0d 0a20 2020 2020 2020 206d 6173  er...        mas
-00009830: 6b3a 205b 626f 6f6c 5d0d 0a20 2020 2020  k: [bool]..     
-00009840: 2020 2020 2020 2054 7275 6520 746f 2045         True to E
-00009850: 7865 636c 7564 6520 7468 6520 6365 6c6c  xeclude the cell
-00009860: 7320 6f75 7420 6f66 2074 6865 2064 6f61  s out of the doa
-00009870: 696e 2e20 4465 6661 756c 7420 6973 2046  in. Default is F
-00009880: 616c 7365 2e0d 0a0d 0a20 2020 2020 2020  alse.....       
-00009890: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-000098a0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-000098b0: 2020 2063 6f6f 7264 7320 3a20 5b6e 702e     coords : [np.
-000098c0: 6e64 6172 7261 795d 0d0a 2020 2020 2020  ndarray]..      
-000098d0: 2020 2020 2020 4172 7261 7920 7769 7468        Array with
-000098e0: 2061 206c 6973 7420 6f66 2074 6865 2063   a list of the c
-000098f0: 6f6f 7264 696e 6174 6573 2074 6f20 6265  oordinates to be
-00009900: 2069 6e74 6572 706f 6c61 7465 642c 2077   interpolated, w
-00009910: 6974 686f 7574 2074 6865 204e 616e 0d0a  ithout the Nan..
-00009920: 2020 2020 2020 2020 6d61 745f 7261 6e67          mat_rang
-00009930: 6520 3a20 5b6e 702e 6e64 6172 7261 795d  e : [np.ndarray]
-00009940: 0d0a 2020 2020 2020 2020 2020 2020 4172  ..            Ar
-00009950: 7261 7920 7769 7468 2061 6c6c 2074 6865  ray with all the
-00009960: 2063 656e 7472 6573 206f 6620 6365 6c6c   centres of cell
-00009970: 7320 696e 2074 6865 2064 6f6d 6169 6e20  s in the domain 
-00009980: 6f66 2074 6865 2044 454d 0d0a 2020 2020  of the DEM..    
-00009990: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000099a0: 2023 2063 6865 636b 2074 6865 206c 6f63   # check the loc
-000099b0: 6174 696f 6e20 7061 7261 6d65 7465 720d  ation parameter.
-000099c0: 0a20 2020 2020 2020 206c 6f63 6174 696f  .        locatio
-000099d0: 6e20 3d20 6c6f 6361 7469 6f6e 2e6c 6f77  n = location.low
-000099e0: 6572 2829 0d0a 2020 2020 2020 2020 6966  er()..        if
-000099f0: 206c 6f63 6174 696f 6e20 6e6f 7420 696e   location not in
-00009a00: 205b 2263 656e 7465 7222 2c20 2263 6f72   ["center", "cor
-00009a10: 6e65 7222 5d3a 0d0a 2020 2020 2020 2020  ner"]:..        
-00009a20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00009a30: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
-00009a40: 2020 2020 2020 2022 5468 6520 6c6f 6361         "The loca
-00009a50: 7469 6f6e 2070 6172 616d 6574 6572 2063  tion parameter c
-00009a60: 616e 2068 6176 6520 6f6e 6520 6f66 2074  an have one of t
-00009a70: 6865 7365 2076 616c 7565 733a 2027 6365  hese values: 'ce
-00009a80: 6e74 6572 272c 2027 636f 726e 6572 272c  nter', 'corner',
-00009a90: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
-00009aa0: 2020 2020 6622 6275 7420 7468 6520 7661      f"but the va
-00009ab0: 6c75 653a 207b 6c6f 6361 7469 6f6e 7d20  lue: {location} 
-00009ac0: 6973 2067 6976 656e 2e22 0d0a 2020 2020  is given."..    
-00009ad0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-00009ae0: 2020 2020 2069 6620 6c6f 6361 7469 6f6e       if location
-00009af0: 203d 3d20 2263 656e 7465 7222 3a0d 0a20   == "center":.. 
-00009b00: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
-00009b10: 696e 6720 302e 352a 6365 6c6c 2073 697a  ing 0.5*cell siz
-00009b20: 6520 746f 2067 6574 2074 6865 2063 656e  e to get the cen
-00009b30: 7472 650d 0a20 2020 2020 2020 2020 2020  tre..           
-00009b40: 2061 6464 5f76 616c 7565 203d 2030 2e35   add_value = 0.5
-00009b50: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00009b60: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
-00009b70: 5f76 616c 7565 203d 2030 0d0a 2020 2020  _value = 0..    
-00009b80: 2020 2020 2320 4765 7474 696e 6720 6461      # Getting da
-00009b90: 7461 2066 6f72 2074 6865 2077 686f 6c65  ta for the whole
-00009ba0: 2067 7269 640d 0a20 2020 2020 2020 2028   grid..        (
-00009bb0: 0d0a 2020 2020 2020 2020 2020 2020 785f  ..            x_
-00009bc0: 696e 6974 2c0d 0a20 2020 2020 2020 2020  init,..         
-00009bd0: 2020 2063 656c 6c5f 7369 7a65 5f78 2c0d     cell_size_x,.
-00009be0: 0a20 2020 2020 2020 2020 2020 2078 795f  .            xy_
-00009bf0: 7370 616e 2c0d 0a20 2020 2020 2020 2020  span,..         
-00009c00: 2020 2079 5f69 6e69 742c 0d0a 2020 2020     y_init,..    
-00009c10: 2020 2020 2020 2020 7979 5f73 7061 6e2c          yy_span,
-00009c20: 0d0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
-00009c30: 6c6c 5f73 697a 655f 792c 0d0a 2020 2020  ll_size_y,..    
-00009c40: 2020 2020 2920 3d20 7365 6c66 2e67 656f      ) = self.geo
-00009c50: 7472 616e 7366 6f72 6d0d 0a20 2020 2020  transform..     
-00009c60: 2020 2069 6620 6365 6c6c 5f73 697a 655f     if cell_size_
-00009c70: 7820 213d 2063 656c 6c5f 7369 7a65 5f79  x != cell_size_y
-00009c80: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00009c90: 6620 6e70 2e61 6273 2863 656c 6c5f 7369  f np.abs(cell_si
-00009ca0: 7a65 5f78 2920 213d 206e 702e 6162 7328  ze_x) != np.abs(
-00009cb0: 6365 6c6c 5f73 697a 655f 7929 3a0d 0a20  cell_size_y):.. 
-00009cc0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00009cd0: 6f67 6765 722e 7761 726e 696e 6728 0d0a  ogger.warning(..
-00009ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009cf0: 2020 2020 6622 5468 6520 6769 7665 6e20      f"The given 
-00009d00: 7261 7374 6572 2064 6f65 7320 6e6f 7420  raster does not 
-00009d10: 6861 7665 2061 2073 7175 6172 6520 6365  have a square ce
-00009d20: 6c6c 732c 2074 6865 2063 656c 6c20 7369  lls, the cell si
-00009d30: 7a65 2069 7320 7b63 656c 6c5f 7369 7a65  ze is {cell_size
-00009d40: 5f78 7d2a 7b63 656c 6c5f 7369 7a65 5f79  _x}*{cell_size_y
-00009d50: 7d20 220d 0a20 2020 2020 2020 2020 2020  } "..           
-00009d60: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
-00009d70: 2020 2320 6461 7461 2069 6e20 7468 6520    # data in the 
-00009d80: 6172 7261 790d 0a20 2020 2020 2020 206e  array..        n
-00009d90: 6f5f 7661 6c20 3d20 7365 6c66 2e6e 6f5f  o_val = self.no_
-00009da0: 6461 7461 5f76 616c 7565 5b30 5d0d 0a20  data_value[0].. 
-00009db0: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
-00009dc0: 662e 7265 6164 5f61 7272 6179 2862 616e  f.read_array(ban
-00009dd0: 643d 3029 0d0a 2020 2020 2020 2020 6966  d=0)..        if
-00009de0: 206d 6173 6b20 6973 206e 6f74 204e 6f6e   mask is not Non
-00009df0: 6520 616e 6420 6e6f 5f76 616c 206e 6f74  e and no_val not
-00009e00: 2069 6e20 6172 723a 0d0a 2020 2020 2020   in arr:..      
-00009e10: 2020 2020 2020 6c6f 6767 6572 2e77 6172        logger.war
-00009e20: 6e69 6e67 280d 0a20 2020 2020 2020 2020  ning(..         
-00009e30: 2020 2020 2020 2022 5468 6520 6e6f 2064         "The no d
-00009e40: 6174 6120 7661 6c75 6520 646f 6573 206e  ata value does n
-00009e50: 6f74 2065 7869 7374 2069 6e20 7468 6520  ot exist in the 
-00009e60: 6261 6e64 2c20 736f 2061 6c6c 2074 6865  band, so all the
-00009e70: 2063 656c 6c73 2077 696c 6c20 6265 2063   cells will be c
-00009e80: 6f73 6964 6572 6564 2061 6e64 2074 6865  osidered and the
-00009e90: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
-00009ea0: 2020 2020 226d 6173 6b20 7769 6c6c 206e      "mask will n
-00009eb0: 6f74 2062 6520 636f 7369 6465 7265 642e  ot be cosidered.
-00009ec0: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-00009ed0: 0d0a 0d0a 2020 2020 2020 2020 6966 206d  ....        if m
-00009ee0: 6173 6b3a 0d0a 2020 2020 2020 2020 2020  ask:..          
-00009ef0: 2020 6d61 736b 203d 205b 6e6f 5f76 616c    mask = [no_val
-00009f00: 5d0d 0a20 2020 2020 2020 2065 6c73 653a  ]..        else:
-00009f10: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-00009f20: 736b 203d 204e 6f6e 650d 0a20 2020 2020  sk = None..     
-00009f30: 2020 2069 6e64 6963 6573 203d 2067 6574     indices = get
-00009f40: 5f69 6e64 6963 6573 3228 6172 722c 206d  _indices2(arr, m
-00009f50: 6173 6b3d 6d61 736b 290d 0a0d 0a20 2020  ask=mask)....   
-00009f60: 2020 2020 2023 2065 7865 636c 7564 6520       # execlude 
-00009f70: 7468 6520 6e6f 5f64 6174 615f 7661 6c75  the no_data_valu
-00009f80: 6573 2063 656c 6c73 2e0d 0a20 2020 2020  es cells...     
-00009f90: 2020 2066 3120 3d20 5b69 5b30 5d20 666f     f1 = [i[0] fo
-00009fa0: 7220 6920 696e 2069 6e64 6963 6573 5d0d  r i in indices].
-00009fb0: 0a20 2020 2020 2020 2066 3220 3d20 5b69  .        f2 = [i
-00009fc0: 5b31 5d20 666f 7220 6920 696e 2069 6e64  [1] for i in ind
-00009fd0: 6963 6573 5d0d 0a20 2020 2020 2020 2078  ices]..        x
-00009fe0: 203d 205b 785f 696e 6974 202b 2063 656c   = [x_init + cel
-00009ff0: 6c5f 7369 7a65 5f78 202a 2028 6920 2b20  l_size_x * (i + 
-0000a000: 6164 645f 7661 6c75 6529 2066 6f72 2069  add_value) for i
-0000a010: 2069 6e20 6632 5d0d 0a20 2020 2020 2020   in f2]..       
-0000a020: 2079 203d 205b 795f 696e 6974 202b 2063   y = [y_init + c
-0000a030: 656c 6c5f 7369 7a65 5f79 202a 2028 6920  ell_size_y * (i 
-0000a040: 2b20 6164 645f 7661 6c75 6529 2066 6f72  + add_value) for
-0000a050: 2069 2069 6e20 6631 5d0d 0a20 2020 2020   i in f1]..     
-0000a060: 2020 2063 6f6f 7264 7320 3d20 6e70 2e61     coords = np.a
-0000a070: 7272 6179 286c 6973 7428 7a69 7028 782c  rray(list(zip(x,
-0000a080: 2079 2929 290d 0a0d 0a20 2020 2020 2020   y)))....       
-0000a090: 2072 6574 7572 6e20 636f 6f72 6473 0d0a   return coords..
-0000a0a0: 0d0a 2020 2020 6465 6620 6765 745f 6365  ..    def get_ce
-0000a0b0: 6c6c 5f70 6f6c 7967 6f6e 7328 7365 6c66  ll_polygons(self
-0000a0c0: 2c20 6d61 736b 3d46 616c 7365 2920 2d3e  , mask=False) ->
-0000a0d0: 2047 656f 4461 7461 4672 616d 653a 0d0a   GeoDataFrame:..
-0000a0e0: 2020 2020 2020 2020 2222 2247 6574 2061          """Get a
-0000a0f0: 2070 6f6c 7967 6f6e 2073 6861 7065 6c79   polygon shapely
-0000a100: 2067 656f 6d65 7472 7920 666f 7220 7468   geometry for th
-0000a110: 6520 7261 7374 6572 2063 656c 6c73 2e0d  e raster cells..
-0000a120: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0000a130: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0000a140: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0000a150: 2020 206d 6173 6b3a 205b 626f 6f6c 5d0d     mask: [bool].
-0000a160: 0a20 2020 2020 2020 2020 2020 2054 7275  .            Tru
-0000a170: 6520 746f 2067 6574 2074 6865 2070 6f6c  e to get the pol
-0000a180: 7967 6f6e 7320 6f66 2074 6865 2063 656c  ygons of the cel
-0000a190: 6c73 2069 6e73 6964 6520 7468 6520 646f  ls inside the do
-0000a1a0: 6d61 696e 2e0d 0a0d 0a20 2020 2020 2020  main.....       
-0000a1b0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0000a1c0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000a1d0: 2020 2047 656f 4461 7461 4672 616d 653a     GeoDataFrame:
-0000a1e0: 0d0a 2020 2020 2020 2020 2020 2020 7769  ..            wi
-0000a1f0: 7468 2074 776f 2063 6f6c 756d 6e73 2c20  th two columns, 
-0000a200: 6765 6f6d 6574 7279 2c20 616e 6420 6964  geometry, and id
-0000a210: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0000a220: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
-0000a230: 7365 6c66 2e67 6574 5f63 656c 6c5f 636f  self.get_cell_co
-0000a240: 6f72 6473 286c 6f63 6174 696f 6e3d 2263  ords(location="c
-0000a250: 6f72 6e65 7222 2c20 6d61 736b 3d6d 6173  orner", mask=mas
-0000a260: 6b29 0d0a 2020 2020 2020 2020 6365 6c6c  k)..        cell
-0000a270: 5f73 697a 6520 3d20 7365 6c66 2e67 656f  _size = self.geo
-0000a280: 7472 616e 7366 6f72 6d5b 315d 0d0a 2020  transform[1]..  
-0000a290: 2020 2020 2020 6570 7367 203d 2073 656c        epsg = sel
-0000a2a0: 662e 5f67 6574 5f65 7073 6728 290d 0a20  f._get_epsg().. 
-0000a2b0: 2020 2020 2020 2078 203d 206e 702e 7a65         x = np.ze
-0000a2c0: 726f 7328 2863 6f6f 7264 732e 7368 6170  ros((coords.shap
-0000a2d0: 655b 305d 2c20 3429 290d 0a20 2020 2020  e[0], 4))..     
-0000a2e0: 2020 2079 203d 206e 702e 7a65 726f 7328     y = np.zeros(
-0000a2f0: 2863 6f6f 7264 732e 7368 6170 655b 305d  (coords.shape[0]
-0000a300: 2c20 3429 290d 0a20 2020 2020 2020 2023  , 4))..        #
-0000a310: 2066 696c 6c20 7468 6520 746f 7020 6c65   fill the top le
-0000a320: 6674 2063 6f72 6e65 7220 706f 696e 740d  ft corner point.
-0000a330: 0a20 2020 2020 2020 2078 5b3a 2c20 305d  .        x[:, 0]
-0000a340: 203d 2063 6f6f 7264 735b 3a2c 2030 5d0d   = coords[:, 0].
-0000a350: 0a20 2020 2020 2020 2079 5b3a 2c20 305d  .        y[:, 0]
-0000a360: 203d 2063 6f6f 7264 735b 3a2c 2031 5d0d   = coords[:, 1].
-0000a370: 0a20 2020 2020 2020 2023 2066 696c 6c20  .        # fill 
-0000a380: 7468 6520 746f 7020 7269 6768 740d 0a20  the top right.. 
-0000a390: 2020 2020 2020 2078 5b3a 2c20 315d 203d         x[:, 1] =
-0000a3a0: 2078 5b3a 2c20 305d 202b 2063 656c 6c5f   x[:, 0] + cell_
-0000a3b0: 7369 7a65 0d0a 2020 2020 2020 2020 795b  size..        y[
-0000a3c0: 3a2c 2031 5d20 3d20 795b 3a2c 2030 5d0d  :, 1] = y[:, 0].
-0000a3d0: 0a20 2020 2020 2020 2023 2066 696c 6c20  .        # fill 
-0000a3e0: 7468 6520 626f 7474 6f6d 2072 6967 6874  the bottom right
-0000a3f0: 0d0a 2020 2020 2020 2020 785b 3a2c 2032  ..        x[:, 2
-0000a400: 5d20 3d20 785b 3a2c 2030 5d20 2b20 6365  ] = x[:, 0] + ce
-0000a410: 6c6c 5f73 697a 650d 0a20 2020 2020 2020  ll_size..       
-0000a420: 2079 5b3a 2c20 325d 203d 2079 5b3a 2c20   y[:, 2] = y[:, 
-0000a430: 305d 202d 2063 656c 6c5f 7369 7a65 0d0a  0] - cell_size..
-0000a440: 0d0a 2020 2020 2020 2020 2320 6669 6c6c  ..        # fill
-0000a450: 2074 6865 2062 6f74 746f 6d20 6c65 6674   the bottom left
-0000a460: 0d0a 2020 2020 2020 2020 785b 3a2c 2033  ..        x[:, 3
-0000a470: 5d20 3d20 785b 3a2c 2030 5d0d 0a20 2020  ] = x[:, 0]..   
-0000a480: 2020 2020 2079 5b3a 2c20 335d 203d 2079       y[:, 3] = y
-0000a490: 5b3a 2c20 305d 202d 2063 656c 6c5f 7369  [:, 0] - cell_si
-0000a4a0: 7a65 0d0a 0d0a 2020 2020 2020 2020 636f  ze....        co
-0000a4b0: 6f72 6473 5f74 7570 6c65 7320 3d20 5b6c  ords_tuples = [l
-0000a4c0: 6973 7428 7a69 7028 785b 3a2c 2069 5d2c  ist(zip(x[:, i],
-0000a4d0: 2079 5b3a 2c20 695d 2929 2066 6f72 2069   y[:, i])) for i
-0000a4e0: 2069 6e20 7261 6e67 6528 3429 5d0d 0a20   in range(4)].. 
-0000a4f0: 2020 2020 2020 2070 6f6c 7973 5f63 6f6f         polys_coo
-0000a500: 7264 7320 3d20 5b0d 0a20 2020 2020 2020  rds = [..       
-0000a510: 2020 2020 2028 0d0a 2020 2020 2020 2020       (..        
-0000a520: 2020 2020 2020 2020 636f 6f72 6473 5f74          coords_t
-0000a530: 7570 6c65 735b 305d 5b69 5d2c 0d0a 2020  uples[0][i],..  
-0000a540: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000a550: 6f72 6473 5f74 7570 6c65 735b 315d 5b69  ords_tuples[1][i
-0000a560: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0000a570: 2020 2020 636f 6f72 6473 5f74 7570 6c65      coords_tuple
-0000a580: 735b 325d 5b69 5d2c 0d0a 2020 2020 2020  s[2][i],..      
-0000a590: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
-0000a5a0: 5f74 7570 6c65 735b 335d 5b69 5d2c 0d0a  _tuples[3][i],..
-0000a5b0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-0000a5c0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0000a5d0: 2069 6e20 7261 6e67 6528 6c65 6e28 7829   in range(len(x)
-0000a5e0: 290d 0a20 2020 2020 2020 205d 0d0a 2020  )..        ]..  
-0000a5f0: 2020 2020 2020 706f 6c79 676f 6e73 203d        polygons =
-0000a600: 206c 6973 7428 6d61 7028 4665 6174 7572   list(map(Featur
-0000a610: 6543 6f6c 6c65 6374 696f 6e2e 6372 6561  eCollection.crea
-0000a620: 7465 5f70 6f6c 7967 6f6e 2c20 706f 6c79  te_polygon, poly
-0000a630: 735f 636f 6f72 6473 2929 0d0a 2020 2020  s_coords))..    
-0000a640: 2020 2020 6764 6620 3d20 6770 642e 4765      gdf = gpd.Ge
-0000a650: 6f44 6174 6146 7261 6d65 2867 656f 6d65  oDataFrame(geome
-0000a660: 7472 793d 706f 6c79 676f 6e73 290d 0a20  try=polygons).. 
-0000a670: 2020 2020 2020 2067 6466 2e73 6574 5f63         gdf.set_c
-0000a680: 7273 2865 7073 673d 6570 7367 2c20 696e  rs(epsg=epsg, in
-0000a690: 706c 6163 653d 5472 7565 290d 0a20 2020  place=True)..   
-0000a6a0: 2020 2020 2067 6466 5b22 6964 225d 203d       gdf["id"] =
-0000a6b0: 2067 6466 2e69 6e64 6578 0d0a 2020 2020   gdf.index..    
-0000a6c0: 2020 2020 7265 7475 726e 2067 6466 0d0a      return gdf..
-0000a6d0: 0d0a 2020 2020 6465 6620 6765 745f 6365  ..    def get_ce
-0000a6e0: 6c6c 5f70 6f69 6e74 7328 7365 6c66 2c20  ll_points(self, 
-0000a6f0: 6c6f 6361 7469 6f6e 3a20 7374 7220 3d20  location: str = 
-0000a700: 2263 656e 7465 7222 2c20 6d61 736b 3d46  "center", mask=F
-0000a710: 616c 7365 2920 2d3e 2047 656f 4461 7461  alse) -> GeoData
-0000a720: 4672 616d 653a 0d0a 2020 2020 2020 2020  Frame:..        
-0000a730: 2222 2247 6574 2061 2070 6f69 6e74 2073  """Get a point s
-0000a740: 6861 7065 6c79 2067 656f 6d65 7472 7920  hapely geometry 
-0000a750: 666f 7220 7468 6520 7261 7374 6572 2063  for the raster c
-0000a760: 656c 6c73 2063 656e 7465 7220 706f 696e  ells center poin
-0000a770: 742e 0d0a 0d0a 2020 2020 2020 2020 5061  t.....        Pa
-0000a780: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0000a790: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0000a7a0: 2020 2020 2020 6c6f 6361 7469 6f6e 3a20        location: 
-0000a7b0: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
-0000a7c0: 2020 206c 6f63 6174 696f 6e20 6f66 2074     location of t
-0000a7d0: 6865 2070 6f69 6e74 2c20 5b22 636f 726e  he point, ["corn
-0000a7e0: 6572 222c 2022 6365 6e74 6572 225d 2e20  er", "center"]. 
-0000a7f0: 4465 6661 756c 7420 6973 2022 6365 6e74  Default is "cent
-0000a800: 6572 222e 0d0a 2020 2020 2020 2020 6d61  er"...        ma
-0000a810: 736b 3a20 5b62 6f6f 6c5d 0d0a 2020 2020  sk: [bool]..    
-0000a820: 2020 2020 2020 2020 5472 7565 2074 6f20          True to 
-0000a830: 6765 7420 7468 6520 706f 6c79 676f 6e73  get the polygons
-0000a840: 206f 6620 7468 6520 6365 6c6c 7320 696e   of the cells in
-0000a850: 7369 6465 2074 6865 2064 6f6d 6169 6e2e  side the domain.
-0000a860: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-0000a870: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-0000a880: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4765  ----..        Ge
-0000a890: 6f44 6174 6146 7261 6d65 3a0d 0a20 2020  oDataFrame:..   
-0000a8a0: 2020 2020 2020 2020 2077 6974 6820 7477           with tw
-0000a8b0: 6f20 636f 6c75 6d6e 732c 2067 656f 6d65  o columns, geome
-0000a8c0: 7472 792c 2061 6e64 2069 640d 0a20 2020  try, and id..   
-0000a8d0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0000a8e0: 2020 636f 6f72 6473 203d 2073 656c 662e    coords = self.
-0000a8f0: 6765 745f 6365 6c6c 5f63 6f6f 7264 7328  get_cell_coords(
-0000a900: 6c6f 6361 7469 6f6e 3d6c 6f63 6174 696f  location=locatio
-0000a910: 6e2c 206d 6173 6b3d 6d61 736b 290d 0a20  n, mask=mask).. 
-0000a920: 2020 2020 2020 2065 7073 6720 3d20 7365         epsg = se
-0000a930: 6c66 2e5f 6765 745f 6570 7367 2829 0d0a  lf._get_epsg()..
-0000a940: 0d0a 2020 2020 2020 2020 636f 6f72 6473  ..        coords
-0000a950: 5f74 7570 6c65 7320 3d20 6c69 7374 287a  _tuples = list(z
-0000a960: 6970 2863 6f6f 7264 735b 3a2c 2030 5d2c  ip(coords[:, 0],
-0000a970: 2063 6f6f 7264 735b 3a2c 2031 5d29 290d   coords[:, 1])).
-0000a980: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
-0000a990: 3d20 4665 6174 7572 6543 6f6c 6c65 6374  = FeatureCollect
-0000a9a0: 696f 6e2e 6372 6561 7465 5f70 6f69 6e74  ion.create_point
-0000a9b0: 2863 6f6f 7264 735f 7475 706c 6573 290d  (coords_tuples).
-0000a9c0: 0a20 2020 2020 2020 2067 6466 203d 2067  .        gdf = g
-0000a9d0: 7064 2e47 656f 4461 7461 4672 616d 6528  pd.GeoDataFrame(
-0000a9e0: 6765 6f6d 6574 7279 3d70 6f69 6e74 7329  geometry=points)
-0000a9f0: 0d0a 2020 2020 2020 2020 6764 662e 7365  ..        gdf.se
-0000aa00: 745f 6372 7328 6570 7367 3d65 7073 672c  t_crs(epsg=epsg,
-0000aa10: 2069 6e70 6c61 6365 3d54 7275 6529 0d0a   inplace=True)..
-0000aa20: 2020 2020 2020 2020 6764 665b 2269 6422          gdf["id"
-0000aa30: 5d20 3d20 6764 662e 696e 6465 780d 0a20  ] = gdf.index.. 
-0000aa40: 2020 2020 2020 2072 6574 7572 6e20 6764         return gd
-0000aa50: 660d 0a0d 0a20 2020 2064 6566 2074 6f5f  f....    def to_
-0000aa60: 6669 6c65 2873 656c 662c 2070 6174 683a  file(self, path:
-0000aa70: 2073 7472 2c20 6472 6976 6572 3a20 7374   str, driver: st
-0000aa80: 7220 3d20 2267 656f 7469 6666 222c 2062  r = "geotiff", b
-0000aa90: 616e 643a 2069 6e74 203d 2030 2920 2d3e  and: int = 0) ->
-0000aaa0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000aab0: 2222 2253 6176 6520 746f 2067 656f 7469  """Save to geoti
-0000aac0: 6666 2066 6f72 6d61 742e 0d0a 0d0a 2020  ff format.....  
-0000aad0: 2020 2020 2020 2020 2020 7361 7665 5261            saveRa
-0000aae0: 7374 6572 2073 6176 6573 2061 2072 6173  ster saves a ras
-0000aaf0: 7465 7220 746f 2061 2070 6174 680d 0a0d  ter to a path...
-0000ab00: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0000ab10: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0000ab20: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000ab30: 2070 6174 683a 205b 7374 7269 6e67 5d0d   path: [string].
-0000ab40: 0a20 2020 2020 2020 2020 2020 2061 2070  .            a p
-0000ab50: 6174 6820 696e 636c 7564 6e67 2074 6865  ath includng the
-0000ab60: 206e 616d 6520 6f66 2074 6865 2072 6173   name of the ras
-0000ab70: 7465 7220 616e 6420 6578 7465 6e74 696f  ter and extentio
-0000ab80: 6e2e 0d0a 2020 2020 2020 2020 2020 2020  n...            
-0000ab90: 3e3e 3e20 7061 7468 203d 2022 6461 7461  >>> path = "data
-0000aba0: 2f63 726f 7070 6564 2e74 6966 220d 0a20  /cropped.tif".. 
-0000abb0: 2020 2020 2020 2064 7269 7665 723a 205b         driver: [
-0000abc0: 7374 725d 0d0a 2020 2020 2020 2020 2020  str]..          
-0000abd0: 2020 6472 6976 6572 203d 2022 6765 6f74    driver = "geot
-0000abe0: 6966 6622 2e0d 0a20 2020 2020 2020 2062  iff"...        b
-0000abf0: 616e 643a 205b 696e 745d 0d0a 2020 2020  and: [int]..    
-0000ac00: 2020 2020 2020 2020 6261 6e64 2069 6e64          band ind
-0000ac10: 6578 2c20 6e65 6564 6564 206f 6e6c 7920  ex, needed only 
-0000ac20: 696e 2063 6173 6520 6f66 2061 7363 6969  in case of ascii
-0000ac30: 2064 7269 7665 7273 2e20 4465 6661 756c   drivers. Defaul
-0000ac40: 7420 6973 2031 2e0d 0a0d 0a20 2020 2020  t is 1.....     
-0000ac50: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
-0000ac60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
-0000ac70: 2020 2020 2020 203e 3e3e 2072 6173 7465         >>> raste
-0000ac80: 725f 6f62 6a20 3d20 4461 7461 7365 742e  r_obj = Dataset.
-0000ac90: 7265 6164 5f66 696c 6528 2270 6174 682f  read_file("path/
-0000aca0: 746f 2f66 696c 652f 2a2a 2a2e 7469 6622  to/file/***.tif"
-0000acb0: 290d 0a20 2020 2020 2020 203e 3e3e 206f  )..        >>> o
-0000acc0: 7574 7075 745f 7061 7468 203d 2022 6578  utput_path = "ex
-0000acd0: 616d 706c 6573 2f47 4953 2f64 6174 612f  amples/GIS/data/
-0000ace0: 7361 7665 5f72 6173 7465 725f 7465 7374  save_raster_test
-0000acf0: 2e74 6966 220d 0a20 2020 2020 2020 203e  .tif"..        >
-0000ad00: 3e3e 2072 6173 7465 725f 6f62 6a2e 746f  >> raster_obj.to
-0000ad10: 5f66 696c 6528 6f75 7470 7574 5f70 6174  _file(output_pat
-0000ad20: 6829 0d0a 2020 2020 2020 2020 2222 220d  h)..        """.
-0000ad30: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0000ad40: 6973 696e 7374 616e 6365 2870 6174 682c  isinstance(path,
-0000ad50: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
-0000ad60: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-0000ad70: 726f 7228 2270 6174 6820 696e 7075 7420  ror("path input 
-0000ad80: 7368 6f75 6c64 2062 6520 7374 7269 6e67  should be string
-0000ad90: 2074 7970 6522 290d 0a0d 0a20 2020 2020   type")....     
-0000ada0: 2020 2069 6620 6e6f 7420 4341 5441 4c4f     if not CATALO
-0000adb0: 472e 6578 6973 7473 2864 7269 7665 7229  G.exists(driver)
-0000adc0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0000add0: 6169 7365 2044 7269 7665 724e 6f74 4578  aise DriverNotEx
-0000ade0: 6973 7445 7272 6f72 2866 2254 6865 2067  istError(f"The g
-0000adf0: 6976 656e 2064 7269 7665 723a 207b 6472  iven driver: {dr
-0000ae00: 6976 6572 7d20 646f 6573 206e 6f74 2065  iver} does not e
-0000ae10: 7869 7374 2229 0d0a 0d0a 2020 2020 2020  xist")....      
-0000ae20: 2020 6472 6976 6572 5f6e 616d 6520 3d20    driver_name = 
-0000ae30: 4341 5441 4c4f 472e 6765 745f 6764 616c  CATALOG.get_gdal
-0000ae40: 5f6e 616d 6528 6472 6976 6572 290d 0a0d  _name(driver)...
-0000ae50: 0a20 2020 2020 2020 2069 6620 6472 6976  .        if driv
-0000ae60: 6572 203d 3d20 2261 7363 6969 223a 0d0a  er == "ascii":..
-0000ae70: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
-0000ae80: 3d20 7365 6c66 2e72 6561 645f 6172 7261  = self.read_arra
-0000ae90: 7928 6261 6e64 3d62 616e 6429 0d0a 2020  y(band=band)..  
-0000aea0: 2020 2020 2020 2020 2020 6e6f 5f64 6174            no_dat
-0000aeb0: 615f 7661 6c75 6520 3d20 7365 6c66 2e6e  a_value = self.n
-0000aec0: 6f5f 6461 7461 5f76 616c 7565 5b62 616e  o_data_value[ban
-0000aed0: 645d 0d0a 2020 2020 2020 2020 2020 2020  d]..            
-0000aee0: 786d 696e 2c20 796d 696e 2c20 5f2c 205f  xmin, ymin, _, _
-0000aef0: 203d 2073 656c 662e 6262 6f78 0d0a 2020   = self.bbox..  
-0000af00: 2020 2020 2020 2020 2020 696f 2e74 6f5f            io.to_
-0000af10: 6173 6369 6928 6172 722c 2073 656c 662e  ascii(arr, self.
-0000af20: 6365 6c6c 5f73 697a 652c 2078 6d69 6e2c  cell_size, xmin,
-0000af30: 2079 6d69 6e2c 206e 6f5f 6461 7461 5f76   ymin, no_data_v
-0000af40: 616c 7565 2c20 7061 7468 290d 0a20 2020  alue, path)..   
-0000af50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0000af60: 2020 2020 2020 2020 6473 7420 3d20 6764          dst = gd
-0000af70: 616c 2e47 6574 4472 6976 6572 4279 4e61  al.GetDriverByNa
-0000af80: 6d65 2864 7269 7665 725f 6e61 6d65 292e  me(driver_name).
-0000af90: 4372 6561 7465 436f 7079 2870 6174 682c  CreateCopy(path,
-0000afa0: 2073 656c 662e 7261 7374 6572 2c20 3029   self.raster, 0)
-0000afb0: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
-0000afc0: 7420 3d20 4e6f 6e65 2020 2320 466c 7573  t = None  # Flus
-0000afd0: 6820 7468 6520 6461 7461 7365 7420 746f  h the dataset to
-0000afe0: 2064 6973 6b0d 0a20 2020 2020 2020 2020   disk..         
-0000aff0: 2020 2023 2070 7269 6e74 2074 6f20 676f     # print to go
-0000b000: 2061 726f 756e 6420 7468 6520 6173 7369   around the assi
-0000b010: 676e 6564 2062 7574 206e 6576 6572 2075  gned but never u
-0000b020: 7365 6420 7072 652d 636f 6d6d 6974 2069  sed pre-commit i
-0000b030: 7373 7565 0d0a 2020 2020 2020 2020 2020  ssue..          
-0000b040: 2020 7072 696e 7428 6473 7429 0d0a 0d0a    print(dst)....
-0000b050: 2020 2020 6465 6620 746f 5f70 6f6c 7967      def to_polyg
-0000b060: 6f6e 280d 0a20 2020 2020 2020 2073 656c  on(..        sel
-0000b070: 662c 0d0a 2020 2020 2020 2020 6261 6e64  f,..        band
-0000b080: 3a20 696e 7420 3d20 302c 0d0a 2020 2020  : int = 0,..    
-0000b090: 2020 2020 636f 6c5f 6e61 6d65 3a20 416e      col_name: An
-0000b0a0: 7920 3d20 2269 6422 2c0d 0a20 2020 2020  y = "id",..     
-0000b0b0: 2020 2070 6174 683a 2073 7472 203d 204e     path: str = N
-0000b0c0: 6f6e 652c 0d0a 2020 2020 2020 2020 6472  one,..        dr
-0000b0d0: 6976 6572 3a20 7374 7220 3d20 226d 656d  iver: str = "mem
-0000b0e0: 6f72 7922 2c0d 0a20 2020 2029 202d 3e20  ory",..    ) -> 
-0000b0f0: 556e 696f 6e5b 4765 6f44 6174 6146 7261  Union[GeoDataFra
-0000b100: 6d65 2c20 4e6f 6e65 5d3a 0d0a 2020 2020  me, None]:..    
-0000b110: 2020 2020 2222 2270 6f6c 7967 6f6e 697a      """polygoniz
-0000b120: 652e 0d0a 0d0a 2020 2020 2020 2020 2020  e.....          
-0000b130: 2020 5261 7374 6572 546f 506f 6c79 676f    RasterToPolygo
-0000b140: 6e20 7461 6b65 7320 6120 6764 616c 2044  n takes a gdal D
-0000b150: 6174 6163 7562 6520 6f62 6a65 6374 2061  atacube object a
-0000b160: 6e64 2067 726f 7570 206e 6569 6768 626f  nd group neighbo
-0000b170: 7269 6e67 2063 656c 6c73 2077 6974 6820  ring cells with 
-0000b180: 7468 6520 7361 6d65 2076 616c 7565 2069  the same value i
-0000b190: 6e74 6f20 6f6e 650d 0a20 2020 2020 2020  nto one..       
-0000b1a0: 2020 2020 2070 6f6c 7967 6f6e 2c20 7468       polygon, th
-0000b1b0: 6520 7265 7375 6c74 6564 2076 6563 746f  e resulted vecto
-0000b1c0: 7220 7769 6c6c 2062 6520 7361 7665 6420  r will be saved 
-0000b1d0: 746f 2064 6973 6b20 6173 2061 2067 656f  to disk as a geo
-0000b1e0: 6a73 6f6e 2066 696c 650d 0a0d 0a20 2020  json file....   
-0000b1f0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0000b200: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000b210: 2d2d 2d0d 0a20 2020 2020 2020 2062 616e  ---..        ban
-0000b220: 643a 205b 696e 745d 0d0a 2020 2020 2020  d: [int]..      
-0000b230: 2020 2020 2020 7261 7374 6572 2062 616e        raster ban
-0000b240: 6420 696e 6465 7820 5b31 2c32 2c33 2c2e  d index [1,2,3,.
-0000b250: 2e5d 0d0a 2020 2020 2020 2020 7061 7468  .]..        path
-0000b260: 3a5b 7374 725d 0d0a 2020 2020 2020 2020  :[str]..        
-0000b270: 2020 2020 7061 7468 2077 6865 7265 2079      path where y
-0000b280: 6f75 2077 616e 7420 746f 2073 6176 6520  ou want to save 
-0000b290: 7468 6520 706f 6c79 676f 6e2c 2074 6865  the polygon, the
-0000b2a0: 2070 6174 6820 7368 6f75 6c64 2069 6e63   path should inc
-0000b2b0: 6c75 6465 2074 6865 2065 7874 656e 7369  lude the extensi
-0000b2c0: 6f6e 2061 7420 7468 6520 656e 640d 0a20  on at the end.. 
-0000b2d0: 2020 2020 2020 2020 2020 2028 692e 652e             (i.e.
-0000b2e0: 2070 6174 682f 7665 6374 6f72 5f6e 616d   path/vector_nam
-0000b2f0: 652e 6765 6f6a 736f 6e29 0d0a 2020 2020  e.geojson)..    
-0000b300: 2020 2020 636f 6c5f 6e61 6d65 3a0d 0a20      col_name:.. 
-0000b310: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-0000b320: 6f66 2074 6865 2063 6f6c 756d 6e20 7768  of the column wh
-0000b330: 6572 6520 7468 6520 7261 7374 6572 2064  ere the raster d
-0000b340: 6174 6120 7769 6c6c 2062 6520 7374 6f72  ata will be stor
-0000b350: 6564 2e0d 0a20 2020 2020 2020 2064 7269  ed...        dri
-0000b360: 7665 723a 205b 7374 725d 0d0a 2020 2020  ver: [str]..    
-0000b370: 2020 2020 2020 2020 7665 6374 6f72 2064          vector d
-0000b380: 7269 7665 722c 2066 6f72 2061 6c6c 2070  river, for all p
-0000b390: 6f73 7369 626c 6520 6472 6976 6572 7320  ossible drivers 
-0000b3a0: 6368 6563 6b20 6874 7470 733a 2f2f 6764  check https://gd
-0000b3b0: 616c 2e6f 7267 2f64 7269 7665 7273 2f76  al.org/drivers/v
-0000b3c0: 6563 746f 722f 696e 6465 782e 6874 6d6c  ector/index.html
-0000b3d0: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
-0000b3e0: 4465 6661 756c 7420 6973 2022 4765 6f4a  Default is "GeoJ
-0000b3f0: 534f 4e22 2e0d 0a0d 0a20 2020 2020 2020  SON".....       
-0000b400: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0000b410: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000b420: 2020 204e 6f6e 650d 0a20 2020 2020 2020     None..       
-0000b430: 2022 2222 0d0a 2020 2020 2020 2020 6261   """..        ba
-0000b440: 6e64 203d 2073 656c 662e 7261 7374 6572  nd = self.raster
-0000b450: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
-0000b460: 616e 6420 2b20 3129 0d0a 2020 2020 2020  and + 1)..      
-0000b470: 2020 7372 7320 3d20 6f73 722e 5370 6174    srs = osr.Spat
-0000b480: 6961 6c52 6566 6572 656e 6365 2877 6b74  ialReference(wkt
-0000b490: 3d73 656c 662e 6372 7329 0d0a 2020 2020  =self.crs)..    
-0000b4a0: 2020 2020 6966 2070 6174 6820 6973 204e      if path is N
-0000b4b0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0000b4c0: 2020 6473 745f 6c61 7965 726e 616d 6520    dst_layername 
-0000b4d0: 3d20 2269 6422 0d0a 2020 2020 2020 2020  = "id"..        
-0000b4e0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000b4f0: 2020 2064 7374 5f6c 6179 6572 6e61 6d65     dst_layername
-0000b500: 203d 2070 6174 682e 7370 6c69 7428 222e   = path.split(".
-0000b510: 2229 5b30 5d2e 7370 6c69 7428 222f 2229  ")[0].split("/")
-0000b520: 5b2d 315d 0d0a 0d0a 2020 2020 2020 2020  [-1]....        
-0000b530: 6473 745f 6473 203d 2046 6561 7475 7265  dst_ds = Feature
-0000b540: 436f 6c6c 6563 7469 6f6e 2e63 7265 6174  Collection.creat
-0000b550: 655f 6473 2864 7269 7665 722c 2070 6174  e_ds(driver, pat
-0000b560: 6829 0d0a 2020 2020 2020 2020 6473 745f  h)..        dst_
-0000b570: 6c61 7965 7220 3d20 6473 745f 6473 2e43  layer = dst_ds.C
-0000b580: 7265 6174 654c 6179 6572 2864 7374 5f6c  reateLayer(dst_l
-0000b590: 6179 6572 6e61 6d65 2c20 7372 733d 7372  ayername, srs=sr
-0000b5a0: 7329 0d0a 2020 2020 2020 2020 6474 7970  s)..        dtyp
-0000b5b0: 6520 3d20 6764 616c 5f74 6f5f 6f67 725f  e = gdal_to_ogr_
-0000b5c0: 6474 7970 6528 7365 6c66 2e72 6173 7465  dtype(self.raste
-0000b5d0: 7229 0d0a 2020 2020 2020 2020 6e65 7746  r)..        newF
-0000b5e0: 6965 6c64 203d 206f 6772 2e46 6965 6c64  ield = ogr.Field
-0000b5f0: 4465 666e 2863 6f6c 5f6e 616d 652c 2064  Defn(col_name, d
-0000b600: 7479 7065 290d 0a20 2020 2020 2020 2064  type)..        d
-0000b610: 7374 5f6c 6179 6572 2e43 7265 6174 6546  st_layer.CreateF
-0000b620: 6965 6c64 286e 6577 4669 656c 6429 0d0a  ield(newField)..
-0000b630: 2020 2020 2020 2020 6764 616c 2e50 6f6c          gdal.Pol
-0000b640: 7967 6f6e 697a 6528 6261 6e64 2c20 6261  ygonize(band, ba
-0000b650: 6e64 2c20 6473 745f 6c61 7965 722c 2030  nd, dst_layer, 0
-0000b660: 2c20 5b5d 2c20 6361 6c6c 6261 636b 3d4e  , [], callback=N
-0000b670: 6f6e 6529 0d0a 2020 2020 2020 2020 6966  one)..        if
-0000b680: 2070 6174 683a 0d0a 2020 2020 2020 2020   path:..        
-0000b690: 2020 2020 6473 745f 6c61 7965 7220 3d20      dst_layer = 
-0000b6a0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
-0000b6b0: 2020 6473 745f 6473 203d 204e 6f6e 650d    dst_ds = None.
-0000b6c0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0000b6d0: 2020 2020 2020 2020 2020 2020 7665 6374              vect
-0000b6e0: 6f72 203d 2046 6561 7475 7265 436f 6c6c  or = FeatureColl
-0000b6f0: 6563 7469 6f6e 2864 7374 5f64 7329 0d0a  ection(dst_ds)..
-0000b700: 2020 2020 2020 2020 2020 2020 6764 6620              gdf 
-0000b710: 3d20 7665 6374 6f72 2e5f 6473 5f74 6f5f  = vector._ds_to_
-0000b720: 6764 6628 290d 0a20 2020 2020 2020 2020  gdf()..         
-0000b730: 2020 2072 6574 7572 6e20 6764 660d 0a0d     return gdf...
-0000b740: 0a20 2020 2064 6566 2074 6f5f 6765 6f64  .    def to_geod
-0000b750: 6174 6166 7261 6d65 280d 0a20 2020 2020  ataframe(..     
-0000b760: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
-0000b770: 2020 7665 6374 6f72 5f6d 6173 6b3a 2055    vector_mask: U
-0000b780: 6e69 6f6e 5b73 7472 2c20 4765 6f44 6174  nion[str, GeoDat
-0000b790: 6146 7261 6d65 5d20 3d20 4e6f 6e65 2c0d  aFrame] = None,.
-0000b7a0: 0a20 2020 2020 2020 2061 6464 5f67 656f  .        add_geo
-0000b7b0: 6d65 7472 793a 2073 7472 203d 204e 6f6e  metry: str = Non
-0000b7c0: 652c 0d0a 2020 2020 2020 2020 7469 6c65  e,..        tile
-0000b7d0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
-0000b7e0: 0a20 2020 2020 2020 2074 696c 655f 7369  .        tile_si
-0000b7f0: 7a65 3a20 696e 7420 3d20 3135 3030 2c0d  ze: int = 1500,.
-0000b800: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
-0000b810: 4461 7461 4672 616d 652c 2047 656f 4461  DataFrame, GeoDa
-0000b820: 7461 4672 616d 655d 3a0d 0a20 2020 2020  taFrame]:..     
-0000b830: 2020 2022 2222 436f 6e76 6572 7420 6120     """Convert a 
-0000b840: 7261 7374 6572 2074 6f20 6120 4765 6f44  raster to a GeoD
-0000b850: 6174 6146 7261 6d65 2e0d 0a0d 0a20 2020  ataFrame.....   
-0000b860: 2020 2020 2020 2020 2054 6865 2066 756e           The fun
-0000b870: 6374 696f 6e20 646f 2074 6865 2066 6f6c  ction do the fol
-0000b880: 6c6f 7769 6e67 0d0a 2020 2020 2020 2020  lowing..        
-0000b890: 2020 2020 2d20 466c 6174 7465 6e20 7468      - Flatten th
-0000b8a0: 6520 6172 7261 7920 696e 2065 6163 6820  e array in each 
-0000b8b0: 6261 6e64 2069 6e20 7468 6520 7261 7374  band in the rast
-0000b8c0: 6572 2074 6865 6e20 6d61 736b 2074 6865  er then mask the
-0000b8d0: 2076 616c 7565 7320 6966 2061 2076 6563   values if a vec
-0000b8e0: 746f 725f 6d61 736b 0d0a 2020 2020 2020  tor_mask..      
-0000b8f0: 2020 2020 2020 6669 6c65 2069 7320 6769        file is gi
-0000b900: 7665 6e20 6f74 6865 7277 6973 6520 6974  ven otherwise it
-0000b910: 2077 696c 6c20 666c 6174 7465 6e20 616c   will flatten al
-0000b920: 6c20 7661 6c75 6573 2e0d 0a20 2020 2020  l values...     
-0000b930: 2020 2020 2020 202d 2050 7574 2074 6865         - Put the
-0000b940: 2076 616c 7565 7320 666f 7220 6561 6368   values for each
-0000b950: 2062 616e 6420 696e 2061 2063 6f6c 756d   band in a colum
-0000b960: 6e20 696e 2061 2064 6174 6166 7261 6d65  n in a dataframe
-0000b970: 2075 6e64 6572 2074 6865 206e 616d 6520   under the name 
-0000b980: 6f66 2074 6865 2072 6173 7465 7220 6261  of the raster ba
-0000b990: 6e64 2c20 6275 7420 6966 206e 6f20 6d65  nd, but if no me
-0000b9a0: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
-0000b9b0: 6461 7461 2069 6e20 7468 6520 7261 7374  data in the rast
-0000b9c0: 6572 2062 616e 6420 6578 6973 7473 2c20  er band exists, 
-0000b9d0: 616e 2069 6e64 6578 206e 756d 6265 7220  an index number 
-0000b9e0: 7769 6c6c 2062 6520 7573 6564 205b 312c  will be used [1,
-0000b9f0: 2032 2c20 332c 202e 2e2e 5d0d 0a20 2020   2, 3, ...]..   
-0000ba00: 2020 2020 2020 2020 202d 2054 6865 2066           - The f
-0000ba10: 756e 6374 696f 6e20 6861 7320 6120 6164  unction has a ad
-0000ba20: 645f 6765 6f6d 6574 7279 2070 6172 616d  d_geometry param
-0000ba30: 6574 6572 2077 6974 6820 7477 6f20 706f  eter with two po
-0000ba40: 7373 6962 6c65 2076 616c 7565 7320 5b22  ssible values ["
-0000ba50: 706f 696e 7422 2c20 2270 6f6c 7967 6f6e  point", "polygon
-0000ba60: 225d 2c20 7768 6963 6820 796f 7520 6361  "], which you ca
-0000ba70: 6e0d 0a20 2020 2020 2020 2020 2020 2073  n..            s
-0000ba80: 7065 6369 6679 2074 6865 2074 7970 6520  pecify the type 
-0000ba90: 6f66 2073 6861 7065 6c79 2067 656f 6d65  of shapely geome
-0000baa0: 7472 7920 796f 7520 7761 6e74 2074 6f20  try you want to 
-0000bab0: 6372 6561 7465 2066 726f 6d20 6561 6368  create from each
-0000bac0: 2063 656c 6c2c 0d0a 2020 2020 2020 2020   cell,..        
-0000bad0: 2020 2020 2020 2020 2d20 4966 2070 6f69          - If poi
-0000bae0: 6e74 2069 7320 6368 6f73 656e 2c20 7468  nt is chosen, th
-0000baf0: 6520 6372 6561 7465 6420 706f 696e 7420  e created point 
-0000bb00: 7769 6c6c 2062 6520 6174 2074 6865 2063  will be at the c
-0000bb10: 656e 7465 7220 6f66 2065 6163 6820 6365  enter of each ce
-0000bb20: 6c6c 0d0a 2020 2020 2020 2020 2020 2020  ll..            
-0000bb30: 2020 2020 2d20 4966 2061 2070 6f6c 7967      - If a polyg
-0000bb40: 6f6e 2069 7320 6368 6f73 656e 2c20 6120  on is chosen, a 
-0000bb50: 7371 7561 7265 2070 6f6c 7967 6f6e 2077  square polygon w
-0000bb60: 696c 6c20 6265 2063 7265 6174 6564 2074  ill be created t
-0000bb70: 6861 7420 636f 7665 7273 2074 6865 2065  hat covers the e
-0000bb80: 6e74 6972 6520 6365 6c6c 2e0d 0a0d 0a20  ntire cell..... 
-0000bb90: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000bba0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0000bbb0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2076  -----..        v
-0000bbc0: 6563 746f 725f 6d61 736b 203a 204f 7074  ector_mask : Opt
-0000bbd0: 696f 6e61 6c5b 4765 6f44 6174 6146 7261  ional[GeoDataFra
-0000bbe0: 6d65 2f73 7472 5d0d 0a20 2020 2020 2020  me/str]..       
-0000bbf0: 2020 2020 2047 656f 4461 7461 4672 616d       GeoDataFram
-0000bc00: 6520 666f 7220 7468 6520 7665 6374 6f72  e for the vector
-0000bc10: 5f6d 6173 6b20 6669 6c65 2070 6174 6820  _mask file path 
-0000bc20: 746f 2076 6563 746f 725f 6d61 736b 2066  to vector_mask f
-0000bc30: 696c 652e 2049 6620 6769 7665 6e2c 2069  ile. If given, i
-0000bc40: 7420 7769 6c6c 2062 6520 7573 6564 2074  t will be used t
-0000bc50: 6f20 636c 6970 2074 6865 2072 6173 7465  o clip the raste
-0000bc60: 720d 0a20 2020 2020 2020 2061 6464 5f67  r..        add_g
-0000bc70: 656f 6d65 7472 793a 205b 7374 725d 0d0a  eometry: [str]..
-0000bc80: 2020 2020 2020 2020 2020 2020 2250 6f6c              "Pol
-0000bc90: 7967 6f6e 222c 206f 7220 2250 6f69 6e74  ygon", or "Point
-0000bca0: 2220 6966 2079 6f75 2077 616e 7420 746f  " if you want to
-0000bcb0: 2061 6464 2061 2070 6f6c 7967 6f6e 2067   add a polygon g
-0000bcc0: 656f 6d65 7472 7920 6f66 2074 6865 2063  eometry of the c
-0000bcd0: 656c 6c73 2061 7320 2063 6f6c 756d 6e20  ells as  column 
-0000bce0: 696e 2064 6174 6166 7261 6d65 2e0d 0a20  in dataframe... 
-0000bcf0: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-0000bd00: 6c74 2069 7320 4e6f 6e65 2e0d 0a20 2020  lt is None...   
-0000bd10: 2020 2020 2074 696c 653a 205b 626f 6f6c       tile: [bool
-0000bd20: 5d0d 0a20 2020 2020 2020 2020 2020 2054  ]..            T
-0000bd30: 7275 6520 746f 2075 7365 2074 696c 6573  rue to use tiles
-0000bd40: 2069 6e20 6578 7472 6163 7469 6e67 2074   in extracting t
-0000bd50: 6865 2076 616c 7565 7320 6672 6f6d 2074  he values from t
-0000bd60: 6865 2072 6173 7465 722e 2044 6566 6175  he raster. Defau
-0000bd70: 6c74 2069 7320 4661 6c73 652e 0d0a 2020  lt is False...  
-0000bd80: 2020 2020 2020 7469 6c65 5f73 697a 653a        tile_size:
-0000bd90: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
-0000bda0: 2020 2020 7469 6c65 2073 697a 652e 2044      tile size. D
-0000bdb0: 6566 6175 6c74 2069 7320 3135 3030 2e0d  efault is 1500..
-0000bdc0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0000bdd0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-0000bde0: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
-0000bdf0: 6146 7261 6d65 2f47 656f 4461 7461 4672  aFrame/GeoDataFr
-0000be00: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
-0000be10: 2063 6f6c 756d 6e64 4c3a 0d0a 2020 2020   columndL:..    
-0000be20: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0000be30: 7072 696e 7428 6764 662e 636f 6c75 6d6e  print(gdf.column
-0000be40: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-0000be50: 2020 2020 3e3e 3e20 496e 6465 7828 5b27      >>> Index(['
-0000be60: 4261 6e64 5f31 272c 2027 6765 6f6d 6574  Band_1', 'geomet
-0000be70: 7279 275d 2c20 6474 7970 653d 276f 626a  ry'], dtype='obj
-0000be80: 6563 7427 290d 0a0d 0a20 2020 2020 2020  ect')....       
-0000be90: 2074 6865 2072 6573 756c 7465 6420 6765   the resulted ge
-0000bea0: 6f64 6174 6166 7261 6d65 2077 696c 6c20  odataframe will 
-0000beb0: 6861 7665 2074 6865 2062 616e 6420 7661  have the band va
-0000bec0: 6c75 6520 756e 6465 7220 7468 6520 6e61  lue under the na
-0000bed0: 6d65 206f 6620 7468 6520 6261 6e64 2028  me of the band (
-0000bee0: 6966 2074 6865 2072 6173 7465 7220 6669  if the raster fi
-0000bef0: 6c65 2068 6173 2061 206d 6574 6164 6174  le has a metadat
-0000bf00: 612c 0d0a 2020 2020 2020 2020 6966 206e  a,..        if n
-0000bf10: 6f74 2c20 7468 6520 6261 6e64 7320 7769  ot, the bands wi
-0000bf20: 6c6c 2062 6520 696e 6465 7865 6420 6672  ll be indexed fr
-0000bf30: 6f6d 2031 2074 6f20 7468 6520 6e75 6d62  om 1 to the numb
-0000bf40: 6572 206f 6620 6261 6e64 7329 0d0a 2020  er of bands)..  
-0000bf50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0000bf60: 2020 2074 656d 705f 6469 7220 3d20 4e6f     temp_dir = No
-0000bf70: 6e65 0d0a 0d0a 2020 2020 2020 2020 2320  ne....        # 
-0000bf80: 4765 7420 7261 7374 6572 2062 616e 6420  Get raster band 
-0000bf90: 6e61 6d65 732e 206f 7065 6e20 7468 6520  names. open the 
-0000bfa0: 6461 7461 7365 7420 7573 696e 6720 6764  dataset using gd
-0000bfb0: 616c 2e4f 7065 6e0d 0a20 2020 2020 2020  al.Open..       
-0000bfc0: 2062 616e 645f 6e61 6d65 7320 3d20 7365   band_names = se
-0000bfd0: 6c66 2e67 6574 5f62 616e 645f 6e61 6d65  lf.get_band_name
-0000bfe0: 7328 290d 0a0d 0a20 2020 2020 2020 2023  s()....        #
-0000bff0: 2043 7265 6174 6520 6120 6d61 736b 2066   Create a mask f
-0000c000: 726f 6d20 7468 6520 7069 7865 6c73 2074  rom the pixels t
-0000c010: 6f75 6368 6564 2062 7920 7468 6520 7665  ouched by the ve
-0000c020: 6374 6f72 5f6d 6173 6b2e 0d0a 2020 2020  ctor_mask...    
-0000c030: 2020 2020 6966 2076 6563 746f 725f 6d61      if vector_ma
-0000c040: 736b 2069 7320 6e6f 7420 4e6f 6e65 3a0d  sk is not None:.
-0000c050: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-0000c060: 7265 6174 6520 6120 7465 6d70 6f72 6172  reate a temporar
-0000c070: 7920 6469 7265 6374 6f72 7920 666f 7220  y directory for 
-0000c080: 6669 6c65 732e 0d0a 2020 2020 2020 2020  files...        
-0000c090: 2020 2020 7465 6d70 5f64 6972 203d 2074      temp_dir = t
-0000c0a0: 656d 7066 696c 652e 6d6b 6474 656d 7028  empfile.mkdtemp(
-0000c0b0: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-0000c0c0: 6577 5f76 6563 746f 725f 7061 7468 203d  ew_vector_path =
-0000c0d0: 206f 732e 7061 7468 2e6a 6f69 6e28 7465   os.path.join(te
-0000c0e0: 6d70 5f64 6972 2c20 6622 7b75 7569 642e  mp_dir, f"{uuid.
-0000c0f0: 7575 6964 3128 297d 2229 0d0a 0d0a 2020  uuid1()}")....  
-0000c100: 2020 2020 2020 2020 2020 2320 7265 6164            # read
-0000c110: 2074 6865 2076 6563 746f 7220 7769 7468   the vector with
-0000c120: 2067 656f 7061 6e64 6173 0d0a 2020 2020   geopandas..    
-0000c130: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000c140: 7461 6e63 6528 7665 6374 6f72 5f6d 6173  tance(vector_mas
-0000c150: 6b2c 2047 656f 4461 7461 4672 616d 6529  k, GeoDataFrame)
-0000c160: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000c170: 2020 2076 6563 746f 7220 3d20 4665 6174     vector = Feat
-0000c180: 7572 6543 6f6c 6c65 6374 696f 6e28 7665  ureCollection(ve
-0000c190: 6374 6f72 5f6d 6173 6b29 0d0a 2020 2020  ctor_mask)..    
-0000c1a0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-0000c1b0: 6e73 7461 6e63 6528 7665 6374 6f72 5f6d  nstance(vector_m
-0000c1c0: 6173 6b2c 2046 6561 7475 7265 436f 6c6c  ask, FeatureColl
-0000c1d0: 6563 7469 6f6e 293a 0d0a 2020 2020 2020  ection):..      
-0000c1e0: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
-0000c1f0: 203d 2076 6563 746f 725f 6d61 736b 0d0a   = vector_mask..
-0000c200: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000c210: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000c220: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0000c230: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-0000c240: 2020 2020 2020 2020 2066 2254 6865 2076           f"The v
-0000c250: 6563 746f 725f 6d61 736b 2073 686f 756c  ector_mask shoul
-0000c260: 6420 6265 206f 6620 7479 7065 3a20 5b47  d be of type: [G
-0000c270: 656f 4461 7461 4672 616d 652f 4665 6174  eoDataFrame/Feat
-0000c280: 7572 6543 6f6c 6c65 6374 696f 6e5d 2c20  ureCollection], 
-0000c290: 6769 7665 6e3a 2022 0d0a 2020 2020 2020  given: "..      
-0000c2a0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000c2b0: 7b74 7970 6528 7665 6374 6f72 5f6d 6173  {type(vector_mas
-0000c2c0: 6b29 7d22 0d0a 2020 2020 2020 2020 2020  k)}"..          
-0000c2d0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-0000c2e0: 2020 2020 2020 2023 2061 6464 2061 2075         # add a u
-0000c2f0: 6e69 7175 6520 7661 6c75 6520 666f 7220  nique value for 
-0000c300: 6561 6368 2072 6f77 7320 746f 2075 7365  each rows to use
-0000c310: 2069 7420 746f 2072 6173 7465 7269 7a65   it to rasterize
-0000c320: 2074 6865 2076 6563 746f 720d 0a20 2020   the vector..   
-0000c330: 2020 2020 2020 2020 2076 6563 746f 722e           vector.
-0000c340: 6665 6174 7572 655b 2262 7572 6e5f 7661  feature["burn_va
-0000c350: 6c75 6522 5d20 3d20 6c69 7374 2872 616e  lue"] = list(ran
-0000c360: 6765 2831 2c20 6c65 6e28 7665 6374 6f72  ge(1, len(vector
-0000c370: 2e66 6561 7475 7265 2920 2b20 3129 290d  .feature) + 1)).
-0000c380: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-0000c390: 6176 6520 7468 6520 6e65 7720 7665 6374  ave the new vect
-0000c3a0: 6f72 2074 6f20 6469 736b 2074 6f20 7265  or to disk to re
-0000c3b0: 6164 2069 7420 7769 7468 206f 6772 206c  ad it with ogr l
-0000c3c0: 6174 6572 0d0a 2020 2020 2020 2020 2020  ater..          
-0000c3d0: 2020 7665 6374 6f72 2e66 6561 7475 7265    vector.feature
-0000c3e0: 2e74 6f5f 6669 6c65 286e 6577 5f76 6563  .to_file(new_vec
-0000c3f0: 746f 725f 7061 7468 2c20 6472 6976 6572  tor_path, driver
-0000c400: 3d22 4765 6f4a 534f 4e22 290d 0a0d 0a20  ="GeoJSON").... 
-0000c410: 2020 2020 2020 2020 2020 2023 2072 6173             # ras
-0000c420: 7465 7269 7a65 2074 6865 2076 6563 746f  terize the vecto
-0000c430: 7220 6279 2062 7572 6e69 6e67 2074 6865  r by burning the
-0000c440: 2075 6e69 7175 6520 7661 6c75 6573 2061   unique values a
-0000c450: 7320 6365 6c6c 2076 616c 7565 732e 0d0a  s cell values...
-0000c460: 2020 2020 2020 2020 2020 2020 2320 7261              # ra
-0000c470: 7374 6572 697a 6564 5f76 6563 746f 725f  sterized_vector_
-0000c480: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
-0000c490: 6f69 6e28 7465 6d70 5f64 6972 2c20 6622  oin(temp_dir, f"
-0000c4a0: 7b75 7569 642e 7575 6964 3128 297d 2e74  {uuid.uuid1()}.t
-0000c4b0: 6966 2229 0d0a 2020 2020 2020 2020 2020  if")..          
-0000c4c0: 2020 7261 7374 6572 697a 6564 5f76 6563    rasterized_vec
-0000c4d0: 746f 7220 3d20 7665 6374 6f72 2e74 6f5f  tor = vector.to_
-0000c4e0: 6461 7461 7365 7428 0d0a 2020 2020 2020  dataset(..      
-0000c4f0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-0000c500: 743d 7365 6c66 2c20 636f 6c75 6d6e 5f6e  t=self, column_n
-0000c510: 616d 653d 2262 7572 6e5f 7661 6c75 6522  ame="burn_value"
-0000c520: 0d0a 2020 2020 2020 2020 2020 2020 2920  ..            ) 
-0000c530: 2023 2072 6173 7465 7269 7a65 645f 7665   # rasterized_ve
-0000c540: 6374 6f72 5f70 6174 682c 0d0a 2020 2020  ctor_path,..    
-0000c550: 2020 2020 2020 2020 6966 2061 6464 5f67          if add_g
-0000c560: 656f 6d65 7472 793a 0d0a 2020 2020 2020  eometry:..      
-0000c570: 2020 2020 2020 2020 2020 6966 2061 6464            if add
-0000c580: 5f67 656f 6d65 7472 792e 6c6f 7765 7228  _geometry.lower(
-0000c590: 2920 3d3d 2022 706f 696e 7422 3a0d 0a20  ) == "point":.. 
-0000c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5b0: 2020 2063 6f6f 7264 7320 3d20 7261 7374     coords = rast
-0000c5c0: 6572 697a 6564 5f76 6563 746f 722e 6765  erized_vector.ge
-0000c5d0: 745f 6365 6c6c 5f70 6f69 6e74 7328 6d61  t_cell_points(ma
-0000c5e0: 736b 3d54 7275 6529 0d0a 2020 2020 2020  sk=True)..      
-0000c5f0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0000c600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c610: 2020 2020 2063 6f6f 7264 7320 3d20 7261       coords = ra
-0000c620: 7374 6572 697a 6564 5f76 6563 746f 722e  sterized_vector.
-0000c630: 6765 745f 6365 6c6c 5f70 6f6c 7967 6f6e  get_cell_polygon
-0000c640: 7328 6d61 736b 3d54 7275 6529 0d0a 0d0a  s(mask=True)....
-0000c650: 2020 2020 2020 2020 2020 2020 2320 4c6f              # Lo
-0000c660: 6f70 206f 7665 7220 6d61 736b 2076 616c  op over mask val
-0000c670: 7565 7320 746f 2065 7874 7261 6374 2070  ues to extract p
-0000c680: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
-0000c690: 2020 2020 2320 4461 7461 4672 616d 6573      # DataFrames
-0000c6a0: 206f 6620 6561 6368 2074 696c 652e 0d0a   of each tile...
-0000c6b0: 2020 2020 2020 2020 2020 2020 6466 5f6c              df_l
-0000c6c0: 6973 7420 3d20 5b5d 0d0a 2020 2020 2020  ist = []..      
-0000c6d0: 2020 2020 2020 6d61 736b 5f61 7272 203d        mask_arr =
-0000c6e0: 2072 6173 7465 7269 7a65 645f 7665 6374   rasterized_vect
-0000c6f0: 6f72 2e72 6173 7465 722e 4765 7452 6173  or.raster.GetRas
-0000c700: 7465 7242 616e 6428 3129 2e52 6561 6441  terBand(1).ReadA
-0000c710: 7341 7272 6179 2829 0d0a 0d0a 2020 2020  sArray()....    
-0000c720: 2020 2020 2020 2020 666f 7220 6172 7220          for arr 
-0000c730: 696e 2073 656c 662e 6765 745f 7469 6c65  in self.get_tile
-0000c740: 2874 696c 655f 7369 7a65 293a 0d0a 0d0a  (tile_size):....
-0000c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c760: 6d61 736b 5f64 6673 203d 205b 5d0d 0a20  mask_dfs = [].. 
-0000c770: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000c780: 6f72 206d 6173 6b5f 7661 6c20 696e 2076  or mask_val in v
-0000c790: 6563 746f 722e 6665 6174 7572 655b 2262  ector.feature["b
-0000c7a0: 7572 6e5f 7661 6c75 6522 5d2e 7661 6c75  urn_value"].valu
-0000c7b0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-0000c7c0: 2020 2020 2020 2020 2023 2045 7874 7261           # Extra
-0000c7d0: 6374 206f 6e6c 7920 6d61 736b 6564 2070  ct only masked p
-0000c7e0: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
-0000c7f0: 2020 2020 2020 2020 2020 2020 666c 6174              flat
-0000c800: 7465 6e5f 6d61 736b 6564 5f76 616c 7565  ten_masked_value
-0000c810: 7320 3d20 6765 745f 7069 7865 6c73 280d  s = get_pixels(.
-0000c820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c830: 2020 2020 2020 2020 2061 7272 2c20 6d61           arr, ma
-0000c840: 736b 5f61 7272 2c20 6d61 736b 5f76 616c  sk_arr, mask_val
-0000c850: 3d6d 6173 6b5f 7661 6c0d 0a20 2020 2020  =mask_val..     
-0000c860: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000c870: 2e74 7261 6e73 706f 7365 2829 0d0a 2020  .transpose()..  
-0000c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c890: 2020 6669 645f 7078 203d 206e 702e 6f6e    fid_px = np.on
-0000c8a0: 6573 2866 6c61 7474 656e 5f6d 6173 6b65  es(flatten_maske
-0000c8b0: 645f 7661 6c75 6573 2e73 6861 7065 5b30  d_values.shape[0
-0000c8c0: 5d29 202a 206d 6173 6b5f 7661 6c0d 0a0d  ]) * mask_val...
-0000c8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c8e0: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
-0000c8f0: 4461 7461 4672 616d 6520 6f66 206d 6173  DataFrame of mas
-0000c900: 6b65 6420 666c 6174 7465 6e5f 6d61 736b  ked flatten_mask
-0000c910: 6564 5f76 616c 7565 7320 616e 6420 7468  ed_values and th
-0000c920: 6569 7220 4649 442e 0d0a 2020 2020 2020  eir FID...      
-0000c930: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-0000c940: 736b 5f64 6620 3d20 7064 2e44 6174 6146  sk_df = pd.DataF
-0000c950: 7261 6d65 2866 6c61 7474 656e 5f6d 6173  rame(flatten_mas
-0000c960: 6b65 645f 7661 6c75 6573 2c20 636f 6c75  ked_values, colu
-0000c970: 6d6e 733d 6261 6e64 5f6e 616d 6573 290d  mns=band_names).
-0000c980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c990: 2020 2020 206d 6173 6b5f 6466 5b22 6275       mask_df["bu
-0000c9a0: 726e 5f76 616c 7565 225d 203d 2066 6964  rn_value"] = fid
-0000c9b0: 5f70 780d 0a20 2020 2020 2020 2020 2020  _px..           
-0000c9c0: 2020 2020 2020 2020 206d 6173 6b5f 6466           mask_df
-0000c9d0: 732e 6170 7065 6e64 286d 6173 6b5f 6466  s.append(mask_df
-0000c9e0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000c9f0: 2020 2020 2023 2043 6f6e 6361 7420 7468       # Concat th
-0000ca00: 6520 6d61 736b 2044 6174 6146 7261 6d65  e mask DataFrame
-0000ca10: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-0000ca20: 2020 2020 6d61 736b 5f64 6620 3d20 7064      mask_df = pd
-0000ca30: 2e63 6f6e 6361 7428 6d61 736b 5f64 6673  .concat(mask_dfs
-0000ca40: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000ca50: 2020 2020 2023 204a 6f69 6e20 7769 7468       # Join with
-0000ca60: 2070 6978 656c 7320 7769 7468 2076 6563   pixels with vec
-0000ca70: 746f 7220 6174 7472 6962 7574 6573 2075  tor attributes u
-0000ca80: 7369 6e67 2074 6865 2046 4944 2e0d 0a20  sing the FID... 
-0000ca90: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000caa0: 665f 6c69 7374 2e61 7070 656e 6428 0d0a  f_list.append(..
-0000cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cac0: 2020 2020 6d61 736b 5f64 662e 6d65 7267      mask_df.merg
-0000cad0: 6528 7665 6374 6f72 2e66 6561 7475 7265  e(vector.feature
-0000cae0: 2c20 686f 773d 226c 6566 7422 2c20 6f6e  , how="left", on
-0000caf0: 3d22 6275 726e 5f76 616c 7565 2229 0d0a  ="burn_value")..
-0000cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb10: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000cb20: 2023 204d 6572 6765 2061 6c6c 2074 6865   # Merge all the
-0000cb30: 2074 696c 6573 2e0d 0a20 2020 2020 2020   tiles...       
-0000cb40: 2020 2020 206f 7574 5f64 6620 3d20 7064       out_df = pd
-0000cb50: 2e63 6f6e 6361 7428 6466 5f6c 6973 7429  .concat(df_list)
-0000cb60: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0000cb70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000cb80: 7469 6c65 3a0d 0a20 2020 2020 2020 2020  tile:..         
-0000cb90: 2020 2020 2020 2064 665f 6c69 7374 203d         df_list =
-0000cba0: 205b 5d20 2023 2044 6174 6146 7261 6d65   []  # DataFrame
-0000cbb0: 7320 6f66 2065 6163 6820 7469 6c65 2e0d  s of each tile..
-0000cbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cbd0: 2066 6f72 2061 7272 2069 6e20 4461 7461   for arr in Data
-0000cbe0: 7365 742e 6765 745f 7469 6c65 2873 656c  set.get_tile(sel
-0000cbf0: 662e 7261 7374 6572 293a 0d0a 2020 2020  f.raster):..    
-0000cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc10: 2320 4173 7375 6d65 206d 756c 7469 6261  # Assume multiba
-0000cc20: 6e64 0d0a 2020 2020 2020 2020 2020 2020  nd..            
-0000cc30: 2020 2020 2020 2020 6964 7820 3d20 2831          idx = (1
-0000cc40: 2c20 3229 0d0a 2020 2020 2020 2020 2020  , 2)..          
-0000cc50: 2020 2020 2020 2020 2020 6966 2061 7272            if arr
-0000cc60: 2e6e 6469 6d20 3d3d 2032 3a0d 0a20 2020  .ndim == 2:..   
-0000cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc80: 2020 2020 2023 2048 616e 646c 6520 7369       # Handle si
-0000cc90: 6e67 6c65 2062 616e 6420 7261 7374 6572  ngle band raster
-0000cca0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000ccb0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
-0000ccc0: 2028 302c 2031 290d 0a0d 0a20 2020 2020   (0, 1)....     
-0000ccd0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000cce0: 6173 6b5f 6172 7220 3d20 6e70 2e6f 6e65  ask_arr = np.one
-0000ccf0: 7328 2861 7272 2e73 6861 7065 5b69 6478  s((arr.shape[idx
-0000cd00: 5b30 5d5d 2c20 6172 722e 7368 6170 655b  [0]], arr.shape[
-0000cd10: 6964 785b 315d 5d29 290d 0a20 2020 2020  idx[1]]))..     
-0000cd20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000cd30: 6978 656c 7320 3d20 6765 745f 7069 7865  ixels = get_pixe
-0000cd40: 6c73 2861 7272 2c20 6d61 736b 5f61 7272  ls(arr, mask_arr
-0000cd50: 292e 7472 616e 7370 6f73 6528 290d 0a20  ).transpose().. 
-0000cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd70: 2020 2064 665f 6c69 7374 2e61 7070 656e     df_list.appen
-0000cd80: 6428 7064 2e44 6174 6146 7261 6d65 2870  d(pd.DataFrame(p
-0000cd90: 6978 656c 732c 2063 6f6c 756d 6e73 3d62  ixels, columns=b
-0000cda0: 616e 645f 6e61 6d65 7329 290d 0a0d 0a20  and_names)).... 
-0000cdb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000cdc0: 204d 6572 6765 2061 6c6c 2074 6865 2074   Merge all the t
-0000cdd0: 696c 6573 2e0d 0a20 2020 2020 2020 2020  iles...         
-0000cde0: 2020 2020 2020 206f 7574 5f64 6620 3d20         out_df = 
-0000cdf0: 7064 2e63 6f6e 6361 7428 6466 5f6c 6973  pd.concat(df_lis
-0000ce00: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-0000ce10: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000ce20: 2020 2020 2020 2023 2057 6172 6e69 6e67         # Warning
-0000ce30: 3a20 6e6f 7420 6368 6563 6b65 6420 7965  : not checked ye
-0000ce40: 7420 666f 7220 6d75 6c74 6920 6261 6e64  t for multi band
-0000ce50: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000ce60: 2020 2061 7272 203d 2073 656c 662e 7261     arr = self.ra
-0000ce70: 7374 6572 2e52 6561 6441 7341 7272 6179  ster.ReadAsArray
-0000ce80: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0000ce90: 2020 2020 7069 7865 6c73 203d 2061 7272      pixels = arr
-0000cea0: 2e66 6c61 7474 656e 2829 0d0a 2020 2020  .flatten()..    
-0000ceb0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-0000cec0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-0000ced0: 6528 7069 7865 6c73 2c20 636f 6c75 6d6e  e(pixels, column
-0000cee0: 733d 6261 6e64 5f6e 616d 6573 290d 0a0d  s=band_names)...
-0000cef0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000cf00: 6164 645f 6765 6f6d 6574 7279 3a0d 0a20  add_geometry:.. 
-0000cf10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000cf20: 6620 6164 645f 6765 6f6d 6574 7279 2e6c  f add_geometry.l
-0000cf30: 6f77 6572 2829 203d 3d20 2270 6f69 6e74  ower() == "point
-0000cf40: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0000cf50: 2020 2020 2020 2020 636f 6f72 6473 203d          coords =
-0000cf60: 2073 656c 662e 6765 745f 6365 6c6c 5f70   self.get_cell_p
-0000cf70: 6f69 6e74 7328 6d61 736b 3d54 7275 6529  oints(mask=True)
-0000cf80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000cf90: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0000cfa0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
-0000cfb0: 7264 7320 3d20 7365 6c66 2e67 6574 5f63  rds = self.get_c
-0000cfc0: 656c 6c5f 706f 6c79 676f 6e73 286d 6173  ell_polygons(mas
-0000cfd0: 6b3d 5472 7565 290d 0a0d 0a20 2020 2020  k=True)....     
-0000cfe0: 2020 206f 7574 5f64 6620 3d20 6f75 745f     out_df = out_
-0000cff0: 6466 2e64 726f 7028 636f 6c75 6d6e 733d  df.drop(columns=
-0000d000: 5b22 6275 726e 5f76 616c 7565 222c 2022  ["burn_value", "
-0000d010: 6765 6f6d 6574 7279 225d 2c20 6572 726f  geometry"], erro
-0000d020: 7273 3d22 6967 6e6f 7265 2229 0d0a 2020  rs="ignore")..  
-0000d030: 2020 2020 2020 6966 2061 6464 5f67 656f        if add_geo
-0000d040: 6d65 7472 793a 0d0a 2020 2020 2020 2020  metry:..        
-0000d050: 2020 2020 6f75 745f 6466 203d 2067 7064      out_df = gpd
-0000d060: 2e47 656f 4461 7461 4672 616d 6528 6f75  .GeoDataFrame(ou
-0000d070: 745f 6466 2c20 6765 6f6d 6574 7279 3d63  t_df, geometry=c
-0000d080: 6f6f 7264 735b 2267 656f 6d65 7472 7922  oords["geometry"
-0000d090: 5d29 0d0a 0d0a 2020 2020 2020 2020 2320  ])....        # 
-0000d0a0: 544f 444f 206d 6173 6b20 6e6f 2064 6174  TODO mask no dat
-0000d0b0: 6120 7661 6c75 6573 2e0d 0a0d 0a20 2020  a values.....   
-0000d0c0: 2020 2020 2023 2052 656d 6f76 6520 7465       # Remove te
-0000d0d0: 6d70 6f72 6172 7920 6669 6c65 732e 0d0a  mporary files...
-0000d0e0: 2020 2020 2020 2020 6966 2074 656d 705f          if temp_
-0000d0f0: 6469 7220 6973 206e 6f74 204e 6f6e 653a  dir is not None:
-0000d100: 0d0a 2020 2020 2020 2020 2020 2020 7368  ..            sh
-0000d110: 7574 696c 2e72 6d74 7265 6528 7465 6d70  util.rmtree(temp
-0000d120: 5f64 6972 2c20 6967 6e6f 7265 5f65 7272  _dir, ignore_err
-0000d130: 6f72 733d 5472 7565 290d 0a0d 0a20 2020  ors=True)....   
-0000d140: 2020 2020 2023 2052 6574 7572 6e20 6472       # Return dr
-0000d150: 6f70 7069 6e67 2061 6e79 2065 7874 7261  opping any extra
-0000d160: 2063 6f6c 732e 0d0a 2020 2020 2020 2020   cols...        
-0000d170: 7265 7475 726e 206f 7574 5f64 660d 0a0d  return out_df...
-0000d180: 0a20 2020 2064 6566 2061 7070 6c79 2873  .    def apply(s
-0000d190: 656c 662c 2066 756e 2c20 6261 6e64 3a20  elf, fun, band: 
-0000d1a0: 696e 7420 3d20 3029 3a0d 0a20 2020 2020  int = 0):..     
-0000d1b0: 2020 2022 2222 6d61 7041 6c67 6562 7261     """mapAlgebra
-0000d1c0: 2e0d 0a0d 0a20 2020 2020 2020 202d 206d  .....        - m
-0000d1d0: 6170 416c 6765 6272 6120 6578 6563 7574  apAlgebra execut
-0000d1e0: 6573 2061 206d 6174 6865 6d61 7469 6361  es a mathematica
-0000d1f0: 6c20 6f70 6572 6174 696f 6e20 6f6e 2072  l operation on r
-0000d200: 6173 7465 7220 6172 7261 7920 616e 6420  aster array and 
-0000d210: 7265 7475 726e 730d 0a20 2020 2020 2020  returns..       
-0000d220: 2074 6865 2072 6573 756c 740d 0a20 2020   the result..   
-0000d230: 2020 2020 202d 2054 6865 206d 6170 416c       - The mapAl
-0000d240: 6765 6272 6120 6578 6563 7574 6573 2074  gebra executes t
-0000d250: 6865 2066 756e 6374 696f 6e20 6f6e 6c79  he function only
-0000d260: 206f 6e20 6f6e 6520 6365 6c6c 2061 7420   on one cell at 
-0000d270: 6120 7469 6d65 2e0d 0a0d 0a20 2020 2020  a time.....     
-0000d280: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0000d290: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000d2a0: 2d0d 0a20 2020 2020 2020 2066 756e 3a20  -..        fun: 
-0000d2b0: 5b66 756e 6374 696f 6e5d 0d0a 2020 2020  [function]..    
-0000d2c0: 2020 2020 2020 2020 6465 6669 6e65 6420          defined 
-0000d2d0: 6675 6e63 7469 6f6e 2074 6861 7420 7461  function that ta
-0000d2e0: 6b65 7320 6f6e 6520 696e 7075 7420 7768  kes one input wh
-0000d2f0: 6963 6820 6973 2074 6865 2063 656c 6c20  ich is the cell 
-0000d300: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
-0000d310: 6261 6e64 3a20 5b69 6e74 5d0d 0a20 2020  band: [int]..   
-0000d320: 2020 2020 2020 2020 2062 616e 6420 6e75           band nu
-0000d330: 6d62 6572 2e0d 0a0d 0a20 2020 2020 2020  mber.....       
-0000d340: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0000d350: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000d360: 2020 2044 6174 6163 7562 650d 0a20 2020     Datacube..   
-0000d370: 2020 2020 2020 2020 2067 6461 6c20 6461           gdal da
-0000d380: 7461 7365 7420 6f62 6a65 6374 0d0a 0d0a  taset object....
-0000d390: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-0000d3a0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000d3b0: 2d2d 0d0a 2020 2020 2020 2020 3e3e 3e20  --..        >>> 
-0000d3c0: 7372 635f 7261 7374 6572 203d 2067 6461  src_raster = gda
-0000d3d0: 6c2e 4f70 656e 2822 6576 6170 2e74 6966  l.Open("evap.tif
-0000d3e0: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
-0000d3f0: 6675 6e63 203d 206e 702e 6162 730d 0a20  func = np.abs.. 
-0000d400: 2020 2020 2020 203e 3e3e 206e 6577 5f72         >>> new_r
-0000d410: 6173 7465 7220 3d20 4461 7461 7365 742e  aster = Dataset.
-0000d420: 6170 706c 7928 7372 635f 7261 7374 6572  apply(src_raster
-0000d430: 2c20 6675 6e63 290d 0a20 2020 2020 2020  , func)..       
-0000d440: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-0000d450: 206e 6f74 2063 616c 6c61 626c 6528 6675   not callable(fu
-0000d460: 6e29 3a0d 0a20 2020 2020 2020 2020 2020  n):..           
-0000d470: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0000d480: 2822 7365 636f 6e64 2061 7267 756d 656e  ("second argumen
-0000d490: 7420 7368 6f75 6c64 2062 6520 6120 6675  t should be a fu
-0000d4a0: 6e63 7469 6f6e 2229 0d0a 0d0a 2020 2020  nction")....    
-0000d4b0: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-0000d4c0: 6520 3d20 7365 6c66 2e6e 6f5f 6461 7461  e = self.no_data
-0000d4d0: 5f76 616c 7565 5b62 616e 645d 0d0a 2020  _value[band]..  
-0000d4e0: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
-0000d4f0: 3d20 7365 6c66 2e72 6561 645f 6172 7261  = self.read_arra
-0000d500: 7928 6261 6e64 290d 0a20 2020 2020 2020  y(band)..       
-0000d510: 2064 7479 7065 203d 2073 656c 662e 6474   dtype = self.dt
-0000d520: 7970 655b 6261 6e64 5d0d 0a0d 0a20 2020  ype[band]....   
-0000d530: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
-0000d540: 6e65 7720 6172 7261 7920 7769 7468 2074  new array with t
-0000d550: 6865 206e 6f64 6174 6120 7661 6c75 650d  he nodata value.
-0000d560: 0a20 2020 2020 2020 206e 6577 5f61 7272  .        new_arr
-0000d570: 6179 203d 206e 702e 6f6e 6573 2828 7365  ay = np.ones((se
-0000d580: 6c66 2e72 6f77 732c 2073 656c 662e 636f  lf.rows, self.co
-0000d590: 6c75 6d6e 7329 2920 2a20 6e6f 5f64 6174  lumns)) * no_dat
-0000d5a0: 615f 7661 6c75 650d 0a20 2020 2020 2020  a_value..       
-0000d5b0: 2023 2065 7865 6375 7465 2074 6865 2066   # execute the f
-0000d5c0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
-0000d5d0: 6365 6c6c 0d0a 2020 2020 2020 2020 2320  cell..        # 
-0000d5e0: 544f 444f 3a20 6f70 7469 6d69 7a65 2065  TODO: optimize e
-0000d5f0: 7865 6375 7469 6e67 2061 2066 756e 6374  xecuting a funct
-0000d600: 696f 6e20 6f76 6572 2061 2077 686f 6c65  ion over a whole
-0000d610: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
-0000d620: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
-0000d630: 656c 662e 726f 7773 293a 0d0a 2020 2020  elf.rows):..    
-0000d640: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-0000d650: 2072 616e 6765 2873 656c 662e 636f 6c75   range(self.colu
-0000d660: 6d6e 7329 3a0d 0a20 2020 2020 2020 2020  mns):..         
-0000d670: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
-0000d680: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
-0000d690: 6179 5b69 2c20 6a5d 2c20 6e6f 5f64 6174  ay[i, j], no_dat
-0000d6a0: 615f 7661 6c75 652c 2072 746f 6c3d 302e  a_value, rtol=0.
-0000d6b0: 3030 3129 3a0d 0a20 2020 2020 2020 2020  001):..         
-0000d6c0: 2020 2020 2020 2020 2020 206e 6577 5f61             new_a
-0000d6d0: 7272 6179 5b69 2c20 6a5d 203d 2066 756e  rray[i, j] = fun
-0000d6e0: 2873 7263 5f61 7272 6179 5b69 2c20 6a5d  (src_array[i, j]
-0000d6f0: 290d 0a0d 0a20 2020 2020 2020 2023 2063  )....        # c
-0000d700: 7265 6174 6520 7468 6520 6f75 7470 7574  reate the output
-0000d710: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
-0000d720: 2064 7374 203d 2044 6174 6173 6574 2e5f   dst = Dataset._
-0000d730: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
-0000d740: 7365 7428 0d0a 2020 2020 2020 2020 2020  set(..          
-0000d750: 2020 7365 6c66 2e63 6f6c 756d 6e73 2c20    self.columns, 
-0000d760: 7365 6c66 2e72 6f77 732c 2031 2c20 6474  self.rows, 1, dt
-0000d770: 7970 652c 2064 7269 7665 723d 224d 454d  ype, driver="MEM
-0000d780: 220d 0a20 2020 2020 2020 2029 0d0a 2020  "..        )..  
-0000d790: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
-0000d7a0: 6765 6f74 7261 6e73 666f 726d 0d0a 2020  geotransform..  
-0000d7b0: 2020 2020 2020 6473 742e 5365 7447 656f        dst.SetGeo
-0000d7c0: 5472 616e 7366 6f72 6d28 7365 6c66 2e67  Transform(self.g
-0000d7d0: 656f 7472 616e 7366 6f72 6d29 0d0a 2020  eotransform)..  
-0000d7e0: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
-0000d7f0: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
-0000d800: 2020 2020 6473 742e 5365 7450 726f 6a65      dst.SetProje
-0000d810: 6374 696f 6e28 7365 6c66 2e63 7273 290d  ction(self.crs).
-0000d820: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
-0000d830: 203d 2044 6174 6173 6574 2864 7374 290d   = Dataset(dst).
-0000d840: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
-0000d850: 2e5f 7365 745f 6e6f 5f64 6174 615f 7661  ._set_no_data_va
-0000d860: 6c75 6528 6e6f 5f64 6174 615f 7661 6c75  lue(no_data_valu
-0000d870: 653d 6e6f 5f64 6174 615f 7661 6c75 6529  e=no_data_value)
-0000d880: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
-0000d890: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
-0000d8a0: 6572 4261 6e64 2862 616e 6420 2b20 3129  erBand(band + 1)
-0000d8b0: 2e57 7269 7465 4172 7261 7928 6e65 775f  .WriteArray(new_
-0000d8c0: 6172 7261 7929 0d0a 0d0a 2020 2020 2020  array)....      
-0000d8d0: 2020 7265 7475 726e 2064 7374 5f6f 626a    return dst_obj
-0000d8e0: 0d0a 0d0a 2020 2020 6465 6620 6669 6c6c  ....    def fill
-0000d8f0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
-0000d900: 2076 616c 3a20 556e 696f 6e5b 666c 6f61   val: Union[floa
-0000d910: 742c 2069 6e74 5d2c 2064 7269 7665 723a  t, int], driver:
-0000d920: 2073 7472 203d 2022 4d45 4d22 2c20 7061   str = "MEM", pa
-0000d930: 7468 3a20 7374 7220 3d20 4e6f 6e65 0d0a  th: str = None..
-0000d940: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b4e      ) -> Union[N
-0000d950: 6f6e 652c 2067 6461 6c2e 4461 7461 7365  one, gdal.Datase
-0000d960: 745d 3a0d 0a20 2020 2020 2020 2022 2222  t]:..        """
-0000d970: 4669 6c6c 2e0d 0a0d 0a20 2020 2020 2020  Fill.....       
-0000d980: 2020 2020 2046 696c 6c20 7461 6b65 7320       Fill takes 
-0000d990: 6120 7261 7374 6572 2061 6e64 2066 696c  a raster and fil
-0000d9a0: 6c20 6974 2077 6974 6820 6f6e 6520 7661  l it with one va
-0000d9b0: 6c75 650d 0a0d 0a20 2020 2020 2020 2050  lue....        P
-0000d9c0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0000d9d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0000d9e0: 2020 2020 2020 2076 616c 3a20 5b6e 756d         val: [num
-0000d9f0: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
-0000da00: 2020 206e 756d 6572 6963 2076 616c 7565     numeric value
-0000da10: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
-0000da20: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-0000da30: 2020 2020 2064 7269 7665 7220 7479 7065       driver type
-0000da40: 205b 2247 5469 6666 222c 2022 4d45 4d22   ["GTiff", "MEM"
-0000da50: 5d0d 0a20 2020 2020 2020 2070 6174 6820  ]..        path 
-0000da60: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-0000da70: 2020 2020 2070 6174 6820 696e 636c 7564       path includ
-0000da80: 696e 6720 7468 6520 6578 7465 6e73 696f  ing the extensio
-0000da90: 6e20 282e 7469 6629 0d0a 0d0a 2020 2020  n (.tif)....    
-0000daa0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-0000dab0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-0000dac0: 2020 2020 2020 7261 7374 6572 203a 205b        raster : [
-0000dad0: 4e6f 6e65 2f67 6461 6c2e 4461 7461 6375  None/gdal.Datacu
-0000dae0: 6265 5d0d 0a20 2020 2020 2020 2020 2020  be]..           
-0000daf0: 2069 6620 7468 6520 7261 7374 6572 2069   if the raster i
-0000db00: 7320 7361 7665 6420 6469 7265 6374 6c79  s saved directly
-0000db10: 2074 6f20 7468 6520 7061 7468 2079 6f75   to the path you
-0000db20: 2070 726f 7669 6465 6420 7468 6520 7265   provided the re
-0000db30: 7475 726e 6564 2076 616c 7565 2077 696c  turned value wil
-0000db40: 6c20 6265 204e 6f6e 652c 206f 7468 6572  l be None, other
-0000db50: 7769 7365 2074 6865 0d0a 2020 2020 2020  wise the..      
-0000db60: 2020 2020 2020 7265 7475 726e 6564 2076        returned v
-0000db70: 616c 7565 2077 696c 6c20 6265 2074 6865  alue will be the
-0000db80: 2067 6461 6c2e 4461 7461 6375 6265 2069   gdal.Datacube i
-0000db90: 7473 656c 662e 0d0a 2020 2020 2020 2020  tself...        
-0000dba0: 2222 220d 0a20 2020 2020 2020 206e 6f5f  """..        no_
-0000dbb0: 6461 7461 5f76 616c 7565 203d 2073 656c  data_value = sel
-0000dbc0: 662e 6e6f 5f64 6174 615f 7661 6c75 655b  f.no_data_value[
-0000dbd0: 305d 0d0a 2020 2020 2020 2020 7372 635f  0]..        src_
-0000dbe0: 6172 7261 7920 3d20 7365 6c66 2e72 6173  array = self.ras
-0000dbf0: 7465 722e 5265 6164 4173 4172 7261 7928  ter.ReadAsArray(
-0000dc00: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-0000dc10: 6e6f 5f64 6174 615f 7661 6c75 6520 6973  no_data_value is
-0000dc20: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000dc30: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-0000dc40: 6520 3d20 6e70 2e6e 616e 0d0a 0d0a 2020  e = np.nan....  
-0000dc50: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
-0000dc60: 6973 6e61 6e28 6e6f 5f64 6174 615f 7661  isnan(no_data_va
-0000dc70: 6c75 6529 3a0d 0a20 2020 2020 2020 2020  lue):..         
-0000dc80: 2020 2073 7263 5f61 7272 6179 5b7e 6e70     src_array[~np
-0000dc90: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
-0000dca0: 6179 2c20 6e6f 5f64 6174 615f 7661 6c75  ay, no_data_valu
-0000dcb0: 652c 2072 746f 6c3d 302e 3030 3030 3031  e, rtol=0.000001
-0000dcc0: 295d 203d 2076 616c 0d0a 2020 2020 2020  )] = val..      
-0000dcd0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0000dce0: 2020 2020 2073 7263 5f61 7272 6179 5b7e       src_array[~
-0000dcf0: 6e70 2e69 736e 616e 2873 7263 5f61 7272  np.isnan(src_arr
-0000dd00: 6179 295d 203d 2076 616c 0d0a 2020 2020  ay)] = val..    
-0000dd10: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
-0000dd20: 742e 6461 7461 7365 745f 6c69 6b65 2873  t.dataset_like(s
-0000dd30: 656c 662c 2073 7263 5f61 7272 6179 2c20  elf, src_array, 
-0000dd40: 6472 6976 6572 3d64 7269 7665 722c 2070  driver=driver, p
-0000dd50: 6174 683d 7061 7468 290d 0a20 2020 2020  ath=path)..     
-0000dd60: 2020 2072 6574 7572 6e20 6473 740d 0a0d     return dst...
-0000dd70: 0a20 2020 2064 6566 2072 6573 616d 706c  .    def resampl
-0000dd80: 6528 7365 6c66 2c20 6365 6c6c 5f73 697a  e(self, cell_siz
-0000dd90: 653a 2055 6e69 6f6e 5b69 6e74 2c20 666c  e: Union[int, fl
-0000dda0: 6f61 745d 2c20 6d65 7468 6f64 3a20 7374  oat], method: st
-0000ddb0: 7220 3d20 226e 6561 7265 7374 206e 6569  r = "nearest nei
-0000ddc0: 626f 7572 2229 3a0d 0a20 2020 2020 2020  bour"):..       
-0000ddd0: 2022 2222 7265 7361 6d70 6c65 5261 7374   """resampleRast
-0000dde0: 6572 2e0d 0a0d 0a20 2020 2020 2020 2072  er.....        r
-0000ddf0: 6573 616d 706c 6520 6d65 7468 6f64 2072  esample method r
-0000de00: 6570 726f 6a65 6374 2061 2072 6173 7465  eproject a raste
-0000de10: 7220 746f 2061 6e79 2070 726f 6a65 6374  r to any project
-0000de20: 696f 6e0d 0a20 2020 2020 2020 2028 6465  ion..        (de
-0000de30: 6661 756c 7420 7468 6520 5747 5338 3420  fault the WGS84 
-0000de40: 7765 6220 6d65 7263 6174 6f72 2070 726f  web mercator pro
-0000de50: 6a65 6374 696f 6e2c 2077 6974 686f 7574  jection, without
-0000de60: 2072 6573 616d 706c 696e 6729 0d0a 2020   resampling)..  
-0000de70: 2020 2020 2020 5468 6520 6675 6e63 7469        The functi
-0000de80: 6f6e 2072 6574 7572 6e73 2061 2047 4441  on returns a GDA
-0000de90: 4c20 696e 2d6d 656d 6f72 7920 6669 6c65  L in-memory file
-0000dea0: 206f 626a 6563 742c 2077 6865 7265 2079   object, where y
-0000deb0: 6f75 2063 616e 2052 6561 6441 7341 7272  ou can ReadAsArr
-0000dec0: 6179 2065 7463 2e0d 0a0d 0a20 2020 2020  ay etc.....     
-0000ded0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0000dee0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000def0: 2d0d 0a20 2020 2020 2020 2063 656c 6c5f  -..        cell_
-0000df00: 7369 7a65 203a 205b 696e 7465 6765 725d  size : [integer]
-0000df10: 0d0a 2020 2020 2020 2020 2020 2020 206e  ..             n
-0000df20: 6577 2063 656c 6c20 7369 7a65 2074 6f20  ew cell size to 
-0000df30: 7265 7361 6d70 6c65 2074 6865 2072 6173  resample the ras
-0000df40: 7465 722e 0d0a 2020 2020 2020 2020 2020  ter...          
-0000df50: 2020 2864 6566 6175 6c74 2065 6d70 7479    (default empty
-0000df60: 2073 6f20 7261 7374 6572 2077 696c 6c20   so raster will 
-0000df70: 6e6f 7420 6265 2072 6573 616d 706c 6564  not be resampled
-0000df80: 290d 0a20 2020 2020 2020 206d 6574 686f  )..        metho
-0000df90: 6420 3a20 5b53 7472 696e 675d 0d0a 2020  d : [String]..  
-0000dfa0: 2020 2020 2020 2020 2020 7265 7361 6d70            resamp
-0000dfb0: 6c69 6e67 2074 6563 686e 6971 7565 2064  ling technique d
-0000dfc0: 6566 6175 6c74 2069 7320 224e 6561 7265  efault is "Neare
-0000dfd0: 7374 220d 0a20 2020 2020 2020 2020 2020  st"..           
-0000dfe0: 2068 7474 7073 3a2f 2f67 6973 6765 6f67   https://gisgeog
-0000dff0: 7261 7068 792e 636f 6d2f 7261 7374 6572  raphy.com/raster
-0000e000: 2d72 6573 616d 706c 696e 672f 0d0a 2020  -resampling/..  
-0000e010: 2020 2020 2020 2020 2020 226e 6561 7265            "neare
-0000e020: 7374 206e 6569 626f 7572 2220 666f 7220  st neibour" for 
-0000e030: 6e65 6172 6573 7420 6e65 6967 6862 6f75  nearest neighbou
-0000e040: 722c 2263 7562 6963 2220 666f 7220 6375  r,"cubic" for cu
-0000e050: 6269 6320 636f 6e76 6f6c 7574 696f 6e2c  bic convolution,
-0000e060: 0d0a 2020 2020 2020 2020 2020 2020 2262  ..            "b
-0000e070: 696c 696e 6561 7222 2066 6f72 2062 696c  ilinear" for bil
-0000e080: 696e 6561 720d 0a0d 0a20 2020 2020 2020  inear....       
-0000e090: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0000e0a0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000e0b0: 2020 2072 6173 7465 7220 3a20 5b67 6461     raster : [gda
-0000e0c0: 6c2e 4461 7461 6375 6265 5d0d 0a20 2020  l.Datacube]..   
-0000e0d0: 2020 2020 2020 2020 2020 6764 616c 206f            gdal o
-0000e0e0: 626a 6563 7420 2879 6f75 2063 616e 2072  bject (you can r
-0000e0f0: 6561 6420 6974 2062 7920 5265 6164 4173  ead it by ReadAs
-0000e100: 4172 7261 7929 0d0a 2020 2020 2020 2020  Array)..        
-0000e110: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
-0000e120: 6e6f 7420 6973 696e 7374 616e 6365 286d  not isinstance(m
-0000e130: 6574 686f 642c 2073 7472 293a 0d0a 2020  ethod, str):..  
-0000e140: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e150: 5479 7065 4572 726f 7228 0d0a 2020 2020  TypeError(..    
-0000e160: 2020 2020 2020 2020 2020 2020 2220 706c              " pl
-0000e170: 6561 7365 2065 6e74 6572 2063 6f72 7265  ease enter corre
-0000e180: 6374 206d 6574 686f 6420 6d6f 7265 2069  ct method more i
-0000e190: 6e66 6f72 6d61 7469 6f6e 2073 6565 2064  nformation see d
-0000e1a0: 6f63 6d65 6e74 6174 696f 6e20 220d 0a20  ocmentation ".. 
-0000e1b0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0000e1c0: 2020 2020 2020 6966 206d 6574 686f 6420        if method 
-0000e1d0: 6e6f 7420 696e 2049 4e54 4552 504f 4c41  not in INTERPOLA
-0000e1e0: 5449 4f4e 5f4d 4554 484f 4453 2e6b 6579  TION_METHODS.key
-0000e1f0: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
-0000e200: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0000e210: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-0000e220: 2020 2020 2066 2254 6865 2067 6976 656e       f"The given
-0000e230: 2069 6e74 6572 706f 6c61 7469 6f6e 206d   interpolation m
-0000e240: 6574 686f 6420 646f 6573 206e 6f74 2065  ethod does not e
-0000e250: 7869 7374 2c20 6578 6973 7469 6e67 206d  xist, existing m
-0000e260: 6574 686f 6473 2061 7265 207b 494e 5445  ethods are {INTE
-0000e270: 5250 4f4c 4154 494f 4e5f 4d45 5448 4f44  RPOLATION_METHOD
-0000e280: 532e 6b65 7973 2829 7d22 0d0a 2020 2020  S.keys()}"..    
-0000e290: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-0000e2a0: 2020 2020 206d 6574 686f 6420 3d20 494e       method = IN
-0000e2b0: 5445 5250 4f4c 4154 494f 4e5f 4d45 5448  TERPOLATION_METH
-0000e2c0: 4f44 532e 6765 7428 6d65 7468 6f64 290d  ODS.get(method).
-0000e2d0: 0a0d 0a20 2020 2020 2020 2073 725f 7372  ...        sr_sr
-0000e2e0: 6320 3d20 6f73 722e 5370 6174 6961 6c52  c = osr.SpatialR
-0000e2f0: 6566 6572 656e 6365 2877 6b74 3d73 656c  eference(wkt=sel
-0000e300: 662e 6372 7329 0d0a 0d0a 2020 2020 2020  f.crs)....      
-0000e310: 2020 756c 7820 3d20 7365 6c66 2e67 656f    ulx = self.geo
-0000e320: 7472 616e 7366 6f72 6d5b 305d 0d0a 2020  transform[0]..  
-0000e330: 2020 2020 2020 756c 7920 3d20 7365 6c66        uly = self
-0000e340: 2e67 656f 7472 616e 7366 6f72 6d5b 335d  .geotransform[3]
-0000e350: 0d0a 2020 2020 2020 2020 2320 7472 616e  ..        # tran
-0000e360: 7366 6f72 6d20 7468 6520 7269 6768 7420  sform the right 
-0000e370: 6c6f 7765 7220 636f 726e 6572 2070 6f69  lower corner poi
-0000e380: 6e74 0d0a 2020 2020 2020 2020 6c72 7820  nt..        lrx 
-0000e390: 3d20 7365 6c66 2e67 656f 7472 616e 7366  = self.geotransf
-0000e3a0: 6f72 6d5b 305d 202b 2073 656c 662e 6765  orm[0] + self.ge
-0000e3b0: 6f74 7261 6e73 666f 726d 5b31 5d20 2a20  otransform[1] * 
-0000e3c0: 7365 6c66 2e63 6f6c 756d 6e73 0d0a 2020  self.columns..  
-0000e3d0: 2020 2020 2020 6c72 7920 3d20 7365 6c66        lry = self
-0000e3e0: 2e67 656f 7472 616e 7366 6f72 6d5b 335d  .geotransform[3]
-0000e3f0: 202b 2073 656c 662e 6765 6f74 7261 6e73   + self.geotrans
-0000e400: 666f 726d 5b35 5d20 2a20 7365 6c66 2e72  form[5] * self.r
-0000e410: 6f77 730d 0a0d 0a20 2020 2020 2020 2070  ows....        p
-0000e420: 6978 656c 5f73 7061 6369 6e67 203d 2063  ixel_spacing = c
-0000e430: 656c 6c5f 7369 7a65 0d0a 2020 2020 2020  ell_size..      
-0000e440: 2020 2320 6e65 7720 6765 6f74 7261 6e73    # new geotrans
-0000e450: 666f 726d 0d0a 2020 2020 2020 2020 6e65  form..        ne
-0000e460: 775f 6765 6f20 3d20 280d 0a20 2020 2020  w_geo = (..     
-0000e470: 2020 2020 2020 2073 656c 662e 6765 6f74         self.geot
-0000e480: 7261 6e73 666f 726d 5b30 5d2c 0d0a 2020  ransform[0],..  
-0000e490: 2020 2020 2020 2020 2020 7069 7865 6c5f            pixel_
-0000e4a0: 7370 6163 696e 672c 0d0a 2020 2020 2020  spacing,..      
-0000e4b0: 2020 2020 2020 7365 6c66 2e67 656f 7472        self.geotr
-0000e4c0: 616e 7366 6f72 6d5b 325d 2c0d 0a20 2020  ansform[2],..   
-0000e4d0: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
-0000e4e0: 6f74 7261 6e73 666f 726d 5b33 5d2c 0d0a  otransform[3],..
-0000e4f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000e500: 2e67 656f 7472 616e 7366 6f72 6d5b 345d  .geotransform[4]
-0000e510: 2c0d 0a20 2020 2020 2020 2020 2020 202d  ,..            -
-0000e520: 3120 2a20 7069 7865 6c5f 7370 6163 696e  1 * pixel_spacin
-0000e530: 672c 0d0a 2020 2020 2020 2020 290d 0a20  g,..        ).. 
-0000e540: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
-0000e550: 6120 6e65 7720 7261 7374 6572 0d0a 2020  a new raster..  
-0000e560: 2020 2020 2020 636f 6c73 203d 2069 6e74        cols = int
-0000e570: 286e 702e 726f 756e 6428 6162 7328 6c72  (np.round(abs(lr
-0000e580: 7820 2d20 756c 7829 202f 2070 6978 656c  x - ulx) / pixel
-0000e590: 5f73 7061 6369 6e67 2929 0d0a 2020 2020  _spacing))..    
-0000e5a0: 2020 2020 726f 7773 203d 2069 6e74 286e      rows = int(n
-0000e5b0: 702e 726f 756e 6428 6162 7328 756c 7920  p.round(abs(uly 
-0000e5c0: 2d20 6c72 7929 202f 2070 6978 656c 5f73  - lry) / pixel_s
-0000e5d0: 7061 6369 6e67 2929 0d0a 2020 2020 2020  pacing))..      
-0000e5e0: 2020 6474 7970 6520 3d20 7365 6c66 2e72    dtype = self.r
-0000e5f0: 6173 7465 722e 4765 7452 6173 7465 7242  aster.GetRasterB
-0000e600: 616e 6428 3129 2e44 6174 6154 7970 650d  and(1).DataType.
-0000e610: 0a0d 0a20 2020 2020 2020 2064 7374 203d  ...        dst =
-0000e620: 2044 6174 6173 6574 2e5f 6372 6561 7465   Dataset._create
-0000e630: 5f67 6461 6c5f 6461 7461 7365 7428 636f  _gdal_dataset(co
-0000e640: 6c73 2c20 726f 7773 2c20 312c 2064 7479  ls, rows, 1, dty
-0000e650: 7065 290d 0a20 2020 2020 2020 2023 2073  pe)..        # s
-0000e660: 6574 2074 6865 2067 656f 7472 616e 7366  et the geotransf
-0000e670: 6f72 6d0d 0a20 2020 2020 2020 2064 7374  orm..        dst
-0000e680: 2e53 6574 4765 6f54 7261 6e73 666f 726d  .SetGeoTransform
-0000e690: 286e 6577 5f67 656f 290d 0a20 2020 2020  (new_geo)..     
-0000e6a0: 2020 2023 2073 6574 2074 6865 2070 726f     # set the pro
-0000e6b0: 6a65 6374 696f 6e0d 0a20 2020 2020 2020  jection..       
-0000e6c0: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
-0000e6d0: 6f6e 2873 725f 7372 632e 4578 706f 7274  on(sr_src.Export
-0000e6e0: 546f 576b 7428 2929 0d0a 2020 2020 2020  ToWkt())..      
-0000e6f0: 2020 6473 745f 6f62 6a20 3d20 4461 7461    dst_obj = Data
-0000e700: 7365 7428 6473 7429 0d0a 2020 2020 2020  set(dst)..      
-0000e710: 2020 2320 7365 7420 7468 6520 6e6f 2064    # set the no d
-0000e720: 6174 6120 7661 6c75 650d 0a20 2020 2020  ata value..     
-0000e730: 2020 206e 6f5f 6461 7461 5f76 616c 7565     no_data_value
-0000e740: 203d 2073 656c 662e 7261 7374 6572 2e47   = self.raster.G
-0000e750: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
-0000e760: 4765 744e 6f44 6174 6156 616c 7565 2829  GetNoDataValue()
-0000e770: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
-0000e780: 6a2e 5f73 6574 5f6e 6f5f 6461 7461 5f76  j._set_no_data_v
-0000e790: 616c 7565 286e 6f5f 6461 7461 5f76 616c  alue(no_data_val
-0000e7a0: 7565 290d 0a20 2020 2020 2020 2023 2070  ue)..        # p
-0000e7b0: 6572 666f 726d 2074 6865 2070 726f 6a65  erform the proje
-0000e7c0: 6374 696f 6e20 2620 7265 7361 6d70 6c69  ction & resampli
-0000e7d0: 6e67 0d0a 2020 2020 2020 2020 6764 616c  ng..        gdal
-0000e7e0: 2e52 6570 726f 6a65 6374 496d 6167 6528  .ReprojectImage(
-0000e7f0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0000e800: 6c66 2e72 6173 7465 722c 0d0a 2020 2020  lf.raster,..    
-0000e810: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
-0000e820: 7261 7374 6572 2c0d 0a20 2020 2020 2020  raster,..       
-0000e830: 2020 2020 2073 725f 7372 632e 4578 706f       sr_src.Expo
-0000e840: 7274 546f 576b 7428 292c 0d0a 2020 2020  rtToWkt(),..    
-0000e850: 2020 2020 2020 2020 7372 5f73 7263 2e45          sr_src.E
-0000e860: 7870 6f72 7454 6f57 6b74 2829 2c0d 0a20  xportToWkt(),.. 
-0000e870: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-0000e880: 642c 0d0a 2020 2020 2020 2020 290d 0a0d  d,..        )...
-0000e890: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e8a0: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
-0000e8b0: 6566 2074 6f5f 6372 7328 0d0a 2020 2020  ef to_crs(..    
-0000e8c0: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
-0000e8d0: 2020 2074 6f5f 6570 7367 3a20 696e 742c     to_epsg: int,
-0000e8e0: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
-0000e8f0: 3a20 7374 7220 3d20 226e 6561 7265 7374  : str = "nearest
-0000e900: 206e 6569 626f 7572 222c 0d0a 2020 2020   neibour",..    
-0000e910: 2020 2020 6d61 696e 7461 696e 5f61 6c69      maintain_ali
-0000e920: 6768 6d65 6e74 3a20 696e 7420 3d20 4661  ghment: int = Fa
-0000e930: 6c73 652c 0d0a 2020 2020 293a 0d0a 2020  lse,..    ):..  
-0000e940: 2020 2020 2020 2222 2274 6f5f 6570 7367        """to_epsg
-0000e950: 2e0d 0a0d 0a20 2020 2020 2020 2074 6f5f  .....        to_
-0000e960: 6570 7367 2072 6570 726f 6a65 6374 7320  epsg reprojects 
-0000e970: 6120 7261 7374 6572 2074 6f20 616e 7920  a raster to any 
-0000e980: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
-0000e990: 2020 2020 2864 6566 6175 6c74 2074 6865      (default the
-0000e9a0: 2057 4753 3834 2077 6562 206d 6572 6361   WGS84 web merca
-0000e9b0: 746f 7220 7072 6f6a 6563 7469 6f6e 2c20  tor projection, 
-0000e9c0: 7769 7468 6f75 7420 7265 7361 6d70 6c69  without resampli
-0000e9d0: 6e67 290d 0a0d 0a20 2020 2020 2020 2050  ng)....        P
-0000e9e0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0000e9f0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0000ea00: 2020 2020 2020 2074 6f5f 6570 7367 3a20         to_epsg: 
-0000ea10: 5b69 6e74 6567 6572 5d0d 0a20 2020 2020  [integer]..     
-0000ea20: 2020 2020 2020 2072 6566 6572 656e 6365         reference
-0000ea30: 206e 756d 6265 7220 746f 2074 6865 206e   number to the n
-0000ea40: 6577 2070 726f 6a65 6374 696f 6e20 2868  ew projection (h
-0000ea50: 7474 7073 3a2f 2f65 7073 672e 696f 2f29  ttps://epsg.io/)
-0000ea60: 0d0a 2020 2020 2020 2020 2020 2020 2864  ..            (d
-0000ea70: 6566 6175 6c74 2033 3835 3720 7468 6520  efault 3857 the 
-0000ea80: 7265 6665 7265 6e63 6520 6e6f 206f 6620  reference no of 
-0000ea90: 5747 5338 3420 7765 6220 6d65 7263 6174  WGS84 web mercat
-0000eaa0: 6f72 2029 0d0a 2020 2020 2020 2020 6d65  or )..        me
-0000eab0: 7468 6f64 3a20 5b53 7472 696e 675d 0d0a  thod: [String]..
-0000eac0: 2020 2020 2020 2020 2020 2020 7265 7361              resa
-0000ead0: 6d70 6c69 6e67 2074 6563 686e 6971 7565  mpling technique
-0000eae0: 2064 6566 6175 6c74 2069 7320 224e 6561   default is "Nea
-0000eaf0: 7265 7374 220d 0a20 2020 2020 2020 2020  rest"..         
-0000eb00: 2020 2068 7474 7073 3a2f 2f67 6973 6765     https://gisge
-0000eb10: 6f67 7261 7068 792e 636f 6d2f 7261 7374  ography.com/rast
-0000eb20: 6572 2d72 6573 616d 706c 696e 672f 0d0a  er-resampling/..
-0000eb30: 2020 2020 2020 2020 2020 2020 226e 6561              "nea
-0000eb40: 7265 7374 206e 6569 626f 7572 2220 666f  rest neibour" fo
-0000eb50: 7220 6e65 6172 6573 7420 6e65 6967 6862  r nearest neighb
-0000eb60: 6f75 722c 2263 7562 6963 2220 666f 7220  our,"cubic" for 
-0000eb70: 6375 6269 6320 636f 6e76 6f6c 7574 696f  cubic convolutio
-0000eb80: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
-0000eb90: 2262 696c 696e 6561 7222 2066 6f72 2062  "bilinear" for b
-0000eba0: 696c 696e 6561 720d 0a20 2020 2020 2020  ilinear..       
-0000ebb0: 206d 6169 6e74 6169 6e5f 616c 6967 686d   maintain_alighm
-0000ebc0: 656e 7420 3a20 5b62 6f6f 6c5d 0d0a 2020  ent : [bool]..  
-0000ebd0: 2020 2020 2020 2020 2020 5472 7565 2074            True t
-0000ebe0: 6f20 6d61 696e 7461 696e 2074 6865 206e  o maintain the n
-0000ebf0: 756d 6265 7220 6f66 2072 6f77 7320 616e  umber of rows an
-0000ec00: 6420 636f 6c75 6d6e 7320 6f66 2074 6865  d columns of the
-0000ec10: 2072 6173 7465 7220 7468 6520 7361 6d65   raster the same
-0000ec20: 2061 6674 6572 2072 6570 726f 6a65 6374   after reproject
-0000ec30: 696f 6e2e 2044 6566 6175 6c74 2069 7320  ion. Default is 
-0000ec40: 4661 6c73 652e 0d0a 0d0a 2020 2020 2020  False.....      
-0000ec50: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-0000ec60: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0000ec70: 2020 2020 7261 7374 6572 3a0d 0a20 2020      raster:..   
-0000ec80: 2020 2020 2020 2020 2067 6461 6c20 6461           gdal da
-0000ec90: 7461 7365 7420 2879 6f75 2063 616e 2072  taset (you can r
-0000eca0: 6561 6420 6974 2062 7920 5265 6164 4173  ead it by ReadAs
-0000ecb0: 4172 7261 7929 0d0a 0d0a 2020 2020 2020  Array)....      
-0000ecc0: 2020 4578 616d 706c 6573 0d0a 2020 2020    Examples..    
-0000ecd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
-0000ece0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2070        >>> from p
-0000ecf0: 7972 616d 6964 732e 6461 7461 7365 7420  yramids.dataset 
-0000ed00: 696d 706f 7274 2044 6174 6173 6574 0d0a  import Dataset..
-0000ed10: 2020 2020 2020 2020 3e3e 3e20 7372 6320          >>> src 
-0000ed20: 3d20 4461 7461 7365 742e 7265 6164 5f66  = Dataset.read_f
-0000ed30: 696c 6528 2270 6174 682f 7261 7374 6572  ile("path/raster
-0000ed40: 5f6e 616d 652e 7469 6622 290d 0a20 2020  _name.tif")..   
-0000ed50: 2020 2020 203e 3e3e 2070 726f 6a65 6374       >>> project
-0000ed60: 6564 5f72 6173 7465 7220 3d20 7372 632e  ed_raster = src.
-0000ed70: 746f 5f63 7273 2874 6f5f 6570 7367 3d33  to_crs(to_epsg=3
-0000ed80: 3835 3729 0d0a 2020 2020 2020 2020 2222  857)..        ""
-0000ed90: 220d 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
-0000eda0: 7420 6973 696e 7374 616e 6365 2874 6f5f  t isinstance(to_
-0000edb0: 6570 7367 2c20 696e 7429 3a0d 0a20 2020  epsg, int):..   
-0000edc0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0000edd0: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
-0000ede0: 2020 2020 2020 2020 2020 2022 706c 6561             "plea
-0000edf0: 7365 2065 6e74 6572 2063 6f72 7265 6374  se enter correct
-0000ee00: 2069 6e74 6567 6572 206e 756d 6265 7220   integer number 
-0000ee10: 666f 7220 746f 5f65 7073 6720 6d6f 7265  for to_epsg more
-0000ee20: 2069 6e66 6f72 6d61 7469 6f6e 2022 0d0a   information "..
-0000ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee40: 6622 6874 7470 733a 2f2f 6570 7367 2e69  f"https://epsg.i
-0000ee50: 6f2f 2c20 6769 7665 6e20 7b74 7970 6528  o/, given {type(
-0000ee60: 746f 5f65 7073 6729 7d22 0d0a 2020 2020  to_epsg)}"..    
-0000ee70: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-0000ee80: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0000ee90: 616e 6365 286d 6574 686f 642c 2073 7472  ance(method, str
-0000eea0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000eeb0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0000eec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000eed0: 2020 2270 6c65 6173 6520 656e 7465 7220    "please enter 
-0000eee0: 636f 7272 6563 7420 6d65 7468 6f64 206d  correct method m
-0000eef0: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
-0000ef00: 7365 6520 2220 2264 6f63 6d65 6e74 6174  see " "docmentat
-0000ef10: 696f 6e20 220d 0a20 2020 2020 2020 2020  ion "..         
-0000ef20: 2020 2029 0d0a 2020 2020 2020 2020 6966     )..        if
-0000ef30: 206d 6574 686f 6420 6e6f 7420 696e 2049   method not in I
-0000ef40: 4e54 4552 504f 4c41 5449 4f4e 5f4d 4554  NTERPOLATION_MET
-0000ef50: 484f 4453 2e6b 6579 7328 293a 0d0a 2020  HODS.keys():..  
-0000ef60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000ef70: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
-0000ef80: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
-0000ef90: 6865 2067 6976 656e 2069 6e74 6572 706f  he given interpo
-0000efa0: 6c61 7469 6f6e 206d 6574 686f 6420 646f  lation method do
-0000efb0: 6573 206e 6f74 2065 7869 7374 2c20 6578  es not exist, ex
-0000efc0: 6973 7469 6e67 206d 6574 686f 6473 2061  isting methods a
-0000efd0: 7265 207b 494e 5445 5250 4f4c 4154 494f  re {INTERPOLATIO
-0000efe0: 4e5f 4d45 5448 4f44 532e 6b65 7973 2829  N_METHODS.keys()
-0000eff0: 7d22 0d0a 2020 2020 2020 2020 2020 2020  }"..            
-0000f000: 290d 0a0d 0a20 2020 2020 2020 206d 6574  )....        met
-0000f010: 686f 6420 3d20 494e 5445 5250 4f4c 4154  hod = INTERPOLAT
-0000f020: 494f 4e5f 4d45 5448 4f44 532e 6765 7428  ION_METHODS.get(
-0000f030: 6d65 7468 6f64 290d 0a0d 0a20 2020 2020  method)....     
-0000f040: 2020 2069 6620 6d61 696e 7461 696e 5f61     if maintain_a
-0000f050: 6c69 6768 6d65 6e74 3a0d 0a20 2020 2020  lighment:..     
-0000f060: 2020 2020 2020 2064 7374 5f6f 626a 203d         dst_obj =
-0000f070: 2073 656c 662e 5f72 6570 726f 6a65 6374   self._reproject
-0000f080: 5f77 6974 685f 5265 7072 6f6a 6563 7449  _with_ReprojectI
-0000f090: 6d61 6765 2874 6f5f 6570 7367 2c20 6d65  mage(to_epsg, me
-0000f0a0: 7468 6f64 290d 0a20 2020 2020 2020 2065  thod)..        e
-0000f0b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0000f0c0: 2020 6473 7420 3d20 6764 616c 2e57 6172    dst = gdal.War
-0000f0d0: 7028 2222 2c20 7365 6c66 2e72 6173 7465  p("", self.raste
-0000f0e0: 722c 2064 7374 5352 533d 6622 4550 5347  r, dstSRS=f"EPSG
-0000f0f0: 3a7b 746f 5f65 7073 677d 222c 2066 6f72  :{to_epsg}", for
-0000f100: 6d61 743d 2256 5254 2229 0d0a 2020 2020  mat="VRT")..    
-0000f110: 2020 2020 2020 2020 6473 745f 6f62 6a20          dst_obj 
-0000f120: 3d20 4461 7461 7365 7428 6473 7429 0d0a  = Dataset(dst)..
-0000f130: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000f140: 2064 7374 5f6f 626a 0d0a 0d0a 2020 2020   dst_obj....    
-0000f150: 6465 6620 5f72 6570 726f 6a65 6374 5f77  def _reproject_w
-0000f160: 6974 685f 5265 7072 6f6a 6563 7449 6d61  ith_ReprojectIma
-0000f170: 6765 280d 0a20 2020 2020 2020 2073 656c  ge(..        sel
-0000f180: 662c 2074 6f5f 6570 7367 3a20 696e 742c  f, to_epsg: int,
-0000f190: 206d 6574 686f 643a 2073 7472 203d 2022   method: str = "
-0000f1a0: 6e65 6172 6573 7420 6e65 6962 6f75 7222  nearest neibour"
-0000f1b0: 0d0a 2020 2020 2920 2d3e 206f 626a 6563  ..    ) -> objec
-0000f1c0: 743a 0d0a 2020 2020 2020 2020 7372 635f  t:..        src_
-0000f1d0: 7072 6f6a 203d 2073 656c 662e 6372 730d  proj = self.crs.
-0000f1e0: 0a20 2020 2020 2020 2073 7263 5f67 7420  .        src_gt 
-0000f1f0: 3d20 7365 6c66 2e67 656f 7472 616e 7366  = self.geotransf
-0000f200: 6f72 6d0d 0a20 2020 2020 2020 2073 7263  orm..        src
-0000f210: 5f78 203d 2073 656c 662e 636f 6c75 6d6e  _x = self.column
-0000f220: 730d 0a20 2020 2020 2020 2073 7263 5f79  s..        src_y
-0000f230: 203d 2073 656c 662e 726f 7773 0d0a 0d0a   = self.rows....
-0000f240: 2020 2020 2020 2020 7372 635f 7372 203d          src_sr =
-0000f250: 206f 7372 2e53 7061 7469 616c 5265 6665   osr.SpatialRefe
-0000f260: 7265 6e63 6528 776b 743d 7372 635f 7072  rence(wkt=src_pr
-0000f270: 6f6a 290d 0a20 2020 2020 2020 2073 7263  oj)..        src
-0000f280: 5f65 7073 6720 3d20 7365 6c66 2e5f 6765  _epsg = self._ge
-0000f290: 745f 6570 7367 2829 0d0a 0d0a 2020 2020  t_epsg()....    
-0000f2a0: 2020 2020 2323 2320 6469 7374 696e 6174      ### distinat
-0000f2b0: 696f 6e20 7261 7374 6572 0d0a 2020 2020  ion raster..    
-0000f2c0: 2020 2020 2320 7370 6174 6961 6c20 7265      # spatial re
-0000f2d0: 660d 0a20 2020 2020 2020 2064 7374 5f73  f..        dst_s
-0000f2e0: 7220 3d20 7365 6c66 2e5f 6372 6561 7465  r = self._create
-0000f2f0: 5f73 725f 6672 6f6d 5f65 7073 6728 746f  _sr_from_epsg(to
-0000f300: 5f65 7073 6729 0d0a 0d0a 2020 2020 2020  _epsg)....      
-0000f310: 2020 2320 696e 2063 6173 6520 7468 6520    # in case the 
-0000f320: 736f 7572 6365 2063 7273 2069 7320 4743  source crs is GC
-0000f330: 5320 616e 6420 6c6f 6e67 6974 7564 6520  S and longitude 
-0000f340: 6973 2069 6e20 7468 6520 7765 7374 2068  is in the west h
-0000f350: 656d 6973 7068 6572 6520 6764 616c 0d0a  emisphere gdal..
-0000f360: 2020 2020 2020 2020 2320 7265 6164 7320          # reads 
-0000f370: 6c6f 6e67 6974 7564 6520 6672 6f6d 2030  longitude from 0
-0000f380: 2074 6f20 3336 3020 616e 6420 7472 616e   to 360 and tran
-0000f390: 7366 6f72 6d61 7469 6f6e 2066 6163 746f  sformation facto
-0000f3a0: 7220 776f 6e74 2077 6f72 6b20 7769 7468  r wont work with
-0000f3b0: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
-0000f3c0: 2023 2067 7265 6174 6572 2074 6861 6e20   # greater than 
-0000f3d0: 3138 300d 0a20 2020 2020 2020 2069 6620  180..        if 
-0000f3e0: 7372 635f 6570 7367 2021 3d20 746f 5f65  src_epsg != to_e
-0000f3f0: 7073 673a 0d0a 2020 2020 2020 2020 2020  psg:..          
-0000f400: 2020 6966 2073 7263 5f65 7073 6720 3d3d    if src_epsg ==
-0000f410: 2022 3433 3236 2220 616e 6420 7372 635f   "4326" and src_
-0000f420: 6774 5b30 5d20 3e20 3138 303a 0d0a 2020  gt[0] > 180:..  
-0000f430: 2020 2020 2020 2020 2020 2020 2020 6c6e                ln
-0000f440: 675f 6e65 7720 3d20 7372 635f 6774 5b30  g_new = src_gt[0
-0000f450: 5d20 2d20 3336 300d 0a20 2020 2020 2020  ] - 360..       
-0000f460: 2020 2020 2020 2020 2023 2074 7261 6e73           # trans
-0000f470: 666f 726d 6174 696f 6e20 6661 6374 6f72  formation factor
-0000f480: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000f490: 2020 2074 7820 3d20 6f73 722e 436f 6f72     tx = osr.Coor
-0000f4a0: 6469 6e61 7465 5472 616e 7366 6f72 6d61  dinateTransforma
-0000f4b0: 7469 6f6e 2873 7263 5f73 722c 2064 7374  tion(src_sr, dst
-0000f4c0: 5f73 7229 0d0a 2020 2020 2020 2020 2020  _sr)..          
-0000f4d0: 2020 2020 2020 2320 7472 616e 7366 6f72        # transfor
-0000f4e0: 6d20 7468 6520 7269 6768 7420 7570 7065  m the right uppe
-0000f4f0: 7220 636f 726e 6572 2070 6f69 6e74 0d0a  r corner point..
-0000f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f510: 2875 6c78 2c20 756c 792c 2075 6c7a 2920  (ulx, uly, ulz) 
-0000f520: 3d20 7478 2e54 7261 6e73 666f 726d 506f  = tx.TransformPo
-0000f530: 696e 7428 6c6e 675f 6e65 772c 2073 7263  int(lng_new, src
-0000f540: 5f67 745b 335d 290d 0a20 2020 2020 2020  _gt[3])..       
-0000f550: 2020 2020 2020 2020 2023 2074 7261 6e73           # trans
-0000f560: 666f 726d 2074 6865 2072 6967 6874 206c  form the right l
-0000f570: 6f77 6572 2063 6f72 6e65 7220 706f 696e  ower corner poin
-0000f580: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
-0000f590: 2020 2028 6c72 782c 206c 7279 2c20 6c72     (lrx, lry, lr
-0000f5a0: 7a29 203d 2074 782e 5472 616e 7366 6f72  z) = tx.Transfor
-0000f5b0: 6d50 6f69 6e74 280d 0a20 2020 2020 2020  mPoint(..       
-0000f5c0: 2020 2020 2020 2020 2020 2020 206c 6e67               lng
-0000f5d0: 5f6e 6577 202b 2073 7263 5f67 745b 315d  _new + src_gt[1]
-0000f5e0: 202a 2073 7263 5f78 2c20 7372 635f 6774   * src_x, src_gt
-0000f5f0: 5b33 5d20 2b20 7372 635f 6774 5b35 5d20  [3] + src_gt[5] 
-0000f600: 2a20 7372 635f 790d 0a20 2020 2020 2020  * src_y..       
-0000f610: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-0000f620: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0000f630: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-0000f640: 7320 3d20 5b73 7263 5f67 745b 305d 2c20  s = [src_gt[0], 
-0000f650: 7372 635f 6774 5b30 5d20 2b20 7372 635f  src_gt[0] + src_
-0000f660: 6774 5b31 5d20 2a20 7372 635f 785d 0d0a  gt[1] * src_x]..
-0000f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f680: 7973 203d 205b 7372 635f 6774 5b33 5d2c  ys = [src_gt[3],
-0000f690: 2073 7263 5f67 745b 335d 202b 2073 7263   src_gt[3] + src
-0000f6a0: 5f67 745b 355d 202a 2073 7263 5f79 5d0d  _gt[5] * src_y].
-0000f6b0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0000f6c0: 2020 205b 756c 792c 206c 7279 5d2c 205b     [uly, lry], [
-0000f6d0: 756c 782c 206c 7278 5d20 3d20 4665 6174  ulx, lrx] = Feat
-0000f6e0: 7572 6543 6f6c 6c65 6374 696f 6e2e 7265  ureCollection.re
-0000f6f0: 7072 6f6a 6563 745f 706f 696e 7473 280d  project_points(.
-0000f700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f710: 2020 2020 2079 732c 2078 732c 2066 726f       ys, xs, fro
-0000f720: 6d5f 6570 7367 3d73 7263 5f65 7073 672c  m_epsg=src_epsg,
-0000f730: 2074 6f5f 6570 7367 3d74 6f5f 6570 7367   to_epsg=to_epsg
-0000f740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f750: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-0000f760: 2020 2020 2023 206f 6c64 2074 7261 6e73       # old trans
-0000f770: 666f 726d 0d0a 2020 2020 2020 2020 2020  form..          
-0000f780: 2020 2020 2020 2320 2320 7472 616e 7366        # # transf
-0000f790: 6f72 6d20 7468 6520 7269 6768 7420 7570  orm the right up
-0000f7a0: 7065 7220 636f 726e 6572 2070 6f69 6e74  per corner point
-0000f7b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f7c0: 2020 2320 2875 6c78 2c20 756c 792c 2075    # (ulx, uly, u
-0000f7d0: 6c7a 2920 3d20 7478 2e54 7261 6e73 666f  lz) = tx.Transfo
-0000f7e0: 726d 506f 696e 7428 7372 635f 6774 5b30  rmPoint(src_gt[0
-0000f7f0: 5d2c 2073 7263 5f67 745b 335d 290d 0a20  ], src_gt[3]).. 
-0000f800: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000f810: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
-0000f820: 2072 6967 6874 206c 6f77 6572 2063 6f72   right lower cor
-0000f830: 6e65 7220 706f 696e 740d 0a20 2020 2020  ner point..     
-0000f840: 2020 2020 2020 2020 2020 2023 2028 6c72             # (lr
-0000f850: 782c 206c 7279 2c20 6c72 7a29 203d 2074  x, lry, lrz) = t
-0000f860: 782e 5472 616e 7366 6f72 6d50 6f69 6e74  x.TransformPoint
-0000f870: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000f880: 2020 2023 2020 2020 2073 7263 5f67 745b     #     src_gt[
-0000f890: 305d 202b 2073 7263 5f67 745b 315d 202a  0] + src_gt[1] *
-0000f8a0: 2073 7263 5f78 2c20 7372 635f 6774 5b33   src_x, src_gt[3
-0000f8b0: 5d20 2b20 7372 635f 6774 5b35 5d20 2a20  ] + src_gt[5] * 
-0000f8c0: 7372 635f 790d 0a20 2020 2020 2020 2020  src_y..         
-0000f8d0: 2020 2020 2020 2023 2029 0d0a 0d0a 2020         # )....  
-0000f8e0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0000f8f0: 2020 2020 2020 2020 2075 6c78 203d 2073           ulx = s
-0000f900: 7263 5f67 745b 305d 0d0a 2020 2020 2020  rc_gt[0]..      
-0000f910: 2020 2020 2020 756c 7920 3d20 7372 635f        uly = src_
-0000f920: 6774 5b33 5d0d 0a20 2020 2020 2020 2020  gt[3]..         
-0000f930: 2020 206c 7278 203d 2073 7263 5f67 745b     lrx = src_gt[
-0000f940: 305d 202b 2073 7263 5f67 745b 315d 202a  0] + src_gt[1] *
-0000f950: 2073 7263 5f78 0d0a 2020 2020 2020 2020   src_x..        
-0000f960: 2020 2020 6c72 7920 3d20 7372 635f 6774      lry = src_gt
-0000f970: 5b33 5d20 2b20 7372 635f 6774 5b35 5d20  [3] + src_gt[5] 
-0000f980: 2a20 7372 635f 790d 0a0d 0a20 2020 2020  * src_y....     
-0000f990: 2020 2023 2067 6574 2074 6865 2063 656c     # get the cel
-0000f9a0: 6c20 7369 7a65 2069 6e20 7468 6520 736f  l size in the so
-0000f9b0: 7572 6365 2072 6173 7465 7220 616e 6420  urce raster and 
-0000f9c0: 636f 6e76 6572 7420 6974 2074 6f20 7468  convert it to th
-0000f9d0: 6520 6e65 7720 6372 730d 0a20 2020 2020  e new crs..     
-0000f9e0: 2020 2023 2078 2063 6f6f 7264 696e 6174     # x coordinat
-0000f9f0: 6573 206f 7220 6c6f 6e67 6974 7564 6573  es or longitudes
-0000fa00: 0d0a 2020 2020 2020 2020 7873 203d 205b  ..        xs = [
-0000fa10: 7372 635f 6774 5b30 5d2c 2073 7263 5f67  src_gt[0], src_g
-0000fa20: 745b 305d 202b 2073 7263 5f67 745b 315d  t[0] + src_gt[1]
-0000fa30: 5d0d 0a20 2020 2020 2020 2023 2079 2063  ]..        # y c
-0000fa40: 6f6f 7264 696e 6174 6573 206f 7220 6c61  oordinates or la
-0000fa50: 7469 7475 6465 730d 0a20 2020 2020 2020  titudes..       
-0000fa60: 2079 7320 3d20 5b73 7263 5f67 745b 335d   ys = [src_gt[3]
-0000fa70: 2c20 7372 635f 6774 5b33 5d5d 0d0a 0d0a  , src_gt[3]]....
-0000fa80: 2020 2020 2020 2020 6966 2073 7263 5f65          if src_e
-0000fa90: 7073 6720 213d 2074 6f5f 6570 7367 3a0d  psg != to_epsg:.
-0000faa0: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-0000fab0: 7261 6e73 666f 726d 2074 6865 2074 776f  ransform the two
-0000fac0: 2070 6f69 6e74 7320 636f 6f72 6469 6e61   points coordina
-0000fad0: 7465 7320 746f 2074 6865 206e 6577 2063  tes to the new c
-0000fae0: 7273 2074 6f20 6361 6c63 756c 6174 6520  rs to calculate 
-0000faf0: 7468 6520 6e65 7720 6365 6c6c 2073 697a  the new cell siz
-0000fb00: 650d 0a20 2020 2020 2020 2020 2020 206e  e..            n
-0000fb10: 6577 5f79 732c 206e 6577 5f78 7320 3d20  ew_ys, new_xs = 
-0000fb20: 4665 6174 7572 6543 6f6c 6c65 6374 696f  FeatureCollectio
-0000fb30: 6e2e 7265 7072 6f6a 6563 745f 706f 696e  n.reproject_poin
-0000fb40: 7473 280d 0a20 2020 2020 2020 2020 2020  ts(..           
-0000fb50: 2020 2020 2079 732c 2078 732c 2066 726f       ys, xs, fro
-0000fb60: 6d5f 6570 7367 3d73 7263 5f65 7073 672c  m_epsg=src_epsg,
-0000fb70: 2074 6f5f 6570 7367 3d74 6f5f 6570 7367   to_epsg=to_epsg
-0000fb80: 2c20 7072 6563 6973 696f 6e3d 360d 0a20  , precision=6.. 
-0000fb90: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0000fba0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0000fbb0: 2020 2020 2020 2020 206e 6577 5f78 7320           new_xs 
-0000fbc0: 3d20 7873 0d0a 2020 2020 2020 2020 2020  = xs..          
-0000fbd0: 2020 2320 6e65 775f 7973 203d 2079 730d    # new_ys = ys.
-0000fbe0: 0a0d 0a20 2020 2020 2020 2070 6978 656c  ...        pixel
-0000fbf0: 5f73 7061 6369 6e67 203d 206e 702e 6162  _spacing = np.ab
-0000fc00: 7328 6e65 775f 7873 5b30 5d20 2d20 6e65  s(new_xs[0] - ne
-0000fc10: 775f 7873 5b31 5d29 0d0a 0d0a 2020 2020  w_xs[1])....    
-0000fc20: 2020 2020 2320 6372 6561 7465 2061 206e      # create a n
-0000fc30: 6577 2072 6173 7465 720d 0a20 2020 2020  ew raster..     
-0000fc40: 2020 2063 6f6c 7320 3d20 696e 7428 6e70     cols = int(np
-0000fc50: 2e72 6f75 6e64 2861 6273 286c 7278 202d  .round(abs(lrx -
-0000fc60: 2075 6c78 2920 2f20 7069 7865 6c5f 7370   ulx) / pixel_sp
-0000fc70: 6163 696e 6729 290d 0a20 2020 2020 2020  acing))..       
-0000fc80: 2072 6f77 7320 3d20 696e 7428 6e70 2e72   rows = int(np.r
-0000fc90: 6f75 6e64 2861 6273 2875 6c79 202d 206c  ound(abs(uly - l
-0000fca0: 7279 2920 2f20 7069 7865 6c5f 7370 6163  ry) / pixel_spac
-0000fcb0: 696e 6729 290d 0a0d 0a20 2020 2020 2020  ing))....       
-0000fcc0: 2064 7479 7065 203d 2073 656c 662e 6474   dtype = self.dt
-0000fcd0: 7970 655b 305d 0d0a 2020 2020 2020 2020  ype[0]..        
-0000fce0: 6473 7420 3d20 4461 7461 7365 742e 5f63  dst = Dataset._c
-0000fcf0: 7265 6174 655f 6764 616c 5f64 6174 6173  reate_gdal_datas
-0000fd00: 6574 2863 6f6c 732c 2072 6f77 732c 2031  et(cols, rows, 1
-0000fd10: 2c20 6474 7970 6529 0d0a 0d0a 2020 2020  , dtype)....    
-0000fd20: 2020 2020 2320 6e65 7720 6765 6f74 7261      # new geotra
-0000fd30: 6e73 666f 726d 0d0a 2020 2020 2020 2020  nsform..        
-0000fd40: 6e65 775f 6765 6f20 3d20 280d 0a20 2020  new_geo = (..   
-0000fd50: 2020 2020 2020 2020 2075 6c78 2c0d 0a20           ulx,.. 
-0000fd60: 2020 2020 2020 2020 2020 2070 6978 656c             pixel
-0000fd70: 5f73 7061 6369 6e67 2c0d 0a20 2020 2020  _spacing,..     
-0000fd80: 2020 2020 2020 2073 7263 5f67 745b 325d         src_gt[2]
-0000fd90: 2c0d 0a20 2020 2020 2020 2020 2020 2075  ,..            u
-0000fda0: 6c79 2c0d 0a20 2020 2020 2020 2020 2020  ly,..           
-0000fdb0: 2073 7263 5f67 745b 345d 2c0d 0a20 2020   src_gt[4],..   
-0000fdc0: 2020 2020 2020 2020 206e 702e 7369 676e           np.sign
-0000fdd0: 2873 7263 5f67 745b 2d31 5d29 202a 2070  (src_gt[-1]) * p
-0000fde0: 6978 656c 5f73 7061 6369 6e67 2c0d 0a20  ixel_spacing,.. 
-0000fdf0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-0000fe00: 2020 2320 7365 7420 7468 6520 6765 6f74    # set the geot
-0000fe10: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
-0000fe20: 2020 6473 742e 5365 7447 656f 5472 616e    dst.SetGeoTran
-0000fe30: 7366 6f72 6d28 6e65 775f 6765 6f29 0d0a  sform(new_geo)..
-0000fe40: 2020 2020 2020 2020 2320 7365 7420 7468          # set th
-0000fe50: 6520 7072 6f6a 6563 7469 6f6e 0d0a 2020  e projection..  
-0000fe60: 2020 2020 2020 6473 742e 5365 7450 726f        dst.SetPro
-0000fe70: 6a65 6374 696f 6e28 6473 745f 7372 2e45  jection(dst_sr.E
-0000fe80: 7870 6f72 7454 6f57 6b74 2829 290d 0a20  xportToWkt()).. 
-0000fe90: 2020 2020 2020 2023 2073 6574 2074 6865         # set the
-0000fea0: 206e 6f20 6461 7461 2076 616c 7565 0d0a   no data value..
-0000feb0: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
-0000fec0: 7661 6c75 6520 3d20 7365 6c66 2e72 6173  value = self.ras
-0000fed0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-0000fee0: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
-0000fef0: 6c75 6528 290d 0a20 2020 2020 2020 2064  lue()..        d
-0000ff00: 7374 5f6f 626a 203d 2044 6174 6173 6574  st_obj = Dataset
-0000ff10: 2864 7374 290d 0a20 2020 2020 2020 2064  (dst)..        d
-0000ff20: 7374 5f6f 626a 2e5f 7365 745f 6e6f 5f64  st_obj._set_no_d
-0000ff30: 6174 615f 7661 6c75 6528 6e6f 5f64 6174  ata_value(no_dat
-0000ff40: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
-0000ff50: 2020 2320 7065 7266 6f72 6d20 7468 6520    # perform the 
-0000ff60: 7072 6f6a 6563 7469 6f6e 2026 2072 6573  projection & res
-0000ff70: 616d 706c 696e 670d 0a20 2020 2020 2020  ampling..       
-0000ff80: 2067 6461 6c2e 5265 7072 6f6a 6563 7449   gdal.ReprojectI
-0000ff90: 6d61 6765 280d 0a20 2020 2020 2020 2020  mage(..         
-0000ffa0: 2020 2073 656c 662e 7261 7374 6572 2c0d     self.raster,.
-0000ffb0: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
-0000ffc0: 5f6f 626a 2e72 6173 7465 722c 0d0a 2020  _obj.raster,..  
-0000ffd0: 2020 2020 2020 2020 2020 7372 635f 7372            src_sr
-0000ffe0: 2e45 7870 6f72 7454 6f57 6b74 2829 2c0d  .ExportToWkt(),.
-0000fff0: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
-00010000: 5f73 722e 4578 706f 7274 546f 576b 7428  _sr.ExportToWkt(
-00010010: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00010020: 6d65 7468 6f64 2c0d 0a20 2020 2020 2020  method,..       
-00010030: 2029 0d0a 2020 2020 2020 2020 7265 7475   )..        retu
-00010040: 726e 2064 7374 5f6f 626a 0d0a 0d0a 2020  rn dst_obj....  
-00010050: 2020 6465 6620 5f63 726f 705f 616c 6c69    def _crop_alli
-00010060: 676e 6564 280d 0a20 2020 2020 2020 2073  gned(..        s
-00010070: 656c 662c 0d0a 2020 2020 2020 2020 6d61  elf,..        ma
-00010080: 736b 3a20 556e 696f 6e5b 6764 616c 2e44  sk: Union[gdal.D
-00010090: 6174 6173 6574 2c20 6e70 2e6e 6461 7272  ataset, np.ndarr
-000100a0: 6179 5d2c 0d0a 2020 2020 2020 2020 6d61  ay],..        ma
-000100b0: 736b 5f6e 6f76 616c 3a20 556e 696f 6e5b  sk_noval: Union[
-000100c0: 696e 742c 2066 6c6f 6174 5d20 3d20 4e6f  int, float] = No
-000100d0: 6e65 2c0d 0a20 2020 2020 2020 2062 616e  ne,..        ban
-000100e0: 643a 2069 6e74 203d 2031 2c0d 0a20 2020  d: int = 1,..   
-000100f0: 2029 202d 3e20 556e 696f 6e5b 6e70 2e6e   ) -> Union[np.n
-00010100: 6461 7272 6179 2c20 6764 616c 2e44 6174  darray, gdal.Dat
-00010110: 6173 6574 5d3a 0d0a 2020 2020 2020 2020  aset]:..        
-00010120: 2222 2263 726f 7041 6c6c 6967 6e65 642e  """cropAlligned.
-00010130: 0d0a 0d0a 2020 2020 2020 2020 6372 6f70  ....        crop
-00010140: 416c 6c69 676e 6564 2063 6c69 702f 6372  Alligned clip/cr
-00010150: 6f70 2028 6d61 7463 6865 7320 7468 6520  op (matches the 
-00010160: 6c6f 6361 7469 6f6e 206f 6620 6e6f 6461  location of noda
-00010170: 7461 2076 616c 7565 2066 726f 6d20 6d61  ta value from ma
-00010180: 736b 2074 6f20 7372 630d 0a20 2020 2020  sk to src..     
-00010190: 2020 2072 6173 7465 7229 2c0d 0a20 2020     raster),..   
-000101a0: 2020 2020 2020 2020 202d 2042 6f74 6820           - Both 
-000101b0: 7261 7374 6572 7320 6861 7665 2074 6f20  rasters have to 
-000101c0: 6861 7665 2074 6865 2073 616d 6520 6469  have the same di
-000101d0: 6d65 6e73 696f 6e73 2028 6e6f 206f 6620  mensions (no of 
-000101e0: 726f 7773 2026 2063 6f6c 756d 6e73 290d  rows & columns).
-000101f0: 0a20 2020 2020 2020 2020 2020 2073 6f20  .            so 
-00010200: 4d61 7463 6852 6173 7465 7241 6c69 676e  MatchRasterAlign
-00010210: 6d65 6e74 2073 686f 756c 6420 6265 2075  ment should be u
-00010220: 7365 6420 7072 696f 7220 746f 2074 6869  sed prior to thi
-00010230: 7320 6675 6e63 7469 6f6e 2074 6f20 616c  s function to al
-00010240: 6967 6e20 626f 7468 0d0a 2020 2020 2020  ign both..      
-00010250: 2020 2020 2020 7261 7374 6572 730d 0a0d        rasters...
-00010260: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00010270: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00010280: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00010290: 2054 4f44 4f3a 2074 6865 206f 7269 6967   TODO: the oriig
-000102a0: 696e 616c 2066 756e 6374 696f 6e20 6861  inal function ha
-000102b0: 6420 7468 6520 6162 696c 6974 7920 746f  d the ability to
-000102c0: 2063 726f 7020 616e 2061 7272 6179 2077   crop an array w
-000102d0: 6974 6820 6120 6461 7461 7365 7420 6f62  ith a dataset ob
-000102e0: 6a65 6374 2061 6e64 2074 6865 206f 7070  ject and the opp
-000102f0: 6f73 6974 650d 0a20 2020 2020 2020 2073  osite..        s
-00010300: 7263 3a20 5b67 6461 6c2e 6461 7461 7365  rc: [gdal.datase
-00010310: 742f 6e70 2e6e 6461 7272 6179 5d0d 0a20  t/np.ndarray].. 
-00010320: 2020 2020 2020 2020 2020 2072 6173 7465             raste
-00010330: 7220 796f 7520 7761 6e74 2074 6f20 636c  r you want to cl
-00010340: 6970 2f73 746f 7265 204e 6f44 6174 6156  ip/store NoDataV
-00010350: 616c 7565 2069 6e20 6974 7320 6365 6c6c  alue in its cell
-00010360: 730d 0a20 2020 2020 2020 2020 2020 2065  s..            e
-00010370: 7861 6374 6c79 2074 6865 2073 616d 6520  xactly the same 
-00010380: 6c69 6b65 206d 6173 6b20 7261 7374 6572  like mask raster
-00010390: 0d0a 2020 2020 2020 2020 6d61 736b 3a20  ..        mask: 
-000103a0: 5b67 6461 6c2e 6461 7461 7365 742f 6e70  [gdal.dataset/np
-000103b0: 2e6e 6461 7272 6179 5d0d 0a20 2020 2020  .ndarray]..     
-000103c0: 2020 2020 2020 206d 6173 6b20 7261 7374         mask rast
-000103d0: 6572 2074 6f20 6765 7420 7468 6520 6c6f  er to get the lo
-000103e0: 6361 7469 6f6e 206f 6620 7468 6520 4e6f  cation of the No
-000103f0: 4461 7461 5661 6c75 6520 616e 640d 0a20  DataValue and.. 
-00010400: 2020 2020 2020 2020 2020 2077 6865 7265             where
-00010410: 2069 7420 6973 2069 6e20 7468 6520 6172   it is in the ar
-00010420: 7261 790d 0a20 2020 2020 2020 206d 6173  ray..        mas
-00010430: 6b5f 6e6f 7661 6c3a 205b 6e75 6d65 7269  k_noval: [numeri
-00010440: 635d 0d0a 2020 2020 2020 2020 2020 2020  c]..            
-00010450: 696e 2063 6173 6520 7468 6520 6d61 736b  in case the mask
-00010460: 2069 7320 6e70 2e6e 6461 7272 6179 2c20   is np.ndarray, 
-00010470: 7468 6520 6d61 736b 5f6e 6f76 616c 2068  the mask_noval h
-00010480: 6176 6520 746f 2062 6520 6769 7665 6e2e  ave to be given.
-00010490: 0d0a 2020 2020 2020 2020 6261 6e64 3a20  ..        band: 
-000104a0: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
-000104b0: 2020 2062 616e 6420 696e 6465 782c 2073     band index, s
-000104c0: 7461 7274 7320 6672 6f6d 2031 2074 6f20  tarts from 1 to 
-000104d0: 7468 6520 6e75 6d62 6572 206f 6620 6261  the number of ba
-000104e0: 6e64 732e 0d0a 0d0a 2020 2020 2020 2020  nds.....        
-000104f0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00010500: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-00010510: 2020 6473 743a 205b 6764 616c 2e64 6174    dst: [gdal.dat
-00010520: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
-00010530: 2020 2074 6865 2073 6563 6f6e 6420 7261     the second ra
-00010540: 7374 6572 2077 6974 6820 4e6f 4461 7461  ster with NoData
-00010550: 5661 6c75 6520 7374 6f72 6564 2069 6e20  Value stored in 
-00010560: 6974 7320 6365 6c6c 730d 0a20 2020 2020  its cells..     
-00010570: 2020 2020 2020 2065 7861 6374 6c79 2074         exactly t
-00010580: 6865 2073 616d 6520 6c69 6b65 2073 7263  he same like src
-00010590: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
-000105a0: 2022 2222 0d0a 2020 2020 2020 2020 2320   """..        # 
-000105b0: 6368 6563 6b20 7468 6520 6d61 736b 0d0a  check the mask..
-000105c0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000105d0: 7461 6e63 6528 6d61 736b 2c20 4461 7461  tance(mask, Data
-000105e0: 7365 7429 3a0d 0a20 2020 2020 2020 2020  set):..         
-000105f0: 2020 206d 6173 6b5f 6774 203d 206d 6173     mask_gt = mas
-00010600: 6b2e 6765 6f74 7261 6e73 666f 726d 0d0a  k.geotransform..
-00010610: 2020 2020 2020 2020 2020 2020 2320 6d61              # ma
-00010620: 736b 5f70 726f 6a20 3d20 6d61 736b 2e70  sk_proj = mask.p
-00010630: 726f 6a0d 0a20 2020 2020 2020 2020 2020  roj..           
-00010640: 2023 206d 6173 6b5f 7372 6566 203d 206f   # mask_sref = o
-00010650: 7372 2e53 7061 7469 616c 5265 6665 7265  sr.SpatialRefere
-00010660: 6e63 6528 776b 743d 6d61 736b 5f70 726f  nce(wkt=mask_pro
-00010670: 6a29 0d0a 2020 2020 2020 2020 2020 2020  j)..            
-00010680: 6d61 736b 5f65 7073 6720 3d20 6d61 736b  mask_epsg = mask
-00010690: 2e65 7073 670d 0a20 2020 2020 2020 2020  .epsg..         
-000106a0: 2020 2072 6f77 203d 206d 6173 6b2e 726f     row = mask.ro
-000106b0: 7773 0d0a 2020 2020 2020 2020 2020 2020  ws..            
-000106c0: 636f 6c20 3d20 6d61 736b 2e63 6f6c 756d  col = mask.colum
-000106d0: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
-000106e0: 6d61 736b 5f6e 6f76 616c 203d 206d 6173  mask_noval = mas
-000106f0: 6b2e 6e6f 5f64 6174 615f 7661 6c75 655b  k.no_data_value[
-00010700: 6261 6e64 202d 2031 5d0d 0a20 2020 2020  band - 1]..     
-00010710: 2020 2020 2020 206d 6173 6b5f 6172 7261         mask_arra
-00010720: 7920 3d20 6d61 736b 2e72 6173 7465 722e  y = mask.raster.
-00010730: 5265 6164 4173 4172 7261 7928 290d 0a20  ReadAsArray().. 
-00010740: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00010750: 7374 616e 6365 286d 6173 6b2c 206e 702e  stance(mask, np.
-00010760: 6e64 6172 7261 7929 3a0d 0a20 2020 2020  ndarray):..     
-00010770: 2020 2020 2020 2069 6620 6d61 736b 5f6e         if mask_n
-00010780: 6f76 616c 2069 7320 4e6f 6e65 3a0d 0a20  oval is None:.. 
-00010790: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000107a0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000107b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000107c0: 2020 2020 2020 2259 6f75 2068 6176 6520        "You have 
-000107d0: 746f 2065 6e74 6572 2074 6865 2076 616c  to enter the val
-000107e0: 7565 206f 6620 7468 6520 6e6f 5f76 616c  ue of the no_val
-000107f0: 2070 6172 616d 6574 6572 2077 6865 6e20   parameter when 
-00010800: 7468 6520 6d61 736b 2069 7320 6120 6e75  the mask is a nu
-00010810: 6d70 7920 6172 7261 7922 0d0a 2020 2020  mpy array"..    
-00010820: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00010830: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-00010840: 6172 7261 7920 3d20 6d61 736b 2e63 6f70  array = mask.cop
-00010850: 7928 290d 0a20 2020 2020 2020 2020 2020  y()..           
-00010860: 2072 6f77 2c20 636f 6c20 3d20 6d61 736b   row, col = mask
-00010870: 2e73 6861 7065 0d0a 2020 2020 2020 2020  .shape..        
-00010880: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00010890: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-000108a0: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-000108b0: 2020 2020 2022 5468 6520 7365 636f 6e64       "The second
-000108c0: 2070 6172 616d 6574 6572 2027 6d61 736b   parameter 'mask
-000108d0: 2720 6861 7320 746f 2062 6520 6569 7468  ' has to be eith
-000108e0: 6572 2067 6461 6c2e 4461 7461 6375 6265  er gdal.Datacube
-000108f0: 206f 7220 6e75 6d70 7920 6172 7261 7922   or numpy array"
-00010900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010910: 2020 6622 6769 7665 6e20 2d20 7b74 7970    f"given - {typ
-00010920: 6528 6d61 736b 297d 220d 0a20 2020 2020  e(mask)}"..     
-00010930: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-00010940: 2020 2020 2320 6966 2074 6865 2074 6f20      # if the to 
-00010950: 6265 2063 6c69 7070 6564 206f 626a 6563  be clipped objec
-00010960: 7420 6973 2072 6173 7465 720d 0a20 2020  t is raster..   
-00010970: 2020 2020 2073 7263 5f6e 6f76 616c 203d       src_noval =
-00010980: 2073 656c 662e 6e6f 5f64 6174 615f 7661   self.no_data_va
-00010990: 6c75 655b 6261 6e64 202d 2031 5d0d 0a20  lue[band - 1].. 
-000109a0: 2020 2020 2020 2064 7479 7065 203d 2073         dtype = s
-000109b0: 656c 662e 6474 7970 655b 6261 6e64 202d  elf.dtype[band -
-000109c0: 2031 5d0d 0a0d 0a20 2020 2020 2020 2073   1]....        s
-000109d0: 7263 5f73 7265 6620 3d20 6f73 722e 5370  rc_sref = osr.Sp
-000109e0: 6174 6961 6c52 6566 6572 656e 6365 2877  atialReference(w
-000109f0: 6b74 3d73 656c 662e 6372 7329 0d0a 2020  kt=self.crs)..  
-00010a00: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
-00010a10: 3d20 7365 6c66 2e72 6173 7465 722e 5265  = self.raster.Re
-00010a20: 6164 4173 4172 7261 7928 290d 0a20 2020  adAsArray()..   
-00010a30: 2020 2020 2023 2057 6172 6e69 6e67 3a20       # Warning: 
-00010a40: 6465 6c65 7465 206c 6174 6572 2074 6865  delete later the
-00010a50: 2073 656c 662e 7261 7374 6572 2077 696c   self.raster wil
-00010a60: 6c20 6e65 7665 7220 6265 2061 6e20 6172  l never be an ar
-00010a70: 7261 790d 0a20 2020 2020 2020 2069 6620  ray..        if 
-00010a80: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
-00010a90: 7261 7374 6572 2c20 6e70 2e6e 6461 7272  raster, np.ndarr
-00010aa0: 6179 293a 0d0a 2020 2020 2020 2020 2020  ay):..          
-00010ab0: 2020 2320 6966 2074 6865 206f 626a 6563    # if the objec
-00010ac0: 7420 746f 2062 6520 6372 6f70 7065 6420  t to be cropped 
-00010ad0: 6973 2061 7272 6179 0d0a 2020 2020 2020  is array..      
-00010ae0: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
-00010af0: 3d20 7365 6c66 2e72 6173 7465 722e 636f  = self.raster.co
-00010b00: 7079 2829 0d0a 2020 2020 2020 2020 2020  py()..          
-00010b10: 2020 6474 7970 6520 3d20 7365 6c66 2e72    dtype = self.r
-00010b20: 6173 7465 722e 6474 7970 650d 0a0d 0a20  aster.dtype.... 
-00010b30: 2020 2020 2020 2023 2063 6865 636b 2070         # check p
-00010b40: 726f 6a0d 0a20 2020 2020 2020 2069 6620  roj..        if 
-00010b50: 6e6f 7420 6d61 736b 5f61 7272 6179 2e73  not mask_array.s
-00010b60: 6861 7065 203d 3d20 7372 635f 6172 7261  hape == src_arra
-00010b70: 792e 7368 6170 653a 0d0a 2020 2020 2020  y.shape:..      
-00010b80: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00010b90: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
-00010ba0: 2020 2020 2020 2020 2022 5477 6f20 7261           "Two ra
-00010bb0: 7374 6572 7320 6861 7320 6469 6666 6572  sters has differ
-00010bc0: 656e 7420 6e75 6d62 6572 206f 6620 636f  ent number of co
-00010bd0: 6c75 6d6e 7320 6f72 2072 6f77 7320 706c  lumns or rows pl
-00010be0: 6561 7365 2072 6573 616d 706c 6520 6f72  ease resample or
-00010bf0: 206d 6174 6368 2062 6f74 6820 7261 7374   match both rast
-00010c00: 6572 7322 0d0a 2020 2020 2020 2020 2020  ers"..          
-00010c10: 2020 290d 0a0d 0a20 2020 2020 2020 2023    )....        #
-00010c20: 2069 6620 626f 7468 2069 6e70 7574 7320   if both inputs 
-00010c30: 6172 6520 7261 7374 6572 730d 0a20 2020  are rasters..   
-00010c40: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00010c50: 6365 286d 6173 6b2c 2044 6174 6173 6574  ce(mask, Dataset
-00010c60: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00010c70: 6966 206e 6f74 2073 656c 662e 6765 6f74  if not self.geot
-00010c80: 7261 6e73 666f 726d 203d 3d20 6d61 736b  ransform == mask
-00010c90: 5f67 743a 0d0a 2020 2020 2020 2020 2020  _gt:..          
-00010ca0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00010cb0: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
-00010cc0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-00010cd0: 6361 7469 6f6e 206f 6620 7570 7065 7220  cation of upper 
-00010ce0: 6c65 6674 2063 6f72 6e65 7220 6f66 2062  left corner of b
-00010cf0: 6f74 6820 7261 7374 6572 7320 6172 6520  oth rasters are 
-00010d00: 6e6f 7420 7468 6520 7361 6d65 206f 7220  not the same or 
-00010d10: 6365 6c6c 2073 697a 6520 6973 2022 0d0a  cell size is "..
-00010d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d30: 2020 2020 2264 6966 6665 7265 6e74 2070      "different p
-00010d40: 6c65 6173 6520 6d61 7463 6820 626f 7468  lease match both
-00010d50: 2072 6173 7465 7273 2066 6972 7374 2022   rasters first "
-00010d60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010d70: 2020 290d 0a0d 0a20 2020 2020 2020 2020    )....         
-00010d80: 2020 2069 6620 6e6f 7420 6d61 736b 5f65     if not mask_e
-00010d90: 7073 6720 3d3d 2073 656c 662e 6570 7367  psg == self.epsg
-00010da0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00010db0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00010dc0: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
-00010dd0: 2020 2020 2020 2020 2020 2244 6174 6173            "Datas
-00010de0: 6574 2041 2026 2042 2061 7265 2075 7369  et A & B are usi
-00010df0: 6e67 2064 6966 6665 7265 6e74 2063 6f6f  ng different coo
-00010e00: 7264 696e 6174 6520 7379 7374 656d 2070  rdinate system p
-00010e10: 6c65 6173 6520 7265 7072 6f6a 6563 7420  lease reproject 
-00010e20: 6f6e 6520 6f66 2074 6865 6d20 746f 2022  one of them to "
-00010e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010e40: 2020 2020 2020 2274 6865 206f 7468 6572        "the other
-00010e50: 2072 6173 7465 7220 636f 6f72 6469 6e61   raster coordina
-00010e60: 7465 2073 7973 7465 6d22 0d0a 2020 2020  te system"..    
-00010e70: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
-00010e80: 0a20 2020 2020 2020 2073 7263 5f61 7272  .        src_arr
-00010e90: 6179 5b6e 702e 6973 636c 6f73 6528 6d61  ay[np.isclose(ma
-00010ea0: 736b 5f61 7272 6179 2c20 6d61 736b 5f6e  sk_array, mask_n
-00010eb0: 6f76 616c 2c20 7274 6f6c 3d30 2e30 3031  oval, rtol=0.001
-00010ec0: 295d 203d 206d 6173 6b5f 6e6f 7661 6c0d  )] = mask_noval.
-00010ed0: 0a0d 0a20 2020 2020 2020 2023 2061 6c69  ...        # ali
-00010ee0: 676e 2066 756e 6374 696f 6e20 6f6e 6c79  gn function only
-00010ef0: 2065 7175 6174 6520 7468 6520 6e6f 206f   equate the no o
-00010f00: 6620 726f 7773 2061 6e64 2063 6f6c 756d  f rows and colum
-00010f10: 6e73 206f 6e6c 790d 0a20 2020 2020 2020  ns only..       
-00010f20: 2023 206d 6174 6368 206e 6f64 6174 6176   # match nodatav
-00010f30: 616c 7565 2069 6e73 6572 7473 206e 6f64  alue inserts nod
-00010f40: 6174 6176 616c 7565 2069 6e20 7372 6320  atavalue in src 
-00010f50: 7261 7374 6572 2074 6f20 616c 6c20 706c  raster to all pl
-00010f60: 6163 6573 206c 696b 6520 6d61 736b 0d0a  aces like mask..
-00010f70: 2020 2020 2020 2020 2320 7374 696c 6c20          # still 
-00010f80: 706c 6163 6573 2074 6861 7420 6861 7320  places that has 
-00010f90: 6e6f 6461 7461 7661 6c75 6520 696e 2074  nodatavalue in t
-00010fa0: 6865 2073 7263 2072 6173 7465 7220 6275  he src raster bu
-00010fb0: 7420 6974 2069 7320 6e6f 7420 6e6f 6461  t it is not noda
-00010fc0: 7461 7661 6c75 6520 696e 2074 6865 206d  tavalue in the m
-00010fd0: 6173 6b0d 0a20 2020 2020 2020 2023 2061  ask..        # a
-00010fe0: 6e64 206e 6f77 2068 6173 2074 6f20 6265  nd now has to be
-00010ff0: 2066 696c 6c65 6420 7769 7468 2076 616c   filled with val
-00011000: 7565 730d 0a20 2020 2020 2020 2023 2063  ues..        # c
-00011010: 6f6d 7061 7265 206e 6f20 6f66 2065 6c65  ompare no of ele
-00011020: 6d65 6e74 2074 6861 7420 6973 206e 6f74  ment that is not
-00011030: 206e 6f64 6174 6176 616c 7565 2069 6e20   nodatavalue in 
-00011040: 626f 7468 2072 6173 7465 7273 2074 6f20  both rasters to 
-00011050: 6d61 6b65 2073 7572 6520 7468 6579 2061  make sure they a
-00011060: 7265 206d 6174 6368 6564 0d0a 2020 2020  re matched..    
-00011070: 2020 2020 2320 6966 2062 6f74 6820 696e      # if both in
-00011080: 7075 7473 2061 7265 2072 6173 7465 7273  puts are rasters
-00011090: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-000110a0: 6e73 7461 6e63 6528 6d61 736b 2c20 6764  nstance(mask, gd
-000110b0: 616c 2e44 6174 6173 6574 2920 616e 6420  al.Dataset) and 
-000110c0: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
-000110d0: 7261 7374 6572 2c20 6764 616c 2e44 6174  raster, gdal.Dat
-000110e0: 6173 6574 293a 0d0a 2020 2020 2020 2020  aset):..        
-000110f0: 2020 2020 2320 7468 6572 6520 6d69 6768      # there migh
-00011100: 7420 6265 2063 656c 6c73 2074 6861 7420  t be cells that 
-00011110: 6172 6520 6f75 7420 6f66 2064 6f6d 6169  are out of domai
-00011120: 6e20 696e 2074 6865 2073 7263 2062 7574  n in the src but
-00011130: 206e 6f74 206f 7574 206f 6620 646f 6d61   not out of doma
-00011140: 696e 2069 6e20 7468 6520 6d61 736b 0d0a  in in the mask..
-00011150: 2020 2020 2020 2020 2020 2020 2320 736f              # so
-00011160: 2063 6861 6e67 6520 616c 6c20 7468 6520   change all the 
-00011170: 7372 635f 6e6f 7661 6c20 746f 206d 6173  src_noval to mas
-00011180: 6b5f 6e6f 7661 6c20 696e 2074 6865 2073  k_noval in the s
-00011190: 7263 5f61 7272 6179 0d0a 2020 2020 2020  rc_array..      
-000111a0: 2020 2020 2020 7372 635f 6172 7261 795b        src_array[
-000111b0: 6e70 2e69 7363 6c6f 7365 2873 7263 5f61  np.isclose(src_a
-000111c0: 7272 6179 2c20 7372 635f 6e6f 7661 6c2c  rray, src_noval,
-000111d0: 2072 746f 6c3d 302e 3030 3129 5d20 3d20   rtol=0.001)] = 
-000111e0: 6d61 736b 5f6e 6f76 616c 0d0a 2020 2020  mask_noval..    
-000111f0: 2020 2020 2020 2020 2320 7468 656e 2063          # then c
-00011200: 6f75 6e74 2074 6865 6d20 286f 7574 206f  ount them (out o
-00011210: 6620 646f 6d61 696e 2063 656c 6c73 2920  f domain cells) 
-00011220: 696e 2074 6865 2073 7263 5f61 7272 6179  in the src_array
-00011230: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00011240: 656d 5f73 7263 203d 206e 702e 7369 7a65  em_src = np.size
-00011250: 2873 7263 5f61 7272 6179 5b3a 2c20 3a5d  (src_array[:, :]
-00011260: 2920 2d20 6e70 2e63 6f75 6e74 5f6e 6f6e  ) - np.count_non
-00011270: 7a65 726f 280d 0a20 2020 2020 2020 2020  zero(..         
-00011280: 2020 2020 2020 2028 7372 635f 6172 7261         (src_arra
-00011290: 795b 6e70 2e69 7363 6c6f 7365 2873 7263  y[np.isclose(src
-000112a0: 5f61 7272 6179 2c20 6d61 736b 5f6e 6f76  _array, mask_nov
-000112b0: 616c 2c20 7274 6f6c 3d30 2e30 3031 295d  al, rtol=0.001)]
-000112c0: 290d 0a20 2020 2020 2020 2020 2020 2029  )..            )
-000112d0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000112e0: 636f 756e 7420 7468 6520 6f75 7420 6f66  count the out of
-000112f0: 2064 6f6d 6961 6e20 6365 6c6c 7320 696e   domian cells in
-00011300: 2074 6865 206d 6173 6b0d 0a20 2020 2020   the mask..     
-00011310: 2020 2020 2020 2065 6c65 6d5f 6d61 736b         elem_mask
-00011320: 203d 206e 702e 7369 7a65 286d 6173 6b5f   = np.size(mask_
-00011330: 6172 7261 795b 3a2c 203a 5d29 202d 206e  array[:, :]) - n
-00011340: 702e 636f 756e 745f 6e6f 6e7a 6572 6f28  p.count_nonzero(
-00011350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011360: 2020 286d 6173 6b5f 6172 7261 795b 6e70    (mask_array[np
-00011370: 2e69 7363 6c6f 7365 286d 6173 6b5f 6172  .isclose(mask_ar
-00011380: 7261 792c 206d 6173 6b5f 6e6f 7661 6c2c  ray, mask_noval,
-00011390: 2072 746f 6c3d 302e 3030 3129 5d29 0d0a   rtol=0.001)])..
-000113a0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
-000113b0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-000113c0: 6620 6e6f 7420 6571 7561 6c20 7468 656e  f not equal then
-000113d0: 2073 746f 7265 2069 6e64 6963 6573 206f   store indices o
-000113e0: 6620 7468 6f73 6520 6365 6c6c 7320 7468  f those cells th
-000113f0: 6174 2064 6f65 736e 2774 206d 6174 6368  at doesn't match
-00011400: 730d 0a20 2020 2020 2020 2020 2020 2069  s..            i
-00011410: 6620 656c 656d 5f6d 6173 6b20 3e20 656c  f elem_mask > el
-00011420: 656d 5f73 7263 3a0d 0a20 2020 2020 2020  em_src:..       
-00011430: 2020 2020 2020 2020 2072 6f77 7320 3d20           rows = 
-00011440: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
-00011450: 2020 2020 2020 2069 0d0a 2020 2020 2020         i..      
-00011460: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00011470: 7220 6920 696e 2072 616e 6765 2872 6f77  r i in range(row
-00011480: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00011490: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-000114a0: 7261 6e67 6528 636f 6c29 0d0a 2020 2020  range(col)..    
-000114b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114c0: 6966 206e 702e 6973 636c 6f73 6528 7372  if np.isclose(sr
-000114d0: 635f 6172 7261 795b 692c 206a 5d2c 206d  c_array[i, j], m
-000114e0: 6173 6b5f 6e6f 7661 6c2c 2072 746f 6c3d  ask_noval, rtol=
-000114f0: 302e 3030 3129 0d0a 2020 2020 2020 2020  0.001)..        
-00011500: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00011510: 6e6f 7420 6e70 2e69 7363 6c6f 7365 286d  not np.isclose(m
-00011520: 6173 6b5f 6172 7261 795b 692c 206a 5d2c  ask_array[i, j],
-00011530: 206d 6173 6b5f 6e6f 7661 6c2c 2072 746f   mask_noval, rto
-00011540: 6c3d 302e 3030 3129 0d0a 2020 2020 2020  l=0.001)..      
-00011550: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
-00011560: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00011570: 7320 3d20 5b0d 0a20 2020 2020 2020 2020  s = [..         
-00011580: 2020 2020 2020 2020 2020 206a 0d0a 2020             j..  
-00011590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115a0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-000115b0: 2872 6f77 290d 0a20 2020 2020 2020 2020  (row)..         
-000115c0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-000115d0: 2069 6e20 7261 6e67 6528 636f 6c29 0d0a   in range(col)..
-000115e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115f0: 2020 2020 6966 206e 702e 6973 636c 6f73      if np.isclos
-00011600: 6528 7372 635f 6172 7261 795b 692c 206a  e(src_array[i, j
-00011610: 5d2c 206d 6173 6b5f 6e6f 7661 6c2c 2072  ], mask_noval, r
-00011620: 746f 6c3d 302e 3030 3129 0d0a 2020 2020  tol=0.001)..    
-00011630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011640: 616e 6420 6e6f 7420 6e70 2e69 7363 6c6f  and not np.isclo
-00011650: 7365 286d 6173 6b5f 6172 7261 795b 692c  se(mask_array[i,
-00011660: 206a 5d2c 206d 6173 6b5f 6e6f 7661 6c2c   j], mask_noval,
-00011670: 2072 746f 6c3d 302e 3030 3129 0d0a 2020   rtol=0.001)..  
-00011680: 2020 2020 2020 2020 2020 2020 2020 5d0d                ].
-00011690: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-000116a0: 6e74 6572 706f 6c61 7465 2074 686f 7365  nterpolate those
-000116b0: 206d 6973 7369 6e67 2063 656c 6c73 2062   missing cells b
-000116c0: 7920 6e65 6172 6573 7420 6e65 6967 6862  y nearest neighb
-000116d0: 6f75 720d 0a20 2020 2020 2020 2020 2020  our..           
-000116e0: 2069 6620 656c 656d 5f6d 6173 6b20 3e20   if elem_mask > 
-000116f0: 656c 656d 5f73 7263 3a0d 0a20 2020 2020  elem_src:..     
-00011700: 2020 2020 2020 2020 2020 2073 7263 5f61             src_a
-00011710: 7272 6179 203d 2044 6174 6173 6574 2e5f  rray = Dataset._
-00011720: 6e65 6172 6573 745f 6e65 6967 6862 6f75  nearest_neighbou
-00011730: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-00011740: 2020 2020 2020 2020 7372 635f 6172 7261          src_arra
-00011750: 792c 206d 6173 6b5f 6e6f 7661 6c2c 2072  y, mask_noval, r
-00011760: 6f77 732c 2063 6f6c 730d 0a20 2020 2020  ows, cols..     
-00011770: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
-00011780: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
-00011790: 2064 7374 2069 7320 6120 7261 7374 6572   dst is a raster
-000117a0: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-000117b0: 6e73 7461 6e63 6528 7365 6c66 2e72 6173  nstance(self.ras
-000117c0: 7465 722c 2067 6461 6c2e 4461 7461 7365  ter, gdal.Datase
-000117d0: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-000117e0: 2064 7374 203d 2044 6174 6173 6574 2e5f   dst = Dataset._
-000117f0: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
-00011800: 7365 7428 636f 6c2c 2072 6f77 2c20 312c  set(col, row, 1,
-00011810: 2064 7479 7065 2c20 6472 6976 6572 3d22   dtype, driver="
-00011820: 4d45 4d22 290d 0a20 2020 2020 2020 2020  MEM")..         
-00011830: 2020 2023 2062 7574 2077 6974 6820 6c6f     # but with lo
-00011840: 7420 6f66 2063 6f6d 7075 7461 7469 6f6e  t of computation
-00011850: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00011860: 6966 2074 6865 206d 6173 6b20 6973 2061  if the mask is a
-00011870: 6e20 6172 7261 7920 616e 6420 7468 6520  n array and the 
-00011880: 6d61 736b 5f67 7420 6973 206e 6f74 2064  mask_gt is not d
-00011890: 6566 696e 6564 2075 7365 2074 6865 2073  efined use the s
-000118a0: 7263 5f67 7420 6173 2062 6f74 6820 7468  rc_gt as both th
-000118b0: 6520 6d61 736b 2061 6e64 2074 6865 2073  e mask and the s
-000118c0: 7263 0d0a 2020 2020 2020 2020 2020 2020  rc..            
-000118d0: 2320 6172 6520 616c 6967 6e65 6420 736f  # are aligned so
-000118e0: 2074 6865 7920 6861 7665 2074 6865 2073   they have the s
-000118f0: 616d 2067 740d 0a20 2020 2020 2020 2020  am gt..         
-00011900: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00011910: 2020 2020 2020 2020 2023 2073 6574 2074           # set t
-00011920: 6865 2067 656f 7472 616e 7366 6f72 6d0d  he geotransform.
-00011930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011940: 2064 7374 2e53 6574 4765 6f54 7261 6e73   dst.SetGeoTrans
-00011950: 666f 726d 286d 6173 6b5f 6774 290d 0a20  form(mask_gt).. 
-00011960: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00011970: 2073 6574 2074 6865 2070 726f 6a65 6374   set the project
-00011980: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-00011990: 2020 2020 2064 7374 2e53 6574 5072 6f6a       dst.SetProj
-000119a0: 6563 7469 6f6e 286d 6173 6b2e 6372 7329  ection(mask.crs)
-000119b0: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-000119c0: 6365 7074 2055 6e62 6f75 6e64 4c6f 6361  cept UnboundLoca
-000119d0: 6c45 7272 6f72 3a0d 0a20 2020 2020 2020  lError:..       
-000119e0: 2020 2020 2020 2020 2064 7374 2e53 6574           dst.Set
-000119f0: 4765 6f54 7261 6e73 666f 726d 2873 656c  GeoTransform(sel
-00011a00: 662e 6765 6f74 7261 6e73 666f 726d 290d  f.geotransform).
-00011a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011a20: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
-00011a30: 6f6e 2873 7263 5f73 7265 662e 4578 706f  on(src_sref.Expo
-00011a40: 7274 546f 576b 7428 2929 0d0a 0d0a 2020  rtToWkt())....  
-00011a50: 2020 2020 2020 2020 2020 6473 745f 6f62            dst_ob
-00011a60: 6a20 3d20 4461 7461 7365 7428 6473 7429  j = Dataset(dst)
-00011a70: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00011a80: 7365 7420 7468 6520 6e6f 2064 6174 6120  set the no data 
-00011a90: 7661 6c75 650d 0a20 2020 2020 2020 2020  value..         
-00011aa0: 2020 2064 7374 5f6f 626a 2e5f 7365 745f     dst_obj._set_
-00011ab0: 6e6f 5f64 6174 615f 7661 6c75 6528 6d61  no_data_value(ma
-00011ac0: 736b 5f6e 6f76 616c 290d 0a20 2020 2020  sk_noval)..     
-00011ad0: 2020 2020 2020 2064 7374 5f6f 626a 2e72         dst_obj.r
-00011ae0: 6173 7465 722e 4765 7452 6173 7465 7242  aster.GetRasterB
-00011af0: 616e 6428 3129 2e57 7269 7465 4172 7261  and(1).WriteArra
-00011b00: 7928 7372 635f 6172 7261 7929 0d0a 2020  y(src_array)..  
-00011b10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00011b20: 2064 7374 5f6f 626a 0d0a 2020 2020 2020   dst_obj..      
-00011b30: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00011b40: 2020 2020 2072 6574 7572 6e20 7372 635f       return src_
-00011b50: 6172 7261 790d 0a0d 0a20 2020 2064 6566  array....    def
-00011b60: 205f 6368 6563 6b5f 616c 6967 6e6d 656e   _check_alignmen
-00011b70: 7428 7365 6c66 2c20 6d61 736b 2920 2d3e  t(self, mask) ->
-00011b80: 2062 6f6f 6c3a 0d0a 2020 2020 2020 2020   bool:..        
-00011b90: 2222 2243 6865 636b 2069 6620 7261 7374  """Check if rast
-00011ba0: 6572 2069 7320 616c 6967 6e65 6420 7769  er is aligned wi
-00011bb0: 7468 2061 2067 6976 656e 206d 6173 6b20  th a given mask 
-00011bc0: 7261 7374 6572 2222 220d 0a20 2020 2020  raster"""..     
-00011bd0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00011be0: 616e 6365 286d 6173 6b2c 2044 6174 6173  ance(mask, Datas
-00011bf0: 6574 293a 0d0a 2020 2020 2020 2020 2020  et):..          
-00011c00: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00011c10: 7228 2254 6865 2073 6563 6f6e 6420 7061  r("The second pa
-00011c20: 7261 6d65 7465 7220 7368 6f75 6c64 2062  rameter should b
-00011c30: 6520 6120 4461 7461 7365 7422 290d 0a0d  e a Dataset")...
-00011c40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00011c50: 7365 6c66 2e72 6f77 7320 3d3d 206d 6173  self.rows == mas
-00011c60: 6b2e 726f 7773 2061 6e64 2073 656c 662e  k.rows and self.
-00011c70: 636f 6c75 6d6e 7320 3d3d 206d 6173 6b2e  columns == mask.
-00011c80: 636f 6c75 6d6e 730d 0a0d 0a20 2020 2064  columns....    d
-00011c90: 6566 2061 6c69 676e 280d 0a20 2020 2020  ef align(..     
-00011ca0: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
-00011cb0: 2020 616c 6967 6e6d 656e 745f 7372 632c    alignment_src,
-00011cc0: 0d0a 2020 2020 2920 2d3e 2067 6461 6c2e  ..    ) -> gdal.
-00011cd0: 4461 7461 7365 743a 0d0a 2020 2020 2020  Dataset:..      
-00011ce0: 2020 2222 226d 6174 6368 5261 7374 6572    """matchRaster
-00011cf0: 416c 6967 6e6d 656e 742e 0d0a 0d0a 2020  Alignment.....  
-00011d00: 2020 2020 2020 6d61 7463 6852 6173 7465        matchRaste
-00011d10: 7241 6c69 676e 6d65 6e74 206d 6574 686f  rAlignment metho
-00011d20: 6420 636f 7069 6573 2074 6865 2066 6f6c  d copies the fol
-00011d30: 6c6f 7769 6e67 2064 6174 610d 0a20 2020  lowing data..   
-00011d40: 2020 2020 2020 2020 202d 2054 6865 2063           - The c
-00011d50: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-00011d60: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00011d70: 5468 6520 6e75 6d62 6572 206f 6620 6f66  The number of of
-00011d80: 2072 6f77 7320 2620 636f 6c75 6d6e 730d   rows & columns.
-00011d90: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
-00011da0: 656c 6c20 7369 7a65 0d0a 2020 2020 2020  ell size..      
-00011db0: 2020 6672 6f6d 2061 6c69 676e 6d65 6e74    from alignment
-00011dc0: 5f73 7263 2074 6f20 6120 6461 7461 5f73  _src to a data_s
-00011dd0: 7263 2072 6173 7465 7220 2874 6865 2073  rc raster (the s
-00011de0: 6f75 7263 6520 6f66 2064 6174 6120 7661  ource of data va
-00011df0: 6c75 6573 2069 6e20 6365 6c6c 7329 0d0a  lues in cells)..
-00011e00: 0d0a 2020 2020 2020 2020 7468 6520 7265  ..        the re
-00011e10: 7375 6c74 2077 696c 6c20 6265 2061 2072  sult will be a r
-00011e20: 6173 7465 7220 7769 7468 2074 6865 2073  aster with the s
-00011e30: 616d 6520 7374 7275 6374 7572 6520 6c69  ame structure li
-00011e40: 6b65 2061 6c69 676e 6d65 6e74 5f73 7263  ke alignment_src
-00011e50: 2062 7574 2077 6974 680d 0a20 2020 2020   but with..     
-00011e60: 2020 2076 616c 7565 7320 6672 6f6d 2064     values from d
-00011e70: 6174 615f 7372 6320 7573 696e 6720 4e65  ata_src using Ne
-00011e80: 6172 6573 7420 4e65 6967 6862 6f75 7220  arest Neighbour 
-00011e90: 696e 7465 7270 6f6c 6174 696f 6e20 616c  interpolation al
-00011ea0: 676f 7269 7468 6d0d 0a0d 0a20 2020 2020  gorithm....     
-00011eb0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00011ec0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00011ed0: 2d0d 0a20 2020 2020 2020 2061 6c69 676e  -..        align
-00011ee0: 6d65 6e74 5f73 7263 203a 205b 6764 616c  ment_src : [gdal
-00011ef0: 2e64 6174 6173 6574 2f73 7472 696e 675d  .dataset/string]
-00011f00: 0d0a 2020 2020 2020 2020 2020 2020 7370  ..            sp
-00011f10: 6174 6961 6c20 696e 666f 726d 6174 696f  atial informatio
-00011f20: 6e20 736f 7572 6365 2072 6173 7465 7220  n source raster 
-00011f30: 746f 2067 6574 2074 6865 2073 7061 7469  to get the spati
-00011f40: 616c 2069 6e66 6f72 6d61 7469 6f6e 0d0a  al information..
-00011f50: 2020 2020 2020 2020 2020 2020 2863 6f6f              (coo
-00011f60: 7264 696e 6174 6520 7379 7374 656d 2c20  rdinate system, 
-00011f70: 6e6f 206f 6620 726f 7773 2026 2063 6f6c  no of rows & col
-00011f80: 756d 6e73 290d 0a20 2020 2020 2020 2020  umns)..         
-00011f90: 2020 2064 6174 6120 7661 6c75 6573 2073     data values s
-00011fa0: 6f75 7263 6520 7261 7374 6572 2074 6f20  ource raster to 
-00011fb0: 6765 7420 7468 6520 6461 7461 2028 7661  get the data (va
-00011fc0: 6c75 6573 206f 6620 6561 6368 2063 656c  lues of each cel
-00011fd0: 6c29 0d0a 0d0a 2020 2020 2020 2020 5265  l)....        Re
-00011fe0: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00011ff0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00012000: 6473 7420 3a20 5b52 6173 7465 725d 0d0a  dst : [Raster]..
-00012010: 2020 2020 2020 2020 2020 2020 5261 7374              Rast
-00012020: 6572 206f 626a 6563 740d 0a0d 0a20 2020  er object....   
-00012030: 2020 2020 2045 7861 6d70 6c65 730d 0a20       Examples.. 
-00012040: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
-00012050: 0a20 2020 2020 2020 203e 3e3e 2041 203d  .        >>> A =
-00012060: 2067 6461 6c2e 4f70 656e 2822 6578 616d   gdal.Open("exam
-00012070: 706c 6573 2f47 4953 2f64 6174 612f 6163  ples/GIS/data/ac
-00012080: 6334 3030 302e 7469 6622 290d 0a20 2020  c4000.tif")..   
-00012090: 2020 2020 203e 3e3e 2042 203d 2067 6461       >>> B = gda
-000120a0: 6c2e 4f70 656e 2822 6578 616d 706c 6573  l.Open("examples
-000120b0: 2f47 4953 2f64 6174 612f 736f 696c 5f72  /GIS/data/soil_r
-000120c0: 6173 7465 722e 7469 6622 290d 0a20 2020  aster.tif")..   
-000120d0: 2020 2020 203e 3e3e 2052 6173 7465 7242       >>> RasterB
-000120e0: 4d61 7463 6865 6420 3d20 4461 7461 7365  Matched = Datase
-000120f0: 742e 616c 6967 6e28 412c 4229 0d0a 2020  t.align(A,B)..  
-00012100: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00012110: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00012120: 2861 6c69 676e 6d65 6e74 5f73 7263 2c20  (alignment_src, 
-00012130: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
-00012140: 2020 2020 2020 2073 7263 203d 2061 6c69         src = ali
-00012150: 676e 6d65 6e74 5f73 7263 0d0a 2020 2020  gnment_src..    
-00012160: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00012170: 6e63 6528 616c 6967 6e6d 656e 745f 7372  nce(alignment_sr
-00012180: 632c 2073 7472 293a 0d0a 2020 2020 2020  c, str):..      
-00012190: 2020 2020 2020 7372 6320 3d20 4461 7461        src = Data
-000121a0: 7365 742e 7265 6164 5f66 696c 6528 616c  set.read_file(al
-000121b0: 6967 6e6d 656e 745f 7372 6329 0d0a 2020  ignment_src)..  
-000121c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000121d0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000121e0: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
-000121f0: 2020 2020 2020 2020 2020 2022 4669 7273             "Firs
-00012200: 7420 7061 7261 6d65 7465 7220 7368 6f75  t parameter shou
-00012210: 6c64 2062 6520 6120 4461 7461 7365 7420  ld be a Dataset 
-00012220: 7265 6164 2075 7369 6e67 2044 6174 6173  read using Datas
-00012230: 6574 2e6f 7065 6e52 6173 7465 7220 6f72  et.openRaster or
-00012240: 2061 2070 6174 6820 746f 2074 6865 2072   a path to the r
-00012250: 6173 7465 722c 2022 0d0a 2020 2020 2020  aster, "..      
-00012260: 2020 2020 2020 2020 2020 6622 6769 7665            f"give
-00012270: 6e20 7b74 7970 6528 616c 6967 6e6d 656e  n {type(alignmen
-00012280: 745f 7372 6329 7d22 0d0a 2020 2020 2020  t_src)}"..      
-00012290: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-000122a0: 2020 2023 2072 6570 726f 6a65 6374 2074     # reproject t
-000122b0: 6865 2072 6173 7465 7220 746f 206d 6174  he raster to mat
-000122c0: 6368 2074 6865 2070 726f 6a65 6374 696f  ch the projectio
-000122d0: 6e20 6f66 2061 6c69 676e 6d65 6e74 5f73  n of alignment_s
-000122e0: 7263 0d0a 2020 2020 2020 2020 7265 7072  rc..        repr
-000122f0: 6f6a 6563 7465 645f 5261 7374 6572 4220  ojected_RasterB 
-00012300: 3d20 7365 6c66 2e74 6f5f 6372 7328 7372  = self.to_crs(sr
-00012310: 632e 6570 7367 290d 0a20 2020 2020 2020  c.epsg)..       
-00012320: 2023 2063 7265 6174 6520 6120 6e65 7720   # create a new 
-00012330: 7261 7374 6572 0d0a 2020 2020 2020 2020  raster..        
-00012340: 6473 7420 3d20 4461 7461 7365 742e 5f63  dst = Dataset._c
-00012350: 7265 6174 655f 6764 616c 5f64 6174 6173  reate_gdal_datas
-00012360: 6574 280d 0a20 2020 2020 2020 2020 2020  et(..           
-00012370: 2073 7263 2e63 6f6c 756d 6e73 2c20 7372   src.columns, sr
-00012380: 632e 726f 7773 2c20 312c 2073 7263 2e64  c.rows, 1, src.d
-00012390: 7479 7065 5b30 5d2c 2064 7269 7665 723d  type[0], driver=
-000123a0: 224d 454d 220d 0a20 2020 2020 2020 2029  "MEM"..        )
-000123b0: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
-000123c0: 7468 6520 6765 6f74 7261 6e73 666f 726d  the geotransform
-000123d0: 0d0a 2020 2020 2020 2020 6473 742e 5365  ..        dst.Se
-000123e0: 7447 656f 5472 616e 7366 6f72 6d28 7372  tGeoTransform(sr
-000123f0: 632e 6765 6f74 7261 6e73 666f 726d 290d  c.geotransform).
-00012400: 0a20 2020 2020 2020 2023 2073 6574 2074  .        # set t
-00012410: 6865 2070 726f 6a65 6374 696f 6e0d 0a20  he projection.. 
-00012420: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
-00012430: 6f6a 6563 7469 6f6e 2873 7263 2e63 7273  ojection(src.crs
-00012440: 290d 0a20 2020 2020 2020 2023 2073 6574  )..        # set
-00012450: 2074 6865 206e 6f20 6461 7461 2076 616c   the no data val
-00012460: 7565 0d0a 2020 2020 2020 2020 6473 745f  ue..        dst_
-00012470: 6f62 6a20 3d20 4461 7461 7365 7428 6473  obj = Dataset(ds
-00012480: 7429 0d0a 2020 2020 2020 2020 6473 745f  t)..        dst_
-00012490: 6f62 6a2e 5f73 6574 5f6e 6f5f 6461 7461  obj._set_no_data
-000124a0: 5f76 616c 7565 2873 7263 2e6e 6f5f 6461  _value(src.no_da
-000124b0: 7461 5f76 616c 7565 5b30 5d29 0d0a 2020  ta_value[0])..  
-000124c0: 2020 2020 2020 2320 7065 7266 6f72 6d20        # perform 
-000124d0: 7468 6520 7072 6f6a 6563 7469 6f6e 2026  the projection &
-000124e0: 2072 6573 616d 706c 696e 670d 0a20 2020   resampling..   
-000124f0: 2020 2020 206d 6574 686f 6420 3d20 6764       method = gd
-00012500: 616c 2e47 5241 5f4e 6561 7265 7374 4e65  al.GRA_NearestNe
-00012510: 6967 6862 6f75 720d 0a20 2020 2020 2020  ighbour..       
-00012520: 2023 2072 6573 616d 706c 6520 7468 6520   # resample the 
-00012530: 7265 7072 6f6a 6563 7465 645f 5261 7374  reprojected_Rast
-00012540: 6572 420d 0a20 2020 2020 2020 2067 6461  erB..        gda
-00012550: 6c2e 5265 7072 6f6a 6563 7449 6d61 6765  l.ReprojectImage
-00012560: 280d 0a20 2020 2020 2020 2020 2020 2072  (..            r
-00012570: 6570 726f 6a65 6374 6564 5f52 6173 7465  eprojected_Raste
-00012580: 7242 2e72 6173 7465 722c 0d0a 2020 2020  rB.raster,..    
-00012590: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
-000125a0: 7261 7374 6572 2c0d 0a20 2020 2020 2020  raster,..       
-000125b0: 2020 2020 2073 7263 2e63 7273 2c0d 0a20       src.crs,.. 
-000125c0: 2020 2020 2020 2020 2020 2073 7263 2e63             src.c
-000125d0: 7273 2c0d 0a20 2020 2020 2020 2020 2020  rs,..           
-000125e0: 206d 6574 686f 642c 0d0a 2020 2020 2020   method,..      
-000125f0: 2020 290d 0a0d 0a20 2020 2020 2020 2072    )....        r
-00012600: 6574 7572 6e20 6473 745f 6f62 6a0d 0a0d  eturn dst_obj...
-00012610: 0a20 2020 2064 6566 205f 6372 6f70 5f77  .    def _crop_w
-00012620: 6974 685f 7261 7374 6572 280d 0a20 2020  ith_raster(..   
-00012630: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
-00012640: 2020 2020 6d61 736b 3a20 556e 696f 6e5b      mask: Union[
-00012650: 6764 616c 2e44 6174 6173 6574 2c20 7374  gdal.Dataset, st
-00012660: 725d 2c0d 0a20 2020 2029 202d 3e20 6764  r],..    ) -> gd
-00012670: 616c 2e44 6174 6173 6574 3a0d 0a20 2020  al.Dataset:..   
-00012680: 2020 2020 2022 2222 6372 6f70 2e0d 0a0d       """crop....
-00012690: 0a20 2020 2020 2020 2020 2020 2063 726f  .            cro
-000126a0: 7020 6d65 7468 6f64 2063 726f 7073 2061  p method crops a
-000126b0: 2072 6173 7465 7220 7573 696e 6720 616e   raster using an
-000126c0: 6f74 6865 7220 7261 7374 6572 2028 626f  other raster (bo
-000126d0: 7468 2072 6173 7465 7273 2064 6f65 7320  th rasters does 
-000126e0: 6e6f 7420 6861 7665 2074 6f20 6265 2061  not have to be a
-000126f0: 6c69 676e 6564 292e 0d0a 0d0a 2020 2020  ligned).....    
-00012700: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00012710: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00012720: 2d2d 2d0d 0a20 2020 2020 2020 206d 6173  ---..        mas
-00012730: 6b20 3a20 5b73 7472 696e 672f 4461 7461  k : [string/Data
-00012740: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
-00012750: 2020 7468 6520 7261 7374 6572 2079 6f75    the raster you
-00012760: 2077 616e 7420 746f 2075 7365 2061 7320   want to use as 
-00012770: 6120 6d61 736b 2074 6f20 6372 6f70 206f  a mask to crop o
-00012780: 7468 6572 2072 6173 7465 722c 0d0a 2020  ther raster,..  
-00012790: 2020 2020 2020 2020 2020 7468 6520 6d61            the ma
-000127a0: 736b 2063 616e 2062 6520 616c 736f 2061  sk can be also a
-000127b0: 2070 6174 6820 6f72 2061 2067 6461 6c20   path or a gdal 
-000127c0: 6f62 6a65 6374 2e0d 0a0d 0a20 2020 2020  object.....     
-000127d0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-000127e0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-000127f0: 2020 2020 2064 7374 203a 205b 4461 7461       dst : [Data
-00012800: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
-00012810: 2020 7468 6520 6372 6f70 7065 6420 7261    the cropped ra
-00012820: 7374 6572 2077 696c 6c20 6265 2072 6574  ster will be ret
-00012830: 7572 6e65 642c 2069 6620 7468 6520 7361  urned, if the sa
-00012840: 7665 2070 6172 616d 6574 6572 2077 6173  ve parameter was
-00012850: 2054 7275 652c 0d0a 2020 2020 2020 2020   True,..        
-00012860: 2020 2020 7468 6520 6372 6f70 7065 6420      the cropped 
-00012870: 7261 7374 6572 2077 696c 6c20 616c 736f  raster will also
-00012880: 2062 6520 7361 7665 6420 746f 2064 6973   be saved to dis
-00012890: 6b20 696e 2074 6865 204f 7574 7075 7450  k in the OutputP
-000128a0: 6174 680d 0a20 2020 2020 2020 2020 2020  ath..           
-000128b0: 2064 6972 6563 746f 7279 2e0d 0a20 2020   directory...   
-000128c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000128d0: 2020 2320 6765 7420 696e 666f 726d 6174    # get informat
-000128e0: 696f 6e20 6672 6f6d 2074 6865 206d 6173  ion from the mas
-000128f0: 6b20 7261 7374 6572 0d0a 2020 2020 2020  k raster..      
-00012900: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00012910: 6d61 736b 2c20 7374 7229 3a0d 0a20 2020  mask, str):..   
-00012920: 2020 2020 2020 2020 206d 6173 6b20 3d20           mask = 
-00012930: 4461 7461 7365 742e 7265 6164 5f66 696c  Dataset.read_fil
-00012940: 6528 6d61 736b 290d 0a20 2020 2020 2020  e(mask)..       
-00012950: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00012960: 286d 6173 6b2c 2044 6174 6173 6574 293a  (mask, Dataset):
-00012970: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-00012980: 736b 203d 206d 6173 6b0d 0a20 2020 2020  sk = mask..     
-00012990: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000129a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000129b0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
-000129c0: 2020 2020 2020 2020 2253 6563 6f6e 6420          "Second 
-000129d0: 7061 7261 6d65 7465 7220 6861 7320 746f  parameter has to
-000129e0: 2062 6520 6569 7468 6572 2070 6174 6820   be either path 
-000129f0: 746f 2074 6865 206d 6173 6b20 7261 7374  to the mask rast
-00012a00: 6572 206f 7220 6120 6764 616c 2e44 6174  er or a gdal.Dat
-00012a10: 6163 7562 6520 6f62 6a65 6374 220d 0a20  acube object".. 
-00012a20: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00012a30: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-00012a40: 662e 5f63 6865 636b 5f61 6c69 676e 6d65  f._check_alignme
-00012a50: 6e74 286d 6173 6b29 3a0d 0a20 2020 2020  nt(mask):..     
-00012a60: 2020 2020 2020 2023 2066 6972 7374 2061         # first a
-00012a70: 6c69 676e 2074 6865 206d 6173 6b20 7769  lign the mask wi
-00012a80: 7468 2074 6865 2073 7263 2072 6173 7465  th the src raste
-00012a90: 720d 0a20 2020 2020 2020 2020 2020 206d  r..            m
-00012aa0: 6173 6b20 3d20 6d61 736b 2e61 6c69 676e  ask = mask.align
-00012ab0: 2873 656c 6629 0d0a 2020 2020 2020 2020  (self)..        
-00012ac0: 2320 6372 6f70 2074 6865 2073 7263 2072  # crop the src r
-00012ad0: 6173 7465 7220 7769 7468 2074 6865 2061  aster with the a
-00012ae0: 6c69 676e 6564 206d 6173 6b0d 0a20 2020  ligned mask..   
-00012af0: 2020 2020 2064 7374 5f6f 626a 203d 2073       dst_obj = s
-00012b00: 656c 662e 5f63 726f 705f 616c 6c69 676e  elf._crop_allign
-00012b10: 6564 286d 6173 6b29 0d0a 0d0a 2020 2020  ed(mask)....    
-00012b20: 2020 2020 7265 7475 726e 2064 7374 5f6f      return dst_o
-00012b30: 626a 0d0a 0d0a 2020 2020 6465 6620 5f63  bj....    def _c
-00012b40: 726f 705f 7769 7468 5f70 6f6c 7967 6f6e  rop_with_polygon
-00012b50: 2873 656c 662c 2070 6f6c 793a 2047 656f  (self, poly: Geo
-00012b60: 4461 7461 4672 616d 6529 3a0d 0a20 2020  DataFrame):..   
-00012b70: 2020 2020 2022 2222 6372 6f70 5769 7468       """cropWith
-00012b80: 506f 6c79 676f 6e2e 0d0a 0d0a 2020 2020  Polygon.....    
-00012b90: 2020 2020 2020 2020 636c 6970 2074 6865          clip the
-00012ba0: 2052 6173 7465 7220 6f62 6a65 6374 2075   Raster object u
-00012bb0: 7369 6e67 2061 2070 6f6c 7967 6f6e 2076  sing a polygon v
-00012bc0: 6563 746f 722e 0d0a 0d0a 2020 2020 2020  ector.....      
-00012bd0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00012be0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00012bf0: 0d0a 2020 2020 2020 2020 706f 6c79 3a20  ..        poly: 
-00012c00: 5b50 6f6c 7967 6f6e 2047 656f 4461 7461  [Polygon GeoData
-00012c10: 4672 616d 655d 0d0a 2020 2020 2020 2020  Frame]..        
-00012c20: 2020 2020 4765 6f64 6174 6146 7261 6d65      GeodataFrame
-00012c30: 2077 6974 6820 6120 6765 6f6d 6574 7279   with a geometry
-00012c40: 206f 6620 706f 6c79 676f 6e20 7479 7065   of polygon type
-00012c50: 2e0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00012c60: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-00012c70: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
-00012c80: 6173 6574 0d0a 2020 2020 2020 2020 2222  aset..        ""
-00012c90: 220d 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
-00012ca0: 7420 6973 696e 7374 616e 6365 2870 6f6c  t isinstance(pol
-00012cb0: 792c 2047 656f 4461 7461 4672 616d 6529  y, GeoDataFrame)
-00012cc0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00012cd0: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
-00012ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012cf0: 2022 5468 6520 7365 636f 6e64 2070 6172   "The second par
-00012d00: 616d 6574 6572 3a20 706f 6c79 2073 686f  ameter: poly sho
-00012d10: 756c 6420 6265 206f 6620 7479 7065 2047  uld be of type G
-00012d20: 656f 4461 7461 4672 616d 6520 220d 0a20  eoDataFrame ".. 
-00012d30: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
-00012d40: 2020 2020 2020 2020 706f 6c79 5f65 7073          poly_eps
-00012d50: 6720 3d20 706f 6c79 2e63 7273 2e74 6f5f  g = poly.crs.to_
-00012d60: 6570 7367 2829 0d0a 2020 2020 2020 2020  epsg()..        
-00012d70: 7372 635f 6570 7367 203d 2073 656c 662e  src_epsg = self.
-00012d80: 6570 7367 0d0a 2020 2020 2020 2020 6966  epsg..        if
-00012d90: 2070 6f6c 795f 6570 7367 2021 3d20 7372   poly_epsg != sr
-00012da0: 635f 6570 7367 3a0d 0a20 2020 2020 2020  c_epsg:..       
-00012db0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00012dc0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
-00012dd0: 2020 2020 2020 2020 2250 726f 6a65 6374          "Project
-00012de0: 696f 6e20 4572 726f 723a 2074 6865 2072  ion Error: the r
-00012df0: 6173 7465 7220 616e 6420 7665 6374 6f72  aster and vector
-00012e00: 2070 6f6c 7967 6f6e 2068 6176 6520 6469   polygon have di
-00012e10: 6666 6572 656e 7420 7072 6f6a 6563 7469  fferent projecti
-00012e20: 6f6e 2070 6c65 6173 6520 220d 0a20 2020  on please "..   
-00012e30: 2020 2020 2020 2020 2020 2020 2022 756e               "un
-00012e40: 6966 7920 7072 6f6a 6563 7469 6f6e 220d  ify projection".
-00012e50: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
-00012e60: 2020 2020 2020 2020 7665 6374 6f72 203d          vector =
-00012e70: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
-00012e80: 6f6e 2870 6f6c 7929 0d0a 2020 2020 2020  on(poly)..      
-00012e90: 2020 6d61 736b 203d 2076 6563 746f 722e    mask = vector.
-00012ea0: 746f 5f64 6174 6173 6574 2864 6174 6173  to_dataset(datas
-00012eb0: 6574 3d73 656c 6629 0d0a 2020 2020 2020  et=self)..      
-00012ec0: 2020 6372 6f70 7065 645f 6f62 6a20 3d20    cropped_obj = 
-00012ed0: 7365 6c66 2e5f 6372 6f70 5f77 6974 685f  self._crop_with_
-00012ee0: 7261 7374 6572 286d 6173 6b29 0d0a 0d0a  raster(mask)....
-00012ef0: 2020 2020 2020 2020 2320 786d 696e 2c20          # xmin, 
-00012f00: 796d 696e 2c20 786d 6178 2c20 796d 6178  ymin, xmax, ymax
-00012f10: 203d 2070 6f6c 792e 626f 756e 6473 2e76   = poly.bounds.v
-00012f20: 616c 7565 732e 746f 6c69 7374 2829 5b30  alues.tolist()[0
-00012f30: 5d0d 0a20 2020 2020 2020 2023 2077 696e  ]..        # win
-00012f40: 646f 7720 3d20 2878 6d69 6e2c 2079 6d61  dow = (xmin, yma
-00012f50: 782c 2078 6d61 782c 2079 6d69 6e29 0d0a  x, xmax, ymin)..
-00012f60: 2020 2020 2020 2020 2320 2320 6764 616c          # # gdal
-00012f70: 2e54 7261 6e73 6c61 7465 4f70 7469 6f6e  .TranslateOption
-00012f80: 7328 6473 742c 2073 732c 2070 726f 6a57  s(dst, ss, projW
-00012f90: 696e 3d77 696e 646f 7729 0d0a 2020 2020  in=window)..    
-00012fa0: 2020 2020 2320 2320 636f 7079 2074 6865      # # copy the
-00012fb0: 2073 7263 2072 6173 7465 720d 0a20 2020   src raster..   
-00012fc0: 2020 2020 2023 2064 7276 203d 2067 6461       # drv = gda
-00012fd0: 6c2e 4765 7444 7269 7665 7242 794e 616d  l.GetDriverByNam
-00012fe0: 6528 224d 454d 2229 0d0a 2020 2020 2020  e("MEM")..      
-00012ff0: 2020 2320 6473 7420 3d20 6472 762e 4372    # dst = drv.Cr
-00013000: 6561 7465 436f 7079 2822 222c 2073 656c  eateCopy("", sel
-00013010: 662e 7261 7374 6572 2c20 3029 0d0a 2020  f.raster, 0)..  
-00013020: 2020 2020 2020 2320 7472 793a 0d0a 2020        # try:..  
-00013030: 2020 2020 2020 2320 2020 2020 6764 616c        #     gdal
-00013040: 2e54 7261 6e73 6c61 7465 2864 7374 2c20  .Translate(dst, 
-00013050: 7365 6c66 2e72 6173 7465 722c 2070 726f  self.raster, pro
-00013060: 6a57 696e 3d77 696e 646f 7729 0d0a 2020  jWin=window)..  
-00013070: 2020 2020 2020 2320 6578 6365 7074 2052        # except R
-00013080: 756e 7469 6d65 4572 726f 723a 0d0a 2020  untimeError:..  
-00013090: 2020 2020 2020 2320 2020 2020 7061 7373        #     pass
-000130a0: 0d0a 0d0a 2020 2020 2020 2020 2320 6372  ....        # cr
-000130b0: 6f70 7065 645f 6f62 6a20 3d20 4461 7461  opped_obj = Data
-000130c0: 7365 7428 6473 7429 0d0a 0d0a 2020 2020  set(dst)....    
-000130d0: 2020 2020 7265 7475 726e 2063 726f 7070      return cropp
-000130e0: 6564 5f6f 626a 0d0a 0d0a 2020 2020 6465  ed_obj....    de
-000130f0: 6620 6372 6f70 2873 656c 662c 206d 6173  f crop(self, mas
-00013100: 6b3a 2055 6e69 6f6e 5b47 656f 4461 7461  k: Union[GeoData
-00013110: 4672 616d 655d 293a 0d0a 2020 2020 2020  Frame]):..      
-00013120: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-00013130: 2020 2020 2063 6c69 7020 7468 6520 4461       clip the Da
-00013140: 7461 7365 7420 6f62 6a65 6374 2075 7369  taset object usi
-00013150: 6e67 2061 2070 6f6c 7967 6f6e 2f61 6e6f  ng a polygon/ano
-00013160: 7468 6572 2072 6173 7465 7220 2862 6f74  ther raster (bot
-00013170: 6820 7261 7374 6572 7320 646f 6573 206e  h rasters does n
-00013180: 6f74 2068 6176 6520 746f 2062 6520 616c  ot have to be al
-00013190: 6967 6e65 6429 2e0d 0a0d 0a20 2020 2020  igned).....     
-000131a0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-000131b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000131c0: 2d0d 0a20 2020 2020 2020 206d 6173 6b3a  -..        mask:
-000131d0: 205b 506f 6c79 676f 6e20 4765 6f44 6174   [Polygon GeoDat
-000131e0: 6146 7261 6d65 2f44 6174 6173 6574 206f  aFrame/Dataset o
-000131f0: 626a 6563 745d 0d0a 2020 2020 2020 2020  bject]..        
-00013200: 2020 2020 4765 6f64 6174 6146 7261 6d65      GeodataFrame
-00013210: 2077 6974 6820 6120 6765 6f6d 6574 7279   with a geometry
-00013220: 206f 6620 706f 6c79 676f 6e20 7479 7065   of polygon type
-00013230: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00013240: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00013250: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4461  ----..        Da
-00013260: 7461 7365 7420 4f62 6a65 6374 0d0a 2020  taset Object..  
-00013270: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00013280: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00013290: 286d 6173 6b2c 2047 656f 4461 7461 4672  (mask, GeoDataFr
-000132a0: 616d 6529 3a0d 0a20 2020 2020 2020 2020  ame):..         
-000132b0: 2020 2064 7374 203d 2073 656c 662e 5f63     dst = self._c
-000132c0: 726f 705f 7769 7468 5f70 6f6c 7967 6f6e  rop_with_polygon
-000132d0: 286d 6173 6b29 0d0a 2020 2020 2020 2020  (mask)..        
-000132e0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-000132f0: 6d61 736b 2c20 4461 7461 7365 7429 3a0d  mask, Dataset):.
-00013300: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
-00013310: 203d 2073 656c 662e 5f63 726f 705f 7769   = self._crop_wi
-00013320: 7468 5f72 6173 7465 7228 6d61 736b 290d  th_raster(mask).
-00013330: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00013340: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00013350: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
-00013360: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-00013370: 6865 2073 6563 6f6e 6420 7061 7261 6d65  he second parame
-00013380: 7465 723a 206d 6173 6b20 636f 756c 6420  ter: mask could 
-00013390: 6265 2065 6974 6865 7220 4765 6f44 6174  be either GeoDat
-000133a0: 6146 7261 6d65 206f 7220 4461 7461 7365  aFrame or Datase
-000133b0: 7420 6f62 6a65 6374 220d 0a20 2020 2020  t object"..     
-000133c0: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-000133d0: 2020 2020 7265 7475 726e 2064 7374 0d0a      return dst..
-000133e0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-000133f0: 686f 640d 0a20 2020 2064 6566 205f 6e65  hod..    def _ne
-00013400: 6172 6573 745f 6e65 6967 6862 6f75 7228  arest_neighbour(
-00013410: 0d0a 2020 2020 2020 2020 6172 7261 793a  ..        array:
-00013420: 206e 702e 6e64 6172 7261 792c 206e 6f64   np.ndarray, nod
-00013430: 6174 6176 616c 7565 3a20 556e 696f 6e5b  atavalue: Union[
-00013440: 666c 6f61 742c 2069 6e74 5d2c 2072 6f77  float, int], row
-00013450: 733a 206c 6973 742c 2063 6f6c 733a 206c  s: list, cols: l
-00013460: 6973 740d 0a20 2020 2029 202d 3e20 6e70  ist..    ) -> np
-00013470: 2e6e 6461 7272 6179 3a0d 0a20 2020 2020  .ndarray:..     
-00013480: 2020 2022 2222 6e65 6172 6573 744e 6569     """nearestNei
-00013490: 6768 626f 7572 2e0d 0a0d 0a20 2020 2020  ghbour.....     
-000134a0: 2020 2020 2020 202d 2066 696c 6c73 2074         - fills t
-000134b0: 6865 2063 656c 6c73 206f 6620 6120 6769  he cells of a gi
-000134c0: 7665 6e20 696e 6469 6365 7320 696e 2072  ven indices in r
-000134d0: 6f77 7320 616e 6420 636f 6c73 2077 6974  ows and cols wit
-000134e0: 6820 7468 6520 7661 6c75 6520 6f66 2074  h the value of t
-000134f0: 6865 206e 6561 7265 7374 0d0a 2020 2020  he nearest..    
-00013500: 2020 2020 2020 2020 6e65 6967 6862 6f75          neighbou
-00013510: 722e 0d0a 2020 2020 2020 2020 2020 2020  r...            
-00013520: 2d20 5373 2074 6865 2072 6173 7465 7220  - Ss the raster 
-00013530: 6772 6964 2069 7320 7371 7561 7265 2073  grid is square s
-00013540: 6f20 7468 6520 3420 7065 7270 656e 6469  o the 4 perpendi
-00013550: 6375 6c61 7220 6469 7265 6374 696f 6e20  cular direction 
-00013560: 6172 6520 6f66 2074 6865 2073 616d 6520  are of the same 
-00013570: 7072 6f78 696d 6974 7920 736f 2074 6865  proximity so the
-00013580: 2066 756e 6374 696f 6e0d 0a20 2020 2020   function..     
-00013590: 2020 2020 2020 2067 6976 6573 2070 7269         gives pri
-000135a0: 6f72 6974 7920 746f 2074 6865 2072 6967  ority to the rig
-000135b0: 6874 2074 6865 6e20 6c65 6674 2074 6865  ht then left the
-000135c0: 6e20 626f 7474 6f6d 2074 6865 6e20 746f  n bottom then to
-000135d0: 7020 616e 6420 7468 6520 7361 6d65 2066  p and the same f
-000135e0: 6f72 2034 3520 6465 6772 6565 2069 6e63  or 45 degree inc
-000135f0: 6c69 6e65 6420 6469 7265 6374 696f 6e0d  lined direction.
-00013600: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
-00013610: 6874 2062 6f74 746f 6d20 7468 656e 206c  ht bottom then l
-00013620: 6566 7420 626f 7474 6f6d 2074 6865 6e20  eft bottom then 
-00013630: 6c65 6674 2054 6f70 2074 6865 6e20 7269  left Top then ri
-00013640: 6768 7420 546f 702e 0d0a 0d0a 2020 2020  ght Top.....    
-00013650: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00013660: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00013670: 2d2d 0d0a 2020 2020 2020 2020 6172 7261  --..        arra
-00013680: 793a 205b 6e75 6d70 792e 6172 7261 795d  y: [numpy.array]
-00013690: 0d0a 2020 2020 2020 2020 2020 2020 4172  ..            Ar
-000136a0: 7261 7920 746f 2066 696c 6c20 736f 6d65  ray to fill some
-000136b0: 206f 6620 6974 7320 6365 6c6c 7320 7769   of its cells wi
-000136c0: 7468 204e 6561 7265 7374 2076 616c 7565  th Nearest value
-000136d0: 2e0d 0a20 2020 2020 2020 206e 6f64 6174  ...        nodat
-000136e0: 6176 616c 7565 3a20 5b66 6c6f 6174 3332  avalue: [float32
-000136f0: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
-00013700: 616c 7565 2073 746f 7265 6420 696e 2063  alue stored in c
-00013710: 656c 6c73 2074 6861 7420 6973 206f 7574  ells that is out
-00013720: 206f 6620 7468 6520 646f 6d61 696e 0d0a   of the domain..
-00013730: 2020 2020 2020 2020 726f 7773 3a20 5b4c          rows: [L
-00013740: 6973 745d 0d0a 2020 2020 2020 2020 2020  ist]..          
-00013750: 2020 6c69 7374 206f 6620 7468 6520 726f    list of the ro
-00013760: 7773 2069 6e64 6578 206f 6620 7468 6520  ws index of the 
-00013770: 6365 6c6c 7320 796f 7520 7761 6e74 2074  cells you want t
-00013780: 6f20 6669 6c6c 2069 7420 7769 7468 0d0a  o fill it with..
-00013790: 2020 2020 2020 2020 2020 2020 6e65 6172              near
-000137a0: 6573 7420 6e65 6967 6862 6f75 722e 0d0a  est neighbour...
-000137b0: 2020 2020 2020 2020 636f 6c73 3a20 5b4c          cols: [L
-000137c0: 6973 745d 0d0a 2020 2020 2020 2020 2020  ist]..          
-000137d0: 2020 6c69 7374 206f 6620 7468 6520 636f    list of the co
-000137e0: 6c75 6d6e 2069 6e64 6578 206f 6620 7468  lumn index of th
-000137f0: 6520 6365 6c6c 7320 796f 7520 7761 6e74  e cells you want
-00013800: 2074 6f20 6669 6c6c 2069 7420 7769 7468   to fill it with
-00013810: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
-00013820: 6172 6573 7420 6e65 6967 6862 6f75 722e  arest neighbour.
-00013830: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00013840: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00013850: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
-00013860: 7261 793a 205b 6e75 6d70 7920 6172 7261  ray: [numpy arra
-00013870: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
-00013880: 4365 6c6c 7320 6f66 2067 6976 656e 2069  Cells of given i
-00013890: 6e64 6963 6573 2077 696c 6c20 6265 2066  ndices will be f
-000138a0: 696c 6c65 6420 7769 7468 2076 616c 7565  illed with value
-000138b0: 206f 6620 7468 6520 4e65 6172 6573 7420   of the Nearest 
-000138c0: 6e65 6967 6862 6f75 720d 0a0d 0a20 2020  neighbour....   
-000138d0: 2020 2020 2045 7861 6d70 6c65 730d 0a20       Examples.. 
-000138e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
-000138f0: 0a20 2020 2020 2020 203e 3e3e 2072 6173  .        >>> ras
-00013900: 7465 7220 3d20 6764 616c 2e4f 7065 6e28  ter = gdal.Open(
-00013910: 2264 656d 2e74 6966 2229 0d0a 2020 2020  "dem.tif")..    
-00013920: 2020 2020 3e3e 3e20 7265 715f 726f 7773      >>> req_rows
-00013930: 203d 205b 332c 3132 5d0d 0a20 2020 2020   = [3,12]..     
-00013940: 2020 203e 3e3e 2072 6571 5f63 6f6c 7320     >>> req_cols 
-00013950: 3d20 5b39 2c32 5d0d 0a20 2020 2020 2020  = [9,2]..       
-00013960: 203e 3e3e 206e 6577 5f61 7272 6179 203d   >>> new_array =
-00013970: 2044 6174 6173 6574 2e5f 6e65 6172 6573   Dataset._neares
-00013980: 745f 6e65 6967 6862 6f75 7228 7261 7374  t_neighbour(rast
-00013990: 6572 2c20 7265 715f 726f 7773 2c20 7265  er, req_rows, re
-000139a0: 715f 636f 6c73 290d 0a20 2020 2020 2020  q_cols)..       
-000139b0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-000139c0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-000139d0: 6172 7261 792c 206e 702e 6e64 6172 7261  array, np.ndarra
-000139e0: 7929 3a0d 0a20 2020 2020 2020 2020 2020  y):..           
-000139f0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00013a00: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00013a10: 2020 2022 7372 6320 7368 6f75 6c64 2062     "src should b
-00013a20: 6520 7265 6164 2075 7369 6e67 2067 6461  e read using gda
-00013a30: 6c20 2867 6461 6c20 6461 7461 7365 7420  l (gdal dataset 
-00013a40: 706c 6561 7365 2072 6561 6420 6974 2075  please read it u
-00013a50: 7369 6e67 2067 6461 6c20 6c69 6272 6172  sing gdal librar
-00013a60: 7929 2022 0d0a 2020 2020 2020 2020 2020  y) "..          
-00013a70: 2020 290d 0a20 2020 2020 2020 2069 6620    )..        if 
-00013a80: 6e6f 7420 6973 696e 7374 616e 6365 2872  not isinstance(r
-00013a90: 6f77 732c 206c 6973 7429 3a0d 0a20 2020  ows, list):..   
-00013aa0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00013ab0: 7970 6545 7272 6f72 2822 726f 7773 2069  ypeError("rows i
-00013ac0: 6e70 7574 2068 6173 2074 6f20 6265 206f  nput has to be o
-00013ad0: 6620 7479 7065 206c 6973 7422 290d 0a20  f type list").. 
-00013ae0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00013af0: 696e 7374 616e 6365 2863 6f6c 732c 206c  instance(cols, l
-00013b00: 6973 7429 3a0d 0a20 2020 2020 2020 2020  ist):..         
-00013b10: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00013b20: 6f72 2822 636f 6c73 2069 6e70 7574 2068  or("cols input h
-00013b30: 6173 2074 6f20 6265 206f 6620 7479 7065  as to be of type
-00013b40: 206c 6973 7422 290d 0a0d 0a20 2020 2020   list")....     
-00013b50: 2020 2023 2020 2020 6172 7261 793d 7261     #    array=ra
-00013b60: 7374 6572 2e52 6561 6441 7341 7272 6179  ster.ReadAsArray
-00013b70: 2829 0d0a 2020 2020 2020 2020 2320 2020  ()..        #   
-00013b80: 206e 6f64 6174 6176 616c 7565 3d6e 702e   nodatavalue=np.
-00013b90: 666c 6f61 7433 3228 7261 7374 6572 2e47  float32(raster.G
-00013ba0: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
-00013bb0: 4765 744e 6f44 6174 6156 616c 7565 2829  GetNoDataValue()
-00013bc0: 290d 0a0d 0a20 2020 2020 2020 206e 6f5f  )....        no_
-00013bd0: 726f 7773 203d 206e 702e 7368 6170 6528  rows = np.shape(
-00013be0: 6172 7261 7929 5b30 5d0d 0a20 2020 2020  array)[0]..     
-00013bf0: 2020 206e 6f5f 636f 6c73 203d 206e 702e     no_cols = np.
-00013c00: 7368 6170 6528 6172 7261 7929 5b31 5d0d  shape(array)[1].
-00013c10: 0a0d 0a20 2020 2020 2020 2066 6f72 2069  ...        for i
-00013c20: 2069 6e20 7261 6e67 6528 6c65 6e28 726f   in range(len(ro
-00013c30: 7773 2929 3a0d 0a20 2020 2020 2020 2020  ws)):..         
-00013c40: 2020 2023 2067 6976 6520 7468 6520 6365     # give the ce
-00013c50: 6c6c 2074 6865 2076 616c 7565 206f 6620  ll the value of 
-00013c60: 7468 6520 6365 6c6c 2074 6861 7420 6973  the cell that is
-00013c70: 2061 7420 7468 6520 7269 6768 740d 0a20   at the right.. 
-00013c80: 2020 2020 2020 2020 2020 2069 6620 6172             if ar
-00013c90: 7261 795b 726f 7773 5b69 5d2c 2063 6f6c  ray[rows[i], col
-00013ca0: 735b 695d 202b 2031 5d20 213d 206e 6f64  s[i] + 1] != nod
-00013cb0: 6174 6176 616c 7565 2061 6e64 2063 6f6c  atavalue and col
-00013cc0: 735b 695d 202b 2031 203c 3d20 6e6f 5f63  s[i] + 1 <= no_c
-00013cd0: 6f6c 733a 0d0a 2020 2020 2020 2020 2020  ols:..          
-00013ce0: 2020 2020 2020 6172 7261 795b 726f 7773        array[rows
-00013cf0: 5b69 5d2c 2063 6f6c 735b 695d 5d20 3d20  [i], cols[i]] = 
-00013d00: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
-00013d10: 6f6c 735b 695d 202b 2031 5d0d 0a0d 0a20  ols[i] + 1].... 
-00013d20: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00013d30: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
-00013d40: 6f6c 735b 695d 202d 2031 5d20 213d 206e  ols[i] - 1] != n
-00013d50: 6f64 6174 6176 616c 7565 2061 6e64 2063  odatavalue and c
-00013d60: 6f6c 735b 695d 202d 2031 203e 2030 3a0d  ols[i] - 1 > 0:.
-00013d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013d80: 2023 2067 6976 6520 7468 6520 6365 6c6c   # give the cell
-00013d90: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
-00013da0: 6520 6365 6c6c 2074 6861 7420 6973 2061  e cell that is a
-00013db0: 7420 7468 6520 6c65 6674 0d0a 2020 2020  t the left..    
-00013dc0: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00013dd0: 795b 726f 7773 5b69 5d2c 2063 6f6c 735b  y[rows[i], cols[
-00013de0: 695d 5d20 3d20 6172 7261 795b 726f 7773  i]] = array[rows
-00013df0: 5b69 5d2c 2063 6f6c 735b 695d 202d 2031  [i], cols[i] - 1
-00013e00: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-00013e10: 2065 6c69 6620 6172 7261 795b 726f 7773   elif array[rows
-00013e20: 5b69 5d20 2d20 312c 2063 6f6c 735b 695d  [i] - 1, cols[i]
-00013e30: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
-00013e40: 2061 6e64 2072 6f77 735b 695d 202d 2031   and rows[i] - 1
-00013e50: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
-00013e60: 2020 2020 2020 2023 2067 6976 6520 7468         # give th
-00013e70: 6520 6365 6c6c 2074 6865 2076 616c 7565  e cell the value
-00013e80: 206f 6620 7468 6520 6365 6c6c 2074 6861   of the cell tha
-00013e90: 7420 6973 2061 7420 7468 6520 626f 7474  t is at the bott
-00013ea0: 6f6d 0d0a 2020 2020 2020 2020 2020 2020  om..            
-00013eb0: 2020 2020 6172 7261 795b 726f 7773 5b69      array[rows[i
-00013ec0: 5d2c 2063 6f6c 735b 695d 5d20 3d20 6172  ], cols[i]] = ar
-00013ed0: 7261 795b 726f 7773 5b69 5d20 2d20 312c  ray[rows[i] - 1,
-00013ee0: 2063 6f6c 735b 695d 5d0d 0a0d 0a20 2020   cols[i]]....   
-00013ef0: 2020 2020 2020 2020 2065 6c69 6620 6172           elif ar
-00013f00: 7261 795b 726f 7773 5b69 5d20 2b20 312c  ray[rows[i] + 1,
-00013f10: 2063 6f6c 735b 695d 5d20 213d 206e 6f64   cols[i]] != nod
-00013f20: 6174 6176 616c 7565 2061 6e64 2072 6f77  atavalue and row
-00013f30: 735b 695d 202b 2031 203c 3d20 6e6f 5f72  s[i] + 1 <= no_r
-00013f40: 6f77 733a 0d0a 2020 2020 2020 2020 2020  ows:..          
-00013f50: 2020 2020 2020 2320 6769 7665 2074 6865        # give the
-00013f60: 2063 656c 6c20 7468 6520 7661 6c75 6520   cell the value 
-00013f70: 6f66 2074 6865 2063 656c 6c20 7468 6174  of the cell that
-00013f80: 2069 7320 6174 2074 6865 2054 6f70 0d0a   is at the Top..
-00013f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fa0: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
-00013fb0: 6f6c 735b 695d 5d20 3d20 6172 7261 795b  ols[i]] = array[
-00013fc0: 726f 7773 5b69 5d20 2b20 312c 2063 6f6c  rows[i] + 1, col
-00013fd0: 735b 695d 5d0d 0a0d 0a20 2020 2020 2020  s[i]]....       
-00013fe0: 2020 2020 2065 6c69 6620 280d 0a20 2020       elif (..   
-00013ff0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
-00014000: 6179 5b72 6f77 735b 695d 202d 2031 2c20  ay[rows[i] - 1, 
-00014010: 636f 6c73 5b69 5d20 2b20 315d 2021 3d20  cols[i] + 1] != 
-00014020: 6e6f 6461 7461 7661 6c75 650d 0a20 2020  nodatavalue..   
-00014030: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-00014040: 2072 6f77 735b 695d 202d 2031 203e 2030   rows[i] - 1 > 0
-00014050: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014060: 2020 616e 6420 636f 6c73 5b69 5d20 2b20    and cols[i] + 
-00014070: 3120 3c3d 206e 6f5f 636f 6c73 0d0a 2020  1 <= no_cols..  
-00014080: 2020 2020 2020 2020 2020 293a 0d0a 2020            ):..  
-00014090: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000140a0: 6769 7665 2074 6865 2063 656c 6c20 7468  give the cell th
-000140b0: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
-000140c0: 656c 6c20 7468 6174 2069 7320 6174 2074  ell that is at t
-000140d0: 6865 2072 6967 6874 2062 6f74 746f 6d0d  he right bottom.
-000140e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000140f0: 2061 7272 6179 5b72 6f77 735b 695d 2c20   array[rows[i], 
-00014100: 636f 6c73 5b69 5d5d 203d 2061 7272 6179  cols[i]] = array
-00014110: 5b72 6f77 735b 695d 202d 2031 2c20 636f  [rows[i] - 1, co
-00014120: 6c73 5b69 5d20 2b20 315d 0d0a 0d0a 2020  ls[i] + 1]....  
-00014130: 2020 2020 2020 2020 2020 656c 6966 2028            elif (
-00014140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014150: 2020 6172 7261 795b 726f 7773 5b69 5d20    array[rows[i] 
-00014160: 2d20 312c 2063 6f6c 735b 695d 202d 2031  - 1, cols[i] - 1
-00014170: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
-00014180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014190: 2020 616e 6420 726f 7773 5b69 5d20 2d20    and rows[i] - 
-000141a0: 3120 3e20 300d 0a20 2020 2020 2020 2020  1 > 0..         
-000141b0: 2020 2020 2020 2061 6e64 2063 6f6c 735b         and cols[
-000141c0: 695d 202d 2031 203e 2030 0d0a 2020 2020  i] - 1 > 0..    
-000141d0: 2020 2020 2020 2020 293a 0d0a 2020 2020          ):..    
-000141e0: 2020 2020 2020 2020 2020 2020 2320 6769              # gi
-000141f0: 7665 2074 6865 2063 656c 6c20 7468 6520  ve the cell the 
-00014200: 7661 6c75 6520 6f66 2074 6865 2063 656c  value of the cel
-00014210: 6c20 7468 6174 2069 7320 6174 2074 6865  l that is at the
-00014220: 206c 6566 7420 626f 7474 6f6d 0d0a 2020   left bottom..  
-00014230: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-00014240: 7261 795b 726f 7773 5b69 5d2c 2063 6f6c  ray[rows[i], col
-00014250: 735b 695d 5d20 3d20 6172 7261 795b 726f  s[i]] = array[ro
-00014260: 7773 5b69 5d20 2d20 312c 2063 6f6c 735b  ws[i] - 1, cols[
-00014270: 695d 202d 2031 5d0d 0a0d 0a20 2020 2020  i] - 1]....     
-00014280: 2020 2020 2020 2065 6c69 6620 280d 0a20         elif (.. 
-00014290: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000142a0: 7272 6179 5b72 6f77 735b 695d 202b 2031  rray[rows[i] + 1
-000142b0: 2c20 636f 6c73 5b69 5d20 2d20 315d 2021  , cols[i] - 1] !
-000142c0: 3d20 6e6f 6461 7461 7661 6c75 650d 0a20  = nodatavalue.. 
-000142d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000142e0: 6e64 2072 6f77 735b 695d 202b 2031 203c  nd rows[i] + 1 <
-000142f0: 3d20 6e6f 5f72 6f77 730d 0a20 2020 2020  = no_rows..     
-00014300: 2020 2020 2020 2020 2020 2061 6e64 2063             and c
-00014310: 6f6c 735b 695d 202d 2031 203e 2030 0d0a  ols[i] - 1 > 0..
-00014320: 2020 2020 2020 2020 2020 2020 293a 0d0a              ):..
-00014330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014340: 2320 6769 7665 2074 6865 2063 656c 6c20  # give the cell 
-00014350: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
-00014360: 2063 656c 6c20 7468 6174 2069 7320 6174   cell that is at
-00014370: 2074 6865 206c 6566 7420 546f 700d 0a20   the left Top.. 
-00014380: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00014390: 7272 6179 5b72 6f77 735b 695d 2c20 636f  rray[rows[i], co
-000143a0: 6c73 5b69 5d5d 203d 2061 7272 6179 5b72  ls[i]] = array[r
-000143b0: 6f77 735b 695d 202b 2031 2c20 636f 6c73  ows[i] + 1, cols
-000143c0: 5b69 5d20 2d20 315d 0d0a 0d0a 2020 2020  [i] - 1]....    
-000143d0: 2020 2020 2020 2020 656c 6966 2028 0d0a          elif (..
-000143e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143f0: 6172 7261 795b 726f 7773 5b69 5d20 2b20  array[rows[i] + 
-00014400: 312c 2063 6f6c 735b 695d 202b 2031 5d20  1, cols[i] + 1] 
-00014410: 213d 206e 6f64 6174 6176 616c 7565 0d0a  != nodatavalue..
-00014420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014430: 616e 6420 726f 7773 5b69 5d20 2b20 3120  and rows[i] + 1 
-00014440: 3c3d 206e 6f5f 726f 7773 0d0a 2020 2020  <= no_rows..    
-00014450: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00014460: 636f 6c73 5b69 5d20 2b20 3120 3c3d 206e  cols[i] + 1 <= n
-00014470: 6f5f 636f 6c73 0d0a 2020 2020 2020 2020  o_cols..        
-00014480: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-00014490: 2020 2020 2020 2020 2320 6769 7665 2074          # give t
-000144a0: 6865 2063 656c 6c20 7468 6520 7661 6c75  he cell the valu
-000144b0: 6520 6f66 2074 6865 2063 656c 6c20 7468  e of the cell th
-000144c0: 6174 2069 7320 6174 2074 6865 2072 6967  at is at the rig
-000144d0: 6874 2054 6f70 0d0a 2020 2020 2020 2020  ht Top..        
-000144e0: 2020 2020 2020 2020 6172 7261 795b 726f          array[ro
-000144f0: 7773 5b69 5d2c 2063 6f6c 735b 695d 5d20  ws[i], cols[i]] 
-00014500: 3d20 6172 7261 795b 726f 7773 5b69 5d20  = array[rows[i] 
-00014510: 2b20 312c 2063 6f6c 735b 695d 202b 2031  + 1, cols[i] + 1
-00014520: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00014530: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00014540: 2020 2020 2020 7072 696e 7428 2274 6865        print("the
-00014550: 2063 656c 6c20 6973 2069 736f 6c61 7465   cell is isolate
-00014560: 6420 284e 6f20 7375 7272 6f75 6e64 696e  d (No surroundin
-00014570: 6720 6365 6c6c 7320 6578 6973 7429 2229  g cells exist)")
-00014580: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00014590: 2061 7272 6179 0d0a 0d0a 2020 2020 6465   array....    de
-000145a0: 6620 6c6f 6361 7465 5f70 6f69 6e74 7328  f locate_points(
-000145b0: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
-000145c0: 0a20 2020 2020 2020 2070 6f69 6e74 733a  .        points:
-000145d0: 2055 6e69 6f6e 5b47 656f 4461 7461 4672   Union[GeoDataFr
-000145e0: 616d 652c 2046 6561 7475 7265 436f 6c6c  ame, FeatureColl
-000145f0: 6563 7469 6f6e 2c20 4461 7461 4672 616d  ection, DataFram
-00014600: 655d 2c0d 0a20 2020 2029 202d 3e20 6e70  e],..    ) -> np
-00014610: 2e6e 6461 7272 6179 3a0d 0a20 2020 2020  .ndarray:..     
-00014620: 2020 2022 2222 6e65 6172 6573 7443 656c     """nearestCel
-00014630: 6c2e 0d0a 0d0a 2020 2020 2020 2020 2020  l.....          
-00014640: 2020 6e65 6172 6573 7443 656c 6c20 6361    nearestCell ca
-00014650: 6c63 756c 6174 6573 2074 6865 2074 6865  lculates the the
-00014660: 2069 6e64 6963 6573 2028 726f 7773 2c20   indices (rows, 
-00014670: 636f 6c29 206f 6620 6e65 6172 6573 7420  col) of nearest 
-00014680: 6365 6c6c 2069 6e20 6120 6769 7665 6e0d  cell in a given.
-00014690: 0a20 2020 2020 2020 2020 2020 2072 6173  .            ras
-000146a0: 7465 7220 746f 2061 2073 7461 7469 6f6e  ter to a station
-000146b0: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-000146c0: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
-000146d0: 6f66 2074 6865 2072 6173 7465 7220 6861  of the raster ha
-000146e0: 7320 746f 2062 6520 7072 6f6a 6563 7465  s to be projecte
-000146f0: 6420 746f 2062 6520 6162 6c65 2074 6f20  d to be able to 
-00014700: 6361 6c63 756c 6174 650d 0a20 2020 2020  calculate..     
-00014710: 2020 2020 2020 2074 6865 2064 6973 7461         the dista
-00014720: 6e63 650d 0a0d 0a20 2020 2020 2020 2050  nce....        P
-00014730: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00014740: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00014750: 2020 2020 2020 2070 6f69 6e74 733a 205b         points: [
-00014760: 4461 7461 6672 616d 655d 0d0a 2020 2020  Dataframe]..    
-00014770: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
-00014780: 6520 7769 7468 2050 4f49 4e54 2067 656f  e with POINT geo
-00014790: 6d65 7472 792e 0d0a 0d0a 2020 2020 2020  metry.....      
-000147a0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-000147b0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-000147c0: 2020 2020 6172 7261 793a 0d0a 2020 2020      array:..    
-000147d0: 2020 2020 2020 2020 6172 7261 7920 7769          array wi
-000147e0: 7468 2061 2073 6861 7065 2028 616e 792c  th a shape (any,
-000147f0: 2032 292c 2066 6f72 2074 6865 2072 6f77   2), for the row
-00014800: 2c20 636f 6c75 6d6e 2069 6e64 6963 6573  , column indices
-00014810: 2069 6e20 7468 6520 6172 7261 792e 0d0a   in the array...
-00014820: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00014830: 7928 5b5b 2035 2c20 2034 5d2c 0d0a 2020  y([[ 5,  4],..  
-00014840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014850: 205b 2032 2c20 2039 5d2c 0d0a 2020 2020   [ 2,  9],..    
-00014860: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00014870: 2035 2c20 2039 5d5d 290d 0a20 2020 2020   5,  9]])..     
-00014880: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00014890: 6966 2069 7369 6e73 7461 6e63 6528 706f  if isinstance(po
-000148a0: 696e 7473 2c20 4765 6f44 6174 6146 7261  ints, GeoDataFra
-000148b0: 6d65 293a 0d0a 2020 2020 2020 2020 2020  me):..          
-000148c0: 2020 706f 696e 7473 203d 2046 6561 7475    points = Featu
-000148d0: 7265 436f 6c6c 6563 7469 6f6e 2870 6f69  reCollection(poi
-000148e0: 6e74 7329 0d0a 2020 2020 2020 2020 656c  nts)..        el
-000148f0: 6966 2069 7369 6e73 7461 6e63 6528 706f  if isinstance(po
-00014900: 696e 7473 2c20 4461 7461 4672 616d 6529  ints, DataFrame)
-00014910: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00014920: 6620 616c 6c28 656c 656d 206e 6f74 2069  f all(elem not i
-00014930: 6e20 706f 696e 7473 2e63 6f6c 756d 6e73  n points.columns
-00014940: 2066 6f72 2065 6c65 6d20 696e 205b 2278   for elem in ["x
-00014950: 222c 2022 7922 5d29 3a0d 0a20 2020 2020  ", "y"]):..     
-00014960: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00014970: 2056 616c 7565 4572 726f 7228 0d0a 2020   ValueError(..  
-00014980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014990: 2020 2249 6620 7468 6520 696e 7075 7420    "If the input 
-000149a0: 696e 2061 2044 6174 6146 7261 6d65 2c20  in a DataFrame, 
-000149b0: 6974 2073 686f 756c 6420 6861 7665 2074  it should have t
-000149c0: 776f 2063 6f6c 756d 6e73 2078 2c20 616e  wo columns x, an
-000149d0: 6420 7922 0d0a 2020 2020 2020 2020 2020  d y"..          
-000149e0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-000149f0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00014a00: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00014a10: 7461 6e63 6528 706f 696e 7473 2c20 4665  tance(points, Fe
-00014a20: 6174 7572 6543 6f6c 6c65 6374 696f 6e29  atureCollection)
-00014a30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014a40: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00014a50: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-00014a60: 2020 2020 2020 2020 2066 2270 6c65 6173           f"pleas
-00014a70: 6520 6368 6563 6b20 706f 696e 7473 2069  e check points i
-00014a80: 6e70 7574 2069 7420 7368 6f75 6c64 2062  nput it should b
-00014a90: 6520 4765 6f44 6174 6146 7261 6d65 2f46  e GeoDataFrame/F
-00014aa0: 6561 7475 7265 436f 6c6c 6563 7469 6f6e  eatureCollection
-00014ab0: 202d 2067 6976 656e 207b 7479 7065 2870   - given {type(p
-00014ac0: 6f69 6e74 7329 7d22 0d0a 2020 2020 2020  oints)}"..      
-00014ad0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00014ae0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00014af0: 7374 616e 6365 2870 6f69 6e74 732c 2044  stance(points, D
-00014b00: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
-00014b10: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-00014b20: 6520 782c 2079 2063 6f6f 7264 696e 6174  e x, y coordinat
-00014b30: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
-00014b40: 2070 6f69 6e74 732e 7879 2829 0d0a 2020   points.xy()..  
-00014b50: 2020 2020 2020 2020 2020 706f 696e 7473            points
-00014b60: 203d 2070 6f69 6e74 732e 6665 6174 7572   = points.featur
-00014b70: 652e 6c6f 635b 3a2c 205b 2278 222c 2022  e.loc[:, ["x", "
-00014b80: 7922 5d5d 2e76 616c 7565 730d 0a20 2020  y"]].values..   
-00014b90: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00014ba0: 2020 2020 2020 2020 706f 696e 7473 203d          points =
-00014bb0: 2070 6f69 6e74 732e 6c6f 635b 3a2c 205b   points.loc[:, [
-00014bc0: 2278 222c 2022 7922 5d5d 2e76 616c 7565  "x", "y"]].value
-00014bd0: 730d 0a0d 0a20 2020 2020 2020 2023 2073  s....        # s
-00014be0: 696e 6365 2066 6972 7374 2072 6f77 2069  ince first row i
-00014bf0: 7320 782d 636f 6f72 6473 2073 6f20 7468  s x-coords so th
-00014c00: 6520 6669 7273 7420 636f 6c75 6d6e 2069  e first column i
-00014c10: 6e20 7468 6520 696e 6469 6365 7320 6973  n the indices is
-00014c20: 2074 6865 2063 6f6c 756d 6e20 696e 6465   the column inde
-00014c30: 780d 0a20 2020 2020 2020 2069 6e64 6963  x..        indic
-00014c40: 6573 203d 206c 6f63 6174 655f 7661 6c75  es = locate_valu
-00014c50: 6573 2870 6f69 6e74 732c 2073 656c 662e  es(points, self.
-00014c60: 782c 2073 656c 662e 7929 0d0a 2020 2020  x, self.y)..    
-00014c70: 2020 2020 2320 7265 6172 7261 6e67 6520      # rearrange 
-00014c80: 7468 6520 636f 6c75 6d6e 7320 746f 206d  the columns to m
-00014c90: 616b 6520 7468 6520 726f 7720 696e 6465  ake the row inde
-00014ca0: 7820 6669 7273 740d 0a20 2020 2020 2020  x first..       
-00014cb0: 2069 6e64 6963 6573 203d 2069 6e64 6963   indices = indic
-00014cc0: 6573 5b3a 2c20 5b31 2c20 305d 5d0d 0a20  es[:, [1, 0]].. 
-00014cd0: 2020 2020 2020 2072 6574 7572 6e20 696e         return in
-00014ce0: 6469 6365 730d 0a0d 0a20 2020 2064 6566  dices....    def
-00014cf0: 2065 7874 7261 6374 280d 0a20 2020 2020   extract(..     
-00014d00: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
-00014d10: 2020 6578 636c 7564 655f 7661 6c75 653a    exclude_value:
-00014d20: 2041 6e79 203d 204e 6f6e 652c 0d0a 2020   Any = None,..  
-00014d30: 2020 2020 2020 6665 6174 7572 653a 2055        feature: U
-00014d40: 6e69 6f6e 5b46 6561 7475 7265 436f 6c6c  nion[FeatureColl
-00014d50: 6563 7469 6f6e 2c20 4765 6f44 6174 6146  ection, GeoDataF
-00014d60: 7261 6d65 5d20 3d20 4e6f 6e65 2c0d 0a20  rame] = None,.. 
-00014d70: 2020 2029 202d 3e20 4c69 7374 3a0d 0a20     ) -> List:.. 
-00014d80: 2020 2020 2020 2022 2222 4578 7472 6163         """Extrac
-00014d90: 742e 0d0a 0d0a 2020 2020 2020 2020 2020  t.....          
-00014da0: 2020 2d20 4578 7472 6163 7420 6d65 7468    - Extract meth
-00014db0: 6f64 2067 6574 2061 6c6c 2074 6865 2076  od get all the v
-00014dc0: 616c 7565 7320 696e 2061 2072 6173 7465  alues in a raste
-00014dd0: 722c 2061 6e64 2065 7863 6c75 6465 2074  r, and exclude t
-00014de0: 6865 2076 616c 7565 7320 696e 2074 6865  he values in the
-00014df0: 2065 7863 6c75 6465 5f76 616c 7565 2070   exclude_value p
-00014e00: 6172 616d 6574 6572 2e0d 0a20 2020 2020  arameter...     
-00014e10: 2020 2020 2020 202d 2049 6620 7468 6520         - If the 
-00014e20: 6665 6174 7572 6520 7061 7261 6d65 7465  feature paramete
-00014e30: 7220 6973 2067 6976 656e 2074 6865 2072  r is given the r
-00014e40: 6173 7465 7220 7769 6c6c 2062 6520 636c  aster will be cl
-00014e50: 6970 6564 2074 6f20 7468 6520 6578 7465  iped to the exte
-00014e60: 6e74 206f 6620 7468 6520 6769 7665 6e20  nt of the given 
-00014e70: 6665 6174 7572 6520 616e 6420 7468 650d  feature and the.
-00014e80: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00014e90: 7565 7320 7769 7468 696e 2074 6865 2066  ues within the f
-00014ea0: 6561 7475 7265 2061 7265 2065 7874 7261  eature are extra
-00014eb0: 6374 6564 2e0d 0a0d 0a20 2020 2020 2020  cted.....       
-00014ec0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00014ed0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00014ee0: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
-00014ef0: 5f76 616c 7565 3a20 5b4e 756d 6572 6963  _value: [Numeric
-00014f00: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
-00014f10: 616c 7565 7320 796f 7520 7761 6e74 2074  alues you want t
-00014f20: 6f20 6578 636c 7564 6520 6672 6f6d 2065  o exclude from e
-00014f30: 7874 6561 6374 6564 2076 616c 7565 730d  xteacted values.
-00014f40: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00014f50: 3a20 5b46 6561 7475 7265 436f 6c6c 6563  : [FeatureCollec
-00014f60: 7469 6f6e 2f47 656f 4461 7461 4672 616d  tion/GeoDataFram
-00014f70: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
-00014f80: 7665 6374 6f72 2066 696c 6520 636f 6e74  vector file cont
-00014f90: 6169 6e73 2067 656f 6d65 7472 6965 7320  ains geometries 
-00014fa0: 796f 7520 7761 6e74 2074 6f20 6578 7472  you want to extr
-00014fb0: 6163 7420 7468 6520 7661 6c75 6573 2061  act the values a
-00014fc0: 7420 7468 6569 7220 6c6f 6361 7469 6f6e  t their location
-00014fd0: 2e20 4465 6661 756c 7420 6973 204e 6f6e  . Default is Non
-00014fe0: 652e 0d0a 2020 2020 2020 2020 2222 220d  e...        """.
-00014ff0: 0a20 2020 2020 2020 2061 7272 203d 2073  .        arr = s
-00015000: 656c 662e 7265 6164 5f61 7272 6179 2829  elf.read_array()
-00015010: 0d0a 0d0a 2020 2020 2020 2020 6966 2066  ....        if f
-00015020: 6561 7475 7265 2069 7320 4e6f 6e65 3a0d  eature is None:.
-00015030: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-00015040: 6b20 3d20 280d 0a20 2020 2020 2020 2020  k = (..         
-00015050: 2020 2020 2020 205b 7365 6c66 2e6e 6f5f         [self.no_
-00015060: 6461 7461 5f76 616c 7565 5b30 5d2c 2065  data_value[0], e
-00015070: 7863 6c75 6465 5f76 616c 7565 5d0d 0a20  xclude_value].. 
-00015080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00015090: 6620 6578 636c 7564 655f 7661 6c75 6520  f exclude_value 
-000150a0: 6973 206e 6f74 204e 6f6e 650d 0a20 2020  is not None..   
-000150b0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000150c0: 6520 5b73 656c 662e 6e6f 5f64 6174 615f  e [self.no_data_
-000150d0: 7661 6c75 655b 305d 5d0d 0a20 2020 2020  value[0]]..     
-000150e0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-000150f0: 2020 2020 2020 7661 6c75 6573 203d 2067        values = g
-00015100: 6574 5f70 6978 656c 7332 2861 7272 2c20  et_pixels2(arr, 
-00015110: 6d61 736b 290d 0a20 2020 2020 2020 2065  mask)..        e
-00015120: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00015130: 2020 696e 6469 6365 7320 3d20 7365 6c66    indices = self
-00015140: 2e6c 6f63 6174 655f 706f 696e 7473 2866  .locate_points(f
-00015150: 6561 7475 7265 290d 0a20 2020 2020 2020  eature)..       
-00015160: 2020 2020 2076 616c 7565 7320 3d20 6172       values = ar
-00015170: 725b 696e 6469 6365 735b 3a2c 2030 5d2c  r[indices[:, 0],
-00015180: 2069 6e64 6963 6573 5b3a 2c20 315d 5d0d   indices[:, 1]].
-00015190: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000151a0: 7661 6c75 6573 0d0a 0d0a 2020 2020 6465  values....    de
-000151b0: 6620 6f76 6572 6c61 7928 0d0a 2020 2020  f overlay(..    
-000151c0: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
-000151d0: 2020 2063 6c61 7373 6573 5f6d 6170 2c0d     classes_map,.
-000151e0: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
-000151f0: 5f76 616c 7565 3a20 556e 696f 6e5b 666c  _value: Union[fl
-00015200: 6f61 742c 2069 6e74 5d20 3d20 4e6f 6e65  oat, int] = None
-00015210: 2c0d 0a20 2020 2029 202d 3e20 4469 6374  ,..    ) -> Dict
-00015220: 5b4c 6973 745b 666c 6f61 745d 2c20 4c69  [List[float], Li
-00015230: 7374 5b66 6c6f 6174 5d5d 3a0d 0a20 2020  st[float]]:..   
-00015240: 2020 2020 2022 2222 4f76 6572 6c61 794d       """OverlayM
-00015250: 6170 2e0d 0a0d 0a20 2020 2020 2020 2020  ap.....         
-00015260: 2020 206f 7665 726c 6179 2065 7874 7261     overlay extra
-00015270: 6374 7320 616c 6c20 7468 6520 7661 6c75  cts all the valu
-00015280: 6573 2069 6e20 7261 7361 7465 7220 6669  es in rasater fi
-00015290: 6c65 2c20 6966 2079 6f75 2068 6176 6520  le, if you have 
-000152a0: 7477 6f20 6d61 7073 206f 6e65 2077 6974  two maps one wit
-000152b0: 6820 636c 6173 7365 732c 2061 6e64 2074  h classes, and t
-000152c0: 6865 206f 7468 6572 206d 6170 0d0a 2020  he other map..  
-000152d0: 2020 2020 2020 2020 2020 636f 6e74 6169            contai
-000152e0: 6e73 2061 6e79 2074 7970 6520 6f66 2076  ns any type of v
-000152f0: 616c 7565 732c 2061 6e64 2079 6f75 2077  alues, and you w
-00015300: 616e 7420 746f 206b 6e6f 7720 7468 6520  ant to know the 
-00015310: 7661 6c75 6573 2069 6e20 6561 6368 2063  values in each c
-00015320: 6c61 7373 2e0d 0a0d 0a20 2020 2020 2020  lass.....       
-00015330: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00015340: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00015350: 0a20 2020 2020 2020 2063 6c61 7373 6573  .        classes
-00015360: 5f6d 6170 3a20 5b44 6174 6173 6574 5d0d  _map: [Dataset].
-00015370: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
-00015380: 6173 6574 204f 626a 6563 7420 666f 7220  aset Object for 
-00015390: 7468 6520 7261 7374 6572 2074 6861 7420  the raster that 
-000153a0: 6861 7665 2063 6c61 7373 6573 2079 6f75  have classes you
-000153b0: 2077 616e 7420 746f 206f 7665 726c 6179   want to overlay
-000153c0: 2077 6974 6820 7468 6520 7261 7374 6572   with the raster
-000153d0: 2e0d 0a20 2020 2020 2020 2065 7863 6c75  ...        exclu
-000153e0: 6465 5f76 616c 7565 3a20 5b4e 756d 6572  de_value: [Numer
-000153f0: 6963 5d0d 0a20 2020 2020 2020 2020 2020  ic]..           
-00015400: 2076 616c 7565 7320 796f 7520 7761 6e74   values you want
-00015410: 2074 6f20 6578 636c 7564 6520 6672 6f6d   to exclude from
-00015420: 2065 7874 7261 6374 6564 2076 616c 7565   extracted value
-00015430: 732e 0d0a 0d0a 2020 2020 2020 2020 5265  s.....        Re
-00015440: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00015450: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00015460: 4469 6374 696f 6e61 7279 3a0d 0a20 2020  Dictionary:..   
-00015470: 2020 2020 2020 2020 2064 6963 746f 6e61           dictona
-00015480: 7279 2077 6974 6820 6120 6c69 7374 206f  ry with a list o
-00015490: 6620 7661 6c75 6573 2069 6e20 7468 6520  f values in the 
-000154a0: 6261 7365 6d61 7020 6173 206b 6579 7320  basemap as keys 
-000154b0: 616e 6420 666f 7220 6561 6368 206b 6579  and for each key
-000154c0: 2061 206c 6973 7420 6f66 2061 6c6c 2074   a list of all t
-000154d0: 6865 2069 6e74 6572 7365 6374 6564 0d0a  he intersected..
-000154e0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-000154f0: 6573 2069 6e20 7468 6520 6d61 7073 2066  es in the maps f
-00015500: 726f 6d20 7468 6520 7061 7468 2e0d 0a20  rom the path... 
-00015510: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00015520: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00015530: 5f63 6865 636b 5f61 6c69 676e 6d65 6e74  _check_alignment
-00015540: 2863 6c61 7373 6573 5f6d 6170 293a 0d0a  (classes_map):..
-00015550: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00015560: 6520 416c 6967 6e6d 656e 7445 7272 6f72  e AlignmentError
-00015570: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00015580: 2020 2022 5468 6520 636c 6173 7320 4461     "The class Da
-00015590: 7461 7365 7420 6973 206e 6f74 2061 6c69  taset is not ali
-000155a0: 676e 6564 2077 6974 6820 7468 6520 6375  gned with the cu
-000155b0: 7272 656e 7420 7261 7374 6572 2c20 706c  rrent raster, pl
-000155c0: 6173 6520 7573 6520 7468 6520 6d65 7468  ase use the meth
-000155d0: 6f64 2022 0d0a 2020 2020 2020 2020 2020  od "..          
-000155e0: 2020 2020 2020 2227 616c 6967 6e27 2074        "'align' t
-000155f0: 6f20 616c 6967 6e20 626f 7468 2072 6173  o align both ras
-00015600: 7465 7273 2e22 0d0a 2020 2020 2020 2020  ters."..        
-00015610: 2020 2020 290d 0a20 2020 2020 2020 2061      )..        a
-00015620: 7272 203d 2073 656c 662e 7265 6164 5f61  rr = self.read_a
-00015630: 7272 6179 2829 0d0a 2020 2020 2020 2020  rray()..        
-00015640: 6d61 736b 203d 2028 0d0a 2020 2020 2020  mask = (..      
-00015650: 2020 2020 2020 5b73 656c 662e 6e6f 5f64        [self.no_d
-00015660: 6174 615f 7661 6c75 655b 305d 2c20 6578  ata_value[0], ex
-00015670: 636c 7564 655f 7661 6c75 655d 0d0a 2020  clude_value]..  
-00015680: 2020 2020 2020 2020 2020 6966 2065 7863            if exc
-00015690: 6c75 6465 5f76 616c 7565 2069 7320 6e6f  lude_value is no
-000156a0: 7420 4e6f 6e65 0d0a 2020 2020 2020 2020  t None..        
-000156b0: 2020 2020 656c 7365 205b 7365 6c66 2e6e      else [self.n
-000156c0: 6f5f 6461 7461 5f76 616c 7565 5b30 5d5d  o_data_value[0]]
-000156d0: 0d0a 2020 2020 2020 2020 290d 0a20 2020  ..        )..   
-000156e0: 2020 2020 2069 6e64 203d 2067 6574 5f69       ind = get_i
-000156f0: 6e64 6963 6573 3228 6172 722c 206d 6173  ndices2(arr, mas
-00015700: 6b29 0d0a 2020 2020 2020 2020 636c 6173  k)..        clas
-00015710: 7365 7320 3d20 636c 6173 7365 735f 6d61  ses = classes_ma
-00015720: 702e 7265 6164 5f61 7272 6179 2829 0d0a  p.read_array()..
-00015730: 2020 2020 2020 2020 7661 6c75 6573 203d          values =
-00015740: 2064 6963 7428 290d 0a0d 0a20 2020 2020   dict()....     
-00015750: 2020 2023 2065 7874 7261 6374 2076 616c     # extract val
-00015760: 7565 730d 0a20 2020 2020 2020 2066 6f72  ues..        for
-00015770: 2069 2c20 696e 645f 6920 696e 2065 6e75   i, ind_i in enu
-00015780: 6d65 7261 7465 2869 6e64 293a 0d0a 2020  merate(ind):..  
-00015790: 2020 2020 2020 2020 2020 2320 6669 7273            # firs
-000157a0: 7420 6368 6563 6b20 6966 2074 6865 2073  t check if the s
-000157b0: 7562 2d62 6173 696e 2068 6173 2061 206c  ub-basin has a l
-000157c0: 6973 7420 696e 2074 6865 2064 6963 7420  ist in the dict 
-000157d0: 6966 206e 6f74 2063 7265 6174 6520 6120  if not create a 
-000157e0: 6c69 7374 0d0a 2020 2020 2020 2020 2020  list..          
-000157f0: 2020 6b65 7920 3d20 636c 6173 7365 735b    key = classes[
-00015800: 696e 645f 695b 305d 2c20 696e 645f 695b  ind_i[0], ind_i[
-00015810: 315d 5d0d 0a20 2020 2020 2020 2020 2020  1]]..           
-00015820: 2069 6620 6b65 7920 6e6f 7420 696e 206c   if key not in l
-00015830: 6973 7428 7661 6c75 6573 2e6b 6579 7328  ist(values.keys(
-00015840: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00015850: 2020 2020 2076 616c 7565 735b 6b65 795d       values[key]
-00015860: 203d 206c 6973 7428 290d 0a0d 0a20 2020   = list()....   
-00015870: 2020 2020 2020 2020 2076 616c 7565 735b           values[
-00015880: 6b65 795d 2e61 7070 656e 6428 6172 725b  key].append(arr[
-00015890: 696e 645f 695b 305d 2c20 696e 645f 695b  ind_i[0], ind_i[
-000158a0: 315d 5d29 0d0a 0d0a 2020 2020 2020 2020  1]])....        
-000158b0: 7265 7475 726e 2076 616c 7565 730d 0a0d  return values...
-000158c0: 0a20 2020 2064 6566 2066 6f6f 7470 7269  .    def footpri
-000158d0: 6e74 280d 0a20 2020 2020 2020 2073 656c  nt(..        sel
-000158e0: 662c 0d0a 2020 2020 2020 2020 6261 6e64  f,..        band
-000158f0: 3a20 696e 7420 3d20 302c 0d0a 2020 2020  : int = 0,..    
-00015900: 2020 2020 6578 636c 7564 655f 7661 6c75      exclude_valu
-00015910: 6573 3a20 4f70 7469 6f6e 616c 5b4c 6973  es: Optional[Lis
-00015920: 745b 416e 795d 5d20 3d20 4e6f 6e65 2c0d  t[Any]] = None,.
-00015930: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
-00015940: 4765 6f44 6174 6146 7261 6d65 2c20 4e6f  GeoDataFrame, No
-00015950: 6e65 5d3a 0d0a 2020 2020 2020 2020 2222  ne]:..        ""
-00015960: 2266 6f6f 7470 7269 6e74 2e0d 0a0d 0a20  "footprint..... 
-00015970: 2020 2020 2020 2020 2020 2065 7874 7261             extra
-00015980: 6374 5f65 7874 656e 7420 7461 6b65 7320  ct_extent takes 
-00015990: 6120 6764 616c 2072 6173 7465 7220 6f62  a gdal raster ob
-000159a0: 6a65 6374 2061 6e64 2072 6574 7572 6e73  ject and returns
-000159b0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-000159c0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-000159d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-000159e0: 2020 2020 6261 6e64 3a20 5b69 6e74 5d0d      band: [int].
-000159f0: 0a20 2020 2020 2020 2020 2020 2062 616e  .            ban
-00015a00: 6420 696e 6465 782e 2044 6566 6175 6c74  d index. Default
-00015a10: 2069 7320 302e 0d0a 2020 2020 2020 2020   is 0...        
-00015a20: 6578 636c 7564 655f 7661 6c75 6573 3a0d  exclude_values:.
-00015a30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00015a40: 796f 7520 7761 6e74 2074 6f20 6578 636c  you want to excl
-00015a50: 7564 655f 7661 6c75 6573 2061 2063 6572  ude_values a cer
-00015a60: 7461 696e 2076 616c 7565 2069 6e20 7468  tain value in th
-00015a70: 6520 7261 7374 6572 2077 6974 6820 616e  e raster with an
-00015a80: 6f74 6865 7220 7661 6c75 6520 696e 7465  other value inte
-00015a90: 7220 7468 6520 7477 6f20 7661 6c75 6573  r the two values
-00015aa0: 2061 7320 6120 6c69 7374 206f 6620 7475   as a list of tu
-00015ab0: 706c 6573 2061 0d0a 2020 2020 2020 2020  ples a..        
-00015ac0: 2020 2020 5b28 7661 6c75 655f 746f 5f62      [(value_to_b
-00015ad0: 655f 6578 636c 7564 655f 7661 6c75 6573  e_exclude_values
-00015ae0: 642c 206e 6577 5f76 616c 7565 295d 0d0a  d, new_value)]..
-00015af0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00015b00: 6578 636c 7564 655f 7661 6c75 6573 203d  exclude_values =
-00015b10: 205b 305d 0d0a 2020 2020 2020 2020 2020   [0]..          
-00015b20: 2020 2d20 5468 6973 2070 6172 616d 6574    - This paramet
-00015b30: 6572 2069 7320 696e 7472 6f64 7563 6564  er is introduced
-00015b40: 2070 6172 7469 6375 6c61 726c 7920 666f   particularly fo
-00015b50: 7220 7468 6520 6361 7365 206f 6620 7261  r the case of ra
-00015b60: 7374 6572 7320 7468 6174 2068 6173 2074  sters that has t
-00015b70: 6865 206e 6f64 6174 6176 616c 7565 2073  he nodatavalue s
-00015b80: 746f 7265 6420 696e 2074 6865 0d0a 2020  tored in the..  
-00015b90: 2020 2020 2020 2020 2020 6172 7261 7920            array 
-00015ba0: 646f 6573 206e 6f74 206d 6174 6368 2074  does not match t
-00015bb0: 6865 2076 616c 7565 2073 746f 7265 6420  he value stored 
-00015bc0: 696e 2061 7272 6179 2c20 736f 2074 6869  in array, so thi
-00015bd0: 7320 6f70 7469 6f6e 2063 616e 2063 6f72  s option can cor
-00015be0: 7265 6374 2074 6869 7320 6265 6861 7669  rect this behavi
-00015bf0: 6f72 2e0d 0a0d 0a20 2020 2020 2020 2052  or.....        R
-00015c00: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00015c10: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00015c20: 2047 656f 4461 7461 4672 616d 653a 0d0a   GeoDataFrame:..
-00015c30: 2020 2020 2020 2020 2020 2020 2d20 6765              - ge
-00015c40: 6f64 6174 6166 7261 6d65 2063 6f6e 7461  odataframe conta
-00015c50: 696e 696e 6720 7468 6520 706f 6c79 676f  ining the polygo
-00015c60: 6e20 7265 7072 6573 656e 7469 6e67 2074  n representing t
-00015c70: 6865 2065 7874 656e 7420 6f66 2074 6865  he extent of the
-00015c80: 2072 6173 7465 722e 2074 6865 2065 7874   raster. the ext
-00015c90: 656e 7420 636f 6c75 6d6e 2073 686f 756c  ent column shoul
-00015ca0: 640d 0a20 2020 2020 2020 2020 2020 2063  d..            c
-00015cb0: 6f6e 7461 696e 7320 6120 7661 6c75 6520  ontains a value 
-00015cc0: 6f66 2020 3220 6f6e 6c79 2e0d 0a20 2020  of  2 only...   
-00015cd0: 2020 2020 2020 2020 202d 2069 6620 7468           - if th
-00015ce0: 6520 6461 7461 7365 7420 6861 6420 7365  e dataset had se
-00015cf0: 7061 7261 7465 2070 6f6c 7967 6f6e 7320  parate polygons 
-00015d00: 6561 6368 2070 6f6c 7967 6f6e 2077 696c  each polygon wil
-00015d10: 6c20 6265 2069 6e20 6120 7365 7061 7261  l be in a separa
-00015d20: 7465 2072 6f77 2e0d 0a20 2020 2020 2020  te row...       
-00015d30: 2022 2222 0d0a 2020 2020 2020 2020 6172   """..        ar
-00015d40: 7220 3d20 7365 6c66 2e72 6561 645f 6172  r = self.read_ar
-00015d50: 7261 7928 6261 6e64 3d62 616e 6429 0d0a  ray(band=band)..
-00015d60: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
-00015d70: 7661 6c20 3d20 7365 6c66 2e6e 6f5f 6461  val = self.no_da
-00015d80: 7461 5f76 616c 7565 5b62 616e 645d 0d0a  ta_value[band]..
-00015d90: 0d0a 2020 2020 2020 2020 6966 206e 6f5f  ..        if no_
-00015da0: 6461 7461 5f76 616c 2069 7320 4e6f 6e65  data_val is None
-00015db0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00015dc0: 6620 6e6f 7420 286e 702e 6973 6e61 6e28  f not (np.isnan(
-00015dd0: 6172 7229 292e 616e 7928 293a 0d0a 2020  arr)).any():..  
-00015de0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-00015df0: 6767 6572 2e77 6172 6e69 6e67 280d 0a20  gger.warning(.. 
-00015e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e10: 2020 2022 7468 6520 6e6f 6461 7461 2076     "the nodata v
-00015e20: 616c 7565 7320 7374 6f72 6564 2069 6e20  alues stored in 
-00015e30: 7468 6520 7261 7374 6572 2064 6f65 7320  the raster does 
-00015e40: 6e6f 7420 6578 6973 7420 696e 2074 6865  not exist in the
-00015e50: 2072 6173 7465 7220 220d 0a20 2020 2020   raster "..     
-00015e60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00015e70: 736f 2065 6974 6865 7220 7468 6520 7261  so either the ra
-00015e80: 7374 6572 2065 7874 656e 7420 6973 2061  ster extent is a
-00015e90: 6c6c 2066 756c 6c20 7769 7468 2064 6174  ll full with dat
-00015ea0: 6120 6f72 2074 6865 206e 6f64 6174 6176  a or the nodatav
-00015eb0: 616c 7565 2073 746f 7265 6420 696e 2074  alue stored in t
-00015ec0: 6865 2072 6173 7465 7220 6973 220d 0a20  he raster is".. 
-00015ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ee0: 2020 2022 206e 6f74 2063 6f72 7265 6374     " not correct
-00015ef0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00015f00: 2020 2029 0d0a 2020 2020 2020 2020 656c     )..        el
-00015f10: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00015f20: 2069 6620 6e6f 7420 286e 702e 6973 636c   if not (np.iscl
-00015f30: 6f73 6528 6172 722c 206e 6f5f 6461 7461  ose(arr, no_data
-00015f40: 5f76 616c 2c20 7274 6f6c 3d30 2e30 3030  _val, rtol=0.000
-00015f50: 3031 2929 2e61 6e79 2829 3a0d 0a20 2020  01)).any():..   
-00015f60: 2020 2020 2020 2020 2020 2020 206c 6f67               log
-00015f70: 6765 722e 7761 726e 696e 6728 0d0a 2020  ger.warning(..  
-00015f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f90: 2020 2274 6865 206e 6f64 6174 6120 7661    "the nodata va
-00015fa0: 6c75 6573 2073 746f 7265 6420 696e 2074  lues stored in t
-00015fb0: 6865 2072 6173 7465 7220 646f 6573 206e  he raster does n
-00015fc0: 6f74 2065 7869 7374 2069 6e20 7468 6520  ot exist in the 
-00015fd0: 7261 7374 6572 2022 0d0a 2020 2020 2020  raster "..      
-00015fe0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00015ff0: 6f20 6569 7468 6572 2074 6865 2072 6173  o either the ras
-00016000: 7465 7220 6578 7465 6e74 2069 7320 616c  ter extent is al
-00016010: 6c20 6675 6c6c 2077 6974 6820 6461 7461  l full with data
-00016020: 206f 7220 7468 6520 6e6f 6461 7461 7661   or the nodatava
-00016030: 6c75 6520 7374 6f72 6564 2069 6e20 7468  lue stored in th
-00016040: 6520 7261 7374 6572 2069 7322 0d0a 2020  e raster is"..  
-00016050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016060: 2020 2220 6e6f 7420 636f 7272 6563 7422    " not correct"
-00016070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016080: 2020 290d 0a20 2020 2020 2020 2023 2069    )..        # i
-00016090: 6620 796f 7520 7761 6e74 2074 6f20 6578  f you want to ex
-000160a0: 636c 7564 655f 7661 6c75 6573 2061 6e79  clude_values any
-000160b0: 2076 616c 7565 2069 6e20 7468 6520 7261   value in the ra
-000160c0: 7374 6572 0d0a 2020 2020 2020 2020 6966  ster..        if
-000160d0: 2065 7863 6c75 6465 5f76 616c 7565 733a   exclude_values:
-000160e0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-000160f0: 7220 7661 6c20 696e 2065 7863 6c75 6465  r val in exclude
-00016100: 5f76 616c 7565 733a 0d0a 2020 2020 2020  _values:..      
-00016110: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-00016120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016130: 2020 2020 2320 696e 2063 6173 6520 7468      # in case th
-00016140: 6520 7661 6c32 2069 7320 4e6f 6e65 2061  e val2 is None a
-00016150: 6e64 2074 6865 2061 7272 6179 2069 7320  nd the array is 
-00016160: 696e 7420 7479 7065 2074 6865 2066 6f6c  int type the fol
-00016170: 6c6f 7769 6e67 206c 696e 6520 7769 6c6c  lowing line will
-00016180: 2067 6976 6520 6572 726f 7220 6173 204e   give error as N
-00016190: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
-000161a0: 2020 2020 2020 2020 2023 2069 7320 636f           # is co
-000161b0: 6e73 6964 6572 6564 2061 7320 666c 6f61  nsidered as floa
-000161c0: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
-000161d0: 2020 2020 2020 2061 7272 5b6e 702e 6973         arr[np.is
-000161e0: 636c 6f73 6528 6172 722c 2076 616c 295d  close(arr, val)]
-000161f0: 203d 206e 6f5f 6461 7461 5f76 616c 0d0a   = no_data_val..
-00016200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016210: 6578 6365 7074 2054 7970 6545 7272 6f72  except TypeError
-00016220: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00016230: 2020 2020 2020 2061 7272 203d 2061 7272         arr = arr
-00016240: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-00016250: 3332 290d 0a20 2020 2020 2020 2020 2020  32)..           
-00016260: 2020 2020 2020 2020 2061 7272 5b6e 702e           arr[np.
-00016270: 6973 636c 6f73 6528 6172 722c 2076 616c  isclose(arr, val
-00016280: 295d 203d 206e 6f5f 6461 7461 5f76 616c  )] = no_data_val
-00016290: 0d0a 0d0a 2020 2020 2020 2020 2320 7265  ....        # re
-000162a0: 706c 6163 6520 616c 6c20 7468 6520 7661  place all the va
-000162b0: 6c75 6573 2077 6974 6820 320d 0a20 2020  lues with 2..   
-000162c0: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
-000162d0: 7661 6c20 6973 204e 6f6e 653a 0d0a 2020  val is None:..  
-000162e0: 2020 2020 2020 2020 2020 2320 6368 6563            # chec
-000162f0: 6b20 6966 2074 6865 2077 686f 6c65 2072  k if the whole r
-00016300: 6173 7465 7220 6973 2066 756c 6c20 6f66  aster is full of
-00016310: 206e 6f5f 6461 7461 5f76 616c 7565 0d0a   no_data_value..
-00016320: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-00016330: 6e70 2e69 736e 616e 2861 7272 2929 2e61  np.isnan(arr)).a
-00016340: 6c6c 2829 3a0d 0a20 2020 2020 2020 2020  ll():..         
-00016350: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
-00016360: 726e 696e 6728 2274 6865 2072 6173 7465  rning("the raste
-00016370: 7220 6973 2066 756c 6c20 6f66 206e 6f5f  r is full of no_
-00016380: 6461 7461 5f76 616c 7565 2229 0d0a 2020  data_value")..  
-00016390: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000163a0: 7475 726e 204e 6f6e 650d 0a0d 0a20 2020  turn None....   
-000163b0: 2020 2020 2020 2020 2061 7272 5b7e 6e70           arr[~np
-000163c0: 2e69 736e 616e 2861 7272 295d 203d 2032  .isnan(arr)] = 2
-000163d0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000163e0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-000163f0: 6865 636b 2069 6620 7468 6520 7768 6f6c  heck if the whol
-00016400: 6520 7261 7374 6572 2069 7320 6675 6c6c  e raster is full
-00016410: 206f 6620 6e6f 6461 7461 7661 6c75 650d   of nodatavalue.
-00016420: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00016430: 286e 702e 6973 636c 6f73 6528 6172 722c  (np.isclose(arr,
-00016440: 206e 6f5f 6461 7461 5f76 616c 2c20 7274   no_data_val, rt
-00016450: 6f6c 3d30 2e30 3030 3031 2929 2e61 6c6c  ol=0.00001)).all
-00016460: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-00016470: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
-00016480: 696e 6728 2274 6865 2072 6173 7465 7220  ing("the raster 
-00016490: 6973 2066 756c 6c20 6f66 206e 6f5f 6461  is full of no_da
-000164a0: 7461 5f76 616c 7565 2229 0d0a 2020 2020  ta_value")..    
-000164b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000164c0: 726e 204e 6f6e 650d 0a0d 0a20 2020 2020  rn None....     
-000164d0: 2020 2020 2020 2061 7272 5b7e 6e70 2e69         arr[~np.i
-000164e0: 7363 6c6f 7365 2861 7272 2c20 6e6f 5f64  sclose(arr, no_d
-000164f0: 6174 615f 7661 6c2c 2072 746f 6c3d 302e  ata_val, rtol=0.
-00016500: 3030 3030 3129 5d20 3d20 320d 0a20 2020  00001)] = 2..   
-00016510: 2020 2020 206e 6577 5f64 6174 6173 6574       new_dataset
-00016520: 203d 2073 656c 662e 6372 6561 7465 5f66   = self.create_f
-00016530: 726f 6d5f 6172 7261 7928 0d0a 2020 2020  rom_array(..    
-00016540: 2020 2020 2020 2020 6172 722c 2073 656c          arr, sel
-00016550: 662e 6765 6f74 7261 6e73 666f 726d 2c20  f.geotransform, 
-00016560: 7365 6c66 2e65 7073 672c 2073 656c 662e  self.epsg, self.
-00016570: 6e6f 5f64 6174 615f 7661 6c75 650d 0a20  no_data_value.. 
-00016580: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00016590: 2020 2320 7468 656e 2063 6f6e 7665 7274    # then convert
-000165a0: 2074 6865 2072 6173 6174 6572 2069 6e74   the rasater int
-000165b0: 6f20 706f 6c79 676f 6e0d 0a20 2020 2020  o polygon..     
-000165c0: 2020 2067 6466 203d 206e 6577 5f64 6174     gdf = new_dat
-000165d0: 6173 6574 2e74 6f5f 706f 6c79 676f 6e28  aset.to_polygon(
-000165e0: 6261 6e64 3d62 616e 6429 0d0a 0d0a 2020  band=band)....  
-000165f0: 2020 2020 2020 7265 7475 726e 2067 6466        return gdf
-00016600: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-00016610: 6574 686f 640d 0a20 2020 2064 6566 206e  ethod..    def n
-00016620: 6f72 6d61 6c69 7a65 2861 7272 6179 3a20  ormalize(array: 
-00016630: 6e70 2e6e 6461 7272 6179 293a 0d0a 2020  np.ndarray):..  
-00016640: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00016650: 2020 204e 6f72 6d61 6c69 7a65 7320 6e75     Normalizes nu
-00016660: 6d70 7920 6172 7261 7973 2069 6e74 6f20  mpy arrays into 
-00016670: 7363 616c 6520 302e 3020 2d20 312e 300d  scale 0.0 - 1.0.
-00016680: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00016690: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-000166a0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-000166b0: 2020 2061 7272 6179 203a 205b 6172 7261     array : [arra
-000166c0: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
-000166d0: 6e75 6d70 7920 6172 7261 790d 0a0d 0a20  numpy array.... 
-000166e0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-000166f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-00016700: 0a20 2020 2020 2020 2061 7272 6179 0d0a  .        array..
-00016710: 2020 2020 2020 2020 2020 2020 4445 5343              DESC
-00016720: 5249 5054 494f 4e2e 0d0a 2020 2020 2020  RIPTION...      
-00016730: 2020 2222 220d 0a20 2020 2020 2020 2061    """..        a
-00016740: 7272 6179 5f6d 696e 203d 2061 7272 6179  rray_min = array
-00016750: 2e6d 696e 2829 0d0a 2020 2020 2020 2020  .min()..        
-00016760: 6172 7261 795f 6d61 7820 3d20 6172 7261  array_max = arra
-00016770: 792e 6d61 7828 290d 0a20 2020 2020 2020  y.max()..       
-00016780: 2076 616c 203d 2028 6172 7261 7920 2d20   val = (array - 
-00016790: 6172 7261 795f 6d69 6e29 202f 2028 6172  array_min) / (ar
-000167a0: 7261 795f 6d61 7820 2d20 6172 7261 795f  ray_max - array_
-000167b0: 6d69 6e29 0d0a 2020 2020 2020 2020 7265  min)..        re
-000167c0: 7475 726e 2076 616c 0d0a 0d0a 2020 2020  turn val....    
-000167d0: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
-000167e0: 2020 2064 6566 205f 7769 6e64 6f77 2873     def _window(s
-000167f0: 7263 3a20 6764 616c 2e44 6174 6173 6574  rc: gdal.Dataset
-00016800: 2c20 7369 7a65 3a20 696e 7420 3d20 3235  , size: int = 25
-00016810: 3629 3a0d 0a20 2020 2020 2020 2022 2222  6):..        """
-00016820: 4461 7461 7365 7420 7371 7561 7265 2077  Dataset square w
-00016830: 696e 646f 7720 7369 7a65 2f6f 6666 7365  indow size/offse
-00016840: 7473 2e0d 0a0d 0a20 2020 2020 2020 2050  ts.....        P
-00016850: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00016860: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00016870: 2020 2020 2020 2073 7263 203a 205b 6764         src : [gd
-00016880: 616c 2e44 6174 6163 7562 655d 0d0a 2020  al.Datacube]..  
-00016890: 2020 2020 2020 2020 2020 6764 616c 2044            gdal D
-000168a0: 6174 6163 7562 6520 6f62 6a65 6374 2e0d  atacube object..
-000168b0: 0a20 2020 2020 2020 2073 697a 6520 3a20  .        size : 
-000168c0: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
-000168d0: 2020 2053 697a 6520 6f66 2077 696e 646f     Size of windo
-000168e0: 7720 696e 2070 6978 656c 732e 204f 6e65  w in pixels. One
-000168f0: 2076 616c 7565 2072 6571 7569 7265 6420   value required 
-00016900: 7768 6963 6820 6973 2075 7365 6420 666f  which is used fo
-00016910: 7220 626f 7468 2074 6865 0d0a 2020 2020  r both the..    
-00016920: 2020 2020 2020 2020 7820 616e 6420 7920          x and y 
-00016930: 7369 7a65 2e20 452e 6720 3235 3620 6d65  size. E.g 256 me
-00016940: 616e 7320 6120 3235 3678 3235 3620 7769  ans a 256x256 wi
-00016950: 6e64 6f77 2e0d 0a0d 0a20 2020 2020 2020  ndow.....       
-00016960: 2059 6965 6c64 730d 0a20 2020 2020 2020   Yields..       
-00016970: 202d 2d2d 2d2d 2d0d 0a20 2020 2020 2020   ------..       
-00016980: 2074 7570 6c65 5b69 6e74 5d0d 0a20 2020   tuple[int]..   
-00016990: 2020 2020 2020 2020 2034 2065 6c65 6d65           4 eleme
-000169a0: 6e74 2074 7570 6c65 2063 6f6e 7461 696e  nt tuple contain
-000169b0: 696e 6720 7468 6520 7820 7369 7a65 2c20  ing the x size, 
-000169c0: 7920 7369 7a65 2c20 7820 6f66 6673 6574  y size, x offset
-000169d0: 2061 6e64 2079 206f 6666 7365 740d 0a20   and y offset.. 
-000169e0: 2020 2020 2020 2020 2020 206f 6620 7468             of th
-000169f0: 6520 7769 6e64 6f77 2e0d 0a20 2020 2020  e window...     
-00016a00: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00016a10: 636f 6c73 203d 2073 7263 2e52 6173 7465  cols = src.Raste
-00016a20: 7258 5369 7a65 0d0a 2020 2020 2020 2020  rXSize..        
-00016a30: 726f 7773 203d 2073 7263 2e52 6173 7465  rows = src.Raste
-00016a40: 7259 5369 7a65 0d0a 2020 2020 2020 2020  rYSize..        
-00016a50: 666f 7220 786f 6666 2069 6e20 7261 6e67  for xoff in rang
-00016a60: 6528 302c 2063 6f6c 732c 2073 697a 6529  e(0, cols, size)
-00016a70: 3a0d 0a20 2020 2020 2020 2020 2020 2078  :..            x
-00016a80: 7369 7a65 203d 2073 697a 6520 6966 2073  size = size if s
-00016a90: 697a 6520 2b20 786f 6666 203c 3d20 636f  ize + xoff <= co
-00016aa0: 6c73 2065 6c73 6520 636f 6c73 202d 2078  ls else cols - x
-00016ab0: 6f66 660d 0a20 2020 2020 2020 2020 2020  off..           
-00016ac0: 2066 6f72 2079 6f66 6620 696e 2072 616e   for yoff in ran
-00016ad0: 6765 2830 2c20 726f 7773 2c20 7369 7a65  ge(0, rows, size
-00016ae0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00016af0: 2020 2020 7973 697a 6520 3d20 7369 7a65      ysize = size
-00016b00: 2069 6620 7369 7a65 202b 2079 6f66 6620   if size + yoff 
-00016b10: 3c3d 2072 6f77 7320 656c 7365 2072 6f77  <= rows else row
-00016b20: 7320 2d20 796f 6666 0d0a 2020 2020 2020  s - yoff..      
-00016b30: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00016b40: 7873 697a 652c 2079 7369 7a65 2c20 786f  xsize, ysize, xo
-00016b50: 6666 2c20 796f 6666 0d0a 0d0a 2020 2020  ff, yoff....    
-00016b60: 6465 6620 6765 745f 7469 6c65 2873 656c  def get_tile(sel
-00016b70: 662c 2073 697a 653d 3235 3629 3a0d 0a20  f, size=256):.. 
-00016b80: 2020 2020 2020 2022 2222 6765 7473 2061         """gets a
-00016b90: 2072 6173 7465 7220 6172 7261 7920 696e   raster array in
-00016ba0: 2074 696c 6573 2e0d 0a0d 0a20 2020 2020   tiles.....     
-00016bb0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00016bc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00016bd0: 2d0d 0a20 2020 2020 2020 2073 697a 6520  -..        size 
-00016be0: 3a20 696e 740d 0a20 2020 2020 2020 2020  : int..         
-00016bf0: 2020 2053 697a 6520 6f66 2077 696e 646f     Size of windo
-00016c00: 7720 696e 2070 6978 656c 732e 204f 6e65  w in pixels. One
-00016c10: 2076 616c 7565 2072 6571 7569 7265 6420   value required 
-00016c20: 7768 6963 6820 6973 2075 7365 6420 666f  which is used fo
-00016c30: 7220 626f 7468 2074 6865 0d0a 2020 2020  r both the..    
-00016c40: 2020 2020 2020 2020 7820 616e 6420 7920          x and y 
-00016c50: 7369 7a65 2e20 452e 6720 3235 3620 6d65  size. E.g 256 me
-00016c60: 616e 7320 6120 3235 3678 3235 3620 7769  ans a 256x256 wi
-00016c70: 6e64 6f77 2e0d 0a0d 0a20 2020 2020 2020  ndow.....       
-00016c80: 2059 6965 6c64 730d 0a20 2020 2020 2020   Yields..       
-00016c90: 202d 2d2d 2d2d 2d0d 0a20 2020 2020 2020   ------..       
-00016ca0: 206e 702e 6e64 6172 7261 790d 0a20 2020   np.ndarray..   
-00016cb0: 2020 2020 2020 2020 2044 6174 6173 6574           Dataset
-00016cc0: 2061 7272 6179 2069 6e20 666f 726d 205b   array in form [
-00016cd0: 6261 6e64 5d5b 795d 5b78 5d2e 0d0a 2020  band][y][x]...  
-00016ce0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00016cf0: 2020 2066 6f72 2078 7369 7a65 2c20 7973     for xsize, ys
-00016d00: 697a 652c 2078 6f66 662c 2079 6f66 6620  ize, xoff, yoff 
-00016d10: 696e 2073 656c 662e 5f77 696e 646f 7728  in self._window(
-00016d20: 7365 6c66 2e72 6173 7465 722c 2073 697a  self.raster, siz
-00016d30: 653d 7369 7a65 293a 0d0a 2020 2020 2020  e=size):..      
-00016d40: 2020 2020 2020 2320 7265 6164 2074 6865        # read the
-00016d50: 2061 7272 6179 2061 7420 6120 6365 7274   array at a cert
-00016d60: 6169 6e20 696e 6465 6365 730d 0a20 2020  ain indeces..   
-00016d70: 2020 2020 2020 2020 2079 6965 6c64 2073           yield s
-00016d80: 656c 662e 7261 7374 6572 2e52 6561 6441  elf.raster.ReadA
-00016d90: 7341 7272 6179 280d 0a20 2020 2020 2020  sArray(..       
-00016da0: 2020 2020 2020 2020 2078 6f66 663d 786f           xoff=xo
-00016db0: 6666 2c20 796f 6666 3d79 6f66 662c 2078  ff, yoff=yoff, x
-00016dc0: 7369 7a65 3d78 7369 7a65 2c20 7973 697a  size=xsize, ysiz
-00016dd0: 653d 7973 697a 650d 0a20 2020 2020 2020  e=ysize..       
-00016de0: 2020 2020 2029 0d0a 0d0a 2020 2020 6465       )....    de
-00016df0: 6620 6c69 7374 4174 7472 6962 7574 6573  f listAttributes
-00016e00: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00016e10: 2022 2222 5072 696e 7420 4174 7472 6962   """Print Attrib
-00016e20: 7574 6573 204c 6973 742e 2222 220d 0a0d  utes List."""...
-00016e30: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-00016e40: 5c6e 2229 0d0a 2020 2020 2020 2020 7072  \n")..        pr
-00016e50: 696e 7428 0d0a 2020 2020 2020 2020 2020  int(..          
-00016e60: 2020 6622 4174 7472 6962 7574 6573 204c    f"Attributes L
-00016e70: 6973 7420 6f66 3a20 7b20 7265 7072 2873  ist of: { repr(s
-00016e80: 656c 662e 5f5f 6469 6374 5f5f 5b27 6e61  elf.__dict__['na
-00016e90: 6d65 275d 297d 202d 207b 7365 6c66 2e5f  me'])} - {self._
-00016ea0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-00016eb0: 5f7d 2020 496e 7374 616e 6365 5c6e 220d  _}  Instance\n".
-00016ec0: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
-00016ed0: 2020 2020 7365 6c66 5f6b 6579 7320 3d20      self_keys = 
-00016ee0: 6c69 7374 2873 656c 662e 5f5f 6469 6374  list(self.__dict
-00016ef0: 5f5f 2e6b 6579 7328 2929 0d0a 2020 2020  __.keys())..    
-00016f00: 2020 2020 7365 6c66 5f6b 6579 732e 736f      self_keys.so
-00016f10: 7274 2829 0d0a 2020 2020 2020 2020 666f  rt()..        fo
-00016f20: 7220 6b65 7920 696e 2073 656c 665f 6b65  r key in self_ke
-00016f30: 7973 3a0d 0a20 2020 2020 2020 2020 2020  ys:..           
-00016f40: 2069 6620 6b65 7920 213d 2022 6e61 6d65   if key != "name
-00016f50: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-00016f60: 2020 2020 7072 696e 7428 7374 7228 6b65      print(str(ke
-00016f70: 7929 202b 2022 203a 2022 202b 2072 6570  y) + " : " + rep
-00016f80: 7228 7365 6c66 2e5f 5f64 6963 745f 5f5b  r(self.__dict__[
-00016f90: 6b65 795d 2929 0d0a 0d0a 2020 2020 2020  key]))....      
-00016fa0: 2020 7072 696e 7428 225c 6e22 290d 0a0d    print("\n")...
-00016fb0: 0a0d 0a63 6c61 7373 2044 6174 6163 7562  ...class Datacub
-00016fc0: 653a 0d0a 0d0a 2020 2020 6669 6c65 733a  e:....    files:
-00016fd0: 204c 6973 745b 7374 725d 0d0a 2020 2020   List[str]..    
-00016fe0: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00016ff0: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
-00017000: 2066 696c 6573 3a0d 0a20 2020 2020 2020   files:..       
-00017010: 206c 6973 7420 6f66 2067 656f 7469 6666   list of geotiff
-00017020: 2066 696c 6573 2720 6e61 6d65 730d 0a20   files' names.. 
-00017030: 2020 2022 2222 0d0a 0d0a 2020 2020 6465     """....    de
-00017040: 6620 5f5f 696e 6974 5f5f 280d 0a20 2020  f __init__(..   
-00017050: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
-00017060: 2020 2020 7372 633a 2044 6174 6173 6574      src: Dataset
-00017070: 2c0d 0a20 2020 2020 2020 2074 696d 655f  ,..        time_
-00017080: 6c65 6e67 7468 3a20 696e 742c 0d0a 2020  length: int,..  
-00017090: 2020 2020 2020 6669 6c65 733a 204c 6973        files: Lis
-000170a0: 745b 7374 725d 203d 204e 6f6e 652c 0d0a  t[str] = None,..
-000170b0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-000170c0: 7365 6c66 2e5f 6261 7365 203d 2073 7263  self._base = src
-000170d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
-000170e0: 696c 6573 203d 2066 696c 6573 0d0a 2020  iles = files..  
-000170f0: 2020 2020 2020 7365 6c66 2e5f 7469 6d65        self._time
-00017100: 5f6c 656e 6774 6820 3d20 7469 6d65 5f6c  _length = time_l
-00017110: 656e 6774 680d 0a0d 0a20 2020 2020 2020  ength....       
-00017120: 2070 6173 730d 0a0d 0a20 2020 2064 6566   pass....    def
-00017130: 205f 5f73 7472 5f5f 2873 656c 6629 3a0d   __str__(self):.
-00017140: 0a20 2020 2020 2020 206d 6573 7361 6765  .        message
-00017150: 203d 2066 2222 220d 0a20 2020 2020 2020   = f"""..       
-00017160: 2020 2020 2046 696c 6573 3a20 7b6c 656e       Files: {len
-00017170: 2873 656c 662e 6669 6c65 7329 7d0d 0a20  (self.files)}.. 
-00017180: 2020 2020 2020 2020 2020 2043 656c 6c20             Cell 
-00017190: 7369 7a65 3a20 7b73 656c 662e 5f62 6173  size: {self._bas
-000171a0: 652e 6365 6c6c 5f73 697a 657d 0d0a 2020  e.cell_size}..  
-000171b0: 2020 2020 2020 2020 2020 4550 5347 3a20            EPSG: 
-000171c0: 7b73 656c 662e 5f62 6173 652e 6570 7367  {self._base.epsg
-000171d0: 7d0d 0a20 2020 2020 2020 2020 2020 2056  }..            V
-000171e0: 6172 6961 626c 6573 3a20 7b73 656c 662e  ariables: {self.
-000171f0: 5f62 6173 652e 7661 7269 6162 6c65 737d  _base.variables}
-00017200: 0d0a 2020 2020 2020 2020 2020 2020 4469  ..            Di
-00017210: 6d65 6e73 696f 6e3a 207b 7365 6c66 2e72  mension: {self.r
-00017220: 6f77 7320 2a20 7365 6c66 2e63 6f6c 756d  ows * self.colum
-00017230: 6e73 7d0d 0a20 2020 2020 2020 2020 2020  ns}..           
-00017240: 204d 6173 6b3a 207b 7365 6c66 2e5f 6261   Mask: {self._ba
-00017250: 7365 2e6e 6f5f 6461 7461 5f76 616c 7565  se.no_data_value
-00017260: 5b30 5d7d 0d0a 2020 2020 2020 2020 2222  [0]}..        ""
-00017270: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-00017280: 6e20 6d65 7373 6167 650d 0a0d 0a20 2020  n message....   
-00017290: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
-000172a0: 6465 6620 6261 7365 2873 656c 6629 202d  def base(self) -
-000172b0: 3e20 4461 7461 7365 743a 0d0a 2020 2020  > Dataset:..    
-000172c0: 2020 2020 2222 2262 6173 652e 0d0a 0d0a      """base.....
-000172d0: 2020 2020 2020 2020 4261 7365 2044 6174          Base Dat
-000172e0: 6173 6574 0d0a 2020 2020 2020 2020 2222  aset..        ""
-000172f0: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-00017300: 6e20 7365 6c66 2e5f 6261 7365 0d0a 0d0a  n self._base....
-00017310: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-00017320: 2020 2064 6566 2074 696d 655f 6c65 6e67     def time_leng
-00017330: 7468 2873 656c 6629 202d 3e20 696e 743a  th(self) -> int:
-00017340: 0d0a 2020 2020 2020 2020 2222 226c 656e  ..        """len
-00017350: 6774 6820 6f66 2074 6865 2064 6174 6173  gth of the datas
-00017360: 6574 2e22 2222 0d0a 2020 2020 2020 2020  et."""..        
-00017370: 7265 7475 726e 2073 656c 662e 5f74 696d  return self._tim
-00017380: 655f 6c65 6e67 7468 0d0a 0d0a 2020 2020  e_length....    
-00017390: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
-000173a0: 6566 2072 6f77 7328 7365 6c66 293a 0d0a  ef rows(self):..
-000173b0: 2020 2020 2020 2020 2222 224e 756d 6265          """Numbe
-000173c0: 7220 6f66 2072 6f77 7322 2222 0d0a 2020  r of rows"""..  
-000173d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000173e0: 662e 5f62 6173 652e 726f 7773 0d0a 0d0a  f._base.rows....
-000173f0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-00017400: 2020 2064 6566 2073 6861 7065 2873 656c     def shape(sel
-00017410: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
-00017420: 4e75 6d62 6572 206f 6620 726f 7773 2222  Number of rows""
-00017430: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-00017440: 6e20 7365 6c66 2e74 696d 655f 6c65 6e67  n self.time_leng
-00017450: 7468 2c20 7365 6c66 2e72 6f77 732c 2073  th, self.rows, s
-00017460: 656c 662e 636f 6c75 6d6e 730d 0a0d 0a20  elf.columns.... 
-00017470: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-00017480: 2020 6465 6620 636f 6c75 6d6e 7328 7365    def columns(se
-00017490: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
-000174a0: 224e 756d 6265 7220 6f66 2063 6f6c 756d  "Number of colum
-000174b0: 6e73 2222 220d 0a20 2020 2020 2020 2072  ns"""..        r
-000174c0: 6574 7572 6e20 7365 6c66 2e5f 6261 7365  eturn self._base
-000174d0: 2e63 6f6c 756d 6e73 0d0a 0d0a 2020 2020  .columns....    
-000174e0: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
-000174f0: 2020 6465 6620 6372 6561 7465 5f63 7562    def create_cub
-00017500: 6528 636c 732c 2073 7263 3a20 4461 7461  e(cls, src: Data
-00017510: 7365 742c 2064 6174 6173 6574 5f6c 656e  set, dataset_len
-00017520: 6774 683a 2069 6e74 293a 0d0a 2020 2020  gth: int):..    
-00017530: 2020 2020 2222 2243 7265 6174 6520 4461      """Create Da
-00017540: 7461 6375 6265 2e0d 0a0d 0a20 2020 2020  tacube.....     
-00017550: 2020 2020 2020 202d 2043 7265 6174 6520         - Create 
-00017560: 4461 7461 6375 6265 2066 726f 6d20 6120  Datacube from a 
-00017570: 7361 6d70 6c65 2072 6173 7465 7220 616e  sample raster an
-00017580: 640d 0a0d 0a20 2020 2020 2020 2050 6172  d....        Par
-00017590: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-000175a0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000175b0: 2020 2020 2073 7263 3a20 5b44 6174 6173       src: [Datas
-000175c0: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
-000175d0: 2052 4173 7465 7220 4f62 6a65 6374 0d0a   RAster Object..
-000175e0: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-000175f0: 6c65 6e67 7468 3a20 5b69 6e74 5d0d 0a20  length: [int].. 
-00017600: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
-00017610: 6820 6f66 2074 6865 2064 6174 6173 6574  h of the dataset
-00017620: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
-00017630: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-00017640: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2044  -----..        D
-00017650: 6174 6163 7562 6520 6f62 6a65 6374 2e0d  atacube object..
-00017660: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00017670: 2020 2020 2020 7265 7475 726e 2063 6c73        return cls
-00017680: 2873 7263 2c20 6461 7461 7365 745f 6c65  (src, dataset_le
-00017690: 6e67 7468 290d 0a0d 0a20 2020 2064 6566  ngth)....    def
-000176a0: 2075 7064 6174 655f 6375 6265 2873 656c   update_cube(sel
-000176b0: 662c 2061 7272 6179 3a20 6e70 2e6e 6461  f, array: np.nda
-000176c0: 7272 6179 293a 0d0a 2020 2020 2020 2020  rray):..        
-000176d0: 2222 2255 7064 6174 6520 6461 7461 7365  """Update datase
-000176e0: 7420 6461 7461 2e0d 0a0d 0a20 2020 2020  t data.....     
-000176f0: 2020 2020 2020 202d 2054 6869 7320 6675         - This fu
-00017700: 6e63 7469 6f6e 2063 7265 6174 6573 2061  nction creates a
-00017710: 2047 656f 7469 6666 2072 6173 7465 7220   Geotiff raster 
-00017720: 6c69 6b65 2061 6e6f 7468 6572 2069 6e70  like another inp
-00017730: 7574 2072 6173 7465 722c 206e 6577 2072  ut raster, new r
-00017740: 6173 7465 7220 7769 6c6c 2068 6176 6520  aster will have 
-00017750: 7468 6520 7361 6d65 0d0a 2020 2020 2020  the same..      
-00017760: 2020 2020 2020 7072 6f6a 6563 7469 6f6e        projection
-00017770: 2c20 636f 6f72 6469 6e61 7465 7320 6f72  , coordinates or
-00017780: 2074 6865 2074 6f70 206c 6566 7420 636f   the top left co
-00017790: 726e 6572 206f 6620 7468 6520 6f72 6967  rner of the orig
-000177a0: 696e 616c 2072 6173 7465 722c 2063 656c  inal raster, cel
-000177b0: 6c20 7369 7a65 2c20 6e6f 6461 7461 2076  l size, nodata v
-000177c0: 656c 7565 2c20 616e 6420 6e75 6d62 6572  elue, and number
-000177d0: 0d0a 2020 2020 2020 2020 2020 2020 6f66  ..            of
-000177e0: 2072 6f77 7320 616e 6420 636f 6c75 6d6e   rows and column
-000177f0: 730d 0a20 2020 2020 2020 2020 2020 202d  s..            -
-00017800: 2074 6865 2072 6173 7465 7220 616e 6420   the raster and 
-00017810: 7468 6520 6769 7665 6e20 6172 7261 7920  the given array 
-00017820: 7368 6f75 6c64 2068 6176 6520 7468 6520  should have the 
-00017830: 7361 6d65 206e 756d 6265 7220 6f66 2063  same number of c
-00017840: 6f6c 756d 6e73 2061 6e64 2072 6f77 732e  olumns and rows.
-00017850: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00017860: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00017870: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00017880: 2020 2020 6172 7261 793a 205b 6e75 6d70      array: [nump
-00017890: 7920 6172 7261 795d 0d0a 2020 2020 2020  y array]..      
-000178a0: 2020 2020 2020 3344 2061 7272 6179 2074        3D array t
-000178b0: 6f20 6265 2073 746f 7265 7320 6173 2061  o be stores as a
-000178c0: 2072 6173 7465 7273 2c20 7468 6520 6469   rasters, the di
-000178d0: 6d65 6e73 696f 6e73 2073 686f 756c 6420  mensions should 
-000178e0: 6265 0d0a 2020 2020 2020 2020 2020 2020  be..            
-000178f0: 5b72 6f77 732c 2063 6f6c 756d 6e73 2c20  [rows, columns, 
-00017900: 7469 6d65 7365 7269 6573 206c 656e 6774  timeseries lengt
-00017910: 685d 0d0a 0d0a 2020 2020 2020 2020 5265  h]....        Re
-00017920: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00017930: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00017940: 7361 7665 2074 6865 206e 6577 2072 6173  save the new ras
-00017950: 7465 7220 746f 2074 6865 2067 6976 656e  ter to the given
-00017960: 2070 6174 680d 0a0d 0a20 2020 2020 2020   path....       
-00017970: 2045 7861 6d70 6c65 730d 0a20 2020 2020   Examples..     
-00017980: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-00017990: 2020 2020 203e 3e3e 2073 7263 5f72 6173       >>> src_ras
-000179a0: 7465 7220 3d20 6764 616c 2e4f 7065 6e28  ter = gdal.Open(
-000179b0: 2244 454d 2e74 6966 2229 0d0a 2020 2020  "DEM.tif")..    
-000179c0: 2020 2020 3e3e 3e20 6e61 6d65 203d 205b      >>> name = [
-000179d0: 2251 5f32 3031 325f 3031 5f30 315f 3031  "Q_2012_01_01_01
-000179e0: 2e74 6966 222c 2251 5f32 3031 325f 3031  .tif","Q_2012_01
-000179f0: 5f30 315f 3032 2e74 6966 222c 2251 5f32  _01_02.tif","Q_2
-00017a00: 3031 325f 3031 5f30 315f 3033 2e74 6966  012_01_01_03.tif
-00017a10: 222c 2251 5f32 3031 325f 3031 5f30 315f  ","Q_2012_01_01_
-00017a20: 3034 2e74 6966 225d 0d0a 2020 2020 2020  04.tif"]..      
-00017a30: 2020 3e3e 3e20 4461 7461 6375 6265 2e72    >>> Datacube.r
-00017a40: 6173 7465 7273 4c69 6b65 2873 7263 5f72  astersLike(src_r
-00017a50: 6173 7465 722c 2064 6174 612c 206e 616d  aster, data, nam
-00017a60: 6529 0d0a 2020 2020 2020 2020 2222 220d  e)..        """.
-00017a70: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
-00017a80: 7461 203d 2061 7272 6179 0d0a 0d0a 2020  ta = array....  
-00017a90: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
-00017aa0: 2020 2020 6465 6620 7265 6164 5f73 6570      def read_sep
-00017ab0: 6172 6174 655f 6669 6c65 7328 0d0a 2020  arate_files(..  
-00017ac0: 2020 2020 2020 636c 732c 0d0a 2020 2020        cls,..    
-00017ad0: 2020 2020 7061 7468 3a20 556e 696f 6e5b      path: Union[
-00017ae0: 7374 722c 204c 6973 745b 7374 725d 5d2c  str, List[str]],
-00017af0: 0d0a 2020 2020 2020 2020 7769 7468 5f6f  ..        with_o
-00017b00: 7264 6572 3a20 626f 6f6c 203d 2046 616c  rder: bool = Fal
-00017b10: 7365 2c0d 0a20 2020 2020 2020 2073 7461  se,..        sta
-00017b20: 7274 3a20 7374 7220 3d20 4e6f 6e65 2c0d  rt: str = None,.
-00017b30: 0a20 2020 2020 2020 2065 6e64 3a20 7374  .        end: st
-00017b40: 7220 3d20 4e6f 6e65 2c0d 0a20 2020 2020  r = None,..     
-00017b50: 2020 2066 6d74 3a20 7374 7220 3d20 2225     fmt: str = "%
-00017b60: 592d 256d 2d25 6422 2c0d 0a20 2020 2020  Y-%m-%d",..     
-00017b70: 2020 2066 7265 713a 2073 7472 203d 2022     freq: str = "
-00017b80: 6461 696c 7922 2c0d 0a20 2020 2020 2020  daily",..       
-00017b90: 2073 6570 6172 6174 6f72 3a20 7374 7220   separator: str 
-00017ba0: 3d20 225f 222c 0d0a 2020 2020 2020 2020  = "_",..        
-00017bb0: 6578 7465 6e73 696f 6e3a 2073 7472 203d  extension: str =
-00017bc0: 2022 2e74 6966 222c 0d0a 2020 2020 293a   ".tif",..    ):
-00017bd0: 0d0a 2020 2020 2020 2020 2222 2272 6561  ..        """rea
-00017be0: 645f 7365 7061 7261 7465 5f66 696c 6573  d_separate_files
-00017bf0: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
-00017c00: 202d 2072 6561 6473 2072 6173 7465 7273   - reads rasters
-00017c10: 2066 726f 6d20 6120 666f 6c64 6572 2061   from a folder a
-00017c20: 6e64 2063 7265 6174 6573 2061 2033 6420  nd creates a 3d 
-00017c30: 6172 7261 7920 7769 7468 2074 6865 2073  array with the s
-00017c40: 616d 6520 3264 2064 696d 656e 7369 6f6e  ame 2d dimension
-00017c50: 7320 6f66 2074 6865 2066 6972 7374 2072  s of the first r
-00017c60: 6173 7465 7220 696e 0d0a 2020 2020 2020  aster in..      
-00017c70: 2020 2020 2020 7468 6520 666f 6c64 6572        the folder
-00017c80: 2061 6e64 206c 656e 2061 7320 7468 6520   and len as the 
-00017c90: 6e75 6d62 6572 206f 6620 6669 6c65 730d  number of files.
-00017ca0: 0a0d 0a20 2020 2020 2020 2069 6e73 6964  ...        insid
-00017cb0: 6520 7468 6520 666f 6c64 6572 2e0d 0a20  e the folder... 
-00017cc0: 2020 2020 2020 2020 2020 202d 2041 6c6c             - All
-00017cd0: 2072 6173 7465 7273 2073 686f 756c 6420   rasters should 
-00017ce0: 6861 7665 2074 6865 2073 616d 6520 6469  have the same di
-00017cf0: 6d65 6e73 696f 6e73 0d0a 2020 2020 2020  mensions..      
-00017d00: 2020 2020 2020 2d20 466f 6c64 6572 2073        - Folder s
-00017d10: 686f 756c 6420 6f6e 6c79 2063 6f6e 7461  hould only conta
-00017d20: 696e 2072 6173 7465 7220 6669 6c65 730d  in raster files.
-00017d30: 0a20 2020 2020 2020 2020 2020 202d 2072  .            - r
-00017d40: 6173 7465 7220 6669 6c65 206e 616d 6520  aster file name 
-00017d50: 7368 6f75 6c64 2068 6176 6520 7468 6520  should have the 
-00017d60: 6461 7465 2061 7420 7468 6520 656e 6420  date at the end 
-00017d70: 6f66 2074 6865 2066 696c 6520 6e61 6d65  of the file name
-00017d80: 2062 6566 6f72 6520 7468 6520 6578 7465   before the exte
-00017d90: 6e73 696f 6e20 6469 7265 6374 6c79 0d0a  nsion directly..
-00017da0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-00017db0: 7468 2074 6865 2059 5959 592e 4d4d 2e44  th the YYYY.MM.D
-00017dc0: 4420 2f20 5959 5959 2d4d 4d2d 4444 206f  D / YYYY-MM-DD o
-00017dd0: 7220 5959 5959 5f4d 4d5f 4444 0d0a 2020  r YYYY_MM_DD..  
-00017de0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00017df0: 2235 305f 4d53 5745 505f 3139 3739 2e30  "50_MSWEP_1979.0
-00017e00: 312e 3031 2e74 6966 220d 0a0d 0a20 2020  1.01.tif"....   
-00017e10: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00017e20: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017e30: 2d2d 2d0d 0a20 2020 2020 2020 2070 6174  ---..        pat
-00017e40: 683a 5b53 7472 696e 672f 6c69 7374 5d0d  h:[String/list].
-00017e50: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-00017e60: 6820 6f66 2074 6865 2066 6f6c 6465 7220  h of the folder 
-00017e70: 7468 6174 2063 6f6e 7461 696e 7320 616c  that contains al
-00017e80: 6c20 7468 6520 7261 7374 6572 7320 6f72  l the rasters or
-00017e90: 0d0a 2020 2020 2020 2020 2020 2020 6120  ..            a 
-00017ea0: 6c69 7374 2063 6f6e 7461 696e 7320 7468  list contains th
-00017eb0: 6520 7061 7468 7320 6f66 2074 6865 2072  e paths of the r
-00017ec0: 6173 7465 7273 2074 6f20 7265 6164 2e0d  asters to read..
-00017ed0: 0a20 2020 2020 2020 2077 6974 685f 6f72  .        with_or
-00017ee0: 6465 723a 205b 626f 6f6c 5d0d 0a20 2020  der: [bool]..   
-00017ef0: 2020 2020 2020 2020 2054 7275 6520 6966           True if
-00017f00: 2074 6865 2072 6173 7465 7273 2066 6f6c   the rasters fol
-00017f10: 6c6f 7773 2061 2063 6572 7461 696e 206f  lows a certain o
-00017f20: 7264 6572 2c20 7468 656e 2074 6865 2072  rder, then the r
-00017f30: 6173 7465 7273 206e 616d 6573 2073 686f  asters names sho
-00017f40: 756c 6420 6861 7665 2061 0d0a 2020 2020  uld have a..    
-00017f50: 2020 2020 2020 2020 6e75 6d62 6572 2061          number a
-00017f60: 7420 7468 6520 6265 6769 6e6e 696e 6720  t the beginning 
-00017f70: 6f66 2074 6865 2066 696c 6520 6e61 6d65  of the file name
-00017f80: 2069 6e64 6963 6174 696e 6720 7468 6520   indicating the 
-00017f90: 6f72 6465 722e 0d0a 2020 2020 2020 2020  order...        
-00017fa0: 2020 2020 3e3e 3e20 2230 315f 4d53 5745      >>> "01_MSWE
-00017fb0: 505f 3139 3739 2e30 312e 3031 2e74 6966  P_1979.01.01.tif
-00017fc0: 220d 0a20 2020 2020 2020 2020 2020 203e  "..            >
-00017fd0: 3e3e 2022 3032 5f4d 5357 4550 5f31 3937  >> "02_MSWEP_197
-00017fe0: 392e 3031 2e30 322e 7469 6622 0d0a 2020  9.01.02.tif"..  
-00017ff0: 2020 2020 2020 2020 2020 3e3e 3e20 2e2e            >>> ..
-00018000: 2e0d 0a20 2020 2020 2020 2020 2020 203e  ...            >
-00018010: 3e3e 2022 3230 5f4d 5357 4550 5f31 3937  >> "20_MSWEP_197
-00018020: 392e 3031 2e32 302e 7469 6622 0d0a 2020  9.01.20.tif"..  
-00018030: 2020 2020 2020 2020 2020 2d20 6375 7272            - curr
-00018040: 656e 746c 7920 7468 6520 6675 6e63 7469  ently the functi
-00018050: 6f6e 2064 6570 656e 6473 206d 6169 6e6c  on depends mainl
-00018060: 7920 6f6e 2074 6865 2073 6570 6172 6174  y on the separat
-00018070: 6f72 2022 5f22 2074 6861 7420 7365 7061  or "_" that sepa
-00018080: 7261 7465 2074 6865 206f 7264 6572 206e  rate the order n
-00018090: 756d 6265 7220 6672 6f6d 2074 6865 2072  umber from the r
-000180a0: 6573 7420 6f66 0d0a 2020 2020 2020 2020  est of..        
-000180b0: 2020 2020 6669 6c65 206e 616d 652e 0d0a      file name...
-000180c0: 2020 2020 2020 2020 2020 2020 2d20 7468              - th
-000180d0: 6520 7365 7061 7261 746f 7220 6265 7477  e separator betw
-000180e0: 6565 6e20 7468 6520 6461 7465 2070 6172  een the date par
-000180f0: 7473 2059 5959 592e 4d4d 2e44 4420 6972  ts YYYY.MM.DD ir
-00018100: 2059 5959 595f 4d4d 5f44 4420 6f72 2061   YYYY_MM_DD or a
-00018110: 6e79 206f 7468 6572 2073 6570 6172 6174  ny other separat
-00018120: 6f72 2064 6f65 7320 6e6f 7420 6d61 7474  or does not matt
-00018130: 6572 2c0d 0a20 2020 2020 2020 2020 2020  er,..           
-00018140: 2068 6f77 6576 6572 2074 6865 2073 6570   however the sep
-00018150: 6172 6174 6f72 2068 6173 2074 6f20 6265  arator has to be
-00018160: 206f 6e6c 7920 6f6e 6520 6c65 7474 6572   only one letter
-00018170: 2e0d 0a20 2020 2020 2020 2066 6d74 3a20  ...        fmt: 
-00018180: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
-00018190: 2020 2066 6f72 6d61 7420 6f66 2074 6865     format of the
-000181a0: 2067 6976 656e 2064 6174 650d 0a20 2020   given date..   
-000181b0: 2020 2020 2073 7461 7274 3a20 5b73 7472       start: [str
-000181c0: 5d0d 0a20 2020 2020 2020 2020 2020 2073  ]..            s
-000181d0: 7461 7274 2064 6174 6520 6966 2079 6f75  tart date if you
-000181e0: 2077 616e 7420 746f 2072 6561 6420 7468   want to read th
-000181f0: 6520 696e 7075 7420 7261 7374 6572 2066  e input raster f
-00018200: 6f72 2061 2073 7065 6369 6669 6320 7065  or a specific pe
-00018210: 7269 6f64 206f 6e6c 7920 616e 6420 6e6f  riod only and no
-00018220: 7420 616c 6c20 7261 7374 6572 732c 0d0a  t all rasters,..
-00018230: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00018240: 6f74 2067 6976 656e 2061 6c6c 2072 6173  ot given all ras
-00018250: 7465 7273 2069 6e20 7468 6520 6769 7665  ters in the give
-00018260: 6e20 7061 7468 2077 696c 6c20 6265 2072  n path will be r
-00018270: 6561 642e 0d0a 2020 2020 2020 2020 2020  ead...          
-00018280: 2020 4869 6e74 3a0d 0a20 2020 2020 2020    Hint:..       
-00018290: 2020 2020 2020 2020 2054 6865 2064 6174           The dat
-000182a0: 6520 696e 2074 6865 2072 6173 7465 7220  e in the raster 
-000182b0: 6669 6c65 206e 616d 6520 7368 6f75 6c64  file name should
-000182c0: 2062 6520 7468 6520 6c61 7374 2073 7472   be the last str
-000182d0: 696e 6720 6265 666f 7220 7468 6520 6669  ing befor the fi
-000182e0: 6c65 2065 7874 656e 7369 6f6e 0d0a 2020  le extension..  
-000182f0: 2020 2020 2020 2020 2020 2020 2020 3e3e                >>
-00018300: 3e20 2232 305f 4d53 5745 505f 5959 5959  > "20_MSWEP_YYYY
-00018310: 2e4d 4d2e 4444 2e74 6966 220d 0a20 2020  .MM.DD.tif"..   
-00018320: 2020 2020 2065 6e64 3a20 5b73 7472 5d0d       end: [str].
-00018330: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
-00018340: 2064 6174 6520 6966 2079 6f75 2077 616e   date if you wan
-00018350: 7420 746f 2072 6561 6420 7468 6520 696e  t to read the in
-00018360: 7075 7420 7465 6d70 6572 6174 7572 6520  put temperature 
-00018370: 666f 7220 6120 7370 6563 6966 6963 2070  for a specific p
-00018380: 6572 696f 6420 6f6e 6c79 2c0d 0a20 2020  eriod only,..   
-00018390: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-000183a0: 6769 7665 6e20 616c 6c20 7261 7374 6572  given all raster
-000183b0: 7320 696e 2074 6865 2067 6976 656e 2070  s in the given p
-000183c0: 6174 6820 7769 6c6c 2062 6520 7265 6164  ath will be read
-000183d0: 2e0d 0a20 2020 2020 2020 2020 2020 2048  ...            H
-000183e0: 696e 743a 0d0a 2020 2020 2020 2020 2020  int:..          
-000183f0: 2020 2020 2020 5468 6520 6461 7465 2069        The date i
-00018400: 6e20 7468 6520 7261 7374 6572 2066 696c  n the raster fil
-00018410: 6520 6e61 6d65 2073 686f 756c 6420 6265  e name should be
-00018420: 2074 6865 206c 6173 7420 7374 7269 6e67   the last string
-00018430: 2062 6566 6f72 2074 6865 2066 696c 6520   befor the file 
-00018440: 6578 7465 6e73 696f 6e0d 0a20 2020 2020  extension..     
-00018450: 2020 2020 2020 2020 2020 203e 3e3e 2022             >>> "
-00018460: 3230 5f4d 5357 4550 5f59 5959 592e 4d4d  20_MSWEP_YYYY.MM
-00018470: 2e44 442e 7469 6622 0d0a 2020 2020 2020  .DD.tif"..      
-00018480: 2020 6672 6571 3a20 5b73 7472 5d0d 0a20    freq: [str].. 
-00018490: 2020 2020 2020 2020 2020 2066 7265 7175             frequ
-000184a0: 656e 6379 206f 6620 7468 6520 7261 7374  ency of the rast
-000184b0: 6572 7320 2264 6169 6c79 222c 2048 6f75  ers "daily", Hou
-000184c0: 726c 792c 206d 6f6e 7468 6c79 0d0a 2020  rly, monthly..  
-000184d0: 2020 2020 2020 7365 7061 7261 746f 723a        separator:
-000184e0: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
-000184f0: 2020 2020 7365 7061 7261 746f 7220 6265      separator be
-00018500: 7477 6565 6e20 7468 6520 6f72 6465 7220  tween the order 
-00018510: 696e 2074 6865 2062 6567 696e 6e69 6e67  in the beginning
-00018520: 206f 6620 7468 6520 7261 7374 6572 2066   of the raster f
-00018530: 696c 6520 6e61 6d65 2061 6e64 2074 6865  ile name and the
-00018540: 2072 6573 7420 6f66 2074 6865 2066 696c   rest of the fil
-00018550: 650d 0a20 2020 2020 2020 2020 2020 206e  e..            n
-00018560: 616d 652e 2044 6566 6175 6c74 2069 7320  ame. Default is 
-00018570: 225f 222e 0d0a 2020 2020 2020 2020 6578  "_"...        ex
-00018580: 7465 6e73 696f 6e3a 205b 7374 725d 0d0a  tension: [str]..
-00018590: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-000185a0: 6578 7465 6e73 696f 6e20 6f66 2074 6865  extension of the
-000185b0: 2066 696c 6573 2079 6f75 2077 616e 7420   files you want 
-000185c0: 746f 2072 6561 6420 6672 6f6d 2074 6865  to read from the
-000185d0: 2067 6976 656e 2070 6174 682e 2044 6566   given path. Def
-000185e0: 6175 6c74 2069 7320 222e 7469 6622 2e0d  ault is ".tif"..
-000185f0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00018600: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-00018610: 2d2d 2d0d 0a20 2020 2020 2020 2061 7272  ---..        arr
-00018620: 5f33 643a 205b 6e75 6d70 792e 6e64 6172  _3d: [numpy.ndar
-00018630: 7261 795d 0d0a 2020 2020 2020 2020 2020  ray]..          
-00018640: 2020 3364 2061 7272 6179 2063 6f6e 7461    3d array conta
-00018650: 696e 7320 6172 7261 7973 2072 6561 6420  ins arrays read 
-00018660: 6672 6f6d 2061 6c6c 2072 6173 7465 7273  from all rasters
-00018670: 2069 6e20 7468 6520 666f 6c64 6572 2e0d   in the folder..
-00018680: 0a0d 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00018690: 6c65 0d0a 2020 2020 2020 2020 2d2d 2d2d  le..        ----
-000186a0: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
-000186b0: 2066 726f 6d20 7079 7261 6d69 6473 2e64   from pyramids.d
-000186c0: 6174 6173 6574 2069 6d70 6f72 7420 4461  ataset import Da
-000186d0: 7461 6375 6265 0d0a 2020 2020 2020 2020  tacube..        
-000186e0: 3e3e 3e20 7261 7374 6572 5f66 6f6c 6465  >>> raster_folde
-000186f0: 7220 3d20 2265 7861 6d70 6c65 732f 4749  r = "examples/GI
-00018700: 532f 6461 7461 2f72 6173 7465 722d 666f  S/data/raster-fo
-00018710: 6c64 6572 220d 0a20 2020 2020 2020 203e  lder"..        >
-00018720: 3e3e 2070 7265 6320 3d20 4461 7461 6375  >> prec = Datacu
-00018730: 6265 2e72 6561 645f 7365 7061 7261 7465  be.read_separate
-00018740: 5f66 696c 6573 2872 6173 7465 725f 666f  _files(raster_fo
-00018750: 6c64 6572 290d 0a0d 0a20 2020 2020 2020  lder)....       
-00018760: 203e 3e3e 2069 6d70 6f72 7420 676c 6f62   >>> import glob
-00018770: 0d0a 2020 2020 2020 2020 3e3e 3e20 7365  ..        >>> se
-00018780: 6172 6368 5f63 7269 7465 7269 6120 3d20  arch_criteria = 
-00018790: 222a 2e74 6966 220d 0a20 2020 2020 2020  "*.tif"..       
-000187a0: 203e 3e3e 2066 696c 655f 6c69 7374 203d   >>> file_list =
-000187b0: 2067 6c6f 622e 676c 6f62 286f 732e 7061   glob.glob(os.pa
-000187c0: 7468 2e6a 6f69 6e28 7261 7374 6572 5f66  th.join(raster_f
-000187d0: 6f6c 6465 722c 2073 6561 7263 685f 6372  older, search_cr
-000187e0: 6974 6572 6961 2929 0d0a 2020 2020 2020  iteria))..      
-000187f0: 2020 3e3e 3e20 7072 6563 203d 2044 6174    >>> prec = Dat
-00018800: 6163 7562 652e 7265 6164 5f73 6570 6172  acube.read_separ
-00018810: 6174 655f 6669 6c65 7328 6669 6c65 5f6c  ate_files(file_l
-00018820: 6973 742c 2077 6974 685f 6f72 6465 723d  ist, with_order=
-00018830: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-00018840: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
-00018850: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
-00018860: 6174 682c 2073 7472 2920 616e 6420 6e6f  ath, str) and no
-00018870: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
-00018880: 682c 206c 6973 7429 3a0d 0a20 2020 2020  h, list):..     
-00018890: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-000188a0: 6545 7272 6f72 2866 2270 6174 6820 696e  eError(f"path in
-000188b0: 7075 7420 7368 6f75 6c64 2062 6520 7374  put should be st
-000188c0: 7269 6e67 2f6c 6973 7420 7479 7065 2c20  ring/list type, 
-000188d0: 6769 7665 6e7b 7479 7065 2870 6174 6829  given{type(path)
-000188e0: 7d22 290d 0a0d 0a20 2020 2020 2020 2069  }")....        i
-000188f0: 6620 6973 696e 7374 616e 6365 2870 6174  f isinstance(pat
-00018900: 682c 2073 7472 293a 0d0a 2020 2020 2020  h, str):..      
-00018910: 2020 2020 2020 2320 6368 6563 6b20 7765        # check we
-00018920: 7468 6572 2074 6865 2070 6174 6820 6578  ther the path ex
-00018930: 6973 7420 6f72 206e 6f74 0d0a 2020 2020  ist or not..    
-00018940: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
-00018950: 732e 7061 7468 2e65 7869 7374 7328 7061  s.path.exists(pa
-00018960: 7468 293a 0d0a 2020 2020 2020 2020 2020  th):..          
-00018970: 2020 2020 2020 7261 6973 6520 4669 6c65        raise File
-00018980: 4e6f 7446 6f75 6e64 4572 726f 7228 2254  NotFoundError("T
-00018990: 6865 2070 6174 6820 796f 7520 6861 7665  he path you have
-000189a0: 2070 726f 7669 6465 6420 646f 6573 206e   provided does n
-000189b0: 6f74 2065 7869 7374 2229 0d0a 2020 2020  ot exist")..    
-000189c0: 2020 2020 2020 2020 2320 6765 7420 6c69          # get li
-000189d0: 7374 206f 6620 616c 6c20 6669 6c65 730d  st of all files.
-000189e0: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
-000189f0: 6573 203d 206f 732e 6c69 7374 6469 7228  es = os.listdir(
-00018a00: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
-00018a10: 2020 2066 696c 6573 203d 205b 6920 666f     files = [i fo
-00018a20: 7220 6920 696e 2066 696c 6573 2069 6620  r i in files if 
-00018a30: 692e 656e 6473 7769 7468 2865 7874 656e  i.endswith(exten
-00018a40: 7369 6f6e 295d 0d0a 2020 2020 2020 2020  sion)]..        
-00018a50: 2020 2020 2320 6669 6c65 7320 3d20 676c      # files = gl
-00018a60: 6f62 2e67 6c6f 6228 6f73 2e70 6174 682e  ob.glob(os.path.
-00018a70: 6a6f 696e 2870 6174 682c 2022 2a2e 7469  join(path, "*.ti
-00018a80: 6622 2929 0d0a 2020 2020 2020 2020 2020  f"))..          
-00018a90: 2020 2320 6368 6563 6b20 7768 6574 6865    # check whethe
-00018aa0: 7220 7468 6572 6520 6172 6520 6669 6c65  r there are file
-00018ab0: 7320 6f72 206e 6f74 2069 6e73 6964 6520  s or not inside 
-00018ac0: 7468 6520 666f 6c64 6572 0d0a 2020 2020  the folder..    
-00018ad0: 2020 2020 2020 2020 6966 206c 656e 2866          if len(f
-00018ae0: 696c 6573 2920 3c20 313a 0d0a 2020 2020  iles) < 1:..    
-00018af0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00018b00: 6520 4669 6c65 4e6f 7446 6f75 6e64 4572  e FileNotFoundEr
-00018b10: 726f 7228 2254 6865 2070 6174 6820 796f  ror("The path yo
-00018b20: 7520 6861 7665 2070 726f 7669 6465 6420  u have provided 
-00018b30: 6973 2065 6d70 7479 2229 0d0a 2020 2020  is empty")..    
-00018b40: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00018b50: 2020 2020 2020 2066 696c 6573 203d 2070         files = p
-00018b60: 6174 685b 3a5d 0d0a 2020 2020 2020 2020  ath[:]..        
-00018b70: 2320 746f 2073 6f72 7420 7468 6520 6669  # to sort the fi
-00018b80: 6c65 7320 696e 2074 6865 2073 616d 6520  les in the same 
-00018b90: 6f72 6465 7220 6173 2074 6865 2066 6972  order as the fir
-00018ba0: 7374 206e 756d 6265 7220 696e 2074 6865  st number in the
-00018bb0: 206e 616d 650d 0a20 2020 2020 2020 2069   name..        i
-00018bc0: 6620 7769 7468 5f6f 7264 6572 3a0d 0a20  f with_order:.. 
-00018bd0: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
-00018be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018bf0: 2066 696c 6573 4e6f 203d 205b 696e 7428   filesNo = [int(
-00018c00: 692e 7370 6c69 7428 7365 7061 7261 746f  i.split(separato
-00018c10: 7229 5b30 5d29 2066 6f72 2069 2069 6e20  r)[0]) for i in 
-00018c20: 6669 6c65 735d 0d0a 2020 2020 2020 2020  files]..        
-00018c30: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
-00018c40: 4572 726f 723a 0d0a 2020 2020 2020 2020  Error:..        
-00018c50: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00018c60: 6c75 6545 7272 6f72 280d 0a20 2020 2020  lueError(..     
-00018c70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00018c80: 706c 6561 7365 2069 6e63 6c75 6465 2061  please include a
-00018c90: 206e 756d 6265 7220 6174 2074 6865 2062   number at the b
-00018ca0: 6567 696e 6e69 6e67 206f 6620 7468 6522  eginning of the"
-00018cb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018cc0: 2020 2020 2020 2272 6173 7465 7273 206e        "rasters n
-00018cd0: 616d 6520 746f 2069 6e64 6963 6174 6520  ame to indicate 
-00018ce0: 7468 6520 6f72 6465 7220 6f66 2074 6865  the order of the
-00018cf0: 2072 6173 7465 7273 2e20 746f 2064 6f20   rasters. to do 
-00018d00: 736f 2070 6c65 6173 6522 0d0a 2020 2020  so please"..    
-00018d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d20: 2275 7365 2074 6865 2049 6e70 7574 732e  "use the Inputs.
-00018d30: 5265 6e61 6d65 4669 6c65 7320 6d65 7468  RenameFiles meth
-00018d40: 6f64 2074 6f20 736f 6c76 6520 7468 6973  od to solve this
-00018d50: 2069 7373 7565 2061 6e64 2064 6f6e 2774   issue and don't
-00018d60: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
-00018d70: 2020 2020 2020 2020 2269 6e63 6c75 6465          "include
-00018d80: 2061 6e79 206f 7468 6572 2066 696c 6573   any other files
-00018d90: 2069 6e20 7468 6520 666f 6c64 6572 2077   in the folder w
-00018da0: 6974 6820 7468 6520 7261 7374 6572 7322  ith the rasters"
-00018db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018dc0: 2020 290d 0a0d 0a20 2020 2020 2020 2020    )....         
-00018dd0: 2020 2066 696c 655f 7475 706c 6520 3d20     file_tuple = 
-00018de0: 736f 7274 6564 287a 6970 2866 696c 6573  sorted(zip(files
-00018df0: 4e6f 2c20 6669 6c65 7329 290d 0a20 2020  No, files))..   
-00018e00: 2020 2020 2020 2020 2066 696c 6573 203d           files =
-00018e10: 205b 7820 666f 7220 5f2c 2078 2069 6e20   [x for _, x in 
-00018e20: 6669 6c65 5f74 7570 6c65 5d0d 0a0d 0a20  file_tuple].... 
-00018e30: 2020 2020 2020 2069 6620 7374 6172 7420         if start 
-00018e40: 6973 206e 6f74 204e 6f6e 6520 6f72 2065  is not None or e
-00018e50: 6e64 2069 7320 6e6f 7420 4e6f 6e65 3a0d  nd is not None:.
-00018e60: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-00018e70: 7274 203d 2064 742e 6461 7465 7469 6d65  rt = dt.datetime
-00018e80: 2e73 7472 7074 696d 6528 7374 6172 742c  .strptime(start,
-00018e90: 2066 6d74 290d 0a20 2020 2020 2020 2020   fmt)..         
-00018ea0: 2020 2065 6e64 203d 2064 742e 6461 7465     end = dt.date
-00018eb0: 7469 6d65 2e73 7472 7074 696d 6528 656e  time.strptime(en
-00018ec0: 642c 2066 6d74 290d 0a0d 0a20 2020 2020  d, fmt)....     
-00018ed0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
-00018ee0: 2064 6174 6573 2066 6f72 2065 6163 6820   dates for each 
-00018ef0: 6669 6c65 0d0a 2020 2020 2020 2020 2020  file..          
-00018f00: 2020 6461 7465 7320 3d20 6c69 7374 2829    dates = list()
-00018f10: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00018f20: 7220 692c 2066 696c 655f 6920 696e 2065  r i, file_i in e
-00018f30: 6e75 6d65 7261 7465 2866 696c 6573 293a  numerate(files):
-00018f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018f50: 2020 6966 2066 7265 7120 3d3d 2022 6461    if freq == "da
-00018f60: 696c 7922 3a0d 0a20 2020 2020 2020 2020  ily":..         
-00018f70: 2020 2020 2020 2020 2020 206c 203d 206c             l = l
-00018f80: 656e 2866 696c 655f 6929 202d 2034 0d0a  en(file_i) - 4..
-00018f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fa0: 2020 2020 6461 7920 3d20 696e 7428 6669      day = int(fi
-00018fb0: 6c65 5f69 5b6c 202d 2032 203a 206c 5d29  le_i[l - 2 : l])
-00018fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018fd0: 2020 2020 2020 6d6f 6e74 6820 3d20 696e        month = in
-00018fe0: 7428 6669 6c65 5f69 5b6c 202d 2035 203a  t(file_i[l - 5 :
-00018ff0: 206c 202d 2033 5d29 0d0a 2020 2020 2020   l - 3])..      
-00019000: 2020 2020 2020 2020 2020 2020 2020 7965                ye
-00019010: 6172 203d 2069 6e74 2866 696c 655f 695b  ar = int(file_i[
-00019020: 6c20 2d20 3130 203a 206c 202d 2036 5d29  l - 10 : l - 6])
-00019030: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019040: 2020 2020 2020 6461 7465 732e 6170 7065        dates.appe
-00019050: 6e64 2864 742e 6461 7465 7469 6d65 2879  nd(dt.datetime(y
-00019060: 6561 722c 206d 6f6e 7468 2c20 6461 7929  ear, month, day)
-00019070: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00019080: 2020 2065 6c69 6620 6672 6571 203d 3d20     elif freq == 
-00019090: 2268 6f75 726c 7922 3a0d 0a20 2020 2020  "hourly":..     
-000190a0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-000190b0: 6561 7220 3d20 696e 7428 6669 6c65 5f69  ear = int(file_i
-000190c0: 2e73 706c 6974 2822 5f22 295b 2d34 5d29  .split("_")[-4])
-000190d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000190e0: 2020 2020 2020 6d6f 6e74 6820 3d20 696e        month = in
-000190f0: 7428 6669 6c65 5f69 2e73 706c 6974 2822  t(file_i.split("
-00019100: 5f22 295b 2d33 5d29 0d0a 2020 2020 2020  _")[-3])..      
-00019110: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00019120: 7920 3d20 696e 7428 6669 6c65 5f69 2e73  y = int(file_i.s
-00019130: 706c 6974 2822 5f22 295b 2d32 5d29 0d0a  plit("_")[-2])..
-00019140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019150: 2020 2020 686f 7572 203d 2069 6e74 2866      hour = int(f
-00019160: 696c 655f 692e 7370 6c69 7428 225f 2229  ile_i.split("_")
-00019170: 5b2d 315d 2e73 706c 6974 2822 2e22 295b  [-1].split(".")[
-00019180: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
-00019190: 2020 2020 2020 2020 2064 6174 6573 2e61           dates.a
-000191a0: 7070 656e 6428 6474 2e64 6174 6574 696d  ppend(dt.datetim
-000191b0: 6528 7965 6172 2c20 6d6f 6e74 682c 2064  e(year, month, d
-000191c0: 6179 2c20 686f 7572 2929 0d0a 0d0a 2020  ay, hour))....  
-000191d0: 2020 2020 2020 2020 2020 7374 6172 7469            starti
-000191e0: 203d 2064 6174 6573 2e69 6e64 6578 2873   = dates.index(s
-000191f0: 7461 7274 290d 0a20 2020 2020 2020 2020  tart)..         
-00019200: 2020 2065 6e64 6920 3d20 6461 7465 732e     endi = dates.
-00019210: 696e 6465 7828 656e 6429 202b 2031 0d0a  index(end) + 1..
-00019220: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00019230: 7274 2061 6c6c 280d 0a20 2020 2020 2020  rt all(..       
-00019240: 2020 2020 2020 2020 2066 696c 655f 692e           file_i.
-00019250: 656e 6473 7769 7468 2822 2e74 6966 2229  endswith(".tif")
-00019260: 2066 6f72 2066 696c 655f 6920 696e 2066   for file_i in f
-00019270: 696c 6573 5b73 7461 7274 693a 656e 6469  iles[starti:endi
-00019280: 5d0d 0a20 2020 2020 2020 2020 2020 2029  ]..            )
-00019290: 2c20 2261 6c6c 2066 696c 6573 2069 6e20  , "all files in 
-000192a0: 7468 6520 6769 7665 6e20 666f 6c64 6572  the given folder
-000192b0: 2073 686f 756c 6420 6861 7665 202e 7469   should have .ti
-000192c0: 6620 6578 7465 6e73 696f 6e22 0d0a 2020  f extension"..  
-000192d0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000192e0: 2020 2020 2020 2020 2073 7461 7274 6920           starti 
-000192f0: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
-00019300: 2065 6e64 6920 3d20 6c65 6e28 6669 6c65   endi = len(file
-00019310: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-00019320: 2320 6368 6563 6b20 7468 6174 2066 6f6c  # check that fol
-00019330: 6465 7220 6f6e 6c79 2063 6f6e 7461 696e  der only contain
-00019340: 7320 7261 7374 6572 730d 0a20 2020 2020  s rasters..     
-00019350: 2020 2020 2020 2061 7373 6572 7420 616c         assert al
-00019360: 6c28 0d0a 2020 2020 2020 2020 2020 2020  l(..            
-00019370: 2020 2020 6669 6c65 5f69 2e65 6e64 7377      file_i.endsw
-00019380: 6974 6828 6578 7465 6e73 696f 6e29 2066  ith(extension) f
-00019390: 6f72 2066 696c 655f 6920 696e 2066 696c  or file_i in fil
-000193a0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-000193b0: 292c 2022 616c 6c20 6669 6c65 7320 696e  ), "all files in
-000193c0: 2074 6865 2067 6976 656e 2066 6f6c 6465   the given folde
-000193d0: 7220 7368 6f75 6c64 2068 6176 6520 2e74  r should have .t
-000193e0: 6966 2065 7874 656e 7369 6f6e 220d 0a0d  if extension"...
-000193f0: 0a20 2020 2020 2020 2023 2066 696c 6573  .        # files
-00019400: 2074 6f20 6265 2072 6561 640d 0a20 2020   to be read..   
-00019410: 2020 2020 2066 696c 6573 203d 2066 696c       files = fil
-00019420: 6573 5b73 7461 7274 693a 656e 6469 5d0d  es[starti:endi].
-00019430: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00019440: 6973 696e 7374 616e 6365 2870 6174 682c  isinstance(path,
-00019450: 206c 6973 7429 3a0d 0a20 2020 2020 2020   list):..       
-00019460: 2020 2020 2023 2061 6464 2074 6865 2070       # add the p
-00019470: 6174 6820 746f 2061 6c6c 2074 6865 2066  ath to all the f
-00019480: 696c 6573 0d0a 2020 2020 2020 2020 2020  iles..          
-00019490: 2020 6669 6c65 7320 3d20 5b66 227b 7061    files = [f"{pa
-000194a0: 7468 7d2f 7b69 7d22 2066 6f72 2069 2069  th}/{i}" for i i
-000194b0: 6e20 6669 6c65 735d 0d0a 2020 2020 2020  n files]..      
-000194c0: 2020 2320 6372 6561 7465 2061 2033 6420    # create a 3d 
-000194d0: 6172 7261 7920 7769 7468 2074 6865 2032  array with the 2
-000194e0: 6420 6469 6d65 6e73 696f 6e20 6f66 2074  d dimension of t
-000194f0: 6865 2066 6972 7374 2072 6173 7465 7220  he first raster 
-00019500: 616e 6420 7468 6520 6c65 6e0d 0a20 2020  and the len..   
-00019510: 2020 2020 2023 206f 6620 7468 6520 6e75       # of the nu
-00019520: 6d62 6572 206f 6620 7261 7374 6572 7320  mber of rasters 
-00019530: 696e 2074 6865 2066 6f6c 6465 720d 0a20  in the folder.. 
-00019540: 2020 2020 2020 2073 616d 706c 6520 3d20         sample = 
-00019550: 4461 7461 7365 742e 7265 6164 5f66 696c  Dataset.read_fil
-00019560: 6528 6669 6c65 735b 305d 290d 0a0d 0a20  e(files[0]).... 
-00019570: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
-00019580: 7328 7361 6d70 6c65 2c20 6c65 6e28 6669  s(sample, len(fi
-00019590: 6c65 7329 2c20 6669 6c65 7329 0d0a 0d0a  les), files)....
-000195a0: 2020 2020 6465 6620 7265 6164 5f64 6174      def read_dat
-000195b0: 6173 6574 2873 656c 662c 2062 616e 643a  aset(self, band:
-000195c0: 2069 6e74 203d 2030 293a 0d0a 2020 2020   int = 0):..    
-000195d0: 2020 2020 2222 2252 6561 6420 6172 7261      """Read arra
-000195e0: 792e 0d0a 0d0a 2020 2020 2020 2020 2020  y.....          
-000195f0: 2020 5265 6164 2076 616c 7565 7320 666f    Read values fo
-00019600: 726d 2074 6865 2067 6976 656e 2062 616e  rm the given ban
-00019610: 6473 2061 7320 4172 7261 7973 2066 6f72  ds as Arrays for
-00019620: 2061 6c6c 2066 696c 6573 0d0a 0d0a 2020   all files....  
-00019630: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00019640: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00019650: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6261  ----..        ba
-00019660: 6e64 3a20 5b69 6e74 5d0d 0a20 2020 2020  nd: [int]..     
-00019670: 2020 2020 2020 2069 6e64 6578 206f 6620         index of 
-00019680: 7468 6520 6261 6e64 2079 6f75 2077 616e  the band you wan
-00019690: 7420 746f 2072 6561 6420 6465 6661 756c  t to read defaul
-000196a0: 7420 6973 2030 2e0d 0a0d 0a20 2020 2020  t is 0.....     
-000196b0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-000196c0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-000196d0: 2020 2020 2041 7272 6179 0d0a 2020 2020       Array..    
-000196e0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000196f0: 2023 2063 6865 636b 2074 6865 2067 6976   # check the giv
-00019700: 656e 2062 616e 6420 6e75 6d62 6572 0d0a  en band number..
-00019710: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
-00019720: 6173 6174 7472 2873 656c 662c 2022 6261  asattr(self, "ba
-00019730: 7365 2229 3a0d 0a20 2020 2020 2020 2020  se"):..         
-00019740: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00019750: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
-00019760: 2020 2020 2020 2270 6c65 6173 6520 7573        "please us
-00019770: 6520 7468 6520 7265 6164 5f73 6570 6172  e the read_separ
-00019780: 6174 655f 6669 6c65 7320 6d65 7468 6f64  ate_files method
-00019790: 2074 6f20 6765 7420 7468 6520 6669 6c65   to get the file
-000197a0: 7320 2874 6966 662f 6173 6369 6929 2069  s (tiff/ascii) i
-000197b0: 6e20 7468 6522 0d0a 2020 2020 2020 2020  n the"..        
-000197c0: 2020 2020 2020 2020 2264 6174 6173 6574          "dataset
-000197d0: 2064 6972 6563 746f 7279 220d 0a20 2020   directory"..   
-000197e0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000197f0: 2020 2020 6966 2062 616e 6420 3e20 7365      if band > se
-00019800: 6c66 2e62 6173 652e 6261 6e64 5f63 6f75  lf.base.band_cou
-00019810: 6e74 202d 2031 3a0d 0a20 2020 2020 2020  nt - 1:..       
-00019820: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00019830: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
-00019840: 2020 2020 2020 2020 6622 7468 6520 7261          f"the ra
-00019850: 7374 6572 2068 6173 206f 6e6c 7920 7b73  ster has only {s
-00019860: 656c 662e 6261 7365 2e62 616e 645f 636f  elf.base.band_co
-00019870: 756e 747d 2063 6865 636b 2074 6865 2067  unt} check the g
-00019880: 6976 656e 2062 616e 6420 6e75 6d62 6572  iven band number
-00019890: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-000198a0: 0d0a 2020 2020 2020 2020 2320 6669 6c6c  ..        # fill
-000198b0: 2074 6865 2061 7272 6179 2077 6974 6820   the array with 
-000198c0: 6e6f 5f64 6174 615f 7661 6c75 6520 6461  no_data_value da
-000198d0: 7461 0d0a 2020 2020 2020 2020 7365 6c66  ta..        self
-000198e0: 2e5f 6461 7461 203d 206e 702e 6f6e 6573  ._data = np.ones
-000198f0: 280d 0a20 2020 2020 2020 2020 2020 2028  (..            (
-00019900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019910: 2020 7365 6c66 2e74 696d 655f 6c65 6e67    self.time_leng
-00019920: 7468 2c0d 0a20 2020 2020 2020 2020 2020  th,..           
-00019930: 2020 2020 2073 656c 662e 6261 7365 2e72       self.base.r
-00019940: 6f77 732c 0d0a 2020 2020 2020 2020 2020  ows,..          
-00019950: 2020 2020 2020 7365 6c66 2e62 6173 652e        self.base.
-00019960: 636f 6c75 6d6e 732c 0d0a 2020 2020 2020  columns,..      
-00019970: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-00019980: 2029 0d0a 2020 2020 2020 2020 7365 6c66   )..        self
-00019990: 2e5f 6461 7461 5b3a 2c20 3a2c 203a 5d20  ._data[:, :, :] 
-000199a0: 3d20 6e70 2e6e 616e 0d0a 0d0a 2020 2020  = np.nan....    
-000199b0: 2020 2020 666f 7220 692c 2066 696c 655f      for i, file_
-000199c0: 6920 696e 2065 6e75 6d65 7261 7465 2873  i in enumerate(s
-000199d0: 656c 662e 6669 6c65 7329 3a0d 0a20 2020  elf.files):..   
-000199e0: 2020 2020 2020 2020 2023 2072 6561 6420           # read 
-000199f0: 7468 6520 7469 6620 6669 6c65 0d0a 2020  the tif file..  
-00019a00: 2020 2020 2020 2020 2020 7261 7374 6572            raster
-00019a10: 5f69 203d 2067 6461 6c2e 4f70 656e 2866  _i = gdal.Open(f
-00019a20: 227b 6669 6c65 5f69 7d22 290d 0a20 2020  "{file_i}")..   
-00019a30: 2020 2020 2020 2020 2073 656c 662e 5f64           self._d
-00019a40: 6174 615b 692c 203a 2c20 3a5d 203d 2072  ata[i, :, :] = r
-00019a50: 6173 7465 725f 692e 4765 7452 6173 7465  aster_i.GetRaste
-00019a60: 7242 616e 6428 6261 6e64 202b 2031 292e  rBand(band + 1).
-00019a70: 5265 6164 4173 4172 7261 7928 290d 0a0d  ReadAsArray()...
-00019a80: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
-00019a90: 2020 2020 6465 6620 6461 7461 2873 656c      def data(sel
-00019aa0: 6629 202d 3e20 6e70 2e6e 6461 7272 6179  f) -> np.ndarray
-00019ab0: 3a0d 0a20 2020 2020 2020 2022 2222 6461  :..        """da
-00019ac0: 7461 2061 7474 7269 6275 7465 2e0d 0a0d  ta attribute....
-00019ad0: 0a20 2020 2020 2020 202d 2054 6865 2061  .        - The a
-00019ae0: 7474 7269 6275 7465 2077 6865 7265 2074  ttribute where t
-00019af0: 6865 2064 6174 6173 6574 2061 7272 6179  he dataset array
-00019b00: 2069 7320 7374 6f72 6564 2e0d 0a20 2020   is stored...   
-00019b10: 2020 2020 202d 2074 6865 2033 4420 6e75       - the 3D nu
-00019b20: 6d70 7920 6172 7261 792c 205b 6461 7461  mpy array, [data
-00019b30: 7365 7420 6c65 6e67 7468 2c20 726f 7773  set length, rows
-00019b40: 2c20 636f 6c73 5d2c 205b 6461 7461 7365  , cols], [datase
-00019b50: 7420 6c65 6e67 7468 2c20 6c6f 6e73 2c20  t length, lons, 
-00019b60: 6c61 7473 5d0d 0a20 2020 2020 2020 2022  lats]..        "
-00019b70: 2222 0d0a 2020 2020 2020 2020 6966 206e  ""..        if n
-00019b80: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
-00019b90: 2022 5f64 6174 6122 293a 0d0a 2020 2020   "_data"):..    
-00019ba0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00019bb0: 6c75 6545 7272 6f72 2822 706c 6561 7365  lueError("please
-00019bc0: 2075 7365 2074 6865 2072 6561 645f 6461   use the read_da
-00019bd0: 7461 7365 7420 746f 2072 6561 6420 7468  taset to read th
-00019be0: 6520 6461 7461 2066 6972 7374 2e22 290d  e data first.").
-00019bf0: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00019c00: 6e20 7365 6c66 2e5f 6461 7461 0d0a 0d0a  n self._data....
-00019c10: 2020 2020 4064 6174 612e 7365 7474 6572      @data.setter
-00019c20: 0d0a 2020 2020 6465 6620 6461 7461 2873  ..    def data(s
-00019c30: 656c 662c 2076 616c 293a 0d0a 2020 2020  elf, val):..    
-00019c40: 2020 2020 2222 2244 6174 6120 6174 7472      """Data attr
-00019c50: 6962 7574 652e 0d0a 0d0a 2020 2020 2020  ibute.....      
-00019c60: 2020 2d20 7365 7474 696e 6720 7468 6520    - setting the 
-00019c70: 6461 7461 2028 6172 7261 7929 2064 6f65  data (array) doe
-00019c80: 7320 6e6f 7420 616c 6c6f 7720 6469 6666  s not allow diff
-00019c90: 6572 656e 7420 6469 6d65 6e73 696f 6e20  erent dimension 
-00019ca0: 6672 6f6d 2074 6865 2064 696d 656e 7369  from the dimensi
-00019cb0: 6f6e 2074 6861 7420 6861 7665 2062 6565  on that have bee
-00019cc0: 6e0d 0a20 2020 2020 2020 2064 6566 696e  n..        defin
-00019cd0: 6564 2069 6e63 7265 6174 696e 6720 7468  ed increating th
-00019ce0: 6520 6461 7461 7365 742e 0d0a 2020 2020  e dataset...    
-00019cf0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00019d00: 2023 2069 6620 7468 6520 6174 7472 6962   # if the attrib
-00019d10: 7574 6520 6973 2064 6566 696e 6564 2062  ute is defined b
-00019d20: 6566 6f72 6520 6368 6563 6b20 7468 6520  efore check the 
-00019d30: 6469 6d65 6e73 696f 6e0d 0a20 2020 2020  dimension..     
-00019d40: 2020 2069 6620 6861 7361 7474 7228 7365     if hasattr(se
-00019d50: 6c66 2c20 2264 6174 6122 293a 0d0a 2020  lf, "data"):..  
-00019d60: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00019d70: 662e 5f64 6174 612e 7368 6170 6520 213d  f._data.shape !=
-00019d80: 2076 616c 2e73 6861 7065 3a0d 0a20 2020   val.shape:..   
-00019d90: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00019da0: 7365 2056 616c 7565 4572 726f 7228 0d0a  se ValueError(..
-00019db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019dc0: 2020 2020 6622 5468 6520 6469 6d65 6e73      f"The dimens
-00019dd0: 696f 6e20 6f66 2074 6865 206e 6577 2064  ion of the new d
-00019de0: 6174 613a 207b 7661 6c2e 7368 6170 657d  ata: {val.shape}
-00019df0: 2c20 6469 6666 6572 7320 6672 6f6d 2074  , differs from t
-00019e00: 6865 2064 696d 656e 7369 6f6e 206f 6620  he dimension of 
-00019e10: 7468 6520 220d 0a20 2020 2020 2020 2020  the "..         
-00019e20: 2020 2020 2020 2020 2020 2066 226f 7269             f"ori
-00019e30: 6769 6e61 6c20 6461 7461 7365 743a 207b  ginal dataset: {
-00019e40: 7365 6c66 2e5f 6461 7461 2e73 6861 7065  self._data.shape
-00019e50: 7d2c 2070 6c65 6173 6520 7265 6465 6669  }, please redefi
-00019e60: 6e65 2074 6865 2062 6173 6520 4461 7461  ne the base Data
-00019e70: 7365 7420 616e 6420 220d 0a20 2020 2020  set and "..     
-00019e80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00019e90: 2264 6174 6173 6574 5f6c 656e 6774 6820  "dataset_length 
-00019ea0: 6669 7273 7422 0d0a 2020 2020 2020 2020  first"..        
-00019eb0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-00019ec0: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
-00019ed0: 3d20 7661 6c0d 0a0d 0a20 2020 2040 6461  = val....    @da
-00019ee0: 7461 2e64 656c 6574 6572 0d0a 2020 2020  ta.deleter..    
-00019ef0: 6465 6620 6461 7461 2873 656c 6629 3a0d  def data(self):.
-00019f00: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-00019f10: 6174 6120 3d20 4e6f 6e65 0d0a 0d0a 2020  ata = None....  
-00019f20: 2020 6465 6620 5f5f 6765 7469 7465 6d5f    def __getitem_
-00019f30: 5f28 7365 6c66 2c20 6b65 7929 3a0d 0a20  _(self, key):.. 
-00019f40: 2020 2020 2020 2069 6620 6e6f 7420 6861         if not ha
-00019f50: 7361 7474 7228 7365 6c66 2c20 2264 6174  sattr(self, "dat
-00019f60: 6122 293a 0d0a 2020 2020 2020 2020 2020  a"):..          
-00019f70: 2020 7261 6973 6520 4174 7472 6962 7574    raise Attribut
-00019f80: 6545 7272 6f72 2822 506c 6561 7365 2075  eError("Please u
-00019f90: 7365 2074 6865 2072 6561 645f 6461 7461  se the read_data
-00019fa0: 7365 7420 6d65 7468 6f64 2074 2072 6561  set method t rea
-00019fb0: 6420 7468 6520 6461 7461 2229 0d0a 2020  d the data")..  
-00019fc0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00019fd0: 662e 5f64 6174 615b 6b65 792c 203a 2c20  f._data[key, :, 
-00019fe0: 3a5d 0d0a 0d0a 2020 2020 6465 6620 5f5f  :]....    def __
-00019ff0: 7365 7469 7465 6d5f 5f28 7365 6c66 2c20  setitem__(self, 
-0001a000: 6b65 792c 2076 616c 7565 3a20 6e70 2e6e  key, value: np.n
-0001a010: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
-0001a020: 2020 6966 206e 6f74 2068 6173 6174 7472    if not hasattr
-0001a030: 2873 656c 662c 2022 6461 7461 2229 3a0d  (self, "data"):.
-0001a040: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001a050: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
-0001a060: 7228 2250 6c65 6173 6520 7573 6520 7468  r("Please use th
-0001a070: 6520 7265 6164 5f64 6174 6173 6574 206d  e read_dataset m
-0001a080: 6574 686f 6420 7420 7265 6164 2074 6865  ethod t read the
-0001a090: 2064 6174 6122 290d 0a20 2020 2020 2020   data")..       
-0001a0a0: 2073 656c 662e 5f64 6174 615b 6b65 792c   self._data[key,
-0001a0b0: 203a 2c20 3a5d 203d 2076 616c 7565 0d0a   :, :] = value..
-0001a0c0: 0d0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
-0001a0d0: 5f28 7365 6c66 293a 0d0a 2020 2020 2020  _(self):..      
-0001a0e0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0001a0f0: 6174 612e 7368 6170 655b 305d 0d0a 0d0a  ata.shape[0]....
-0001a100: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
-0001a110: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-0001a120: 2072 6574 7572 6e20 6974 6572 2873 656c   return iter(sel
-0001a130: 662e 5f64 6174 615b 3a5d 290d 0a0d 0a20  f._data[:]).... 
-0001a140: 2020 2064 6566 2068 6561 6428 7365 6c66     def head(self
-0001a150: 2c20 6e3a 2069 6e74 203d 2035 293a 0d0a  , n: int = 5):..
-0001a160: 2020 2020 2020 2020 2222 2246 6972 7374          """First
-0001a170: 2035 2044 6174 6173 6574 732e 2222 220d   5 Datasets.""".
-0001a180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001a190: 7365 6c66 2e5f 6461 7461 5b3a 6e2c 203a  self._data[:n, :
-0001a1a0: 2c20 3a5d 0d0a 0d0a 2020 2020 6465 6620  , :]....    def 
-0001a1b0: 7461 696c 2873 656c 662c 206e 3a20 696e  tail(self, n: in
-0001a1c0: 7420 3d20 2d35 293a 0d0a 2020 2020 2020  t = -5):..      
-0001a1d0: 2020 2222 224c 6173 7420 3520 4461 7461    """Last 5 Data
-0001a1e0: 7365 7473 2e22 2222 0d0a 2020 2020 2020  sets."""..      
-0001a1f0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0001a200: 6174 615b 6e3a 2c20 3a2c 203a 5d0d 0a0d  ata[n:, :, :]...
-0001a210: 0a20 2020 2064 6566 2066 6972 7374 2873  .    def first(s
-0001a220: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
-0001a230: 2222 4669 7273 7420 4461 7461 7365 742e  ""First Dataset.
-0001a240: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
-0001a250: 7572 6e20 7365 6c66 2e5f 6461 7461 5b30  urn self._data[0
-0001a260: 2c20 3a2c 203a 5d0d 0a0d 0a20 2020 2064  , :, :]....    d
-0001a270: 6566 206c 6173 7428 7365 6c66 293a 0d0a  ef last(self):..
-0001a280: 2020 2020 2020 2020 2222 224c 6173 7420          """Last 
-0001a290: 4461 7461 7365 742e 2222 220d 0a20 2020  Dataset."""..   
-0001a2a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001a2b0: 2e5f 6461 7461 5b2d 312c 203a 2c20 3a5d  ._data[-1, :, :]
-0001a2c0: 0d0a 0d0a 2020 2020 6465 6620 696c 6f63  ....    def iloc
-0001a2d0: 2873 656c 662c 2069 293a 0d0a 2020 2020  (self, i):..    
-0001a2e0: 2020 2020 2222 2269 6c6f 632e 0d0a 0d0a      """iloc.....
-0001a2f0: 2020 2020 2020 2020 2020 2020 2d20 4163              - Ac
-0001a300: 6365 7373 2064 6174 6173 6574 2061 7272  cess dataset arr
-0001a310: 6179 2075 7369 6e67 2069 6e64 6578 2e0d  ay using index..
-0001a320: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0001a330: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0001a340: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0001a350: 2020 2069 3a20 5b69 6e74 5d0d 0a20 2020     i: [int]..   
-0001a360: 2020 2020 2020 2020 2069 6e64 6578 0d0a           index..
-0001a370: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001a380: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0001a390: 2d2d 0d0a 2020 2020 2020 2020 4461 7461  --..        Data
-0001a3a0: 7365 743a 0d0a 2020 2020 2020 2020 2020  set:..          
-0001a3b0: 2020 4461 7461 7365 7420 6f62 6a65 6374    Dataset object
-0001a3c0: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-0001a3d0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
-0001a3e0: 6173 6174 7472 2873 656c 662c 2022 6461  asattr(self, "da
-0001a3f0: 7461 2229 3a0d 0a20 2020 2020 2020 2020  ta"):..         
-0001a400: 2020 2072 6169 7365 2044 6174 6173 6574     raise Dataset
-0001a410: 4e6f 466f 756e 6445 7272 6f72 2822 706c  NoFoundError("pl
-0001a420: 6561 7365 2072 6561 6420 7468 6520 6461  ease read the da
-0001a430: 7461 7365 7420 6669 7273 7422 290d 0a20  taset first").. 
-0001a440: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
-0001a450: 662e 5f64 6174 615b 692c 203a 2c20 3a5d  f._data[i, :, :]
-0001a460: 0d0a 2020 2020 2020 2020 6473 7420 3d20  ..        dst = 
-0001a470: 6764 616c 2e47 6574 4472 6976 6572 4279  gdal.GetDriverBy
-0001a480: 4e61 6d65 2822 4d45 4d22 292e 4372 6561  Name("MEM").Crea
-0001a490: 7465 436f 7079 2822 222c 2073 656c 662e  teCopy("", self.
-0001a4a0: 6261 7365 2e72 6173 7465 722c 2030 290d  base.raster, 0).
-0001a4b0: 0a20 2020 2020 2020 2064 7374 2e47 6574  .        dst.Get
-0001a4c0: 5261 7374 6572 4261 6e64 2831 292e 5772  RasterBand(1).Wr
-0001a4d0: 6974 6541 7272 6179 2861 7272 290d 0a20  iteArray(arr).. 
-0001a4e0: 2020 2020 2020 2072 6574 7572 6e20 4461         return Da
-0001a4f0: 7461 7365 7428 6473 7429 0d0a 0d0a 2020  taset(dst)....  
-0001a500: 2020 6465 6620 706c 6f74 2873 656c 662c    def plot(self,
-0001a510: 2062 616e 643a 2069 6e74 203d 2030 2c20   band: int = 0, 
-0001a520: 6578 636c 7564 655f 7661 6c75 653a 2041  exclude_value: A
-0001a530: 6e79 203d 204e 6f6e 652c 202a 2a6b 7761  ny = None, **kwa
-0001a540: 7267 7329 3a0d 0a20 2020 2020 2020 2022  rgs):..        "
-0001a550: 2222 5265 6164 2041 7272 6179 0d0a 0d0a  ""Read Array....
-0001a560: 2020 2020 2020 2020 2020 2020 2d20 7265              - re
-0001a570: 6164 2074 6865 2076 616c 7565 7320 7374  ad the values st
-0001a580: 6f72 6564 2069 6e20 6120 6769 7665 6e20  ored in a given 
-0001a590: 6261 6e64 2e0d 0a0d 0a20 2020 2020 2020  band.....       
-0001a5a0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0001a5b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0001a5c0: 0a20 2020 2020 2020 2062 616e 6420 3a20  .        band : 
-0001a5d0: 5b69 6e74 6567 6572 5d0d 0a20 2020 2020  [integer]..     
-0001a5e0: 2020 2020 2020 2074 6865 2062 616e 6420         the band 
-0001a5f0: 796f 7520 7761 6e74 2074 6f20 6765 7420  you want to get 
-0001a600: 6974 7320 6461 7461 2e20 4465 6661 756c  its data. Defaul
-0001a610: 7420 6973 2030 0d0a 2020 2020 2020 2020  t is 0..        
-0001a620: 6578 636c 7564 655f 7661 6c75 653a 205b  exclude_value: [
-0001a630: 416e 795d 0d0a 2020 2020 2020 2020 2020  Any]..          
-0001a640: 2020 7661 6c75 6520 746f 2065 7865 636c    value to execl
-0001a650: 7564 6520 6672 6f6d 2074 6865 2070 6c6f  ude from the plo
-0001a660: 742e 2044 6566 6175 6c74 2069 7320 4e6f  t. Default is No
-0001a670: 6e65 2e0d 0a20 2020 2020 2020 202a 2a6b  ne...        **k
-0001a680: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-0001a690: 2020 2070 6f69 6e74 7320 3a20 5b61 7272     points : [arr
-0001a6a0: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
-0001a6b0: 2020 2020 2033 2063 6f6c 756d 6e20 6172       3 column ar
-0001a6c0: 7261 7920 7769 7468 2074 6865 2066 6972  ray with the fir
-0001a6d0: 7374 2063 6f6c 756d 6e20 6173 2074 6865  st column as the
-0001a6e0: 2076 616c 7565 2079 6f75 2077 616e 7420   value you want 
-0001a6f0: 746f 2064 6973 706c 6179 2066 6f72 2074  to display for t
-0001a700: 6865 2070 6f69 6e74 2c20 7468 6520 7365  he point, the se
-0001a710: 636f 6e64 2069 7320 7468 6520 726f 7773  cond is the rows
-0001a720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a730: 2020 696e 6465 7820 6f66 2074 6865 2070    index of the p
-0001a740: 6f69 6e74 2069 6e20 7468 6520 6172 7261  oint in the arra
-0001a750: 792c 2061 6e64 2074 6865 2074 6869 7264  y, and the third
-0001a760: 2063 6f6c 756d 6e20 6173 2074 6865 2063   column as the c
-0001a770: 6f6c 756d 6e20 696e 6465 7820 696e 2074  olumn index in t
-0001a780: 6865 2061 7272 6179 2e0d 0a20 2020 2020  he array...     
-0001a790: 2020 2020 2020 2020 2020 202d 2074 6865             - the
-0001a7a0: 2073 6563 6f6e 6420 616e 6420 7468 6972   second and thir
-0001a7b0: 6420 636f 6c75 6d6e 2074 656c 6c73 2074  d column tells t
-0001a7c0: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
-0001a7d0: 6865 2070 6f69 6e74 2069 6e20 7468 6520  he point in the 
-0001a7e0: 6172 7261 792e 0d0a 2020 2020 2020 2020  array...        
-0001a7f0: 2020 2020 706f 696e 745f 636f 6c6f 723a      point_color:
-0001a800: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
-0001a810: 2020 2020 2020 2020 636f 6c6f 722e 0d0a          color...
-0001a820: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-0001a830: 745f 7369 7a65 3a20 5b41 6e79 5d0d 0a20  t_size: [Any].. 
-0001a840: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001a850: 697a 6520 6f66 2074 6865 2070 6f69 6e74  ize of the point
-0001a860: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
-0001a870: 6964 5f63 6f6c 6f72 3a20 5b73 7472 5d0d  id_color: [str].
-0001a880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a890: 2074 6865 2063 6f6c 6f72 206f 6620 7468   the color of th
-0001a8a0: 6520 616e 6f74 6174 696f 6e20 6f66 2074  e anotation of t
-0001a8b0: 6865 2070 6f69 6e74 2e20 4465 6661 756c  he point. Defaul
-0001a8c0: 7420 6973 2062 6c75 652e 0d0a 2020 2020  t is blue...    
-0001a8d0: 2020 2020 2020 2020 7069 645f 7369 7a65          pid_size
-0001a8e0: 3a20 5b41 6e79 5d0d 0a20 2020 2020 2020  : [Any]..       
-0001a8f0: 2020 2020 2020 2020 2073 697a 6520 6f66           size of
-0001a900: 2074 6865 2070 6f69 6e74 2061 6e6e 6f74   the point annot
-0001a910: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
-0001a920: 2020 2020 6669 6773 697a 6520 3a20 5b74      figsize : [t
-0001a930: 7570 6c65 5d2c 206f 7074 696f 6e61 6c0d  uple], optional.
-0001a940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a950: 2066 6967 7572 6520 7369 7a65 2e20 5468   figure size. Th
-0001a960: 6520 6465 6661 756c 7420 6973 2028 382c  e default is (8,
-0001a970: 3829 2e0d 0a20 2020 2020 2020 2020 2020  8)...           
-0001a980: 2074 6974 6c65 203a 205b 7374 725d 2c20   title : [str], 
-0001a990: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0001a9a0: 2020 2020 2020 2020 2020 7469 746c 6520            title 
-0001a9b0: 6f66 2074 6865 2070 6c6f 742e 2054 6865  of the plot. The
-0001a9c0: 2064 6566 6175 6c74 2069 7320 2754 6f74   default is 'Tot
-0001a9d0: 616c 2044 6973 6368 6172 6765 272e 0d0a  al Discharge'...
-0001a9e0: 2020 2020 2020 2020 2020 2020 7469 746c              titl
-0001a9f0: 655f 7369 7a65 203a 205b 696e 7465 6765  e_size : [intege
-0001aa00: 725d 2c20 6f70 7469 6f6e 616c 0d0a 2020  r], optional..  
-0001aa10: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-0001aa20: 746c 6520 7369 7a65 2e20 5468 6520 6465  tle size. The de
-0001aa30: 6661 756c 7420 6973 2031 352e 0d0a 2020  fault is 15...  
-0001aa40: 2020 2020 2020 2020 2020 6f72 6965 6e74            orient
-0001aa50: 6174 696f 6e20 3a20 5b73 7472 696e 675d  ation : [string]
-0001aa60: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-0001aa70: 2020 2020 2020 2020 2020 2020 6f72 696e              orin
-0001aa80: 7461 7469 6f6e 206f 6620 7468 6520 636f  tation of the co
-0001aa90: 6c6f 7262 6172 2068 6f72 697a 6f6e 7461  lorbar horizonta
-0001aaa0: 6c2f 7665 7274 6963 616c 2e20 5468 6520  l/vertical. The 
-0001aab0: 6465 6661 756c 7420 6973 2027 7665 7274  default is 'vert
-0001aac0: 6963 616c 272e 0d0a 2020 2020 2020 2020  ical'...        
-0001aad0: 2020 2020 726f 7461 7469 6f6e 203a 205b      rotation : [
-0001aae0: 6e75 6d62 6572 5d2c 206f 7074 696f 6e61  number], optiona
-0001aaf0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-0001ab00: 2020 2072 6f74 6174 696f 6e20 6f66 2074     rotation of t
-0001ab10: 6865 2063 6f6c 6f72 6261 7220 6c61 6265  he colorbar labe
-0001ab20: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
-0001ab30: 7320 2d39 302e 0d0a 2020 2020 2020 2020  s -90...        
-0001ab40: 2020 2020 6f72 6965 6e74 6174 696f 6e20      orientation 
-0001ab50: 3a20 5b73 7472 696e 675d 2c20 6f70 7469  : [string], opti
-0001ab60: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-0001ab70: 2020 2020 2020 6f72 696e 7461 7469 6f6e        orintation
-0001ab80: 206f 6620 7468 6520 636f 6c6f 7262 6172   of the colorbar
-0001ab90: 2068 6f72 697a 6f6e 7461 6c2f 7665 7274   horizontal/vert
-0001aba0: 6963 616c 2e20 5468 6520 6465 6661 756c  ical. The defaul
-0001abb0: 7420 6973 2027 7665 7274 6963 616c 272e  t is 'vertical'.
-0001abc0: 0d0a 2020 2020 2020 2020 2020 2020 6362  ..            cb
-0001abd0: 6172 5f6c 656e 6774 6820 3a20 5b66 6c6f  ar_length : [flo
-0001abe0: 6174 5d2c 206f 7074 696f 6e61 6c0d 0a20  at], optional.. 
-0001abf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001ac00: 6174 696f 2074 6f20 636f 6e74 726f 6c20  atio to control 
-0001ac10: 7468 6520 6865 6967 6874 206f 6620 7468  the height of th
-0001ac20: 6520 636f 6c6f 7262 6172 2e20 5468 6520  e colorbar. The 
-0001ac30: 6465 6661 756c 7420 6973 2030 2e37 352e  default is 0.75.
-0001ac40: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
-0001ac50: 636b 735f 7370 6163 696e 6720 3a20 5b69  cks_spacing : [i
-0001ac60: 6e74 6567 6572 5d2c 206f 7074 696f 6e61  nteger], optiona
-0001ac70: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-0001ac80: 2020 2053 7061 6369 6e67 2069 6e20 7468     Spacing in th
-0001ac90: 6520 636f 6c6f 7262 6172 2074 6963 6b73  e colorbar ticks
-0001aca0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-0001acb0: 2032 2e0d 0a20 2020 2020 2020 2020 2020   2...           
-0001acc0: 2063 6261 725f 6c61 6265 6c5f 7369 7a65   cbar_label_size
-0001acd0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
-0001ace0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-0001acf0: 2020 2020 2020 7369 7a65 206f 6620 7468        size of th
-0001ad00: 6520 636f 6c6f 7220 6261 7220 6c61 6265  e color bar labe
-0001ad10: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
-0001ad20: 7320 3132 2e0d 0a20 2020 2020 2020 2020  s 12...         
-0001ad30: 2020 2063 6261 725f 6c61 6265 6c20 3a20     cbar_label : 
-0001ad40: 7374 722c 206f 7074 696f 6e61 6c0d 0a20  str, optional.. 
-0001ad50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001ad60: 6162 656c 206f 6620 7468 6520 636f 6c6f  abel of the colo
-0001ad70: 7220 6261 722e 2054 6865 2064 6566 6175  r bar. The defau
-0001ad80: 6c74 2069 7320 2744 6973 6368 6172 6765  lt is 'Discharge
-0001ad90: 206d 332f 7327 2e0d 0a20 2020 2020 2020   m3/s'...       
-0001ada0: 2020 2020 2063 6f6c 6f72 5f73 6361 6c65       color_scale
-0001adb0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
-0001adc0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-0001add0: 2020 2020 2020 7468 6572 6520 6172 6520        there are 
-0001ade0: 3520 6f70 7469 6f6e 7320 746f 2063 6861  5 options to cha
-0001adf0: 6e67 6520 7468 6520 7363 616c 6520 6f66  nge the scale of
-0001ae00: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
-0001ae10: 2064 6566 6175 6c74 2069 7320 312e 0d0a   default is 1...
-0001ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ae30: 312d 2063 6f6c 6f72 5f73 6361 6c65 2031  1- color_scale 1
-0001ae40: 2069 7320 7468 6520 6e6f 726d 616c 2073   is the normal s
-0001ae50: 6361 6c65 0d0a 2020 2020 2020 2020 2020  cale..          
-0001ae60: 2020 2020 2020 322d 2063 6f6c 6f72 5f73        2- color_s
-0001ae70: 6361 6c65 2032 2069 7320 7468 6520 706f  cale 2 is the po
-0001ae80: 7765 7220 7363 616c 650d 0a20 2020 2020  wer scale..     
-0001ae90: 2020 2020 2020 2020 2020 2033 2d20 636f             3- co
-0001aea0: 6c6f 725f 7363 616c 6520 3320 6973 2074  lor_scale 3 is t
-0001aeb0: 6865 2053 796d 4c6f 674e 6f72 6d20 7363  he SymLogNorm sc
-0001aec0: 616c 650d 0a20 2020 2020 2020 2020 2020  ale..           
-0001aed0: 2020 2020 2034 2d20 636f 6c6f 725f 7363       4- color_sc
-0001aee0: 616c 6520 3420 6973 2074 6865 2050 6f77  ale 4 is the Pow
-0001aef0: 6572 4e6f 726d 2073 6361 6c65 0d0a 2020  erNorm scale..  
-0001af00: 2020 2020 2020 2020 2020 2020 2020 352d                5-
-0001af10: 2063 6f6c 6f72 5f73 6361 6c65 2035 2069   color_scale 5 i
-0001af20: 7320 7468 6520 426f 756e 6461 7279 4e6f  s the BoundaryNo
-0001af30: 726d 2073 6361 6c65 0d0a 2020 2020 2020  rm scale..      
-0001af40: 2020 2020 2020 2020 2020 2d2d 2d2d 2d2d            ------
-0001af50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001af60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001af70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001af80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-0001af90: 2020 2020 2020 2020 2020 2020 2020 6761                ga
-0001afa0: 6d6d 6120 3a20 5b66 6c6f 6174 5d2c 206f  mma : [float], o
-0001afb0: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-0001afc0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-0001afd0: 7565 206e 6565 6465 6420 666f 7220 6f70  ue needed for op
-0001afe0: 7469 6f6e 2032 202e 2054 6865 2064 6566  tion 2 . The def
-0001aff0: 6175 6c74 2069 7320 312e 2f32 2e2e 0d0a  ault is 1./2....
-0001b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b010: 6c69 6e65 5f74 6872 6573 686f 6c64 203a  line_threshold :
-0001b020: 205b 666c 6f61 745d 2c20 6f70 7469 6f6e   [float], option
-0001b030: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-0001b040: 2020 2020 2020 2020 7661 6c75 6520 6e65          value ne
-0001b050: 6564 6564 2066 6f72 206f 7074 696f 6e20  eded for option 
-0001b060: 332e 2054 6865 2064 6566 6175 6c74 2069  3. The default i
-0001b070: 7320 302e 3030 3031 2e0d 0a20 2020 2020  s 0.0001...     
-0001b080: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-0001b090: 7363 616c 6520 3a20 5b66 6c6f 6174 5d2c  scale : [float],
-0001b0a0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-0001b0b0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0001b0c0: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
-0001b0d0: 6f70 7469 6f6e 2033 2e20 5468 6520 6465  option 3. The de
-0001b0e0: 6661 756c 7420 6973 2030 2e30 3031 2e0d  fault is 0.001..
-0001b0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b100: 2062 6f75 6e64 733a 205b 4c69 7374 5d0d   bounds: [List].
-0001b110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b120: 2020 2020 2061 206c 6973 7420 6f66 206e       a list of n
-0001b130: 756d 6265 7220 746f 2062 6520 7573 6564  umber to be used
-0001b140: 2061 7320 6120 6469 7363 7265 7465 2062   as a discrete b
-0001b150: 6f75 6e64 7320 666f 7220 7468 6520 636f  ounds for the co
-0001b160: 6c6f 7220 7363 616c 6520 342e 4465 6661  lor scale 4.Defa
-0001b170: 756c 7420 6973 204e 6f6e 652c 0d0a 2020  ult is None,..  
-0001b180: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-0001b190: 6470 6f69 6e74 203a 205b 666c 6f61 745d  dpoint : [float]
-0001b1a0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-0001b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1c0: 7661 6c75 6520 6e65 6564 6564 2066 6f72  value needed for
-0001b1d0: 206f 7074 696f 6e20 352e 2054 6865 2064   option 5. The d
-0001b1e0: 6566 6175 6c74 2069 7320 302e 0d0a 2020  efault is 0...  
-0001b1f0: 2020 2020 2020 2020 2020 2020 2020 2d2d                --
-0001b200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001b210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001b220: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001b230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001b240: 0d0a 2020 2020 2020 2020 2020 2020 636d  ..            cm
-0001b250: 6170 203a 205b 7374 725d 2c20 6f70 7469  ap : [str], opti
-0001b260: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-0001b270: 2020 2020 2020 636f 6c6f 7220 7374 796c        color styl
-0001b280: 652e 2054 6865 2064 6566 6175 6c74 2069  e. The default i
-0001b290: 7320 2763 6f6f 6c77 6172 6d5f 7227 2e0d  s 'coolwarm_r'..
-0001b2a0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-0001b2b0: 706c 6179 5f63 656c 6c5f 7661 6c75 6520  play_cell_value 
-0001b2c0: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
-0001b2d0: 2020 2020 2020 2020 2020 5472 7565 2069            True i
-0001b2e0: 6620 796f 7520 7761 6e74 2074 6f20 6469  f you want to di
-0001b2f0: 7370 6c61 7920 7468 6520 7661 6c75 6573  splay the values
-0001b300: 206f 6620 7468 6520 6365 6c6c 7320 6173   of the cells as
-0001b310: 2061 2074 6578 740d 0a20 2020 2020 2020   a text..       
-0001b320: 2020 2020 206e 756d 5f73 697a 6520 3a20       num_size : 
-0001b330: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
-0001b340: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-0001b350: 2020 2073 697a 6520 6f66 2074 6865 206e     size of the n
-0001b360: 756d 6265 7273 2070 6c6f 7474 6564 2069  umbers plotted i
-0001b370: 6e74 6f70 206f 6620 6561 6368 2063 656c  ntop of each cel
-0001b380: 6c73 2e20 5468 6520 6465 6661 756c 7420  ls. The default 
-0001b390: 6973 2038 2e0d 0a20 2020 2020 2020 2020  is 8...         
-0001b3a0: 2020 2062 6163 6b67 726f 756e 645f 636f     background_co
-0001b3b0: 6c6f 725f 7468 7265 7368 6f6c 6420 3a20  lor_threshold : 
-0001b3c0: 5b66 6c6f 6174 2f69 6e74 6567 6572 5d2c  [float/integer],
-0001b3d0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-0001b3e0: 2020 2020 2020 2020 2020 2074 6872 6573             thres
-0001b3f0: 686f 6c64 2076 616c 7565 2069 6620 7468  hold value if th
-0001b400: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
-0001b410: 656c 6c20 6973 2067 7265 6174 6572 2c20  ell is greater, 
-0001b420: 7468 6520 706c 6f74 7465 640d 0a20 2020  the plotted..   
-0001b430: 2020 2020 2020 2020 2020 2020 206e 756d               num
-0001b440: 6265 7273 2077 696c 6c20 6265 2062 6c61  bers will be bla
-0001b450: 636b 2061 6e64 2069 6620 736d 616c 6c65  ck and if smalle
-0001b460: 7220 7468 6520 706c 6f74 7465 6420 6e75  r the plotted nu
-0001b470: 6d62 6572 2077 696c 6c20 6265 2077 6869  mber will be whi
-0001b480: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
-0001b490: 2020 2020 6966 204e 6f6e 6520 6769 7665      if None give
-0001b4a0: 6e20 7468 6520 6d61 7876 616c 7565 2f32  n the maxvalue/2
-0001b4b0: 2077 696c 6c20 6265 2063 6f6e 7369 6465   will be conside
-0001b4c0: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
-0001b4d0: 2069 7320 4e6f 6e65 2e0d 0a0d 0a20 2020   is None.....   
-0001b4e0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-0001b4f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-0001b500: 2020 2020 2020 2061 7865 733a 205b 6669         axes: [fi
-0001b510: 6775 7265 2061 7865 735d 2e0d 0a20 2020  gure axes]...   
-0001b520: 2020 2020 2020 2020 2074 6865 2061 7865           the axe
-0001b530: 7320 6f66 2074 6865 206d 6174 706c 6f74  s of the matplot
-0001b540: 6c69 6220 6669 6775 7265 0d0a 2020 2020  lib figure..    
-0001b550: 2020 2020 6669 673a 205b 6d61 7470 6c6f      fig: [matplo
-0001b560: 746c 6962 2066 6967 7572 6520 6f62 6a65  tlib figure obje
-0001b570: 6374 5d0d 0a20 2020 2020 2020 2020 2020  ct]..           
-0001b580: 2074 6865 2066 6967 7572 6520 6f62 6a65   the figure obje
-0001b590: 6374 0d0a 2020 2020 2020 2020 2222 220d  ct..        """.
-0001b5a0: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
-0001b5b0: 636c 656f 7061 7472 6128 0d0a 2020 2020  cleopatra(..    
-0001b5c0: 2020 2020 2020 2020 2254 6865 2063 7572          "The cur
-0001b5d0: 7265 6e74 2066 756e 6372 696f 6e20 7573  rent funcrion us
-0001b5e0: 6573 2063 6c65 6f70 6174 7261 2070 6163  es cleopatra pac
-0001b5f0: 6b61 6765 2074 6f20 666f 7220 706c 6f74  kage to for plot
-0001b600: 7469 6e67 2c20 706c 6561 7365 2069 6e73  ting, please ins
-0001b610: 7461 6c6c 2069 7420 6d61 6e75 616c 6c79  tall it manually
-0001b620: 2c20 666f 7220 6d6f 7265 2069 6e66 6f20  , for more info 
-0001b630: 220d 0a20 2020 2020 2020 2020 2020 2022  "..            "
-0001b640: 6368 6563 6b20 6874 7470 733a 2f2f 6769  check https://gi
-0001b650: 7468 7562 2e63 6f6d 2f53 6572 6170 6965  thub.com/Serapie
-0001b660: 756d 2d6f 662d 616c 6578 2f63 6c65 6f70  um-of-alex/cleop
-0001b670: 6174 7261 220d 0a20 2020 2020 2020 2029  atra"..        )
-0001b680: 0d0a 2020 2020 2020 2020 6672 6f6d 2063  ..        from c
-0001b690: 6c65 6f70 6174 7261 2e61 7272 6179 2069  leopatra.array i
-0001b6a0: 6d70 6f72 7420 4172 7261 790d 0a0d 0a20  mport Array.... 
-0001b6b0: 2020 2020 2020 2064 6174 6120 3d20 7365         data = se
-0001b6c0: 6c66 2e64 6174 610d 0a0d 0a20 2020 2020  lf.data....     
-0001b6d0: 2020 2065 7863 6c75 6465 5f76 616c 7565     exclude_value
-0001b6e0: 203d 2028 0d0a 2020 2020 2020 2020 2020   = (..          
-0001b6f0: 2020 5b73 656c 662e 6261 7365 2e6e 6f5f    [self.base.no_
-0001b700: 6461 7461 5f76 616c 7565 5b62 616e 645d  data_value[band]
-0001b710: 2c20 6578 636c 7564 655f 7661 6c75 655d  , exclude_value]
-0001b720: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001b730: 2065 7863 6c75 6465 5f76 616c 7565 2069   exclude_value i
-0001b740: 7320 6e6f 7420 4e6f 6e65 0d0a 2020 2020  s not None..    
-0001b750: 2020 2020 2020 2020 656c 7365 205b 7365          else [se
-0001b760: 6c66 2e62 6173 652e 6e6f 5f64 6174 615f  lf.base.no_data_
-0001b770: 7661 6c75 655b 6261 6e64 5d5d 0d0a 2020  value[band]]..  
-0001b780: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-0001b790: 2020 2063 6c65 6f20 3d20 4172 7261 7928     cleo = Array(
-0001b7a0: 6461 7461 2c20 6578 636c 7564 655f 7661  data, exclude_va
-0001b7b0: 6c75 653d 6578 636c 7564 655f 7661 6c75  lue=exclude_valu
-0001b7c0: 6529 0d0a 2020 2020 2020 2020 7469 6d65  e)..        time
-0001b7d0: 203d 206c 6973 7428 7261 6e67 6528 7365   = list(range(se
-0001b7e0: 6c66 2e74 696d 655f 6c65 6e67 7468 2929  lf.time_length))
-0001b7f0: 0d0a 2020 2020 2020 2020 616e 696d 203d  ..        anim =
-0001b800: 2063 6c65 6f2e 616e 696d 6174 6528 7469   cleo.animate(ti
-0001b810: 6d65 2c20 2a2a 6b77 6172 6773 290d 0a20  me, **kwargs).. 
-0001b820: 2020 2020 2020 2072 6574 7572 6e20 616e         return an
-0001b830: 696d 0d0a 0d0a 2020 2020 6465 6620 746f  im....    def to
-0001b840: 5f66 696c 6528 7365 6c66 2c20 7061 7468  _file(self, path
-0001b850: 3a20 7374 722c 2064 7269 7665 723a 2073  : str, driver: s
-0001b860: 7472 203d 2022 6765 6f74 6966 6622 2c20  tr = "geotiff", 
-0001b870: 6261 6e64 3a20 696e 7420 3d20 3029 3a0d  band: int = 0):.
-0001b880: 0a20 2020 2020 2020 2022 2222 5361 7665  .        """Save
-0001b890: 2074 6f20 6765 6f74 6966 6620 666f 726d   to geotiff form
-0001b8a0: 6174 2e0d 0a0d 0a20 2020 2020 2020 2020  at.....         
-0001b8b0: 2020 2073 6176 6552 6173 7465 7220 7361     saveRaster sa
-0001b8c0: 7665 7320 6120 7261 7374 6572 2074 6f20  ves a raster to 
-0001b8d0: 6120 7061 7468 0d0a 0d0a 2020 2020 2020  a path....      
-0001b8e0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0001b8f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001b900: 0d0a 2020 2020 2020 2020 7061 7468 3a20  ..        path: 
-0001b910: 5b73 7472 696e 675d 0d0a 2020 2020 2020  [string]..      
-0001b920: 2020 2020 2020 6120 7061 7468 2069 6e63        a path inc
-0001b930: 6c75 646e 6720 7468 6520 6e61 6d65 206f  ludng the name o
-0001b940: 6620 7468 6520 7261 7374 6572 2061 6e64  f the raster and
-0001b950: 2065 7874 656e 7469 6f6e 2e0d 0a20 2020   extention...   
-0001b960: 2020 2020 2020 2020 203e 3e3e 2070 6174           >>> pat
-0001b970: 6820 3d20 2264 6174 612f 6372 6f70 7065  h = "data/croppe
-0001b980: 642e 7469 6622 0d0a 2020 2020 2020 2020  d.tif"..        
-0001b990: 6472 6976 6572 3a20 5b73 7472 5d0d 0a20  driver: [str].. 
-0001b9a0: 2020 2020 2020 2020 2020 2064 7269 7665             drive
-0001b9b0: 7220 3d20 2267 656f 7469 6666 222e 0d0a  r = "geotiff"...
-0001b9c0: 2020 2020 2020 2020 6261 6e64 3a20 5b69          band: [i
-0001b9d0: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
-0001b9e0: 2062 616e 6420 696e 6465 782c 206e 6565   band index, nee
-0001b9f0: 6465 6420 6f6e 6c79 2069 6e20 6361 7365  ded only in case
-0001ba00: 206f 6620 6173 6369 6920 6472 6976 6572   of ascii driver
-0001ba10: 732e 2044 6566 6175 6c74 2069 7320 312e  s. Default is 1.
-0001ba20: 0d0a 0d0a 2020 2020 2020 2020 4578 616d  ....        Exam
-0001ba30: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
-0001ba40: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0001ba50: 3e3e 3e20 7261 7374 6572 5f6f 626a 203d  >>> raster_obj =
-0001ba60: 2044 6174 6173 6574 2e72 6561 645f 6669   Dataset.read_fi
-0001ba70: 6c65 2822 7061 7468 2f74 6f2f 6669 6c65  le("path/to/file
-0001ba80: 2f2a 2a2a 2e74 6966 2229 0d0a 2020 2020  /***.tif")..    
-0001ba90: 2020 2020 3e3e 3e20 6f75 7470 7574 5f70      >>> output_p
-0001baa0: 6174 6820 3d20 2265 7861 6d70 6c65 732f  ath = "examples/
-0001bab0: 4749 532f 6461 7461 2f73 6176 655f 7261  GIS/data/save_ra
-0001bac0: 7374 6572 5f74 6573 742e 7469 6622 0d0a  ster_test.tif"..
-0001bad0: 2020 2020 2020 2020 3e3e 3e20 7261 7374          >>> rast
-0001bae0: 6572 5f6f 626a 2e74 6f5f 6669 6c65 286f  er_obj.to_file(o
-0001baf0: 7574 7075 745f 7061 7468 290d 0a20 2020  utput_path)..   
-0001bb00: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0001bb10: 2020 6966 206e 6f74 2050 6174 6828 7061    if not Path(pa
-0001bb20: 7468 292e 6578 6973 7473 2829 3a0d 0a20  th).exists():.. 
-0001bb30: 2020 2020 2020 2020 2020 2050 6174 6828             Path(
-0001bb40: 7061 7468 292e 6d6b 6469 7228 7061 7265  path).mkdir(pare
-0001bb50: 6e74 733d 5472 7565 2c20 6578 6973 745f  nts=True, exist_
-0001bb60: 6f6b 3d54 7275 6529 0d0a 2020 2020 2020  ok=True)..      
-0001bb70: 2020 6578 7420 3d20 4341 5441 4c4f 472e    ext = CATALOG.
-0001bb80: 6765 745f 6578 7465 6e73 696f 6e28 6472  get_extension(dr
-0001bb90: 6976 6572 290d 0a0d 0a20 2020 2020 2020  iver)....       
-0001bba0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0001bbb0: 7365 6c66 2e74 696d 655f 6c65 6e67 7468  self.time_length
-0001bbc0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001bbd0: 7372 6320 3d20 7365 6c66 2e69 6c6f 6328  src = self.iloc(
-0001bbe0: 6929 0d0a 2020 2020 2020 2020 2020 2020  i)..            
-0001bbf0: 7372 632e 746f 5f66 696c 6528 6622 7b70  src.to_file(f"{p
-0001bc00: 6174 687d 2f7b 697d 2e7b 6578 747d 222c  ath}/{i}.{ext}",
-0001bc10: 2064 7269 7665 723d 6472 6976 6572 2c20   driver=driver, 
-0001bc20: 6261 6e64 3d62 616e 6429 0d0a 0d0a 2020  band=band)....  
-0001bc30: 2020 6465 6620 746f 5f63 7273 280d 0a20    def to_crs(.. 
-0001bc40: 2020 2020 2020 2073 656c 662c 0d0a 2020         self,..  
-0001bc50: 2020 2020 2020 746f 5f65 7073 673a 2069        to_epsg: i
-0001bc60: 6e74 203d 2033 3835 372c 0d0a 2020 2020  nt = 3857,..    
-0001bc70: 2020 2020 6d65 7468 6f64 3a20 7374 7220      method: str 
-0001bc80: 3d20 226e 6561 7265 7374 206e 6569 626f  = "nearest neibo
-0001bc90: 7572 222c 0d0a 2020 2020 2020 2020 6d61  ur",..        ma
-0001bca0: 696e 7461 696e 5f61 6c69 6768 6d65 6e74  intain_alighment
-0001bcb0: 3a20 696e 7420 3d20 4661 6c73 652c 0d0a  : int = False,..
-0001bcc0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-0001bcd0: 2222 2274 6f5f 6570 7367 2e0d 0a0d 0a20  """to_epsg..... 
-0001bce0: 2020 2020 2020 2020 2020 202d 2074 6f5f             - to_
-0001bcf0: 6570 7367 2072 6570 726f 6a65 6374 7320  epsg reprojects 
-0001bd00: 6120 7261 7374 6572 2074 6f20 616e 7920  a raster to any 
-0001bd10: 7072 6f6a 6563 7469 6f6e 2028 6465 6661  projection (defa
-0001bd20: 756c 7420 7468 6520 5747 5338 3420 7765  ult the WGS84 we
-0001bd30: 6220 6d65 7263 6174 6f72 2070 726f 6a65  b mercator proje
-0001bd40: 6374 696f 6e2c 0d0a 2020 2020 2020 2020  ction,..        
-0001bd50: 2020 2020 7769 7468 6f75 7420 7265 7361      without resa
-0001bd60: 6d70 6c69 6e67 2920 5468 6520 6675 6e63  mpling) The func
-0001bd70: 7469 6f6e 2072 6574 7572 6e73 2061 2047  tion returns a G
-0001bd80: 4441 4c20 696e 2d6d 656d 6f72 7920 6669  DAL in-memory fi
-0001bd90: 6c65 206f 626a 6563 742c 2077 6865 7265  le object, where
-0001bda0: 2079 6f75 2063 616e 2052 6561 6441 7341   you can ReadAsA
-0001bdb0: 7272 6179 2065 7463 2e0d 0a0d 0a20 2020  rray etc.....   
-0001bdc0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0001bdd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001bde0: 2d2d 2d0d 0a20 2020 2020 2020 2074 6f5f  ---..        to_
-0001bdf0: 6570 7367 3a20 5b69 6e74 6567 6572 5d0d  epsg: [integer].
-0001be00: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
-0001be10: 6572 656e 6365 206e 756d 6265 7220 746f  erence number to
-0001be20: 2074 6865 206e 6577 2070 726f 6a65 6374   the new project
-0001be30: 696f 6e20 2868 7474 7073 3a2f 2f65 7073  ion (https://eps
-0001be40: 672e 696f 2f29 0d0a 2020 2020 2020 2020  g.io/)..        
-0001be50: 2020 2020 2864 6566 6175 6c74 2033 3835      (default 385
-0001be60: 3720 7468 6520 7265 6665 7265 6e63 6520  7 the reference 
-0001be70: 6e6f 206f 6620 5747 5338 3420 7765 6220  no of WGS84 web 
-0001be80: 6d65 7263 6174 6f72 2029 0d0a 2020 2020  mercator )..    
-0001be90: 2020 2020 6d65 7468 6f64 3a20 5b53 7472      method: [Str
-0001bea0: 696e 675d 0d0a 2020 2020 2020 2020 2020  ing]..          
-0001beb0: 2020 7265 7361 6d70 6c69 6e67 2074 6563    resampling tec
-0001bec0: 686e 6971 7565 2064 6566 6175 6c74 2069  hnique default i
-0001bed0: 7320 224e 6561 7265 7374 220d 0a20 2020  s "Nearest"..   
-0001bee0: 2020 2020 2020 2020 2068 7474 7073 3a2f           https:/
-0001bef0: 2f67 6973 6765 6f67 7261 7068 792e 636f  /gisgeography.co
-0001bf00: 6d2f 7261 7374 6572 2d72 6573 616d 706c  m/raster-resampl
-0001bf10: 696e 672f 0d0a 2020 2020 2020 2020 2020  ing/..          
-0001bf20: 2020 224e 6561 7265 7374 2220 666f 7220    "Nearest" for 
-0001bf30: 6e65 6172 6573 7420 6e65 6967 6862 6f75  nearest neighbou
-0001bf40: 722c 2263 7562 6963 2220 666f 7220 6375  r,"cubic" for cu
-0001bf50: 6269 6320 636f 6e76 6f6c 7574 696f 6e2c  bic convolution,
-0001bf60: 0d0a 2020 2020 2020 2020 2020 2020 2262  ..            "b
-0001bf70: 696c 696e 6561 7222 2066 6f72 2062 696c  ilinear" for bil
-0001bf80: 696e 6561 720d 0a20 2020 2020 2020 206d  inear..        m
-0001bf90: 6169 6e74 6169 6e5f 616c 6967 686d 656e  aintain_alighmen
-0001bfa0: 7420 3a20 5b62 6f6f 6c5d 0d0a 2020 2020  t : [bool]..    
-0001bfb0: 2020 2020 2020 2020 5472 7565 2074 6f20          True to 
-0001bfc0: 6d61 696e 7461 696e 2074 6865 206e 756d  maintain the num
-0001bfd0: 6265 7220 6f66 2072 6f77 7320 616e 6420  ber of rows and 
-0001bfe0: 636f 6c75 6d6e 7320 6f66 2074 6865 2072  columns of the r
-0001bff0: 6173 7465 7220 7468 6520 7361 6d65 2061  aster the same a
-0001c000: 6674 6572 2072 6570 726f 6a65 6374 696f  fter reprojectio
-0001c010: 6e2e 2044 6566 6175 6c74 2069 7320 4661  n. Default is Fa
-0001c020: 6c73 652e 0d0a 0d0a 2020 2020 2020 2020  lse.....        
-0001c030: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-0001c040: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-0001c050: 2020 7261 7374 6572 3a0d 0a20 2020 2020    raster:..     
-0001c060: 2020 2020 2020 2067 6461 6c20 6461 7461         gdal data
-0001c070: 7365 7420 2879 6f75 2063 616e 2072 6561  set (you can rea
-0001c080: 6420 6974 2062 7920 5265 6164 4173 4172  d it by ReadAsAr
-0001c090: 7261 7929 0d0a 0d0a 2020 2020 2020 2020  ray)....        
-0001c0a0: 4578 616d 706c 6573 0d0a 2020 2020 2020  Examples..      
-0001c0b0: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020    --------..    
-0001c0c0: 2020 2020 3e3e 3e20 6672 6f6d 2070 7972      >>> from pyr
-0001c0d0: 616d 6964 732e 6461 7461 7365 7420 696d  amids.dataset im
-0001c0e0: 706f 7274 2044 6174 6173 6574 0d0a 2020  port Dataset..  
-0001c0f0: 2020 2020 2020 3e3e 3e20 7372 6320 3d20        >>> src = 
-0001c100: 4461 7461 7365 742e 7265 6164 5f66 696c  Dataset.read_fil
-0001c110: 6528 2270 6174 682f 7261 7374 6572 5f6e  e("path/raster_n
-0001c120: 616d 652e 7469 6622 290d 0a20 2020 2020  ame.tif")..     
-0001c130: 2020 203e 3e3e 2070 726f 6a65 6374 6564     >>> projected
-0001c140: 5f72 6173 7465 7220 3d20 7372 632e 746f  _raster = src.to
-0001c150: 5f63 7273 2874 6f5f 6570 7367 3d33 3835  _crs(to_epsg=385
-0001c160: 3729 0d0a 2020 2020 2020 2020 2222 220d  7)..        """.
-0001c170: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0001c180: 6e20 7261 6e67 6528 7365 6c66 2e74 696d  n range(self.tim
-0001c190: 655f 6c65 6e67 7468 293a 0d0a 2020 2020  e_length):..    
-0001c1a0: 2020 2020 2020 2020 7372 6320 3d20 7365          src = se
-0001c1b0: 6c66 2e69 6c6f 6328 6929 0d0a 2020 2020  lf.iloc(i)..    
-0001c1c0: 2020 2020 2020 2020 6473 7420 3d20 7372          dst = sr
-0001c1d0: 632e 746f 5f63 7273 280d 0a20 2020 2020  c.to_crs(..     
-0001c1e0: 2020 2020 2020 2020 2020 2074 6f5f 6570             to_ep
-0001c1f0: 7367 2c20 6d65 7468 6f64 3d6d 6574 686f  sg, method=metho
-0001c200: 642c 206d 6169 6e74 6169 6e5f 616c 6967  d, maintain_alig
-0001c210: 686d 656e 743d 6d61 696e 7461 696e 5f61  hment=maintain_a
-0001c220: 6c69 6768 6d65 6e74 0d0a 2020 2020 2020  lighment..      
-0001c230: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-0001c240: 2020 2020 2061 7272 203d 2064 7374 2e72       arr = dst.r
-0001c250: 6561 645f 6172 7261 7928 290d 0a20 2020  ead_array()..   
-0001c260: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
-0001c270: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-0001c280: 2020 2020 2023 2063 7265 6174 6520 7468       # create th
-0001c290: 6520 6172 7261 790d 0a20 2020 2020 2020  e array..       
-0001c2a0: 2020 2020 2020 2020 2061 7272 6179 203d           array =
-0001c2b0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-0001c2c0: 2020 2020 2020 2020 6e70 2e6f 6e65 7328          np.ones(
-0001c2d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001c2e0: 2020 2020 2020 2020 2020 280d 0a20 2020            (..   
-0001c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c300: 2020 2020 2020 2020 2073 656c 662e 7469           self.ti
-0001c310: 6d65 5f6c 656e 6774 682c 0d0a 2020 2020  me_length,..    
-0001c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c330: 2020 2020 2020 2020 6172 722e 7368 6170          arr.shap
-0001c340: 655b 305d 2c0d 0a20 2020 2020 2020 2020  e[0],..         
-0001c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c360: 2020 2061 7272 2e73 6861 7065 5b31 5d2c     arr.shape[1],
-0001c370: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001c380: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-0001c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3a0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-0001c3b0: 2020 2020 2020 2020 2a20 6e70 2e6e 616e          * np.nan
-0001c3c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001c3d0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-0001c3e0: 2061 7272 6179 5b69 2c20 3a2c 203a 5d20   array[i, :, :] 
-0001c3f0: 3d20 6172 720d 0a0d 0a20 2020 2020 2020  = arr....       
-0001c400: 2073 656c 662e 5f64 6174 6120 3d20 6172   self._data = ar
-0001c410: 7261 790d 0a20 2020 2020 2020 2023 2075  ray..        # u
-0001c420: 7365 2074 6865 206c 6173 7420 7372 6320  se the last src 
-0001c430: 6173 0d0a 2020 2020 2020 2020 7365 6c66  as..        self
-0001c440: 2e5f 6261 7365 203d 2064 7374 0d0a 0d0a  ._base = dst....
-0001c450: 2020 2020 6465 6620 6372 6f70 280d 0a20      def crop(.. 
-0001c460: 2020 2020 2020 2073 656c 662c 0d0a 2020         self,..  
-0001c470: 2020 2020 2020 6d61 736b 3a20 556e 696f        mask: Unio
-0001c480: 6e5b 4461 7461 7365 742c 2073 7472 5d2c  n[Dataset, str],
-0001c490: 0d0a 2020 2020 2920 2d3e 204e 6f6e 653a  ..    ) -> None:
-0001c4a0: 0d0a 2020 2020 2020 2020 2222 2263 726f  ..        """cro
-0001c4b0: 7041 6c69 676e 6564 466f 6c64 6572 2e0d  pAlignedFolder..
-0001c4c0: 0a0d 0a20 2020 2020 2020 2020 2020 2063  ...            c
-0001c4d0: 726f 7041 6c69 676e 6564 466f 6c64 6572  ropAlignedFolder
-0001c4e0: 206d 6174 6368 6573 2074 6865 206c 6f63   matches the loc
-0001c4f0: 6174 696f 6e20 6f66 206e 6f64 6174 6120  ation of nodata 
-0001c500: 7661 6c75 6520 6672 6f6d 2073 7263 2072  value from src r
-0001c510: 6173 7465 7220 746f 2064 7374 0d0a 2020  aster to dst..  
-0001c520: 2020 2020 2020 2020 2020 7261 7374 6572            raster
-0001c530: 2c20 4d61 736b 2069 7320 7768 6572 6520  , Mask is where 
-0001c540: 7468 6520 4e6f 4461 7461 7661 6c75 6520  the NoDatavalue 
-0001c550: 7769 6c6c 2062 6520 7461 6b65 6e20 616e  will be taken an
-0001c560: 6420 7468 6520 6c6f 6361 7469 6f6e 206f  d the location o
-0001c570: 660d 0a20 2020 2020 2020 2020 2020 2074  f..            t
-0001c580: 6869 7320 7661 6c75 6520 7372 635f 6469  his value src_di
-0001c590: 7220 6973 2070 6174 6820 746f 2074 6865  r is path to the
-0001c5a0: 2066 6f6c 6465 7220 7768 6572 6520 7261   folder where ra
-0001c5b0: 7374 6572 7320 6578 6973 7420 7768 6572  sters exist wher
-0001c5c0: 6520 7765 0d0a 2020 2020 2020 2020 2020  e we..          
-0001c5d0: 2020 6e65 6564 2074 6f20 7075 7420 7468    need to put th
-0001c5e0: 6520 4e6f 4461 7461 5661 6c75 6520 6f66  e NoDataValue of
-0001c5f0: 2074 6865 206d 6173 6b20 696e 2052 6173   the mask in Ras
-0001c600: 7465 7242 2061 7420 7468 6520 7361 6d65  terB at the same
-0001c610: 206c 6f63 6174 696f 6e73 0d0a 0d0a 2020   locations....  
-0001c620: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0001c630: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0001c640: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6d61  ----..        ma
-0001c650: 736b 203a 205b 7374 722f 4461 7461 7365  sk : [str/Datase
-0001c660: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
-0001c670: 7061 7468 2f44 6174 6173 6574 206f 626a  path/Dataset obj
-0001c680: 6563 7420 6f66 2074 6865 206d 6173 6b20  ect of the mask 
-0001c690: 7261 7374 6572 2074 6f20 6372 6f70 2074  raster to crop t
-0001c6a0: 6865 2072 6173 7465 7273 2028 746f 2067  he rasters (to g
-0001c6b0: 6574 2074 6865 204e 6f44 6174 6120 7661  et the NoData va
-0001c6c0: 6c75 650d 0a20 2020 2020 2020 2020 2020  lue..           
-0001c6d0: 2061 6e64 2069 7420 6c6f 6361 7469 6f6e   and it location
-0001c6e0: 2069 6e20 7468 6520 6172 7261 7929 204d   in the array) M
-0001c6f0: 6173 6b20 7368 6f75 6c64 2069 6e63 6c75  ask should inclu
-0001c700: 6465 2074 6865 206e 616d 6520 6f66 2074  de the name of t
-0001c710: 6865 2072 6173 7465 7220 616e 6420 7468  he raster and th
-0001c720: 650d 0a20 2020 2020 2020 2020 2020 2065  e..            e
-0001c730: 7874 656e 7369 6f6e 206c 696b 6520 2264  xtension like "d
-0001c740: 6174 612f 6465 6d2e 7469 6622 2c20 6f72  ata/dem.tif", or
-0001c750: 2079 6f75 2063 616e 2072 6561 6420 7468   you can read th
-0001c760: 6520 6d61 736b 2072 6173 7465 7220 7573  e mask raster us
-0001c770: 696e 6720 6764 616c 2061 6e64 2075 7365  ing gdal and use
-0001c780: 0d0a 2020 2020 2020 2020 2020 2020 6973  ..            is
-0001c790: 2074 6865 2066 6972 7374 2070 6172 616d   the first param
-0001c7a0: 6574 6572 2074 6f20 7468 6520 6675 6e63  eter to the func
-0001c7b0: 7469 6f6e 2e0d 0a0d 0a20 2020 2020 2020  tion.....       
-0001c7c0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0001c7d0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0001c7e0: 2020 206e 6577 2072 6173 7465 7273 2068     new rasters h
-0001c7f0: 6176 6520 7468 6520 7661 6c75 6573 2066  ave the values f
-0001c800: 726f 6d20 7261 7374 6572 7320 696e 2042  rom rasters in B
-0001c810: 5f69 6e70 7574 5f70 6174 6820 7769 7468  _input_path with
-0001c820: 2074 6865 204e 6f44 6174 6156 616c 7565   the NoDataValue
-0001c830: 2069 6e20 7468 6520 7361 6d65 0d0a 2020   in the same..  
-0001c840: 2020 2020 2020 6c6f 6361 7469 6f6e 7320        locations 
-0001c850: 6c69 6b65 2072 6173 7465 7220 412e 0d0a  like raster A...
-0001c860: 0d0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0001c870: 6573 0d0a 2020 2020 2020 2020 2d2d 2d2d  es..        ----
-0001c880: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3e3e  ----..        >>
-0001c890: 3e20 6465 6d5f 7061 7468 203d 2022 6578  > dem_path = "ex
-0001c8a0: 616d 706c 6573 2f47 4953 2f64 6174 612f  amples/GIS/data/
-0001c8b0: 6163 6334 3030 302e 7469 6622 0d0a 2020  acc4000.tif"..  
-0001c8c0: 2020 2020 2020 3e3e 3e20 7372 635f 7061        >>> src_pa
-0001c8d0: 7468 203d 2022 6578 616d 706c 6573 2f47  th = "examples/G
-0001c8e0: 4953 2f64 6174 612f 616c 6967 6e65 645f  IS/data/aligned_
-0001c8f0: 7261 7374 6572 732f 220d 0a20 2020 2020  rasters/"..     
-0001c900: 2020 203e 3e3e 206f 7574 5f70 6174 6820     >>> out_path 
-0001c910: 3d20 2265 7861 6d70 6c65 732f 4749 532f  = "examples/GIS/
-0001c920: 6461 7461 2f63 726f 705f 616c 6967 6e65  data/crop_aligne
-0001c930: 645f 666f 6c64 6572 2f22 0d0a 2020 2020  d_folder/"..    
-0001c940: 2020 2020 3e3e 3e20 4461 7461 6375 6265      >>> Datacube
-0001c950: 2e63 726f 7028 6465 6d5f 7061 7468 2c20  .crop(dem_path, 
-0001c960: 7372 635f 7061 7468 2c20 6f75 745f 7061  src_path, out_pa
-0001c970: 7468 290d 0a20 2020 2020 2020 2022 2222  th)..        """
-0001c980: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-0001c990: 696e 2072 616e 6765 2873 656c 662e 7469  in range(self.ti
-0001c9a0: 6d65 5f6c 656e 6774 6829 3a0d 0a20 2020  me_length):..   
-0001c9b0: 2020 2020 2020 2020 2073 7263 203d 2073           src = s
-0001c9c0: 656c 662e 696c 6f63 2869 290d 0a20 2020  elf.iloc(i)..   
-0001c9d0: 2020 2020 2020 2020 2064 7374 203d 2073           dst = s
-0001c9e0: 7263 2e63 726f 7028 6d61 736b 290d 0a20  rc.crop(mask).. 
-0001c9f0: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
-0001ca00: 2064 7374 2e72 6561 645f 6172 7261 7928   dst.read_array(
-0001ca10: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0001ca20: 6620 6920 3d3d 2030 3a0d 0a20 2020 2020  f i == 0:..     
-0001ca30: 2020 2020 2020 2020 2020 2023 2063 7265             # cre
-0001ca40: 6174 6520 7468 6520 6172 7261 790d 0a20  ate the array.. 
-0001ca50: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0001ca60: 7272 6179 203d 2028 0d0a 2020 2020 2020  rray = (..      
-0001ca70: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-0001ca80: 2e6f 6e65 7328 0d0a 2020 2020 2020 2020  .ones(..        
-0001ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001caa0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0001cab0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001cac0: 656c 662e 7469 6d65 5f6c 656e 6774 682c  elf.time_length,
-0001cad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001cae0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-0001caf0: 722e 7368 6170 655b 305d 2c0d 0a20 2020  r.shape[0],..   
-0001cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb10: 2020 2020 2020 2020 2061 7272 2e73 6861           arr.sha
-0001cb20: 7065 5b31 5d2c 0d0a 2020 2020 2020 2020  pe[1],..        
-0001cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0001cb50: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-0001cb60: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-0001cb70: 6e70 2e6e 616e 0d0a 2020 2020 2020 2020  np.nan..        
-0001cb80: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-0001cb90: 2020 2020 2020 2061 7272 6179 5b69 2c20         array[i, 
-0001cba0: 3a2c 203a 5d20 3d20 6172 720d 0a0d 0a20  :, :] = arr.... 
-0001cbb0: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
-0001cbc0: 6120 3d20 6172 7261 790d 0a20 2020 2020  a = array..     
-0001cbd0: 2020 2023 2075 7365 2074 6865 206c 6173     # use the las
-0001cbe0: 7420 7372 6320 6173 0d0a 2020 2020 2020  t src as..      
-0001cbf0: 2020 7365 6c66 2e5f 6261 7365 203d 2064    self._base = d
-0001cc00: 7374 0d0a 0d0a 2020 2020 2320 2320 544f  st....    # # TO
-0001cc10: 444f 3a20 6d65 7267 6520 5265 7072 6f6a  DO: merge Reproj
-0001cc20: 6563 7444 6174 6173 6574 2061 6e64 2050  ectDataset and P
-0001cc30: 726f 6a65 6374 5261 7374 6572 2074 6865  rojectRaster the
-0001cc40: 7920 6172 6520 616c 6d6f 7374 2074 6865  y are almost the
-0001cc50: 2073 616d 650d 0a20 2020 2023 2023 2054   same..    # # T
-0001cc60: 4f44 4f3a 2073 7469 6c6c 206e 6565 6473  ODO: still needs
-0001cc70: 2074 6f20 6265 2074 6573 7465 640d 0a20   to be tested.. 
-0001cc80: 2020 2023 2040 7374 6174 6963 6d65 7468     # @staticmeth
-0001cc90: 6f64 0d0a 2020 2020 2320 6465 6620 746f  od..    # def to
-0001cca0: 5f65 7073 6728 0d0a 2020 2020 2320 2020  _epsg(..    #   
-0001ccb0: 2020 2020 2020 7372 633a 2067 6461 6c2e        src: gdal.
-0001ccc0: 4461 7461 6375 6265 2c0d 0a20 2020 2023  Datacube,..    #
-0001ccd0: 2020 2020 2020 2020 2074 6f5f 6570 7367           to_epsg
-0001cce0: 3a20 696e 7420 3d20 3338 3537 2c0d 0a20  : int = 3857,.. 
-0001ccf0: 2020 2023 2020 2020 2020 2020 2063 656c     #         cel
-0001cd00: 6c5f 7369 7a65 3a20 696e 7420 3d20 5b5d  l_size: int = []
-0001cd10: 2c0d 0a20 2020 2023 2020 2020 2020 2020  ,..    #        
-0001cd20: 206d 6574 686f 643a 2073 7472 203d 2022   method: str = "
-0001cd30: 4e65 6172 6573 7422 2c0d 0a20 2020 2023  Nearest",..    #
-0001cd40: 0d0a 2020 2020 2320 2920 2d3e 2067 6461  ..    # ) -> gda
-0001cd50: 6c2e 4461 7461 6375 6265 3a0d 0a20 2020  l.Datacube:..   
-0001cd60: 2023 2020 2020 2022 2222 746f 5f65 7073   #     """to_eps
-0001cd70: 672e 0d0a 2020 2020 230d 0a20 2020 2023  g...    #..    #
-0001cd80: 2020 2020 2020 2020 202d 2074 6f5f 6570           - to_ep
-0001cd90: 7367 2072 6570 726f 6a65 6374 7320 616e  sg reprojects an
-0001cda0: 6420 7265 7361 6d70 6c65 7320 6120 666f  d resamples a fo
-0001cdb0: 6c64 6572 206f 6620 7261 7374 6572 7320  lder of rasters 
-0001cdc0: 746f 2061 6e79 2070 726f 6a65 6374 696f  to any projectio
-0001cdd0: 6e0d 0a20 2020 2023 2020 2020 2020 2020  n..    #        
-0001cde0: 2028 6465 6661 756c 7420 7468 6520 5747   (default the WG
-0001cdf0: 5338 3420 7765 6220 6d65 7263 6174 6f72  S84 web mercator
-0001ce00: 2070 726f 6a65 6374 696f 6e2c 2077 6974   projection, wit
-0001ce10: 686f 7574 2072 6573 616d 706c 696e 6729  hout resampling)
-0001ce20: 0d0a 2020 2020 230d 0a20 2020 2023 2020  ..    #..    #  
-0001ce30: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0001ce40: 2020 2023 2020 2020 202d 2d2d 2d2d 2d2d     #     -------
-0001ce50: 2d2d 2d0d 0a20 2020 2023 2020 2020 2073  ---..    #     s
-0001ce60: 7263 3a20 5b67 6461 6c20 6461 7461 7365  rc: [gdal datase
-0001ce70: 745d 0d0a 2020 2020 2320 2020 2020 2020  t]..    #       
-0001ce80: 2020 6764 616c 2064 6174 6173 6574 206f    gdal dataset o
-0001ce90: 626a 6563 7420 2873 7263 3d67 6461 6c2e  bject (src=gdal.
-0001cea0: 4f70 656e 2822 6465 6d2e 7469 6622 2929  Open("dem.tif"))
-0001ceb0: 0d0a 2020 2020 2320 2020 2020 746f 5f65  ..    #     to_e
-0001cec0: 7073 673a 205b 696e 7465 6765 725d 0d0a  psg: [integer]..
-0001ced0: 2020 2020 2320 2020 2020 2020 2020 2072      #          r
-0001cee0: 6566 6572 656e 6365 206e 756d 6265 7220  eference number 
-0001cef0: 746f 2074 6865 206e 6577 2070 726f 6a65  to the new proje
-0001cf00: 6374 696f 6e20 2868 7474 7073 3a2f 2f65  ction (https://e
-0001cf10: 7073 672e 696f 2f29 0d0a 2020 2020 2320  psg.io/)..    # 
-0001cf20: 2020 2020 2020 2020 2864 6566 6175 6c74          (default
-0001cf30: 2033 3835 3720 7468 6520 7265 6665 7265   3857 the refere
-0001cf40: 6e63 6520 6e6f 206f 6620 5747 5338 3420  nce no of WGS84 
-0001cf50: 7765 6220 6d65 7263 6174 6f72 2029 0d0a  web mercator )..
-0001cf60: 2020 2020 2320 2020 2020 6365 6c6c 5f73      #     cell_s
-0001cf70: 697a 653a 205b 696e 7465 6765 725d 0d0a  ize: [integer]..
-0001cf80: 2020 2020 2320 2020 2020 2020 2020 206e      #          n
-0001cf90: 756d 6265 7220 746f 2072 6573 616d 706c  umber to resampl
-0001cfa0: 6520 7468 6520 7261 7374 6572 2063 656c  e the raster cel
-0001cfb0: 6c20 7369 7a65 2074 6f20 6120 6e65 7720  l size to a new 
-0001cfc0: 6365 6c6c 2073 697a 650d 0a20 2020 2023  cell size..    #
-0001cfd0: 2020 2020 2020 2020 2028 6465 6661 756c           (defaul
-0001cfe0: 7420 656d 7074 7920 736f 2072 6173 7465  t empty so raste
-0001cff0: 7220 7769 6c6c 206e 6f74 2062 6520 7265  r will not be re
-0001d000: 7361 6d70 6c65 6429 0d0a 2020 2020 2320  sampled)..    # 
-0001d010: 2020 2020 6d65 7468 6f64 3a20 5b53 7472      method: [Str
-0001d020: 696e 675d 0d0a 2020 2020 2320 2020 2020  ing]..    #     
-0001d030: 2020 2020 7265 7361 6d70 6c69 6e67 2074      resampling t
-0001d040: 6563 686e 6971 7565 2064 6566 6175 6c74  echnique default
-0001d050: 2069 7320 224e 6561 7265 7374 220d 0a20   is "Nearest".. 
-0001d060: 2020 2023 2020 2020 2020 2020 2068 7474     #         htt
-0001d070: 7073 3a2f 2f67 6973 6765 6f67 7261 7068  ps://gisgeograph
-0001d080: 792e 636f 6d2f 7261 7374 6572 2d72 6573  y.com/raster-res
-0001d090: 616d 706c 696e 672f 0d0a 2020 2020 2320  ampling/..    # 
-0001d0a0: 2020 2020 2020 2020 224e 6561 7265 7374          "Nearest
-0001d0b0: 2220 666f 7220 6e65 6172 6573 7420 6e65  " for nearest ne
-0001d0c0: 6967 6862 6f75 722c 2263 7562 6963 2220  ighbour,"cubic" 
-0001d0d0: 666f 7220 6375 6269 6320 636f 6e76 6f6c  for cubic convol
-0001d0e0: 7574 696f 6e2c 0d0a 2020 2020 2320 2020  ution,..    #   
-0001d0f0: 2020 2020 2020 2262 696c 696e 6561 7222        "bilinear"
-0001d100: 2066 6f72 2062 696c 696e 6561 720d 0a20   for bilinear.. 
-0001d110: 2020 2023 0d0a 2020 2020 2320 2020 2020     #..    #     
-0001d120: 5265 7475 726e 730d 0a20 2020 2023 2020  Returns..    #  
-0001d130: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0001d140: 2320 2020 2020 7261 7374 6572 3a20 5b67  #     raster: [g
-0001d150: 6461 6c20 4461 7461 6375 6265 5d0d 0a20  dal Datacube].. 
-0001d160: 2020 2023 2020 2020 2020 2020 2020 6120     #          a 
-0001d170: 4744 414c 2069 6e2d 6d65 6d6f 7279 2066  GDAL in-memory f
-0001d180: 696c 6520 6f62 6a65 6374 2c20 7768 6572  ile object, wher
-0001d190: 6520 796f 7520 6361 6e20 5265 6164 4173  e you can ReadAs
-0001d1a0: 4172 7261 7920 6574 632e 0d0a 2020 2020  Array etc...    
-0001d1b0: 2320 2020 2020 2222 220d 0a20 2020 2023  #     """..    #
-0001d1c0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0001d1d0: 7374 616e 6365 2873 7263 2c20 6764 616c  stance(src, gdal
-0001d1e0: 2e44 6174 6163 7562 6529 3a0d 0a20 2020  .Datacube):..   
-0001d1f0: 2023 2020 2020 2020 2020 2072 6169 7365   #         raise
-0001d200: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
-0001d210: 2023 2020 2020 2020 2020 2020 2020 2022   #             "
-0001d220: 7372 6320 7368 6f75 6c64 2062 6520 7265  src should be re
-0001d230: 6164 2075 7369 6e67 2067 6461 6c20 2867  ad using gdal (g
-0001d240: 6461 6c20 6461 7461 7365 7420 706c 6561  dal dataset plea
-0001d250: 7365 2072 6561 6420 6974 2075 7369 6e67  se read it using
-0001d260: 2067 6461 6c22 0d0a 2020 2020 2320 2020   gdal"..    #   
-0001d270: 2020 2020 2020 2020 2020 6622 206c 6962            f" lib
-0001d280: 7261 7279 2920 6769 7665 6e20 7b74 7970  rary) given {typ
-0001d290: 6528 7372 6329 7d22 0d0a 2020 2020 2320  e(src)}"..    # 
-0001d2a0: 2020 2020 2020 2020 290d 0a20 2020 2023          )..    #
-0001d2b0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0001d2c0: 7374 616e 6365 2874 6f5f 6570 7367 2c20  stance(to_epsg, 
-0001d2d0: 696e 7429 3a0d 0a20 2020 2023 2020 2020  int):..    #    
-0001d2e0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0001d2f0: 7272 6f72 280d 0a20 2020 2023 2020 2020  rror(..    #    
-0001d300: 2020 2020 2020 2020 2022 706c 6561 7365           "please
-0001d310: 2065 6e74 6572 2063 6f72 7265 6374 2069   enter correct i
-0001d320: 6e74 6567 6572 206e 756d 6265 7220 666f  nteger number fo
-0001d330: 7220 746f 5f65 7073 6720 6d6f 7265 2069  r to_epsg more i
-0001d340: 6e66 6f72 6d61 7469 6f6e 2022 0d0a 2020  nformation "..  
-0001d350: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-0001d360: 6622 6874 7470 733a 2f2f 6570 7367 2e69  f"https://epsg.i
-0001d370: 6f2f 2c20 6769 7665 6e20 7b74 7970 6528  o/, given {type(
-0001d380: 746f 5f65 7073 6729 7d22 0d0a 2020 2020  to_epsg)}"..    
-0001d390: 2320 2020 2020 2020 2020 290d 0a20 2020  #         )..   
-0001d3a0: 2023 2020 2020 2069 6620 6e6f 7420 6973   #     if not is
-0001d3b0: 696e 7374 616e 6365 286d 6574 686f 642c  instance(method,
-0001d3c0: 2073 7472 293a 0d0a 2020 2020 2320 2020   str):..    #   
-0001d3d0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0001d3e0: 4572 726f 7228 0d0a 2020 2020 2320 2020  Error(..    #   
-0001d3f0: 2020 2020 2020 2020 2020 2270 6c65 6173            "pleas
-0001d400: 6520 656e 7465 7220 636f 7272 6563 7420  e enter correct 
-0001d410: 6d65 7468 6f64 206d 6f72 6520 696e 666f  method more info
-0001d420: 726d 6174 696f 6e20 7365 6520 2220 2264  rmation see " "d
-0001d430: 6f63 6d65 6e74 6174 696f 6e20 220d 0a20  ocmentation ".. 
-0001d440: 2020 2023 2020 2020 2020 2020 2029 0d0a     #         )..
-0001d450: 2020 2020 230d 0a20 2020 2023 2020 2020      #..    #    
-0001d460: 2069 6620 6365 6c6c 5f73 697a 653a 0d0a   if cell_size:..
-0001d470: 2020 2020 2320 2020 2020 2020 2020 6173      #         as
-0001d480: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-0001d490: 6365 6c6c 5f73 697a 652c 2069 6e74 2920  cell_size, int) 
-0001d4a0: 6f72 2069 7369 6e73 7461 6e63 6528 0d0a  or isinstance(..
-0001d4b0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0001d4c0: 2020 6365 6c6c 5f73 697a 652c 2066 6c6f    cell_size, flo
-0001d4d0: 6174 0d0a 2020 2020 2320 2020 2020 2020  at..    #       
-0001d4e0: 2020 292c 2022 706c 6561 7365 2065 6e74    ), "please ent
-0001d4f0: 6572 2061 6e20 696e 7465 6765 7220 6f72  er an integer or
-0001d500: 2066 6c6f 6174 2063 656c 6c20 7369 7a65   float cell size
-0001d510: 220d 0a20 2020 2023 0d0a 2020 2020 2320  "..    #..    # 
-0001d520: 2020 2020 6966 206d 6574 686f 6420 3d3d      if method ==
-0001d530: 2022 4e65 6172 6573 7422 3a0d 0a20 2020   "Nearest":..   
-0001d540: 2023 2020 2020 2020 2020 206d 6574 686f   #         metho
-0001d550: 6420 3d20 6764 616c 2e47 5241 5f4e 6561  d = gdal.GRA_Nea
-0001d560: 7265 7374 4e65 6967 6862 6f75 720d 0a20  restNeighbour.. 
-0001d570: 2020 2023 2020 2020 2065 6c69 6620 6d65     #     elif me
-0001d580: 7468 6f64 203d 3d20 2263 7562 6963 223a  thod == "cubic":
-0001d590: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001d5a0: 6d65 7468 6f64 203d 2067 6461 6c2e 4752  method = gdal.GR
-0001d5b0: 415f 4375 6269 630d 0a20 2020 2023 2020  A_Cubic..    #  
-0001d5c0: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
-0001d5d0: 3d20 2262 696c 696e 6561 7222 3a0d 0a20  = "bilinear":.. 
-0001d5e0: 2020 2023 2020 2020 2020 2020 206d 6574     #         met
-0001d5f0: 686f 6420 3d20 6764 616c 2e47 5241 5f42  hod = gdal.GRA_B
-0001d600: 696c 696e 6561 720d 0a20 2020 2023 0d0a  ilinear..    #..
-0001d610: 2020 2020 2320 2020 2020 7372 635f 7072      #     src_pr
-0001d620: 6f6a 203d 2073 7263 2e47 6574 5072 6f6a  oj = src.GetProj
-0001d630: 6563 7469 6f6e 2829 0d0a 2020 2020 2320  ection()..    # 
-0001d640: 2020 2020 7372 635f 6774 203d 2073 7263      src_gt = src
-0001d650: 2e47 6574 4765 6f54 7261 6e73 666f 726d  .GetGeoTransform
-0001d660: 2829 0d0a 2020 2020 2320 2020 2020 7372  ()..    #     sr
-0001d670: 635f 7820 3d20 7372 632e 5261 7374 6572  c_x = src.Raster
-0001d680: 5853 697a 650d 0a20 2020 2023 2020 2020  XSize..    #    
-0001d690: 2073 7263 5f79 203d 2073 7263 2e52 6173   src_y = src.Ras
-0001d6a0: 7465 7259 5369 7a65 0d0a 2020 2020 2320  terYSize..    # 
-0001d6b0: 2020 2020 6474 7970 6520 3d20 7372 632e      dtype = src.
-0001d6c0: 4765 7452 6173 7465 7242 616e 6428 3129  GetRasterBand(1)
-0001d6d0: 2e44 6174 6154 7970 650d 0a20 2020 2023  .DataType..    #
-0001d6e0: 2020 2020 2023 2073 7061 7469 616c 2072       # spatial r
-0001d6f0: 6566 0d0a 2020 2020 2320 2020 2020 7372  ef..    #     sr
-0001d700: 635f 7372 203d 206f 7372 2e53 7061 7469  c_sr = osr.Spati
-0001d710: 616c 5265 6665 7265 6e63 6528 776b 743d  alReference(wkt=
-0001d720: 7372 635f 7072 6f6a 290d 0a20 2020 2023  src_proj)..    #
-0001d730: 2020 2020 2073 7263 5f65 7073 6720 3d20       src_epsg = 
-0001d740: 7372 635f 7372 2e47 6574 4174 7472 5661  src_sr.GetAttrVa
-0001d750: 6c75 6528 2241 5554 484f 5249 5459 222c  lue("AUTHORITY",
-0001d760: 2031 290d 0a20 2020 2023 0d0a 2020 2020   1)..    #..    
-0001d770: 2320 2020 2020 2320 6469 7374 696e 6174  #     # distinat
-0001d780: 696f 6e0d 0a20 2020 2023 2020 2020 2023  ion..    #     #
-0001d790: 2073 7061 7469 616c 2072 6566 0d0a 2020   spatial ref..  
-0001d7a0: 2020 2320 2020 2020 6473 745f 6570 7367    #     dst_epsg
-0001d7b0: 203d 206f 7372 2e53 7061 7469 616c 5265   = osr.SpatialRe
-0001d7c0: 6665 7265 6e63 6528 290d 0a20 2020 2023  ference()..    #
-0001d7d0: 2020 2020 2064 7374 5f65 7073 672e 496d       dst_epsg.Im
-0001d7e0: 706f 7274 4672 6f6d 4550 5347 2874 6f5f  portFromEPSG(to_
-0001d7f0: 6570 7367 290d 0a20 2020 2023 2020 2020  epsg)..    #    
-0001d800: 2023 2074 7261 6e73 666f 726d 6174 696f   # transformatio
-0001d810: 6e20 6661 6374 6f72 730d 0a20 2020 2023  n factors..    #
-0001d820: 2020 2020 2074 7820 3d20 6f73 722e 436f       tx = osr.Co
-0001d830: 6f72 6469 6e61 7465 5472 616e 7366 6f72  ordinateTransfor
-0001d840: 6d61 7469 6f6e 2873 7263 5f73 722c 2064  mation(src_sr, d
-0001d850: 7374 5f65 7073 6729 0d0a 2020 2020 230d  st_epsg)..    #.
-0001d860: 0a20 2020 2023 2020 2020 2023 2069 6e63  .    #     # inc
-0001d870: 6173 6520 7468 6520 736f 7572 6365 2063  ase the source c
-0001d880: 7273 2069 7320 4743 5320 616e 6420 6c6f  rs is GCS and lo
-0001d890: 6e67 6974 7564 6520 6973 2069 6e20 7468  ngitude is in th
-0001d8a0: 6520 7765 7374 2068 656d 6973 7068 6572  e west hemispher
-0001d8b0: 6520 6764 616c 0d0a 2020 2020 2320 2020  e gdal..    #   
-0001d8c0: 2020 2320 7265 6164 7320 6c6f 6e67 6974    # reads longit
-0001d8d0: 7564 6520 6672 6f6e 2030 2074 6f20 3336  ude fron 0 to 36
-0001d8e0: 3020 616e 6420 7472 616e 7366 6f72 6d61  0 and transforma
-0001d8f0: 7469 6f6e 2066 6163 746f 7220 776f 6e74  tion factor wont
-0001d900: 2077 6f72 6b20 7769 7468 2076 616c 6575   work with valeu
-0001d910: 730d 0a20 2020 2023 2020 2020 2023 2067  s..    #     # g
-0001d920: 7265 6174 6572 2074 6861 6e20 3138 300d  reater than 180.
-0001d930: 0a20 2020 2023 2020 2020 2069 6620 7372  .    #     if sr
-0001d940: 635f 6570 7367 203d 3d20 2234 3332 3622  c_epsg == "4326"
-0001d950: 2061 6e64 2073 7263 5f67 745b 305d 203e   and src_gt[0] >
-0001d960: 2031 3830 3a0d 0a20 2020 2023 2020 2020   180:..    #    
-0001d970: 2020 2020 206c 6e67 5f6e 6577 203d 2073       lng_new = s
-0001d980: 7263 5f67 745b 305d 202d 2033 3630 0d0a  rc_gt[0] - 360..
-0001d990: 2020 2020 2320 2020 2020 2020 2020 2320      #         # 
-0001d9a0: 7472 616e 7366 6f72 6d20 7468 6520 7269  transform the ri
-0001d9b0: 6768 7420 7570 7065 7220 636f 726e 6572  ght upper corner
-0001d9c0: 2070 6f69 6e74 0d0a 2020 2020 2320 2020   point..    #   
-0001d9d0: 2020 2020 2020 2875 6c78 2c20 756c 792c        (ulx, uly,
-0001d9e0: 2075 6c7a 2920 3d20 7478 2e54 7261 6e73   ulz) = tx.Trans
-0001d9f0: 666f 726d 506f 696e 7428 6c6e 675f 6e65  formPoint(lng_ne
-0001da00: 772c 2073 7263 5f67 745b 335d 290d 0a20  w, src_gt[3]).. 
-0001da10: 2020 2023 2020 2020 2020 2020 2023 2074     #         # t
-0001da20: 7261 6e73 666f 726d 2074 6865 2072 6967  ransform the rig
-0001da30: 6874 206c 6f77 6572 2063 6f72 6e65 7220  ht lower corner 
-0001da40: 706f 696e 740d 0a20 2020 2023 2020 2020  point..    #    
-0001da50: 2020 2020 2028 6c72 782c 206c 7279 2c20       (lrx, lry, 
-0001da60: 6c72 7a29 203d 2074 782e 5472 616e 7366  lrz) = tx.Transf
-0001da70: 6f72 6d50 6f69 6e74 280d 0a20 2020 2023  ormPoint(..    #
-0001da80: 2020 2020 2020 2020 2020 2020 206c 6e67               lng
-0001da90: 5f6e 6577 202b 2073 7263 5f67 745b 315d  _new + src_gt[1]
-0001daa0: 202a 2073 7263 5f78 2c20 7372 635f 6774   * src_x, src_gt
-0001dab0: 5b33 5d20 2b20 7372 635f 6774 5b35 5d20  [3] + src_gt[5] 
-0001dac0: 2a20 7372 635f 790d 0a20 2020 2023 2020  * src_y..    #  
-0001dad0: 2020 2020 2020 2029 0d0a 2020 2020 2320         )..    # 
-0001dae0: 2020 2020 656c 7365 3a0d 0a20 2020 2023      else:..    #
-0001daf0: 2020 2020 2020 2020 2023 2074 7261 6e73           # trans
-0001db00: 666f 726d 2074 6865 2072 6967 6874 2075  form the right u
-0001db10: 7070 6572 2063 6f72 6e65 7220 706f 696e  pper corner poin
-0001db20: 740d 0a20 2020 2023 2020 2020 2020 2020  t..    #        
-0001db30: 2028 756c 782c 2075 6c79 2c20 756c 7a29   (ulx, uly, ulz)
-0001db40: 203d 2074 782e 5472 616e 7366 6f72 6d50   = tx.TransformP
-0001db50: 6f69 6e74 2873 7263 5f67 745b 305d 2c20  oint(src_gt[0], 
-0001db60: 7372 635f 6774 5b33 5d29 0d0a 2020 2020  src_gt[3])..    
-0001db70: 2320 2020 2020 2020 2020 2320 7472 616e  #         # tran
-0001db80: 7366 6f72 6d20 7468 6520 7269 6768 7420  sform the right 
-0001db90: 6c6f 7765 7220 636f 726e 6572 2070 6f69  lower corner poi
-0001dba0: 6e74 0d0a 2020 2020 2320 2020 2020 2020  nt..    #       
-0001dbb0: 2020 286c 7278 2c20 6c72 792c 206c 727a    (lrx, lry, lrz
-0001dbc0: 2920 3d20 7478 2e54 7261 6e73 666f 726d  ) = tx.Transform
-0001dbd0: 506f 696e 7428 0d0a 2020 2020 2320 2020  Point(..    #   
-0001dbe0: 2020 2020 2020 2020 2020 7372 635f 6774            src_gt
-0001dbf0: 5b30 5d20 2b20 7372 635f 6774 5b31 5d20  [0] + src_gt[1] 
-0001dc00: 2a20 7372 635f 782c 2073 7263 5f67 745b  * src_x, src_gt[
-0001dc10: 335d 202b 2073 7263 5f67 745b 355d 202a  3] + src_gt[5] *
-0001dc20: 2073 7263 5f79 0d0a 2020 2020 2320 2020   src_y..    #   
-0001dc30: 2020 2020 2020 290d 0a20 2020 2023 0d0a        )..    #..
-0001dc40: 2020 2020 2320 2020 2020 6966 206e 6f74      #     if not
-0001dc50: 2063 656c 6c5f 7369 7a65 3a0d 0a20 2020   cell_size:..   
-0001dc60: 2023 2020 2020 2020 2020 2023 2074 6865   #         # the
-0001dc70: 2072 6573 756c 7420 7261 7374 6572 2068   result raster h
-0001dc80: 6173 2074 6865 2073 616d 6520 7069 7863  as the same pixc
-0001dc90: 656c 2073 697a 6520 6173 2074 6865 2073  el size as the s
-0001dca0: 6f75 7263 650d 0a20 2020 2023 2020 2020  ource..    #    
-0001dcb0: 2020 2020 2023 2063 6865 636b 2069 6620       # check if 
-0001dcc0: 7468 6520 636f 6f72 6469 6e61 7465 2073  the coordinate s
-0001dcd0: 7973 7465 6d20 6973 2047 4353 2063 6f6e  ystem is GCS con
-0001dce0: 7665 7274 2074 6865 2064 6973 7461 6e63  vert the distanc
-0001dcf0: 6520 6672 6f6d 2061 6e67 756c 6172 2074  e from angular t
-0001dd00: 6f20 6d65 7472 6963 0d0a 2020 2020 2320  o metric..    # 
-0001dd10: 2020 2020 2020 2020 6966 2073 7263 5f65          if src_e
-0001dd20: 7073 6720 3d3d 2022 3433 3236 223a 0d0a  psg == "4326":..
-0001dd30: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0001dd40: 2020 636f 6f72 6473 5f31 203d 2028 7372    coords_1 = (sr
-0001dd50: 635f 6774 5b33 5d2c 2073 7263 5f67 745b  c_gt[3], src_gt[
-0001dd60: 305d 290d 0a20 2020 2023 2020 2020 2020  0])..    #      
-0001dd70: 2020 2020 2020 2063 6f6f 7264 735f 3220         coords_2 
-0001dd80: 3d20 2873 7263 5f67 745b 335d 2c20 7372  = (src_gt[3], sr
-0001dd90: 635f 6774 5b30 5d20 2b20 7372 635f 6774  c_gt[0] + src_gt
-0001dda0: 5b31 5d29 0d0a 2020 2020 2320 2020 2020  [1])..    #     
-0001ddb0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-0001ddc0: 2020 2020 2070 6978 656c 5f73 7061 6369       pixel_spaci
-0001ddd0: 6e67 3d67 656f 7079 2e64 6973 7461 6e63  ng=geopy.distanc
-0001dde0: 652e 7669 6e63 656e 7479 2863 6f6f 7264  e.vincenty(coord
-0001ddf0: 735f 312c 2063 6f6f 7264 735f 3229 2e6d  s_1, coords_2).m
-0001de00: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001de10: 2020 2020 7069 7865 6c5f 7370 6163 696e      pixel_spacin
-0001de20: 6720 3d20 4665 6174 7572 6543 6f6c 6c65  g = FeatureColle
-0001de30: 6374 696f 6e2e 4743 5344 6973 7461 6e63  ction.GCSDistanc
-0001de40: 6528 636f 6f72 6473 5f31 2c20 636f 6f72  e(coords_1, coor
-0001de50: 6473 5f32 290d 0a20 2020 2023 2020 2020  ds_2)..    #    
-0001de60: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0001de70: 2320 2020 2020 2020 2020 2020 2020 7069  #             pi
-0001de80: 7865 6c5f 7370 6163 696e 6720 3d20 7372  xel_spacing = sr
-0001de90: 635f 6774 5b31 5d0d 0a20 2020 2023 2020  c_gt[1]..    #  
-0001dea0: 2020 2065 6c73 653a 0d0a 2020 2020 2320     else:..    # 
-0001deb0: 2020 2020 2020 2020 2320 6966 2073 7263          # if src
-0001dec0: 5f65 7073 672e 4765 7441 7474 7256 616c  _epsg.GetAttrVal
-0001ded0: 7565 2827 4155 5448 4f52 4954 5927 2c20  ue('AUTHORITY', 
-0001dee0: 3129 2021 3d20 2234 3332 3622 3a0d 0a20  1) != "4326":.. 
-0001def0: 2020 2023 2020 2020 2020 2020 2023 2020     #         #  
-0001df00: 2020 2061 7373 6572 7420 2863 656c 6c5f     assert (cell_
-0001df10: 7369 7a65 203e 2031 292c 2022 706c 6561  size > 1), "plea
-0001df20: 7365 2065 6e74 6572 2063 656c 6c20 7369  se enter cell si
-0001df30: 7a65 2067 7265 6174 6572 2074 6861 6e20  ze greater than 
-0001df40: 3122 0d0a 2020 2020 2320 2020 2020 2020  1"..    #       
-0001df50: 2020 2320 6966 2074 6865 2075 7365 7220    # if the user 
-0001df60: 696e 7075 7420 6120 6365 6c6c 2073 697a  input a cell siz
-0001df70: 6520 7265 7361 6d70 6c65 2074 6865 2072  e resample the r
-0001df80: 6173 7465 720d 0a20 2020 2023 2020 2020  aster..    #    
-0001df90: 2020 2020 2070 6978 656c 5f73 7061 6369       pixel_spaci
-0001dfa0: 6e67 203d 2063 656c 6c5f 7369 7a65 0d0a  ng = cell_size..
-0001dfb0: 2020 2020 230d 0a20 2020 2023 2020 2020      #..    #    
-0001dfc0: 2023 2063 7265 6174 6520 6120 6e65 7720   # create a new 
-0001dfd0: 7261 7374 6572 0d0a 2020 2020 2320 2020  raster..    #   
-0001dfe0: 2020 636f 6c73 203d 2069 6e74 286e 702e    cols = int(np.
-0001dff0: 726f 756e 6428 6162 7328 6c72 7820 2d20  round(abs(lrx - 
-0001e000: 756c 7829 202f 2070 6978 656c 5f73 7061  ulx) / pixel_spa
-0001e010: 6369 6e67 2929 0d0a 2020 2020 2320 2020  cing))..    #   
-0001e020: 2020 726f 7773 203d 2069 6e74 286e 702e    rows = int(np.
-0001e030: 726f 756e 6428 6162 7328 756c 7920 2d20  round(abs(uly - 
-0001e040: 6c72 7929 202f 2070 6978 656c 5f73 7061  lry) / pixel_spa
-0001e050: 6369 6e67 2929 0d0a 2020 2020 2320 2020  cing))..    #   
-0001e060: 2020 6473 7420 3d20 4461 7461 7365 742e    dst = Dataset.
-0001e070: 5f63 7265 6174 655f 6461 7461 7365 7428  _create_dataset(
-0001e080: 636f 6c73 2c20 726f 7773 2c20 312c 2064  cols, rows, 1, d
-0001e090: 7479 7065 2c20 6472 6976 6572 3d22 4d45  type, driver="ME
-0001e0a0: 4d22 290d 0a20 2020 2023 0d0a 2020 2020  M")..    #..    
-0001e0b0: 2320 2020 2020 2320 6e65 7720 6765 6f74  #     # new geot
-0001e0c0: 7261 6e73 666f 726d 0d0a 2020 2020 2320  ransform..    # 
-0001e0d0: 2020 2020 6e65 775f 6765 6f20 3d20 2875      new_geo = (u
-0001e0e0: 6c78 2c20 7069 7865 6c5f 7370 6163 696e  lx, pixel_spacin
-0001e0f0: 672c 2073 7263 5f67 745b 325d 2c20 756c  g, src_gt[2], ul
-0001e100: 792c 2073 7263 5f67 745b 345d 2c20 2d70  y, src_gt[4], -p
-0001e110: 6978 656c 5f73 7061 6369 6e67 290d 0a20  ixel_spacing).. 
-0001e120: 2020 2023 2020 2020 2023 2073 6574 2074     #     # set t
-0001e130: 6865 2067 656f 7472 616e 7366 6f72 6d0d  he geotransform.
-0001e140: 0a20 2020 2023 2020 2020 2064 7374 2e53  .    #     dst.S
-0001e150: 6574 4765 6f54 7261 6e73 666f 726d 286e  etGeoTransform(n
-0001e160: 6577 5f67 656f 290d 0a20 2020 2023 2020  ew_geo)..    #  
-0001e170: 2020 2023 2073 6574 2074 6865 2070 726f     # set the pro
-0001e180: 6a65 6374 696f 6e0d 0a20 2020 2023 2020  jection..    #  
-0001e190: 2020 2064 7374 2e53 6574 5072 6f6a 6563     dst.SetProjec
-0001e1a0: 7469 6f6e 2864 7374 5f65 7073 672e 4578  tion(dst_epsg.Ex
-0001e1b0: 706f 7274 546f 576b 7428 2929 0d0a 2020  portToWkt())..  
-0001e1c0: 2020 2320 2020 2020 2320 7365 7420 7468    #     # set th
-0001e1d0: 6520 6e6f 2064 6174 6120 7661 6c75 650d  e no data value.
-0001e1e0: 0a20 2020 2023 2020 2020 206e 6f5f 6461  .    #     no_da
-0001e1f0: 7461 5f76 616c 7565 203d 2073 7263 2e47  ta_value = src.G
-0001e200: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
-0001e210: 4765 744e 6f44 6174 6156 616c 7565 2829  GetNoDataValue()
-0001e220: 0d0a 2020 2020 2320 2020 2020 6473 7420  ..    #     dst 
-0001e230: 3d20 4461 7461 7365 742e 5f73 6574 5f6e  = Dataset._set_n
-0001e240: 6f5f 6461 7461 5f76 616c 7565 2864 7374  o_data_value(dst
-0001e250: 2c20 6e6f 5f64 6174 615f 7661 6c75 6529  , no_data_value)
-0001e260: 0d0a 2020 2020 2320 2020 2020 2320 7065  ..    #     # pe
-0001e270: 7266 6f72 6d20 7468 6520 7072 6f6a 6563  rform the projec
-0001e280: 7469 6f6e 2026 2072 6573 616d 706c 696e  tion & resamplin
-0001e290: 670d 0a20 2020 2023 2020 2020 2067 6461  g..    #     gda
-0001e2a0: 6c2e 5265 7072 6f6a 6563 7449 6d61 6765  l.ReprojectImage
-0001e2b0: 280d 0a20 2020 2023 2020 2020 2020 2020  (..    #        
-0001e2c0: 2073 7263 2c20 6473 742c 2073 7263 5f73   src, dst, src_s
-0001e2d0: 722e 4578 706f 7274 546f 576b 7428 292c  r.ExportToWkt(),
-0001e2e0: 2064 7374 5f65 7073 672e 4578 706f 7274   dst_epsg.Export
-0001e2f0: 546f 576b 7428 292c 206d 6574 686f 640d  ToWkt(), method.
-0001e300: 0a20 2020 2023 2020 2020 2029 0d0a 2020  .    #     )..  
-0001e310: 2020 230d 0a20 2020 2023 2020 2020 2072    #..    #     r
-0001e320: 6574 7572 6e20 6473 740d 0a0d 0a20 2020  eturn dst....   
-0001e330: 2064 6566 2061 6c69 676e 2873 656c 662c   def align(self,
-0001e340: 2061 6c69 676e 6d65 6e74 5f73 7263 3a20   alignment_src: 
-0001e350: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
-0001e360: 2020 2022 2222 6d61 7463 6844 6174 6141     """matchDataA
-0001e370: 6c69 676e 6d65 6e74 2e0d 0a0d 0a20 2020  lignment.....   
-0001e380: 2020 2020 2074 6869 7320 6675 6e63 7469       this functi
-0001e390: 6f6e 206d 6174 6368 6573 2074 6865 2063  on matches the c
-0001e3a0: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-0001e3b0: 2061 6e64 2074 6865 206e 756d 6265 7220   and the number 
-0001e3c0: 6f66 206f 6620 726f 7773 2026 2063 6f6c  of of rows & col
-0001e3d0: 756d 6e73 0d0a 2020 2020 2020 2020 6265  umns..        be
-0001e3e0: 7477 6565 6e20 7477 6f20 7261 7374 6572  tween two raster
-0001e3f0: 730d 0a20 2020 2020 2020 2052 6173 7465  s..        Raste
-0001e400: 7220 4120 6973 2074 6865 2073 6f75 7263  r A is the sourc
-0001e410: 6520 6f66 2074 6865 2063 6f6f 7264 696e  e of the coordin
-0001e420: 6174 6520 7379 7374 656d 2c20 6e6f 206f  ate system, no o
-0001e430: 6620 726f 7773 2061 6e64 206e 6f20 6f66  f rows and no of
-0001e440: 2063 6f6c 756d 6e73 2026 2063 656c 6c20   columns & cell 
-0001e450: 7369 7a65 0d0a 2020 2020 2020 2020 7261  size..        ra
-0001e460: 7374 6572 735f 6469 7220 6973 2070 6174  sters_dir is pat
-0001e470: 6820 746f 2074 6865 2066 6f6c 6465 7220  h to the folder 
-0001e480: 7768 6572 6520 5261 7374 6572 2042 2065  where Raster B e
-0001e490: 7869 7374 2077 6865 7265 2020 5261 7374  xist where  Rast
-0001e4a0: 6572 2042 2069 730d 0a20 2020 2020 2020  er B is..       
-0001e4b0: 2074 6865 2073 6f75 7263 6520 6f66 2064   the source of d
-0001e4c0: 6174 6120 7661 6c75 6573 2069 6e20 6365  ata values in ce
-0001e4d0: 6c6c 730d 0a20 2020 2020 2020 2074 6865  lls..        the
-0001e4e0: 2072 6573 756c 7420 7769 6c6c 2062 6520   result will be 
-0001e4f0: 6120 7261 7374 6572 2077 6974 6820 7468  a raster with th
-0001e500: 6520 7361 6d65 2073 7472 7563 7475 7265  e same structure
-0001e510: 206c 696b 6520 5261 7374 6572 4120 6275   like RasterA bu
-0001e520: 7420 7769 7468 0d0a 2020 2020 2020 2020  t with..        
-0001e530: 7661 6c75 6573 2066 726f 6d20 5261 7374  values from Rast
-0001e540: 6572 4220 7573 696e 6720 4e65 6172 6573  erB using Neares
-0001e550: 7420 4e65 6967 6862 6f75 7220 696e 7465  t Neighbour inte
-0001e560: 7270 6f6c 6174 696f 6e20 616c 676f 7269  rpolation algori
-0001e570: 7468 6d0d 0a0d 0a20 2020 2020 2020 2050  thm....        P
-0001e580: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0001e590: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001e5a0: 2020 2020 2020 2061 6c69 676e 6d65 6e74         alignment
-0001e5b0: 5f73 7263 3a20 5b53 7472 696e 675d 0d0a  _src: [String]..
-0001e5c0: 2020 2020 2020 2020 2020 2020 7061 7468              path
-0001e5d0: 2074 6f20 7468 6520 7370 6174 6961 6c20   to the spatial 
-0001e5e0: 696e 666f 726d 6174 696f 6e20 736f 7572  information sour
-0001e5f0: 6365 2072 6173 7465 7220 746f 2067 6574  ce raster to get
-0001e600: 2074 6865 2073 7061 7469 616c 2069 6e66   the spatial inf
-0001e610: 6f72 6d61 7469 6f6e 0d0a 2020 2020 2020  ormation..      
-0001e620: 2020 2020 2020 2863 6f6f 7264 696e 6174        (coordinat
-0001e630: 6520 7379 7374 656d 2c20 6e6f 206f 6620  e system, no of 
-0001e640: 726f 7773 2026 2063 6f6c 756d 6e73 2920  rows & columns) 
-0001e650: 616c 6967 6e6d 656e 745f 7372 6320 7368  alignment_src sh
-0001e660: 6f75 6c64 2069 6e63 6c75 6465 2074 6865  ould include the
-0001e670: 206e 616d 6520 6f66 2074 6865 2072 6173   name of the ras
-0001e680: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
-0001e690: 2061 6e64 2074 6865 2065 7874 656e 7369   and the extensi
-0001e6a0: 6f6e 206c 696b 6520 2264 6174 612f 6465  on like "data/de
-0001e6b0: 6d2e 7469 6622 0d0a 0d0a 2020 2020 2020  m.tif"....      
-0001e6c0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-0001e6d0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0001e6e0: 2020 2020 6e65 7720 7261 7374 6572 733a      new rasters:
-0001e6f0: 0d0a 2020 2020 2020 2020 2020 2020 d98c  ..            ..
-0001e700: 5261 7374 6572 7320 6861 7665 2074 6865  Rasters have the
-0001e710: 2076 616c 7565 7320 6672 6f6d 2072 6173   values from ras
-0001e720: 7465 7273 2069 6e20 7261 7374 6572 735f  ters in rasters_
-0001e730: 6469 7220 7769 7468 2074 6865 2073 616d  dir with the sam
-0001e740: 650d 0a20 2020 2020 2020 2020 2020 2063  e..            c
-0001e750: 656c 6c20 7369 7a65 2c20 6e6f 206f 6620  ell size, no of 
-0001e760: 726f 7773 2026 2063 6f6c 756d 6e73 2c20  rows & columns, 
-0001e770: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
-0001e780: 6d20 616e 6420 616c 6967 6e6d 656e 7420  m and alignment 
-0001e790: 6c69 6b65 2072 6173 7465 7220 410d 0a0d  like raster A...
-0001e7a0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-0001e7b0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0001e7c0: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
-0001e7d0: 2064 656d 5f70 6174 6820 3d20 2230 3147   dem_path = "01G
-0001e7e0: 4953 2f69 6e70 7574 732f 3430 3030 2f61  IS/inputs/4000/a
-0001e7f0: 6363 3430 3030 2e74 6966 220d 0a20 2020  cc4000.tif"..   
-0001e800: 2020 2020 203e 3e3e 2070 7265 635f 696e       >>> prec_in
-0001e810: 5f70 6174 6820 3d20 2230 3250 7265 6369  _path = "02Preci
-0001e820: 7069 7461 7469 6f6e 2f43 4849 5250 532f  pitation/CHIRPS/
-0001e830: 4461 696c 792f 220d 0a20 2020 2020 2020  Daily/"..       
-0001e840: 203e 3e3e 2070 7265 635f 6f75 745f 7061   >>> prec_out_pa
-0001e850: 7468 203d 2022 3032 5072 6563 6970 6974  th = "02Precipit
-0001e860: 6174 696f 6e2f 346b 6d2f 220d 0a20 2020  ation/4km/"..   
-0001e870: 2020 2020 203e 3e3e 2044 6174 6173 6574       >>> Dataset
-0001e880: 2e61 6c69 676e 2864 656d 5f70 6174 682c  .align(dem_path,
-0001e890: 7072 6563 5f69 6e5f 7061 7468 2c70 7265  prec_in_path,pre
-0001e8a0: 635f 6f75 745f 7061 7468 290d 0a20 2020  c_out_path)..   
-0001e8b0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0001e8c0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0001e8d0: 6e63 6528 616c 6967 6e6d 656e 745f 7372  nce(alignment_sr
-0001e8e0: 632c 2044 6174 6173 6574 293a 0d0a 2020  c, Dataset):..  
-0001e8f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001e900: 5479 7065 4572 726f 7228 2261 6c69 676e  TypeError("align
-0001e910: 6d65 6e74 5f73 7263 2069 6e70 7574 2073  ment_src input s
-0001e920: 686f 756c 6420 6265 2061 2044 6174 6173  hould be a Datas
-0001e930: 6574 206f 626a 6563 7422 290d 0a0d 0a20  et object").... 
-0001e940: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0001e950: 7261 6e67 6528 7365 6c66 2e74 696d 655f  range(self.time_
-0001e960: 6c65 6e67 7468 293a 0d0a 2020 2020 2020  length):..      
-0001e970: 2020 2020 2020 7372 6320 3d20 7365 6c66        src = self
-0001e980: 2e69 6c6f 6328 6929 0d0a 2020 2020 2020  .iloc(i)..      
-0001e990: 2020 2020 2020 6473 7420 3d20 7372 632e        dst = src.
-0001e9a0: 616c 6967 6e28 616c 6967 6e6d 656e 745f  align(alignment_
-0001e9b0: 7372 6329 0d0a 2020 2020 2020 2020 2020  src)..          
-0001e9c0: 2020 6172 7220 3d20 6473 742e 7265 6164    arr = dst.read
-0001e9d0: 5f61 7272 6179 2829 0d0a 2020 2020 2020  _array()..      
-0001e9e0: 2020 2020 2020 6966 2069 203d 3d20 303a        if i == 0:
-0001e9f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ea00: 2020 2320 6372 6561 7465 2074 6865 2061    # create the a
-0001ea10: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
-0001ea20: 2020 2020 2020 6172 7261 7920 3d20 280d        array = (.
-0001ea30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ea40: 2020 2020 206e 702e 6f6e 6573 280d 0a20       np.ones(.. 
-0001ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea60: 2020 2020 2020 2028 0d0a 2020 2020 2020         (..      
-0001ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea80: 2020 2020 2020 7365 6c66 2e74 696d 655f        self.time_
-0001ea90: 6c65 6e67 7468 2c0d 0a20 2020 2020 2020  length,..       
-0001eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eab0: 2020 2020 2061 7272 2e73 6861 7065 5b30       arr.shape[0
-0001eac0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0001ead0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eae0: 6172 722e 7368 6170 655b 315d 2c0d 0a20  arr.shape[1],.. 
-0001eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eb00: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-0001eb10: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0001eb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eb30: 2020 2020 202a 206e 702e 6e61 6e0d 0a20       * np.nan.. 
-0001eb40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001eb50: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-0001eb60: 7261 795b 692c 203a 2c20 3a5d 203d 2061  ray[i, :, :] = a
-0001eb70: 7272 0d0a 0d0a 2020 2020 2020 2020 7365  rr....        se
-0001eb80: 6c66 2e5f 6461 7461 203d 2061 7272 6179  lf._data = array
-0001eb90: 0d0a 2020 2020 2020 2020 2320 7573 6520  ..        # use 
-0001eba0: 7468 6520 6c61 7374 2073 7263 2061 730d  the last src as.
-0001ebb0: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
-0001ebc0: 6173 6520 3d20 6473 740d 0a0d 0a20 2020  ase = dst....   
-0001ebd0: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-0001ebe0: 2020 2020 6465 6620 6d65 7267 6528 0d0a      def merge(..
-0001ebf0: 2020 2020 2020 2020 7372 633a 204c 6973          src: Lis
-0001ec00: 745b 7374 725d 2c0d 0a20 2020 2020 2020  t[str],..       
-0001ec10: 2064 7374 3a20 7374 722c 0d0a 2020 2020   dst: str,..    
-0001ec20: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-0001ec30: 653a 2055 6e69 6f6e 5b66 6c6f 6174 2c20  e: Union[float, 
-0001ec40: 696e 742c 2073 7472 5d20 3d20 2230 222c  int, str] = "0",
-0001ec50: 0d0a 2020 2020 2020 2020 696e 6974 3a20  ..        init: 
-0001ec60: 556e 696f 6e5b 666c 6f61 742c 2069 6e74  Union[float, int
-0001ec70: 2c20 7374 725d 203d 2022 6e61 6e22 2c0d  , str] = "nan",.
-0001ec80: 0a20 2020 2020 2020 206e 3a20 556e 696f  .        n: Unio
-0001ec90: 6e5b 666c 6f61 742c 2069 6e74 2c20 7374  n[float, int, st
-0001eca0: 725d 203d 2022 6e61 6e22 2c0d 0a20 2020  r] = "nan",..   
-0001ecb0: 2029 3a0d 0a20 2020 2020 2020 2022 2222   ):..        """
-0001ecc0: 6d65 7267 652e 0d0a 0d0a 2020 2020 2020  merge.....      
-0001ecd0: 2020 2020 2020 6d65 7267 6573 2067 726f        merges gro
-0001ece0: 7570 206f 6620 7261 7374 6572 7320 696e  up of rasters in
-0001ecf0: 746f 206f 6e65 2072 6173 7465 720d 0a0d  to one raster...
-0001ed00: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0001ed10: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0001ed20: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0001ed30: 2073 7263 3a20 4c69 7374 5b73 7472 5d0d   src: List[str].
-0001ed40: 0a20 2020 2020 2020 2020 2020 206c 6973  .            lis
-0001ed50: 7420 6f66 2074 6865 2070 6174 6820 746f  t of the path to
-0001ed60: 2061 6c6c 2069 6e70 7574 2072 6173 7465   all input raste
-0001ed70: 720d 0a20 2020 2020 2020 2064 7374 3a20  r..        dst: 
-0001ed80: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
-0001ed90: 2020 2070 6174 6820 746f 2074 6865 206f     path to the o
-0001eda0: 7574 7075 7420 7261 7374 6572 0d0a 2020  utput raster..  
-0001edb0: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
-0001edc0: 6c75 653a 205b 666c 6f61 742f 696e 745d  lue: [float/int]
-0001edd0: 0d0a 2020 2020 2020 2020 2020 2020 4173  ..            As
-0001ede0: 7369 676e 2061 2073 7065 6369 6669 6564  sign a specified
-0001edf0: 206e 6f64 6174 6120 7661 6c75 6520 746f   nodata value to
-0001ee00: 206f 7574 7075 7420 6261 6e64 732e 0d0a   output bands...
-0001ee10: 2020 2020 2020 2020 696e 6974 3a20 5b66          init: [f
-0001ee20: 6c6f 6174 2f69 6e74 5d0d 0a20 2020 2020  loat/int]..     
-0001ee30: 2020 2020 2020 2050 7265 2d69 6e69 7469         Pre-initi
-0001ee40: 616c 697a 6520 7468 6520 6f75 7470 7574  alize the output
-0001ee50: 2069 6d61 6765 2062 616e 6473 2077 6974   image bands wit
-0001ee60: 6820 7468 6573 6520 7661 6c75 6573 2e20  h these values. 
-0001ee70: 486f 7765 7665 722c 2069 7420 6973 206e  However, it is n
-0001ee80: 6f74 206d 6172 6b65 6420 6173 2074 6865  ot marked as the
-0001ee90: 206e 6f64 6174 6120 7661 6c75 650d 0a20   nodata value.. 
-0001eea0: 2020 2020 2020 2020 2020 2069 6e20 7468             in th
-0001eeb0: 6520 6f75 7470 7574 2066 696c 652e 2049  e output file. I
-0001eec0: 6620 6f6e 6c79 206f 6e65 2076 616c 7565  f only one value
-0001eed0: 2069 7320 6769 7665 6e2c 2074 6865 2073   is given, the s
-0001eee0: 616d 6520 7661 6c75 6520 6973 2075 7365  ame value is use
-0001eef0: 6420 696e 2061 6c6c 2074 6865 2062 616e  d in all the ban
-0001ef00: 6473 2e0d 0a20 2020 2020 2020 206e 3a20  ds...        n: 
-0001ef10: 5b66 6c6f 6174 2f69 6e74 5d0d 0a20 2020  [float/int]..   
-0001ef20: 2020 2020 2020 2020 2049 676e 6f72 6520           Ignore 
-0001ef30: 7069 7865 6c73 2066 726f 6d20 6669 6c65  pixels from file
-0001ef40: 7320 6265 696e 6720 6d65 7267 6564 2069  s being merged i
-0001ef50: 6e20 7769 7468 2074 6869 7320 7069 7865  n with this pixe
-0001ef60: 6c20 7661 6c75 652e 0d0a 0d0a 2020 2020  l value.....    
-0001ef70: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-0001ef80: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-0001ef90: 2020 2020 2020 4e6f 6e65 0d0a 2020 2020        None..    
-0001efa0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-0001efb0: 2023 2072 756e 2074 6865 2063 6f6d 6d61   # run the comma
-0001efc0: 6e64 0d0a 2020 2020 2020 2020 2320 636d  nd..        # cm
-0001efd0: 6420 3d20 2267 6461 6c5f 6d65 7267 652e  d = "gdal_merge.
-0001efe0: 7079 202d 6f20 6d65 7267 6564 5f69 6d61  py -o merged_ima
-0001eff0: 6765 5f31 2e74 6966 220d 0a20 2020 2020  ge_1.tif"..     
-0001f000: 2020 2023 2073 7562 7072 6f63 6573 732e     # subprocess.
-0001f010: 6361 6c6c 2863 6d64 2e73 706c 6974 2829  call(cmd.split()
-0001f020: 202b 2066 696c 655f 6c69 7374 290d 0a20   + file_list).. 
-0001f030: 2020 2020 2020 2023 2076 7274 203d 2067         # vrt = g
-0001f040: 6461 6c2e 4275 696c 6456 5254 2822 6d65  dal.BuildVRT("me
-0001f050: 7267 6564 2e76 7274 222c 2066 696c 655f  rged.vrt", file_
-0001f060: 6c69 7374 290d 0a20 2020 2020 2020 2023  list)..        #
-0001f070: 2073 7263 203d 2067 6461 6c2e 5472 616e   src = gdal.Tran
-0001f080: 736c 6174 6528 226d 6572 6765 645f 696d  slate("merged_im
-0001f090: 6167 652e 7469 6622 2c20 7672 7429 0d0a  age.tif", vrt)..
-0001f0a0: 0d0a 2020 2020 2020 2020 7061 7261 6d65  ..        parame
-0001f0b0: 7465 7273 203d 2028 0d0a 2020 2020 2020  ters = (..      
-0001f0c0: 2020 2020 2020 5b22 222c 2022 2d6f 222c        ["", "-o",
-0001f0d0: 2064 7374 5d0d 0a20 2020 2020 2020 2020   dst]..         
-0001f0e0: 2020 202b 2073 7263 0d0a 2020 2020 2020     + src..      
-0001f0f0: 2020 2020 2020 2b20 5b0d 0a20 2020 2020        + [..     
-0001f100: 2020 2020 2020 2020 2020 2022 2d63 6f22             "-co"
-0001f110: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001f120: 2020 2022 434f 4d50 5245 5353 3d4c 5a57     "COMPRESS=LZW
-0001f130: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
-0001f140: 2020 2020 222d 696e 6974 222c 0d0a 2020      "-init",..  
-0001f150: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0001f160: 7228 696e 6974 292c 0d0a 2020 2020 2020  r(init),..      
-0001f170: 2020 2020 2020 2020 2020 222d 615f 6e6f            "-a_no
-0001f180: 6461 7461 222c 0d0a 2020 2020 2020 2020  data",..        
-0001f190: 2020 2020 2020 2020 7374 7228 6e6f 5f64          str(no_d
-0001f1a0: 6174 615f 7661 6c75 6529 2c0d 0a20 2020  ata_value),..   
-0001f1b0: 2020 2020 2020 2020 2020 2020 2022 2d6e               "-n
-0001f1c0: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
-0001f1d0: 2020 2020 7374 7228 6e29 2c0d 0a20 2020      str(n),..   
-0001f1e0: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
-0001f1f0: 2020 2020 2920 2023 2027 2d73 6570 6172      )  # '-separ
-0001f200: 6174 6527 0d0a 2020 2020 2020 2020 6764  ate'..        gd
-0001f210: 616c 5f6d 6572 6765 2e6d 6169 6e28 7061  al_merge.main(pa
-0001f220: 7261 6d65 7465 7273 290d 0a0d 0a20 2020  rameters)....   
-0001f230: 2064 6566 2061 7070 6c79 2873 656c 662c   def apply(self,
-0001f240: 2075 6675 6e63 3a20 4361 6c6c 6162 6c65   ufunc: Callable
-0001f250: 293a 0d0a 2020 2020 2020 2020 2222 2266  ):..        """f
-0001f260: 6f6c 6465 7243 616c 6375 6c61 746f 722e  olderCalculator.
-0001f270: 0d0a 0d0a 2020 2020 2020 2020 7468 6973  ....        this
-0001f280: 2066 756e 6374 696f 6e20 6d61 7463 6865   function matche
-0001f290: 7320 7468 6520 6c6f 6361 7469 6f6e 206f  s the location o
-0001f2a0: 6620 6e6f 6461 7461 2076 616c 7565 2066  f nodata value f
-0001f2b0: 726f 6d20 7372 6320 7261 7374 6572 2074  rom src raster t
-0001f2c0: 6f20 6473 740d 0a20 2020 2020 2020 2072  o dst..        r
-0001f2d0: 6173 7465 720d 0a20 2020 2020 2020 2044  aster..        D
-0001f2e0: 6174 6173 6574 2041 2069 7320 7768 6572  ataset A is wher
-0001f2f0: 6520 7468 6520 4e6f 4461 7461 7661 6c75  e the NoDatavalu
-0001f300: 6520 7769 6c6c 2062 6520 7461 6b65 6e20  e will be taken 
-0001f310: 616e 6420 7468 6520 6c6f 6361 7469 6f6e  and the location
-0001f320: 206f 6620 7468 6973 2076 616c 7565 0d0a   of this value..
-0001f330: 2020 2020 2020 2020 425f 696e 7075 745f          B_input_
-0001f340: 7061 7468 2069 7320 7061 7468 2074 6f20  path is path to 
-0001f350: 7468 6520 666f 6c64 6572 2077 6865 7265  the folder where
-0001f360: 2044 6174 6173 6574 2042 2065 7869 7374   Dataset B exist
-0001f370: 2077 6865 7265 2020 7765 206e 6565 6420   where  we need 
-0001f380: 746f 2070 7574 0d0a 2020 2020 2020 2020  to put..        
-0001f390: 7468 6520 4e6f 4461 7461 5661 6c75 6520  the NoDataValue 
-0001f3a0: 6f66 2052 6173 7465 7241 2069 6e20 5261  of RasterA in Ra
-0001f3b0: 7374 6572 4220 6174 2074 6865 2073 616d  sterB at the sam
-0001f3c0: 6520 6c6f 6361 7469 6f6e 730d 0a0d 0a20  e locations.... 
-0001f3d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0001f3e0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0001f3f0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2075  -----..        u
-0001f400: 6675 6e63 3a20 5b66 756e 6374 696f 6e5d  func: [function]
-0001f410: 0d0a 2020 2020 2020 2020 2020 2020 6361  ..            ca
-0001f420: 6c6c 6162 6c65 2075 6e69 7665 7273 616c  llable universal
-0001f430: 2066 756e 6374 696f 6e20 7566 756e 6320   function ufunc 
-0001f440: 2862 7569 6c74 696e 206f 7220 7573 6572  (builtin or user
-0001f450: 2064 6566 696e 6564 290d 0a20 2020 2020   defined)..     
-0001f460: 2020 2020 2020 2068 7474 7073 3a2f 2f6e         https://n
-0001f470: 756d 7079 2e6f 7267 2f64 6f63 2f73 7461  umpy.org/doc/sta
-0001f480: 626c 652f 7265 6665 7265 6e63 652f 7566  ble/reference/uf
-0001f490: 756e 6373 2e68 746d 6c0d 0a20 2020 2020  uncs.html..     
-0001f4a0: 2020 2020 2020 202d 2074 6f20 6372 6561         - to crea
-0001f4b0: 7465 2061 2075 6675 6e63 2066 726f 6d20  te a ufunc from 
-0001f4c0: 6120 6e6f 726d 616c 2066 756e 6374 696f  a normal functio
-0001f4d0: 6e20 2868 7474 7073 3a2f 2f6e 756d 7079  n (https://numpy
-0001f4e0: 2e6f 7267 2f64 6f63 2f73 7461 626c 652f  .org/doc/stable/
-0001f4f0: 7265 6665 7265 6e63 652f 6765 6e65 7261  reference/genera
-0001f500: 7465 642f 6e75 6d70 792e 6672 6f6d 7079  ted/numpy.frompy
-0001f510: 6675 6e63 2e68 746d 6c29 0d0a 0d0a 2020  func.html)....  
-0001f520: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0001f530: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0001f540: 2020 2020 2020 2020 6e65 7720 7261 7374          new rast
-0001f550: 6572 7320 7769 6c6c 2062 6520 7361 7665  ers will be save
-0001f560: 6420 746f 2074 6865 2073 6176 655f 746f  d to the save_to
-0001f570: 0d0a 0d0a 2020 2020 2020 2020 4578 616d  ....        Exam
-0001f580: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
-0001f590: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0001f5a0: 3e3e 3e20 6465 6620 6675 6e63 2876 616c  >>> def func(val
-0001f5b0: 293a 0d0a 2020 2020 2020 2020 3e3e 3e20  ):..        >>> 
-0001f5c0: 2020 2072 6574 7572 6e20 7661 6c25 320d     return val%2.
-0001f5d0: 0a20 2020 2020 2020 203e 3e3e 2075 6675  .        >>> ufu
-0001f5e0: 6e63 203d 206e 702e 6672 6f6d 7079 6675  nc = np.frompyfu
-0001f5f0: 6e63 2866 756e 632c 2031 2c20 3129 0d0a  nc(func, 1, 1)..
-0001f600: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
-0001f610: 7365 742e 6170 706c 7928 7566 756e 6329  set.apply(ufunc)
-0001f620: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0001f630: 2020 2020 2020 2069 6620 6e6f 7420 6361         if not ca
-0001f640: 6c6c 6162 6c65 2875 6675 6e63 293a 0d0a  llable(ufunc):..
-0001f650: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001f660: 6520 5479 7065 4572 726f 7228 2273 6563  e TypeError("sec
-0001f670: 6f6e 6420 6172 6775 6d65 6e74 2073 686f  ond argument sho
-0001f680: 756c 6420 6265 2061 2066 756e 6374 696f  uld be a functio
-0001f690: 6e22 290d 0a20 2020 2020 2020 2061 7272  n")..        arr
-0001f6a0: 203d 2073 656c 662e 6461 7461 0d0a 2020   = self.data..  
-0001f6b0: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
-0001f6c0: 6c75 6520 3d20 7365 6c66 2e62 6173 652e  lue = self.base.
-0001f6d0: 6e6f 5f64 6174 615f 7661 6c75 655b 305d  no_data_value[0]
-0001f6e0: 0d0a 2020 2020 2020 2020 2320 6578 6563  ..        # exec
-0001f6f0: 7574 6520 7468 6520 6675 6e63 7469 6f6e  ute the function
-0001f700: 206f 6e20 6561 6368 2072 6173 7465 720d   on each raster.
-0001f710: 0a20 2020 2020 2020 2061 7272 5b7e 6e70  .        arr[~np
-0001f720: 2e69 7363 6c6f 7365 2861 7272 2c20 6e6f  .isclose(arr, no
-0001f730: 5f64 6174 615f 7661 6c75 652c 2072 746f  _data_value, rto
-0001f740: 6c3d 302e 3030 3129 5d20 3d20 7566 756e  l=0.001)] = ufun
-0001f750: 6328 0d0a 2020 2020 2020 2020 2020 2020  c(..            
-0001f760: 6172 725b 7e6e 702e 6973 636c 6f73 6528  arr[~np.isclose(
-0001f770: 6172 722c 206e 6f5f 6461 7461 5f76 616c  arr, no_data_val
-0001f780: 7565 2c20 7274 6f6c 3d30 2e30 3031 295d  ue, rtol=0.001)]
-0001f790: 0d0a 2020 2020 2020 2020 290d 0a0d 0a20  ..        ).... 
-0001f7a0: 2020 2064 6566 206f 7665 726c 6179 280d     def overlay(.
-0001f7b0: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
-0001f7c0: 2020 2020 2020 2020 636c 6173 7365 735f          classes_
-0001f7d0: 6d61 702c 0d0a 2020 2020 2020 2020 6578  map,..        ex
-0001f7e0: 636c 7564 655f 7661 6c75 653a 2055 6e69  clude_value: Uni
-0001f7f0: 6f6e 5b66 6c6f 6174 2c20 696e 745d 203d  on[float, int] =
-0001f800: 204e 6f6e 652c 0d0a 2020 2020 2920 2d3e   None,..    ) ->
-0001f810: 2044 6963 745b 4c69 7374 5b66 6c6f 6174   Dict[List[float
-0001f820: 5d2c 204c 6973 745b 666c 6f61 745d 5d3a  ], List[float]]:
-0001f830: 0d0a 2020 2020 2020 2020 2222 2274 6869  ..        """thi
-0001f840: 7320 6675 6e63 7469 6f6e 2069 7320 7772  s function is wr
-0001f850: 6974 7465 6e20 746f 2065 7874 7261 6374  itten to extract
-0001f860: 2061 6e64 2072 6574 7572 6e20 6120 6c69   and return a li
-0001f870: 7374 206f 6620 616c 6c20 7468 6520 7661  st of all the va
-0001f880: 6c75 6573 2069 6e20 616e 2041 5343 4949  lues in an ASCII
-0001f890: 2066 696c 652e 0d0a 0d0a 2020 2020 2020   file.....      
-0001f8a0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0001f8b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001f8c0: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
-0001f8d0: 735f 6d61 703a 205b 4461 7461 7365 745d  s_map: [Dataset]
-0001f8e0: 0d0a 2020 2020 2020 2020 2020 2020 4461  ..            Da
-0001f8f0: 7461 7365 7420 4f62 6a65 6374 2066 7072  taset Object fpr
-0001f900: 2074 6865 2072 6173 7465 7220 7468 6174   the raster that
-0001f910: 2068 6176 6520 636c 6173 7365 7320 796f   have classes yo
-0001f920: 7520 7761 6e74 2074 6f20 6f76 6572 6c61  u want to overla
-0001f930: 7920 7769 7468 2074 6865 2072 6173 7465  y with the raste
-0001f940: 722e 0d0a 2020 2020 2020 2020 6578 636c  r...        excl
-0001f950: 7564 655f 7661 6c75 653a 205b 4e75 6d65  ude_value: [Nume
-0001f960: 7269 635d 0d0a 2020 2020 2020 2020 2020  ric]..          
-0001f970: 2020 7661 6c75 6573 2079 6f75 2077 616e    values you wan
-0001f980: 7420 746f 2065 7863 6c75 6465 2066 726f  t to exclude fro
-0001f990: 6d20 6578 7472 6163 7465 6420 7661 6c75  m extracted valu
-0001f9a0: 6573 2e0d 0a0d 0a20 2020 2020 2020 2052  es.....        R
-0001f9b0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0001f9c0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0001f9d0: 2044 6963 7469 6f6e 6172 793a 0d0a 2020   Dictionary:..  
-0001f9e0: 2020 2020 2020 2020 2020 6469 6374 6f6e            dicton
-0001f9f0: 6172 7920 7769 7468 2061 206c 6973 7420  ary with a list 
-0001fa00: 6f66 2076 616c 7565 7320 696e 2074 6865  of values in the
-0001fa10: 2062 6173 656d 6170 2061 7320 6b65 7973   basemap as keys
-0001fa20: 2061 6e64 2066 6f72 2065 6163 6820 6b65   and for each ke
-0001fa30: 7920 6120 6c69 7374 206f 6620 616c 6c20  y a list of all 
-0001fa40: 7468 6520 696e 7465 7273 6563 7465 640d  the intersected.
-0001fa50: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-0001fa60: 7565 7320 696e 2074 6865 206d 6170 7320  ues in the maps 
-0001fa70: 6672 6f6d 2074 6865 2070 6174 682e 0d0a  from the path...
-0001fa80: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0001fa90: 2020 2020 2076 616c 7565 7320 3d20 7b7d       values = {}
-0001faa0: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-0001fab0: 696e 2072 616e 6765 2873 656c 662e 7469  in range(self.ti
-0001fac0: 6d65 5f6c 656e 6774 6829 3a0d 0a20 2020  me_length):..   
-0001fad0: 2020 2020 2020 2020 2073 7263 203d 2073           src = s
-0001fae0: 656c 662e 696c 6f63 2869 290d 0a20 2020  elf.iloc(i)..   
-0001faf0: 2020 2020 2020 2020 2064 6963 745f 6920           dict_i 
-0001fb00: 3d20 7372 632e 6f76 6572 6c61 7928 636c  = src.overlay(cl
-0001fb10: 6173 7365 735f 6d61 702c 2065 7863 6c75  asses_map, exclu
-0001fb20: 6465 5f76 616c 7565 290d 0a0d 0a20 2020  de_value)....   
-0001fb30: 2020 2020 2020 2020 2023 2074 6865 7365           # these
-0001fb40: 2061 7265 2074 6865 2064 6573 7469 6e63   are the destinc
-0001fb50: 7420 7661 6c75 6573 2066 726f 6d20 7468  t values from th
-0001fb60: 6520 4261 7365 4d61 7020 7768 6963 6820  e BaseMap which 
-0001fb70: 6172 6520 6b65 7973 2069 6e20 7468 650d  are keys in the.
-0001fb80: 0a20 2020 2020 2020 2020 2020 2023 2045  .            # E
-0001fb90: 7874 7261 6374 6564 5661 6c75 6573 6920  xtractedValuesi 
-0001fba0: 6469 6374 2077 6974 6820 6561 6368 206f  dict with each o
-0001fbb0: 6e65 2068 6176 696e 6720 6120 6c69 7374  ne having a list
-0001fbc0: 206f 6620 7661 6c75 6573 0d0a 2020 2020   of values..    
-0001fbd0: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
-0001fbe0: 3d20 6c69 7374 2864 6963 745f 692e 6b65  = list(dict_i.ke
-0001fbf0: 7973 2829 290d 0a0d 0a20 2020 2020 2020  ys())....       
-0001fc00: 2020 2020 2066 6f72 2063 6c61 7373 5f69       for class_i
-0001fc10: 2069 6e20 636c 6173 7365 733a 0d0a 2020   in classes:..  
-0001fc20: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001fc30: 2063 6c61 7373 5f69 206e 6f74 2069 6e20   class_i not in 
-0001fc40: 7661 6c75 6573 2e6b 6579 7328 293a 0d0a  values.keys():..
-0001fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc60: 2020 2020 7661 6c75 6573 5b63 6c61 7373      values[class
-0001fc70: 5f69 5d20 3d20 6c69 7374 2829 0d0a 0d0a  _i] = list()....
-0001fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc90: 7661 6c75 6573 5b63 6c61 7373 5f69 5d20  values[class_i] 
-0001fca0: 3d20 7661 6c75 6573 5b63 6c61 7373 5f69  = values[class_i
-0001fcb0: 5d20 2b20 6469 6374 5f69 5b63 6c61 7373  ] + dict_i[class
-0001fcc0: 5f69 5d0d 0a0d 0a20 2020 2020 2020 2072  _i]....        r
-0001fcd0: 6574 7572 6e20 7661 6c75 6573 0d0a 0d0a  eturn values....
-0001fce0: 2020 2020 2320 4073 7461 7469 636d 6574      # @staticmet
-0001fcf0: 686f 640d 0a20 2020 2023 2064 6566 2072  hod..    # def r
-0001fd00: 6561 644e 4328 0d0a 2020 2020 2320 2020  eadNC(..    #   
-0001fd10: 2020 2020 2020 7061 7468 2c0d 0a20 2020        path,..   
-0001fd20: 2023 2020 2020 2020 2020 2073 6176 655f   #         save_
-0001fd30: 746f 3a20 7374 722c 0d0a 2020 2020 2320  to: str,..    # 
-0001fd40: 2020 2020 2020 2020 7365 7061 7261 746f          separato
-0001fd50: 723a 2073 7472 203d 2022 5f22 2c0d 0a20  r: str = "_",.. 
-0001fd60: 2020 2023 2020 2020 2020 2020 2074 696d     #         tim
-0001fd70: 655f 7661 725f 6e61 6d65 3a20 7374 7220  e_var_name: str 
-0001fd80: 3d20 4e6f 6e65 2c0d 0a20 2020 2023 2020  = None,..    #  
-0001fd90: 2020 2020 2020 2070 7265 6669 783a 2073         prefix: s
-0001fda0: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
-0001fdb0: 2320 293a 0d0a 2020 2020 230d 0a20 2020  # ):..    #..   
-0001fdc0: 2023 2020 2020 2069 6620 6973 696e 7374   #     if isinst
-0001fdd0: 616e 6365 2870 6174 682c 2073 7472 293a  ance(path, str):
-0001fde0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001fdf0: 6e63 203d 206e 6574 4344 4634 2e44 6174  nc = netCDF4.Dat
-0001fe00: 6163 7562 6528 7061 7468 290d 0a20 2020  acube(path)..   
-0001fe10: 2023 2020 2020 2065 6c69 6620 6973 696e   #     elif isin
-0001fe20: 7374 616e 6365 2870 6174 682c 206c 6973  stance(path, lis
-0001fe30: 7429 3a0d 0a20 2020 2023 2020 2020 2020  t):..    #      
-0001fe40: 2020 206e 6320 3d20 6e65 7443 4446 342e     nc = netCDF4.
-0001fe50: 4d46 4461 7461 7365 7428 7061 7468 290d  MFDataset(path).
-0001fe60: 0a20 2020 2023 2020 2020 2065 6c73 653a  .    #     else:
-0001fe70: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001fe80: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0001fe90: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001fea0: 2020 2020 2246 6972 7374 2070 6172 616d      "First param
-0001feb0: 6574 6572 2074 6f20 7468 6520 6e63 746f  eter to the ncto
-0001fec0: 5469 6666 2066 756e 6374 696f 6e20 7368  Tiff function sh
-0001fed0: 6f75 6c64 2062 6520 6569 7468 6572 2073  ould be either s
-0001fee0: 7472 206f 7220 6c69 7374 220d 0a20 2020  tr or list"..   
-0001fef0: 2023 2020 2020 2020 2020 2029 0d0a 2020   #         )..  
-0001ff00: 2020 230d 0a20 2020 2023 2020 2020 2023    #..    #     #
-0001ff10: 2067 6574 2074 6865 2076 6172 6961 626c   get the variabl
-0001ff20: 650d 0a20 2020 2023 2020 2020 2056 6172  e..    #     Var
-0001ff30: 203d 206c 6973 7428 6e63 2e73 7562 7365   = list(nc.subse
-0001ff40: 7473 2e6b 6579 7328 2929 5b2d 315d 0d0a  ts.keys())[-1]..
-0001ff50: 2020 2020 2320 2020 2020 2320 6578 7472      #     # extr
-0001ff60: 6163 7420 7468 6520 6461 7461 0d0a 2020  act the data..  
-0001ff70: 2020 2320 2020 2020 6461 7461 7365 7420    #     dataset 
-0001ff80: 3d20 6e63 5b56 6172 5d0d 0a20 2020 2023  = nc[Var]..    #
-0001ff90: 2020 2020 2023 2067 6574 2074 6865 2064       # get the d
-0001ffa0: 6574 6169 6c73 206f 6620 7468 6520 6669  etails of the fi
-0001ffb0: 6c65 0d0a 2020 2020 2320 2020 2020 6765  le..    #     ge
-0001ffc0: 6f2c 2065 7073 672c 205f 2c20 5f2c 2074  o, epsg, _, _, t
-0001ffd0: 696d 655f 6c65 6e2c 2074 696d 655f 7661  ime_len, time_va
-0001ffe0: 722c 206e 6f5f 6461 7461 5f76 616c 7565  r, no_data_value
-0001fff0: 2c20 6461 7461 7479 7065 203d 204e 432e  , datatype = NC.
-00020000: 6765 744e 4344 6574 6169 6c73 280d 0a20  getNCDetails(.. 
-00020010: 2020 2023 2020 2020 2020 2020 206e 632c     #         nc,
-00020020: 2074 696d 655f 7661 725f 6e61 6d65 3d74   time_var_name=t
-00020030: 696d 655f 7661 725f 6e61 6d65 0d0a 2020  ime_var_name..  
-00020040: 2020 2320 2020 2020 290d 0a20 2020 2023    #     )..    #
-00020050: 2020 2020 2070 7269 6e74 2822 7373 7322       print("sss"
-00020060: 290d 0a                                  )..
+000020d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000020e0: 662e 5f67 6574 5f63 7273 2829 0d0a 0d0a  f._get_crs()....
+000020f0: 2020 2020 4063 7273 2e73 6574 7465 720d      @crs.setter.
+00002100: 0a20 2020 2064 6566 2063 7273 2873 656c  .    def crs(sel
+00002110: 662c 2076 616c 7565 3a20 7374 7229 3a0d  f, value: str):.
+00002120: 0a20 2020 2020 2020 2022 2222 436f 6f72  .        """Coor
+00002130: 6469 6e61 7465 2072 6566 6572 656e 6365  dinate reference
+00002140: 2073 7973 7465 6d2e 2222 220d 0a20 2020   system."""..   
+00002150: 2020 2020 2073 656c 662e 7365 745f 6372       self.set_cr
+00002160: 7328 7661 6c75 6529 0d0a 0d0a 2020 2020  s(value)....    
+00002170: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+00002180: 6566 2063 656c 6c5f 7369 7a65 2873 656c  ef cell_size(sel
+00002190: 6629 202d 3e20 696e 743a 0d0a 2020 2020  f) -> int:..    
+000021a0: 2020 2020 2222 2243 656c 6c20 7369 7a65      """Cell size
+000021b0: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
+000021c0: 7475 726e 2073 656c 662e 5f63 656c 6c5f  turn self._cell_
+000021d0: 7369 7a65 0d0a 0d0a 2020 2020 4070 726f  size....    @pro
+000021e0: 7065 7274 790d 0a20 2020 2064 6566 2062  perty..    def b
+000021f0: 616e 645f 636f 756e 7428 7365 6c66 293a  and_count(self):
+00002200: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
+00002210: 6265 7220 6f66 2062 616e 6473 2069 6e20  ber of bands in 
+00002220: 7468 6520 7261 7374 6572 2e22 2222 0d0a  the raster."""..
+00002230: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00002240: 656c 662e 5f62 616e 645f 636f 756e 740d  elf._band_count.
+00002250: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+00002260: 0d0a 2020 2020 6465 6620 6261 6e64 5f6e  ..    def band_n
+00002270: 616d 6573 2873 656c 6629 3a0d 0a20 2020  ames(self):..   
+00002280: 2020 2020 2022 2222 4261 6e64 206e 616d       """Band nam
+00002290: 6573 2e22 2222 0d0a 2020 2020 2020 2020  es."""..        
+000022a0: 7265 7475 726e 2073 656c 662e 5f62 616e  return self._ban
+000022b0: 645f 6e61 6d65 730d 0a0d 0a20 2020 2040  d_names....    @
+000022c0: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+000022d0: 6620 7661 7269 6162 6c65 7328 7365 6c66  f variables(self
+000022e0: 293a 0d0a 2020 2020 2020 2020 2222 2256  ):..        """V
+000022f0: 6172 6961 626c 6573 2069 6e20 7468 6520  ariables in the 
+00002300: 7261 7374 6572 2028 7265 7361 6d62 6c65  raster (resamble
+00002310: 7320 7468 6520 7661 7269 6162 6c65 7320  s the variables 
+00002320: 696e 206e 6574 6364 6620 6669 6c65 732e  in netcdf files.
+00002330: 2922 2222 0d0a 2020 2020 2020 2020 7265  )"""..        re
+00002340: 7475 726e 2073 656c 662e 5f76 6172 6961  turn self._varia
+00002350: 626c 6573 0d0a 0d0a 2020 2020 4070 726f  bles....    @pro
+00002360: 7065 7274 790d 0a20 2020 2064 6566 206e  perty..    def n
+00002370: 6f5f 6461 7461 5f76 616c 7565 2873 656c  o_data_value(sel
+00002380: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
+00002390: 4e6f 2064 6174 6120 7661 6c75 6520 7468  No data value th
+000023a0: 6174 206d 6172 6b73 2074 6865 2063 656c  at marks the cel
+000023b0: 6c73 206f 7574 206f 6620 7468 6520 646f  ls out of the do
+000023c0: 6d61 696e 2222 220d 0a20 2020 2020 2020  main"""..       
+000023d0: 2072 6574 7572 6e20 7365 6c66 2e5f 6e6f   return self._no
+000023e0: 5f64 6174 615f 7661 6c75 650d 0a0d 0a20  _data_value.... 
+000023f0: 2020 2040 6e6f 5f64 6174 615f 7661 6c75     @no_data_valu
+00002400: 652e 7365 7474 6572 0d0a 2020 2020 6465  e.setter..    de
+00002410: 6620 6e6f 5f64 6174 615f 7661 6c75 6528  f no_data_value(
+00002420: 7365 6c66 2c20 7661 6c75 653a 206f 626a  self, value: obj
+00002430: 6563 7429 3a0d 0a20 2020 2020 2020 2022  ect):..        "
+00002440: 2222 4e6f 2064 6174 6120 7661 6c75 6520  ""No data value 
+00002450: 7468 6174 206d 6172 6b73 2074 6865 2063  that marks the c
+00002460: 656c 6c73 206f 7574 206f 6620 7468 6520  ells out of the 
+00002470: 646f 6d61 696e 2222 220d 0a20 2020 2020  domain"""..     
+00002480: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00002490: 2876 616c 7565 2c20 6c69 7374 293a 0d0a  (value, list):..
+000024a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000024b0: 692c 2076 616c 2069 6e20 656e 756d 6572  i, val in enumer
+000024c0: 6174 6528 7661 6c75 6529 3a0d 0a20 2020  ate(value):..   
+000024d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000024e0: 662e 5f63 6861 6e67 655f 6e6f 5f64 6174  f._change_no_dat
+000024f0: 615f 7661 6c75 655f 6174 7472 2869 2c20  a_value_attr(i, 
+00002500: 7661 6c29 0d0a 2020 2020 2020 2020 656c  val)..        el
+00002510: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00002520: 2073 656c 662e 5f63 6861 6e67 655f 6e6f   self._change_no
+00002530: 5f64 6174 615f 7661 6c75 655f 6174 7472  _data_value_attr
+00002540: 2830 2c20 7661 6c75 6529 0d0a 0d0a 2020  (0, value)....  
+00002550: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
+00002560: 2064 6566 206d 6574 615f 6461 7461 2873   def meta_data(s
+00002570: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+00002580: 2222 4d65 7461 2064 6174 6122 2222 0d0a  ""Meta data"""..
+00002590: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000025a0: 656c 662e 5f6d 6574 615f 6461 7461 0d0a  elf._meta_data..
+000025b0: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
+000025c0: 0a20 2020 2064 6566 2064 7479 7065 2873  .    def dtype(s
+000025d0: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+000025e0: 2222 4461 7461 2054 7970 6522 2222 0d0a  ""Data Type"""..
+000025f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00002600: 656c 662e 5f64 7479 7065 0d0a 0d0a 2020  elf._dtype....  
+00002610: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
+00002620: 2064 6566 2066 696c 655f 6e61 6d65 2873   def file_name(s
+00002630: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+00002640: 2222 6669 6c65 206e 616d 6522 2222 0d0a  ""file name"""..
+00002650: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00002660: 5f66 696c 655f 6e61 6d65 2e73 7461 7274  _file_name.start
+00002670: 7377 6974 6828 224e 4554 4344 4622 293a  swith("NETCDF"):
+00002680: 0d0a 2020 2020 2020 2020 2020 2020 6e61  ..            na
+00002690: 6d65 203d 2073 656c 662e 5f66 696c 655f  me = self._file_
+000026a0: 6e61 6d65 2e73 706c 6974 2822 3a22 295b  name.split(":")[
+000026b0: 315d 5b31 3a2d 315d 0d0a 2020 2020 2020  1][1:-1]..      
+000026c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000026d0: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
+000026e0: 2e5f 6669 6c65 5f6e 616d 650d 0a20 2020  ._file_name..   
+000026f0: 2020 2020 2072 6574 7572 6e20 6e61 6d65       return name
+00002700: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+00002710: 790d 0a20 2020 2064 6566 2074 696d 655f  y..    def time_
+00002720: 7374 616d 7028 7365 6c66 293a 0d0a 2020  stamp(self):..  
+00002730: 2020 2020 2020 2222 2254 696d 6520 7374        """Time st
+00002740: 616d 7022 2222 0d0a 2020 2020 2020 2020  amp"""..        
+00002750: 6966 2068 6173 6174 7472 2873 656c 662c  if hasattr(self,
+00002760: 2022 5f74 696d 655f 7374 616d 7022 293a   "_time_stamp"):
+00002770: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+00002780: 6c20 3d20 7365 6c66 2e5f 7469 6d65 5f73  l = self._time_s
+00002790: 7461 6d70 0d0a 2020 2020 2020 2020 656c  tamp..        el
+000027a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000027b0: 2076 616c 203d 204e 6f6e 650d 0a0d 0a20   val = None.... 
+000027c0: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
+000027d0: 6c0d 0a0d 0a20 2020 2040 7072 6f70 6572  l....    @proper
+000027e0: 7479 0d0a 2020 2020 6465 6620 6472 6976  ty..    def driv
+000027f0: 6572 5f74 7970 6528 7365 6c66 293a 0d0a  er_type(self):..
+00002800: 2020 2020 2020 2020 2222 2244 7269 7665          """Drive
+00002810: 7220 5479 7065 2222 220d 0a20 2020 2020  r Type"""..     
+00002820: 2020 2064 7269 7665 725f 7479 7065 203d     driver_type =
+00002830: 2073 656c 662e 7261 7374 6572 2e47 6574   self.raster.Get
+00002840: 4472 6976 6572 2829 2e47 6574 4465 7363  Driver().GetDesc
+00002850: 7269 7074 696f 6e28 290d 0a20 2020 2020  ription()..     
+00002860: 2020 2072 6574 7572 6e20 4341 5441 4c4f     return CATALO
+00002870: 472e 6765 745f 6472 6976 6572 5f6e 616d  G.get_driver_nam
+00002880: 6528 6472 6976 6572 5f74 7970 6529 0d0a  e(driver_type)..
+00002890: 0d0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+000028a0: 6f64 0d0a 2020 2020 6465 6620 7265 6164  od..    def read
+000028b0: 5f66 696c 6528 636c 732c 2070 6174 683a  _file(cls, path:
+000028c0: 2073 7472 2c20 7265 6164 5f6f 6e6c 793d   str, read_only=
+000028d0: 5472 7565 293a 0d0a 2020 2020 2020 2020  True):..        
+000028e0: 2222 2272 6561 6420 6669 6c65 2e0d 0a0d  """read file....
+000028f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00002900: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00002910: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00002920: 2070 6174 6820 3a20 5b73 7472 5d0d 0a20   path : [str].. 
+00002930: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
+00002940: 6f66 2066 696c 6520 746f 206f 7065 6e28  of file to open(
+00002950: 776f 726b 7320 666f 7220 6173 6369 692c  works for ascii,
+00002960: 2067 656f 7469 6666 292e 0d0a 2020 2020   geotiff)...    
+00002970: 2020 2020 7265 6164 5f6f 6e6c 7920 3a20      read_only : 
+00002980: 5b62 6f6f 6c5d 0d0a 2020 2020 2020 2020  [bool]..        
+00002990: 2020 2020 4669 6c65 206d 6f64 652c 2073      File mode, s
+000029a0: 6574 2074 6f20 4661 6c73 6520 746f 206f  et to False to o
+000029b0: 7065 6e20 696e 2022 7570 6461 7465 2220  pen in "update" 
+000029c0: 6d6f 6465 2e0d 0a0d 0a20 2020 2020 2020  mode.....       
+000029d0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+000029e0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+000029f0: 2020 2047 4441 4c20 6461 7461 7365 740d     GDAL dataset.
+00002a00: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00002a10: 2020 2020 2020 7372 6320 3d20 5f69 6f2e        src = _io.
+00002a20: 7265 6164 5f66 696c 6528 7061 7468 2c20  read_file(path, 
+00002a30: 7265 6164 5f6f 6e6c 7929 0d0a 2020 2020  read_only)..    
+00002a40: 2020 2020 7265 7475 726e 2063 6c73 2873      return cls(s
+00002a50: 7263 290d 0a0d 0a20 2020 2040 636c 6173  rc)....    @clas
+00002a60: 736d 6574 686f 640d 0a20 2020 2064 6566  smethod..    def
+00002a70: 205f 6372 6561 7465 5f65 6d70 7479 5f64   _create_empty_d
+00002a80: 7269 7665 7228 0d0a 2020 2020 2020 2020  river(..        
+00002a90: 636c 732c 2073 7263 3a20 6764 616c 2e44  cls, src: gdal.D
+00002aa0: 6174 6173 6574 2c20 7061 7468 3a20 7374  ataset, path: st
+00002ab0: 7220 3d20 4e6f 6e65 2c20 6261 6e64 733a  r = None, bands:
+00002ac0: 2069 6e74 203d 2031 2c20 6e6f 5f64 6174   int = 1, no_dat
+00002ad0: 615f 7661 6c75 653d 4e6f 6e65 0d0a 2020  a_value=None..  
+00002ae0: 2020 293a 0d0a 2020 2020 2020 2020 2222    ):..        ""
+00002af0: 2243 7265 6174 6520 6120 6e65 7720 656d  "Create a new em
+00002b00: 7074 7920 6472 6976 6572 2066 726f 6d20  pty driver from 
+00002b10: 616e 6f74 6865 7220 6461 7461 7365 742e  another dataset.
+00002b20: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00002b30: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00002b40: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00002b50: 2020 2020 7372 6320 3a20 5b67 6461 6c2e      src : [gdal.
+00002b60: 4461 7461 6375 6265 5d0d 0a20 2020 2020  Datacube]..     
+00002b70: 2020 2020 2020 2067 6461 6c20 6461 7461         gdal data
+00002b80: 7365 740d 0a20 2020 2020 2020 2070 6174  set..        pat
+00002b90: 6820 3a20 7374 720d 0a20 2020 2020 2020  h : str..       
+00002ba0: 2062 616e 6473 203a 2069 6e74 206f 7220   bands : int or 
+00002bb0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+00002bc0: 2020 4e75 6d62 6572 206f 6620 6261 6e64    Number of band
+00002bd0: 7320 746f 2063 7265 6174 6520 696e 2074  s to create in t
+00002be0: 6865 206f 7574 7075 7420 7261 7374 6572  he output raster
+00002bf0: 2e0d 0a20 2020 2020 2020 206e 6f5f 6461  ...        no_da
+00002c00: 7461 5f76 616c 7565 203a 2066 6c6f 6174  ta_value : float
+00002c10: 206f 7220 4e6f 6e65 0d0a 2020 2020 2020   or None..      
+00002c20: 2020 2020 2020 4e6f 2064 6174 6120 7661        No data va
+00002c30: 6c75 652c 2069 6620 4e6f 6e65 2075 7365  lue, if None use
+00002c40: 7320 7468 6520 7361 6d65 2061 7320 6060  s the same as ``
+00002c50: 7372 6360 602e 0d0a 0d0a 2020 2020 2020  src``.....      
+00002c60: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00002c70: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00002c80: 2020 2020 6764 616c 2e44 6174 6153 6574      gdal.DataSet
+00002c90: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00002ca0: 2020 2020 2020 2062 616e 6473 203d 2069         bands = i
+00002cb0: 6e74 2862 616e 6473 2920 6966 2062 616e  nt(bands) if ban
+00002cc0: 6473 2069 7320 6e6f 7420 4e6f 6e65 2065  ds is not None e
+00002cd0: 6c73 6520 7372 632e 5261 7374 6572 436f  lse src.RasterCo
+00002ce0: 756e 740d 0a20 2020 2020 2020 2023 2063  unt..        # c
+00002cf0: 7265 6174 6520 7468 6520 6f62 6865 6374  reate the obhect
+00002d00: 0d0a 2020 2020 2020 2020 7372 635f 6f62  ..        src_ob
+00002d10: 6a20 3d20 636c 7328 7372 6329 0d0a 2020  j = cls(src)..  
+00002d20: 2020 2020 2020 2320 4372 6561 7465 2074        # Create t
+00002d30: 6865 2064 7269 7665 722e 0d0a 2020 2020  he driver...    
+00002d40: 2020 2020 6473 7420 3d20 7372 635f 6f62      dst = src_ob
+00002d50: 6a2e 5f63 7265 6174 655f 6764 616c 5f64  j._create_gdal_d
+00002d60: 6174 6173 6574 280d 0a20 2020 2020 2020  ataset(..       
+00002d70: 2020 2020 2073 7263 5f6f 626a 2e63 6f6c       src_obj.col
+00002d80: 756d 6e73 2c20 7372 635f 6f62 6a2e 726f  umns, src_obj.ro
+00002d90: 7773 2c20 6261 6e64 732c 2073 7263 5f6f  ws, bands, src_o
+00002da0: 626a 2e64 7479 7065 5b30 5d2c 2070 6174  bj.dtype[0], pat
+00002db0: 683d 7061 7468 0d0a 2020 2020 2020 2020  h=path..        
+00002dc0: 290d 0a0d 0a20 2020 2020 2020 2023 2053  )....        # S
+00002dd0: 6574 2074 6865 2070 726f 6a65 6374 696f  et the projectio
+00002de0: 6e2e 0d0a 2020 2020 2020 2020 6473 742e  n...        dst.
+00002df0: 5365 7447 656f 5472 616e 7366 6f72 6d28  SetGeoTransform(
+00002e00: 7372 635f 6f62 6a2e 6765 6f74 7261 6e73  src_obj.geotrans
+00002e10: 666f 726d 290d 0a20 2020 2020 2020 2064  form)..        d
+00002e20: 7374 2e53 6574 5072 6f6a 6563 7469 6f6e  st.SetProjection
+00002e30: 2873 7263 5f6f 626a 2e72 6173 7465 722e  (src_obj.raster.
+00002e40: 4765 7450 726f 6a65 6374 696f 6e52 6566  GetProjectionRef
+00002e50: 2829 290d 0a20 2020 2020 2020 2064 7374  ())..        dst
+00002e60: 203d 2063 6c73 2864 7374 290d 0a20 2020   = cls(dst)..   
+00002e70: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
+00002e80: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
+00002e90: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00002ea0: 6473 742e 5f73 6574 5f6e 6f5f 6461 7461  dst._set_no_data
+00002eb0: 5f76 616c 7565 286e 6f5f 6461 7461 5f76  _value(no_data_v
+00002ec0: 616c 7565 3d66 6c6f 6174 286e 6f5f 6461  alue=float(no_da
+00002ed0: 7461 5f76 616c 7565 2929 0d0a 0d0a 2020  ta_value))....  
+00002ee0: 2020 2020 2020 7265 7475 726e 2064 7374        return dst
+00002ef0: 0d0a 0d0a 2020 2020 4063 6c61 7373 6d65  ....    @classme
+00002f00: 7468 6f64 0d0a 2020 2020 6465 6620 5f63  thod..    def _c
+00002f10: 7265 6174 655f 6472 6976 6572 5f66 726f  reate_driver_fro
+00002f20: 6d5f 7363 7261 7463 6828 0d0a 2020 2020  m_scratch(..    
+00002f30: 2020 2020 636c 732c 0d0a 2020 2020 2020      cls,..      
+00002f40: 2020 6365 6c6c 5f73 697a 653a 2069 6e74    cell_size: int
+00002f50: 2c0d 0a20 2020 2020 2020 2072 6f77 733a  ,..        rows:
+00002f60: 2069 6e74 2c0d 0a20 2020 2020 2020 2063   int,..        c
+00002f70: 6f6c 756d 6e73 3a20 696e 742c 0d0a 2020  olumns: int,..  
+00002f80: 2020 2020 2020 6474 7970 653a 2069 6e74        dtype: int
+00002f90: 2c0d 0a20 2020 2020 2020 2062 616e 6473  ,..        bands
+00002fa0: 3a20 696e 742c 0d0a 2020 2020 2020 2020  : int,..        
+00002fb0: 746f 705f 6c65 6674 5f63 6f6f 7264 733a  top_left_coords:
+00002fc0: 2054 7570 6c65 2c0d 0a20 2020 2020 2020   Tuple,..       
+00002fd0: 2065 7073 673a 2069 6e74 2c0d 0a20 2020   epsg: int,..   
+00002fe0: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
+00002ff0: 7565 3a20 416e 7920 3d20 4e6f 6e65 2c0d  ue: Any = None,.
+00003000: 0a20 2020 2020 2020 2070 6174 683a 2073  .        path: s
+00003010: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
+00003020: 293a 0d0a 2020 2020 2020 2020 2222 2243  ):..        """C
+00003030: 7265 6174 6520 6120 6e65 7720 656d 7074  reate a new empt
+00003040: 7920 6472 6976 6572 2066 726f 6d20 616e  y driver from an
+00003050: 6f74 6865 7220 6461 7461 7365 742e 0d0a  other dataset...
+00003060: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00003070: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00003080: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00003090: 2020 6365 6c6c 5f73 697a 653a 205b 416e    cell_size: [An
+000030a0: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
+000030b0: 6365 6c6c 2073 697a 652e 0d0a 2020 2020  cell size...    
+000030c0: 2020 2020 726f 7773 3a20 5b69 6e74 5d0d      rows: [int].
+000030d0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+000030e0: 6265 7220 6f66 2072 6f77 732e 0d0a 2020  ber of rows...  
+000030f0: 2020 2020 2020 636f 6c75 6d6e 733a 205b        columns: [
+00003100: 696e 745d 0d0a 2020 2020 2020 2020 2020  int]..          
+00003110: 2020 6e75 6d62 6572 206f 6620 636f 6c75    number of colu
+00003120: 6d6e 732e 0d0a 2020 2020 2020 2020 6474  mns...        dt
+00003130: 7970 653a 205b 696e 745d 0d0a 2020 2020  ype: [int]..    
+00003140: 2020 2020 2020 2020 6461 7461 2074 7970          data typ
+00003150: 652e 0d0a 2020 2020 2020 2020 6261 6e64  e...        band
+00003160: 7320 3a20 696e 7420 6f72 204e 6f6e 650d  s : int or None.
+00003170: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+00003180: 6265 7220 6f66 2062 616e 6473 2074 6f20  ber of bands to 
+00003190: 6372 6561 7465 2069 6e20 7468 6520 6f75  create in the ou
+000031a0: 7470 7574 2072 6173 7465 722e 0d0a 2020  tput raster...  
+000031b0: 2020 2020 2020 746f 705f 6c65 6674 5f63        top_left_c
+000031c0: 6f6f 7264 733a 205b 5475 706c 655d 0d0a  oords: [Tuple]..
+000031d0: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+000031e0: 6469 6e61 7465 7320 6f66 2074 6865 2074  dinates of the t
+000031f0: 6f70 206c 6566 7420 636f 726e 6572 2070  op left corner p
+00003200: 6f69 6e74 2e0d 0a20 2020 2020 2020 2065  oint...        e
+00003210: 7073 673a 205b 696e 745d 0d0a 2020 2020  psg: [int]..    
+00003220: 2020 2020 2020 2020 6570 7367 206e 756d          epsg num
+00003230: 6265 7220 746f 2069 6465 6e74 6966 7920  ber to identify 
+00003240: 7468 6520 7072 6f6a 6563 7469 6f6e 206f  the projection o
+00003250: 6620 7468 6520 636f 6f72 6469 6e61 7465  f the coordinate
+00003260: 7320 696e 2074 6865 2063 7265 6174 6564  s in the created
+00003270: 2072 6173 7465 722e 0d0a 2020 2020 2020   raster...      
+00003280: 2020 6e6f 5f64 6174 615f 7661 6c75 6520    no_data_value 
+00003290: 3a20 666c 6f61 7420 6f72 204e 6f6e 650d  : float or None.
+000032a0: 0a20 2020 2020 2020 2020 2020 204e 6f20  .            No 
+000032b0: 6461 7461 2076 616c 7565 2c20 6966 204e  data value, if N
+000032c0: 6f6e 6520 7573 6573 2074 6865 2073 616d  one uses the sam
+000032d0: 6520 6173 2060 6073 7263 6060 2e0d 0a20  e as ``src``... 
+000032e0: 2020 2020 2020 2070 6174 6820 3a20 5b73         path : [s
+000032f0: 7472 5d0d 0a20 2020 2020 2020 2020 2020  tr]..           
+00003300: 2070 6174 6820 6f6e 2064 6973 6b2e 0d0a   path on disk...
+00003310: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00003320: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00003330: 2d2d 0d0a 2020 2020 2020 2020 6764 616c  --..        gdal
+00003340: 2e44 6174 6153 6574 0d0a 2020 2020 2020  .DataSet..      
+00003350: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
+00003360: 2043 7265 6174 6520 7468 6520 6472 6976   Create the driv
+00003370: 6572 2e0d 0a20 2020 2020 2020 2064 7374  er...        dst
+00003380: 203d 2044 6174 6173 6574 2e5f 6372 6561   = Dataset._crea
+00003390: 7465 5f67 6461 6c5f 6461 7461 7365 7428  te_gdal_dataset(
+000033a0: 636f 6c75 6d6e 732c 2072 6f77 732c 2062  columns, rows, b
+000033b0: 616e 6473 2c20 6474 7970 652c 2070 6174  ands, dtype, pat
+000033c0: 683d 7061 7468 290d 0a20 2020 2020 2020  h=path)..       
+000033d0: 2067 656f 7472 616e 7366 6f72 6d20 3d20   geotransform = 
+000033e0: 280d 0a20 2020 2020 2020 2020 2020 2074  (..            t
+000033f0: 6f70 5f6c 6566 745f 636f 6f72 6473 5b30  op_left_coords[0
+00003400: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00003410: 6365 6c6c 5f73 697a 652c 0d0a 2020 2020  cell_size,..    
+00003420: 2020 2020 2020 2020 302c 0d0a 2020 2020          0,..    
+00003430: 2020 2020 2020 2020 746f 705f 6c65 6674          top_left
+00003440: 5f63 6f6f 7264 735b 315d 2c0d 0a20 2020  _coords[1],..   
+00003450: 2020 2020 2020 2020 2030 2c0d 0a20 2020           0,..   
+00003460: 2020 2020 2020 2020 202d 3120 2a20 6365           -1 * ce
+00003470: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
+00003480: 2020 290d 0a20 2020 2020 2020 2073 7220    )..        sr 
+00003490: 3d20 4461 7461 7365 742e 5f63 7265 6174  = Dataset._creat
+000034a0: 655f 7372 5f66 726f 6d5f 6570 7367 2865  e_sr_from_epsg(e
+000034b0: 7073 6729 0d0a 0d0a 2020 2020 2020 2020  psg)....        
+000034c0: 2320 5365 7420 7468 6520 7072 6f6a 6563  # Set the projec
+000034d0: 7469 6f6e 2e0d 0a20 2020 2020 2020 2064  tion...        d
+000034e0: 7374 2e53 6574 4765 6f54 7261 6e73 666f  st.SetGeoTransfo
+000034f0: 726d 2867 656f 7472 616e 7366 6f72 6d29  rm(geotransform)
+00003500: 0d0a 2020 2020 2020 2020 6473 742e 5365  ..        dst.Se
+00003510: 7450 726f 6a65 6374 696f 6e28 7372 2e45  tProjection(sr.E
+00003520: 7870 6f72 7454 6f57 6b74 2829 290d 0a20  xportToWkt()).. 
+00003530: 2020 2020 2020 2064 7374 203d 2063 6c73         dst = cls
+00003540: 2864 7374 290d 0a20 2020 2020 2020 2069  (dst)..        i
+00003550: 6620 6e6f 5f64 6174 615f 7661 6c75 6520  f no_data_value 
+00003560: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00003570: 2020 2020 2020 2020 2020 6473 742e 5f73            dst._s
+00003580: 6574 5f6e 6f5f 6461 7461 5f76 616c 7565  et_no_data_value
+00003590: 286e 6f5f 6461 7461 5f76 616c 7565 3d6e  (no_data_value=n
+000035a0: 6f5f 6461 7461 5f76 616c 7565 290d 0a0d  o_data_value)...
+000035b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000035c0: 6473 740d 0a0d 0a20 2020 2064 6566 2072  dst....    def r
+000035d0: 6561 645f 6172 7261 7928 7365 6c66 2c20  ead_array(self, 
+000035e0: 6261 6e64 3a20 696e 7420 3d20 4e6f 6e65  band: int = None
+000035f0: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+00003600: 0d0a 2020 2020 2020 2020 2222 2252 6561  ..        """Rea
+00003610: 6420 4172 7261 790d 0a0d 0a20 2020 2020  d Array....     
+00003620: 2020 2020 2020 202d 2072 6561 6420 7468         - read th
+00003630: 6520 7661 6c75 6573 2073 746f 7265 6420  e values stored 
+00003640: 696e 2061 2067 6976 656e 2062 616e 642e  in a given band.
+00003650: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00003660: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00003670: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00003680: 2020 2020 6261 6e64 203a 205b 696e 7465      band : [inte
+00003690: 6765 725d 0d0a 2020 2020 2020 2020 2020  ger]..          
+000036a0: 2020 7468 6520 6261 6e64 2079 6f75 2077    the band you w
+000036b0: 616e 7420 746f 2067 6574 2069 7473 2064  ant to get its d
+000036c0: 6174 612e 2044 6566 6175 6c74 2069 7320  ata. Default is 
+000036d0: 300d 0a0d 0a20 2020 2020 2020 2052 6574  0....        Ret
+000036e0: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+000036f0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
+00003700: 7272 6179 203a 205b 6172 7261 795d 0d0a  rray : [array]..
+00003710: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+00003720: 7920 7769 7468 2061 6c6c 2074 6865 2076  y with all the v
+00003730: 616c 7565 7320 696e 2074 6865 2072 6173  alues in the ras
+00003740: 7465 722e 0d0a 2020 2020 2020 2020 2222  ter...        ""
+00003750: 220d 0a20 2020 2020 2020 2023 2074 7279  "..        # try
+00003760: 2074 6f20 7265 7475 726e 2061 7272 6179   to return array
+00003770: 2061 7320 7468 6520 7361 6d65 2074 7970   as the same typ
+00003780: 6520 6173 2074 6865 2072 6173 7465 7220  e as the raster 
+00003790: 6261 6e64 2062 7574 206d 6164 6520 7072  band but made pr
+000037a0: 6f62 6c65 6d73 2077 6865 6e20 7472 7969  oblems when tryi
+000037b0: 6e67 2074 6f20 7265 706c 6163 6520 7468  ng to replace th
+000037c0: 650d 0a20 2020 2020 2020 2023 206e 6f5f  e..        # no_
+000037d0: 6461 7461 5f76 616c 7565 206f 6620 616e  data_value of an
+000037e0: 2069 6e74 6567 6572 2062 616e 6420 7769   integer band wi
+000037f0: 7468 206e 702e 6e61 6e20 7661 6c75 650d  th np.nan value.
+00003800: 0a20 2020 2020 2020 2023 2064 7479 7065  .        # dtype
+00003810: 203d 2067 6461 6c5f 746f 5f6e 756d 7079   = gdal_to_numpy
+00003820: 5f64 7479 7065 2873 656c 662e 6474 7970  _dtype(self.dtyp
+00003830: 655b 305d 290d 0a20 2020 2020 2020 2069  e[0])..        i
+00003840: 6620 6261 6e64 2069 7320 4e6f 6e65 2061  f band is None a
+00003850: 6e64 2073 656c 662e 6261 6e64 5f63 6f75  nd self.band_cou
+00003860: 6e74 203e 2031 3a0d 0a20 2020 2020 2020  nt > 1:..       
+00003870: 2020 2020 2061 7272 203d 206e 702e 6f6e       arr = np.on
+00003880: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
+00003890: 2020 2020 2028 0d0a 2020 2020 2020 2020       (..        
+000038a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000038b0: 2e62 616e 645f 636f 756e 742c 0d0a 2020  .band_count,..  
+000038c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000038d0: 2020 7365 6c66 2e72 6f77 732c 0d0a 2020    self.rows,..  
+000038e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000038f0: 2020 7365 6c66 2e63 6f6c 756d 6e73 2c0d    self.columns,.
+00003900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003910: 2029 2c0d 0a20 2020 2020 2020 2020 2020   ),..           
+00003920: 2020 2020 2023 2064 7479 7065 3d64 7479       # dtype=dty
+00003930: 7065 0d0a 2020 2020 2020 2020 2020 2020  pe..            
+00003940: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+00003950: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
+00003960: 6c66 2e62 616e 645f 636f 756e 7429 3a0d  lf.band_count):.
+00003970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003980: 2061 7272 5b69 2c20 3a2c 203a 5d20 3d20   arr[i, :, :] = 
+00003990: 7365 6c66 2e5f 7261 7374 6572 2e47 6574  self._raster.Get
+000039a0: 5261 7374 6572 4261 6e64 2869 202b 2031  RasterBand(i + 1
+000039b0: 292e 5265 6164 4173 4172 7261 7928 290d  ).ReadAsArray().
+000039c0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+000039d0: 2020 2020 2020 2020 2020 2020 6966 2062              if b
+000039e0: 616e 6420 6973 204e 6f6e 653a 0d0a 2020  and is None:..  
+000039f0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
+00003a00: 6e64 203d 2030 0d0a 2020 2020 2020 2020  nd = 0..        
+00003a10: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00003a20: 2020 2020 2020 2020 2020 2069 6620 6261             if ba
+00003a30: 6e64 203e 2073 656c 662e 6261 6e64 5f63  nd > self.band_c
+00003a40: 6f75 6e74 202d 2031 3a0d 0a20 2020 2020  ount - 1:..     
+00003a50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00003a60: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00003a70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003a80: 2020 2020 2020 2020 2020 6622 6261 6e64            f"band
+00003a90: 2069 6e64 6578 2073 686f 756c 6420 6265   index should be
+00003aa0: 2062 6574 7765 656e 2030 2061 6e64 207b   between 0 and {
+00003ab0: 7365 6c66 2e62 616e 645f 636f 756e 7420  self.band_count 
+00003ac0: 2d20 317d 220d 0a20 2020 2020 2020 2020  - 1}"..         
+00003ad0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00003ae0: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
+00003af0: 7365 6c66 2e72 6173 7465 722e 4765 7452  self.raster.GetR
+00003b00: 6173 7465 7242 616e 6428 6261 6e64 202b  asterBand(band +
+00003b10: 2031 292e 5265 6164 4173 4172 7261 7928   1).ReadAsArray(
+00003b20: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
+00003b30: 7572 6e20 6172 720d 0a0d 0a20 2020 2064  urn arr....    d
+00003b40: 6566 2070 6c6f 7428 0d0a 2020 2020 2020  ef plot(..      
+00003b50: 2020 7365 6c66 2c0d 0a20 2020 2020 2020    self,..       
+00003b60: 2062 616e 643a 2069 6e74 203d 204e 6f6e   band: int = Non
+00003b70: 652c 0d0a 2020 2020 2020 2020 6578 636c  e,..        excl
+00003b80: 7564 655f 7661 6c75 653a 2041 6e79 203d  ude_value: Any =
+00003b90: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00003ba0: 7267 623a 204c 6973 745b 696e 745d 203d  rgb: List[int] =
+00003bb0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00003bc0: 7375 7266 6163 655f 7265 666c 6563 7461  surface_reflecta
+00003bd0: 6e63 653a 2069 6e74 203d 2031 3030 3030  nce: int = 10000
+00003be0: 2c0d 0a20 2020 2020 2020 2063 7574 6f66  ,..        cutof
+00003bf0: 663a 204c 6973 7420 3d20 4e6f 6e65 2c0d  f: List = None,.
+00003c00: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+00003c10: 732c 0d0a 2020 2020 293a 0d0a 2020 2020  s,..    ):..    
+00003c20: 2020 2020 2222 2252 6561 6420 4172 7261      """Read Arra
+00003c30: 790d 0a0d 0a20 2020 2020 2020 2020 2020  y....           
+00003c40: 202d 2072 6561 6420 7468 6520 7661 6c75   - read the valu
+00003c50: 6573 2073 746f 7265 6420 696e 2061 2067  es stored in a g
+00003c60: 6976 656e 2062 616e 642e 0d0a 0d0a 2020  iven band.....  
+00003c70: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00003c80: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00003c90: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6261  ----..        ba
+00003ca0: 6e64 203a 205b 696e 7465 6765 725d 0d0a  nd : [integer]..
+00003cb0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00003cc0: 6261 6e64 2079 6f75 2077 616e 7420 746f  band you want to
+00003cd0: 2067 6574 2069 7473 2064 6174 612e 2044   get its data. D
+00003ce0: 6566 6175 6c74 2069 7320 300d 0a20 2020  efault is 0..   
+00003cf0: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
+00003d00: 7565 3a20 5b41 6e79 5d0d 0a20 2020 2020  ue: [Any]..     
+00003d10: 2020 2020 2020 2076 616c 7565 2074 6f20         value to 
+00003d20: 6578 6563 6c75 6465 2066 726f 6d20 7468  execlude from th
+00003d30: 6520 706c 6f74 2e20 4465 6661 756c 7420  e plot. Default 
+00003d40: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
+00003d50: 2020 7267 623a 205b 4c69 7374 5d0d 0a20    rgb: [List].. 
+00003d60: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+00003d70: 6c74 2069 7320 5b33 2c32 2c31 5d0d 0a20  lt is [3,2,1].. 
+00003d80: 2020 2020 2020 2073 7572 6661 6365 5f72         surface_r
+00003d90: 6566 6c65 6374 616e 6365 3a20 5b69 6e74  eflectance: [int
+00003da0: 5d0d 0a20 2020 2020 2020 2020 2020 2044  ]..            D
+00003db0: 6566 6175 6c74 2069 7320 2031 3030 3030  efault is  10000
+00003dc0: 0d0a 2020 2020 2020 2020 6375 746f 6666  ..        cutoff
+00003dd0: 3a20 5b4c 6973 745d 0d0a 2020 2020 2020  : [List]..      
+00003de0: 2020 2020 2020 636c 6970 2074 6865 2072        clip the r
+00003df0: 616e 6765 206f 6620 7069 7865 6c20 7661  ange of pixel va
+00003e00: 6c75 6573 2066 6f72 2065 6163 6820 6261  lues for each ba
+00003e10: 6e64 2e20 2874 616b 6520 6f6e 6c79 2074  nd. (take only t
+00003e20: 6865 2070 6978 656c 2076 616c 7565 7320  he pixel values 
+00003e30: 6672 6f6d 2030 2074 6f20 7661 6c75 6520  from 0 to value 
+00003e40: 6f66 2074 6865 2063 7574 6f66 6620 616e  of the cutoff an
+00003e50: 640d 0a20 2020 2020 2020 2020 2020 2073  d..            s
+00003e60: 6361 6c65 2074 6865 6d20 6261 636b 2074  cale them back t
+00003e70: 6f20 6265 7477 6565 6e20 3020 616e 6420  o between 0 and 
+00003e80: 312e 2044 6566 6175 6c74 2069 7320 4e6f  1. Default is No
+00003e90: 6e65 2e0d 0a20 2020 2020 2020 202a 2a6b  ne...        **k
+00003ea0: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
+00003eb0: 2020 2070 6f69 6e74 7320 3a20 5b61 7272     points : [arr
+00003ec0: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
+00003ed0: 2020 2020 2033 2063 6f6c 756d 6e20 6172       3 column ar
+00003ee0: 7261 7920 7769 7468 2074 6865 2066 6972  ray with the fir
+00003ef0: 7374 2063 6f6c 756d 6e20 6173 2074 6865  st column as the
+00003f00: 2076 616c 7565 2079 6f75 2077 616e 7420   value you want 
+00003f10: 746f 2064 6973 706c 6179 2066 6f72 2074  to display for t
+00003f20: 6865 2070 6f69 6e74 2c20 7468 6520 7365  he point, the se
+00003f30: 636f 6e64 2069 7320 7468 6520 726f 7773  cond is the rows
+00003f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003f50: 2020 696e 6465 7820 6f66 2074 6865 2070    index of the p
+00003f60: 6f69 6e74 2069 6e20 7468 6520 6172 7261  oint in the arra
+00003f70: 792c 2061 6e64 2074 6865 2074 6869 7264  y, and the third
+00003f80: 2063 6f6c 756d 6e20 6173 2074 6865 2063   column as the c
+00003f90: 6f6c 756d 6e20 696e 6465 7820 696e 2074  olumn index in t
+00003fa0: 6865 2061 7272 6179 2e0d 0a20 2020 2020  he array...     
+00003fb0: 2020 2020 2020 2020 2020 202d 2074 6865             - the
+00003fc0: 2073 6563 6f6e 6420 616e 6420 7468 6972   second and thir
+00003fd0: 6420 636f 6c75 6d6e 2074 656c 6c73 2074  d column tells t
+00003fe0: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
+00003ff0: 6865 2070 6f69 6e74 2069 6e20 7468 6520  he point in the 
+00004000: 6172 7261 792e 0d0a 2020 2020 2020 2020  array...        
+00004010: 2020 2020 706f 696e 745f 636f 6c6f 723a      point_color:
+00004020: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
+00004030: 2020 2020 2020 2020 636f 6c6f 722e 0d0a          color...
+00004040: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00004050: 745f 7369 7a65 3a20 5b41 6e79 5d0d 0a20  t_size: [Any].. 
+00004060: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00004070: 697a 6520 6f66 2074 6865 2070 6f69 6e74  ize of the point
+00004080: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
+00004090: 6964 5f63 6f6c 6f72 3a20 5b73 7472 5d0d  id_color: [str].
+000040a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000040b0: 2074 6865 2063 6f6c 6f72 206f 6620 7468   the color of th
+000040c0: 6520 616e 6f74 6174 696f 6e20 6f66 2074  e anotation of t
+000040d0: 6865 2070 6f69 6e74 2e20 4465 6661 756c  he point. Defaul
+000040e0: 7420 6973 2062 6c75 652e 0d0a 2020 2020  t is blue...    
+000040f0: 2020 2020 2020 2020 7069 645f 7369 7a65          pid_size
+00004100: 3a20 5b41 6e79 5d0d 0a20 2020 2020 2020  : [Any]..       
+00004110: 2020 2020 2020 2020 2073 697a 6520 6f66           size of
+00004120: 2074 6865 2070 6f69 6e74 2061 6e6e 6f74   the point annot
+00004130: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
+00004140: 2020 2020 6669 6773 697a 6520 3a20 5b74      figsize : [t
+00004150: 7570 6c65 5d2c 206f 7074 696f 6e61 6c0d  uple], optional.
+00004160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004170: 2066 6967 7572 6520 7369 7a65 2e20 5468   figure size. Th
+00004180: 6520 6465 6661 756c 7420 6973 2028 382c  e default is (8,
+00004190: 3829 2e0d 0a20 2020 2020 2020 2020 2020  8)...           
+000041a0: 2074 6974 6c65 203a 205b 7374 725d 2c20   title : [str], 
+000041b0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+000041c0: 2020 2020 2020 2020 2020 7469 746c 6520            title 
+000041d0: 6f66 2074 6865 2070 6c6f 742e 2054 6865  of the plot. The
+000041e0: 2064 6566 6175 6c74 2069 7320 2754 6f74   default is 'Tot
+000041f0: 616c 2044 6973 6368 6172 6765 272e 0d0a  al Discharge'...
+00004200: 2020 2020 2020 2020 2020 2020 7469 746c              titl
+00004210: 655f 7369 7a65 203a 205b 696e 7465 6765  e_size : [intege
+00004220: 725d 2c20 6f70 7469 6f6e 616c 0d0a 2020  r], optional..  
+00004230: 2020 2020 2020 2020 2020 2020 2020 7469                ti
+00004240: 746c 6520 7369 7a65 2e20 5468 6520 6465  tle size. The de
+00004250: 6661 756c 7420 6973 2031 352e 0d0a 2020  fault is 15...  
+00004260: 2020 2020 2020 2020 2020 6f72 6965 6e74            orient
+00004270: 6174 696f 6e20 3a20 5b73 7472 696e 675d  ation : [string]
+00004280: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00004290: 2020 2020 2020 2020 2020 2020 6f72 696e              orin
+000042a0: 7461 7469 6f6e 206f 6620 7468 6520 636f  tation of the co
+000042b0: 6c6f 7262 6172 2068 6f72 697a 6f6e 7461  lorbar horizonta
+000042c0: 6c2f 7665 7274 6963 616c 2e20 5468 6520  l/vertical. The 
+000042d0: 6465 6661 756c 7420 6973 2027 7665 7274  default is 'vert
+000042e0: 6963 616c 272e 0d0a 2020 2020 2020 2020  ical'...        
+000042f0: 2020 2020 726f 7461 7469 6f6e 203a 205b      rotation : [
+00004300: 6e75 6d62 6572 5d2c 206f 7074 696f 6e61  number], optiona
+00004310: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00004320: 2020 2072 6f74 6174 696f 6e20 6f66 2074     rotation of t
+00004330: 6865 2063 6f6c 6f72 6261 7220 6c61 6265  he colorbar labe
+00004340: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
+00004350: 7320 2d39 302e 0d0a 2020 2020 2020 2020  s -90...        
+00004360: 2020 2020 6f72 6965 6e74 6174 696f 6e20      orientation 
+00004370: 3a20 5b73 7472 696e 675d 2c20 6f70 7469  : [string], opti
+00004380: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00004390: 2020 2020 2020 6f72 696e 7461 7469 6f6e        orintation
+000043a0: 206f 6620 7468 6520 636f 6c6f 7262 6172   of the colorbar
+000043b0: 2068 6f72 697a 6f6e 7461 6c2f 7665 7274   horizontal/vert
+000043c0: 6963 616c 2e20 5468 6520 6465 6661 756c  ical. The defaul
+000043d0: 7420 6973 2027 7665 7274 6963 616c 272e  t is 'vertical'.
+000043e0: 0d0a 2020 2020 2020 2020 2020 2020 6362  ..            cb
+000043f0: 6172 5f6c 656e 6774 6820 3a20 5b66 6c6f  ar_length : [flo
+00004400: 6174 5d2c 206f 7074 696f 6e61 6c0d 0a20  at], optional.. 
+00004410: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00004420: 6174 696f 2074 6f20 636f 6e74 726f 6c20  atio to control 
+00004430: 7468 6520 6865 6967 6874 206f 6620 7468  the height of th
+00004440: 6520 636f 6c6f 7262 6172 2e20 5468 6520  e colorbar. The 
+00004450: 6465 6661 756c 7420 6973 2030 2e37 352e  default is 0.75.
+00004460: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
+00004470: 636b 735f 7370 6163 696e 6720 3a20 5b69  cks_spacing : [i
+00004480: 6e74 6567 6572 5d2c 206f 7074 696f 6e61  nteger], optiona
+00004490: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+000044a0: 2020 2053 7061 6369 6e67 2069 6e20 7468     Spacing in th
+000044b0: 6520 636f 6c6f 7262 6172 2074 6963 6b73  e colorbar ticks
+000044c0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+000044d0: 2032 2e0d 0a20 2020 2020 2020 2020 2020   2...           
+000044e0: 2063 6261 725f 6c61 6265 6c5f 7369 7a65   cbar_label_size
+000044f0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+00004500: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00004510: 2020 2020 2020 7369 7a65 206f 6620 7468        size of th
+00004520: 6520 636f 6c6f 7220 6261 7220 6c61 6265  e color bar labe
+00004530: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
+00004540: 7320 3132 2e0d 0a20 2020 2020 2020 2020  s 12...         
+00004550: 2020 2063 6261 725f 6c61 6265 6c20 3a20     cbar_label : 
+00004560: 7374 722c 206f 7074 696f 6e61 6c0d 0a20  str, optional.. 
+00004570: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00004580: 6162 656c 206f 6620 7468 6520 636f 6c6f  abel of the colo
+00004590: 7220 6261 722e 2054 6865 2064 6566 6175  r bar. The defau
+000045a0: 6c74 2069 7320 2744 6973 6368 6172 6765  lt is 'Discharge
+000045b0: 206d 332f 7327 2e0d 0a20 2020 2020 2020   m3/s'...       
+000045c0: 2020 2020 2063 6f6c 6f72 5f73 6361 6c65       color_scale
+000045d0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+000045e0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+000045f0: 2020 2020 2020 7468 6572 6520 6172 6520        there are 
+00004600: 3520 6f70 7469 6f6e 7320 746f 2063 6861  5 options to cha
+00004610: 6e67 6520 7468 6520 7363 616c 6520 6f66  nge the scale of
+00004620: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
+00004630: 2064 6566 6175 6c74 2069 7320 312e 0d0a   default is 1...
+00004640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004650: 312d 2063 6f6c 6f72 5f73 6361 6c65 2031  1- color_scale 1
+00004660: 2069 7320 7468 6520 6e6f 726d 616c 2073   is the normal s
+00004670: 6361 6c65 0d0a 2020 2020 2020 2020 2020  cale..          
+00004680: 2020 2020 2020 322d 2063 6f6c 6f72 5f73        2- color_s
+00004690: 6361 6c65 2032 2069 7320 7468 6520 706f  cale 2 is the po
+000046a0: 7765 7220 7363 616c 650d 0a20 2020 2020  wer scale..     
+000046b0: 2020 2020 2020 2020 2020 2033 2d20 636f             3- co
+000046c0: 6c6f 725f 7363 616c 6520 3320 6973 2074  lor_scale 3 is t
+000046d0: 6865 2053 796d 4c6f 674e 6f72 6d20 7363  he SymLogNorm sc
+000046e0: 616c 650d 0a20 2020 2020 2020 2020 2020  ale..           
+000046f0: 2020 2020 2034 2d20 636f 6c6f 725f 7363       4- color_sc
+00004700: 616c 6520 3420 6973 2074 6865 2050 6f77  ale 4 is the Pow
+00004710: 6572 4e6f 726d 2073 6361 6c65 0d0a 2020  erNorm scale..  
+00004720: 2020 2020 2020 2020 2020 2020 2020 352d                5-
+00004730: 2063 6f6c 6f72 5f73 6361 6c65 2035 2069   color_scale 5 i
+00004740: 7320 7468 6520 426f 756e 6461 7279 4e6f  s the BoundaryNo
+00004750: 726d 2073 6361 6c65 0d0a 2020 2020 2020  rm scale..      
+00004760: 2020 2020 2020 2020 2020 2d2d 2d2d 2d2d            ------
+00004770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004780: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004790: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000047a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+000047b0: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+000047c0: 6d6d 6120 3a20 5b66 6c6f 6174 5d2c 206f  mma : [float], o
+000047d0: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+000047e0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+000047f0: 7565 206e 6565 6465 6420 666f 7220 6f70  ue needed for op
+00004800: 7469 6f6e 2032 202e 2054 6865 2064 6566  tion 2 . The def
+00004810: 6175 6c74 2069 7320 312e 2f32 2e2e 0d0a  ault is 1./2....
+00004820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004830: 6c69 6e65 5f74 6872 6573 686f 6c64 203a  line_threshold :
+00004840: 205b 666c 6f61 745d 2c20 6f70 7469 6f6e   [float], option
+00004850: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+00004860: 2020 2020 2020 2020 7661 6c75 6520 6e65          value ne
+00004870: 6564 6564 2066 6f72 206f 7074 696f 6e20  eded for option 
+00004880: 332e 2054 6865 2064 6566 6175 6c74 2069  3. The default i
+00004890: 7320 302e 3030 3031 2e0d 0a20 2020 2020  s 0.0001...     
+000048a0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+000048b0: 7363 616c 6520 3a20 5b66 6c6f 6174 5d2c  scale : [float],
+000048c0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+000048d0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000048e0: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
+000048f0: 6f70 7469 6f6e 2033 2e20 5468 6520 6465  option 3. The de
+00004900: 6661 756c 7420 6973 2030 2e30 3031 2e0d  fault is 0.001..
+00004910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004920: 2062 6f75 6e64 733a 205b 4c69 7374 5d0d   bounds: [List].
+00004930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004940: 2020 2020 2061 206c 6973 7420 6f66 206e       a list of n
+00004950: 756d 6265 7220 746f 2062 6520 7573 6564  umber to be used
+00004960: 2061 7320 6120 6469 7363 7265 7465 2062   as a discrete b
+00004970: 6f75 6e64 7320 666f 7220 7468 6520 636f  ounds for the co
+00004980: 6c6f 7220 7363 616c 6520 342e 4465 6661  lor scale 4.Defa
+00004990: 756c 7420 6973 204e 6f6e 652c 0d0a 2020  ult is None,..  
+000049a0: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+000049b0: 6470 6f69 6e74 203a 205b 666c 6f61 745d  dpoint : [float]
+000049c0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+000049d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049e0: 7661 6c75 6520 6e65 6564 6564 2066 6f72  value needed for
+000049f0: 206f 7074 696f 6e20 352e 2054 6865 2064   option 5. The d
+00004a00: 6566 6175 6c74 2069 7320 302e 0d0a 2020  efault is 0...  
+00004a10: 2020 2020 2020 2020 2020 2020 2020 2d2d                --
+00004a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004a60: 0d0a 2020 2020 2020 2020 2020 2020 636d  ..            cm
+00004a70: 6170 203a 205b 7374 725d 2c20 6f70 7469  ap : [str], opti
+00004a80: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00004a90: 2020 2020 2020 636f 6c6f 7220 7374 796c        color styl
+00004aa0: 652e 2054 6865 2064 6566 6175 6c74 2069  e. The default i
+00004ab0: 7320 2763 6f6f 6c77 6172 6d5f 7227 2e0d  s 'coolwarm_r'..
+00004ac0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+00004ad0: 706c 6179 5f63 656c 6c5f 7661 6c75 6520  play_cell_value 
+00004ae0: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
+00004af0: 2020 2020 2020 2020 2020 5472 7565 2069            True i
+00004b00: 6620 796f 7520 7761 6e74 2074 6f20 6469  f you want to di
+00004b10: 7370 6c61 7920 7468 6520 7661 6c75 6573  splay the values
+00004b20: 206f 6620 7468 6520 6365 6c6c 7320 6173   of the cells as
+00004b30: 2061 2074 6578 740d 0a20 2020 2020 2020   a text..       
+00004b40: 2020 2020 206e 756d 5f73 697a 6520 3a20       num_size : 
+00004b50: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
+00004b60: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00004b70: 2020 2073 697a 6520 6f66 2074 6865 206e     size of the n
+00004b80: 756d 6265 7273 2070 6c6f 7474 6564 2069  umbers plotted i
+00004b90: 6e74 6f70 206f 6620 6561 6368 2063 656c  ntop of each cel
+00004ba0: 6c73 2e20 5468 6520 6465 6661 756c 7420  ls. The default 
+00004bb0: 6973 2038 2e0d 0a20 2020 2020 2020 2020  is 8...         
+00004bc0: 2020 2062 6163 6b67 726f 756e 645f 636f     background_co
+00004bd0: 6c6f 725f 7468 7265 7368 6f6c 6420 3a20  lor_threshold : 
+00004be0: 5b66 6c6f 6174 2f69 6e74 6567 6572 5d2c  [float/integer],
+00004bf0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+00004c00: 2020 2020 2020 2020 2020 2074 6872 6573             thres
+00004c10: 686f 6c64 2076 616c 7565 2069 6620 7468  hold value if th
+00004c20: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
+00004c30: 656c 6c20 6973 2067 7265 6174 6572 2c20  ell is greater, 
+00004c40: 7468 6520 706c 6f74 7465 640d 0a20 2020  the plotted..   
+00004c50: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00004c60: 6265 7273 2077 696c 6c20 6265 2062 6c61  bers will be bla
+00004c70: 636b 2061 6e64 2069 6620 736d 616c 6c65  ck and if smalle
+00004c80: 7220 7468 6520 706c 6f74 7465 6420 6e75  r the plotted nu
+00004c90: 6d62 6572 2077 696c 6c20 6265 2077 6869  mber will be whi
+00004ca0: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
+00004cb0: 2020 2020 6966 204e 6f6e 6520 6769 7665      if None give
+00004cc0: 6e20 7468 6520 6d61 7876 616c 7565 2f32  n the maxvalue/2
+00004cd0: 2077 696c 6c20 6265 2063 6f6e 7369 6465   will be conside
+00004ce0: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
+00004cf0: 2069 7320 4e6f 6e65 2e0d 0a0d 0a20 2020   is None.....   
+00004d00: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00004d10: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00004d20: 2020 2020 2020 2061 7865 733a 205b 6669         axes: [fi
+00004d30: 6775 7265 2061 7865 735d 2e0d 0a20 2020  gure axes]...   
+00004d40: 2020 2020 2020 2020 2074 6865 2061 7865           the axe
+00004d50: 7320 6f66 2074 6865 206d 6174 706c 6f74  s of the matplot
+00004d60: 6c69 6220 6669 6775 7265 0d0a 2020 2020  lib figure..    
+00004d70: 2020 2020 6669 673a 205b 6d61 7470 6c6f      fig: [matplo
+00004d80: 746c 6962 2066 6967 7572 6520 6f62 6a65  tlib figure obje
+00004d90: 6374 5d0d 0a20 2020 2020 2020 2020 2020  ct]..           
+00004da0: 2074 6865 2066 6967 7572 6520 6f62 6a65   the figure obje
+00004db0: 6374 0d0a 2020 2020 2020 2020 2222 220d  ct..        """.
+00004dc0: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
+00004dd0: 636c 656f 7061 7472 6128 0d0a 2020 2020  cleopatra(..    
+00004de0: 2020 2020 2020 2020 2254 6865 2063 7572          "The cur
+00004df0: 7265 6e74 2066 756e 6372 696f 6e20 7573  rent funcrion us
+00004e00: 6573 2063 6c65 6f70 6174 7261 2070 6163  es cleopatra pac
+00004e10: 6b61 6765 2074 6f20 666f 7220 706c 6f74  kage to for plot
+00004e20: 7469 6e67 2c20 706c 6561 7365 2069 6e73  ting, please ins
+00004e30: 7461 6c6c 2069 7420 6d61 6e75 616c 6c79  tall it manually
+00004e40: 2c20 666f 7220 6d6f 7265 2069 6e66 6f20  , for more info 
+00004e50: 220d 0a20 2020 2020 2020 2020 2020 2022  "..            "
+00004e60: 6368 6563 6b20 6874 7470 733a 2f2f 6769  check https://gi
+00004e70: 7468 7562 2e63 6f6d 2f53 6572 6170 6965  thub.com/Serapie
+00004e80: 756d 2d6f 662d 616c 6578 2f63 6c65 6f70  um-of-alex/cleop
+00004e90: 6174 7261 220d 0a20 2020 2020 2020 2029  atra"..        )
+00004ea0: 0d0a 2020 2020 2020 2020 6672 6f6d 2063  ..        from c
+00004eb0: 6c65 6f70 6174 7261 2e61 7272 6179 2069  leopatra.array i
+00004ec0: 6d70 6f72 7420 4172 7261 790d 0a0d 0a20  mport Array.... 
+00004ed0: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
+00004ee0: 616c 7565 203d 205b 6e70 2e6e 616e 2069  alue = [np.nan i
+00004ef0: 6620 6920 6973 204e 6f6e 6520 656c 7365  f i is None else
+00004f00: 2069 2066 6f72 2069 2069 6e20 7365 6c66   i for i in self
+00004f10: 2e6e 6f5f 6461 7461 5f76 616c 7565 5d0d  .no_data_value].
+00004f20: 0a0d 0a20 2020 2020 2020 2069 6620 6261  ...        if ba
+00004f30: 6e64 2069 7320 4e6f 6e65 3a0d 0a20 2020  nd is None:..   
+00004f40: 2020 2020 2020 2020 2069 6620 7267 6220           if rgb 
+00004f50: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+00004f60: 2020 2020 2020 2020 2020 7267 6220 3d20            rgb = 
+00004f70: 5b33 2c20 322c 2031 5d0d 0a20 2020 2020  [3, 2, 1]..     
+00004f80: 2020 2020 2020 2023 2066 6972 7374 206d         # first m
+00004f90: 616b 6520 7468 6520 6261 6e64 2069 6e64  ake the band ind
+00004fa0: 6578 2074 6865 2066 6972 7374 2062 616e  ex the first ban
+00004fb0: 6420 696e 2074 6865 2072 6762 206c 6973  d in the rgb lis
+00004fc0: 7420 2872 6564 2062 616e 6429 0d0a 2020  t (red band)..  
+00004fd0: 2020 2020 2020 2020 2020 6261 6e64 203d            band =
+00004fe0: 2072 6762 5b30 5d0d 0a20 2020 2020 2020   rgb[0]..       
+00004ff0: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
+00005000: 7565 203d 2028 0d0a 2020 2020 2020 2020  ue = (..        
+00005010: 2020 2020 2020 2020 5b6e 6f5f 6461 7461          [no_data
+00005020: 5f76 616c 7565 5b62 616e 645d 2c20 6578  _value[band], ex
+00005030: 636c 7564 655f 7661 6c75 655d 0d0a 2020  clude_value]..  
+00005040: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00005050: 2065 7863 6c75 6465 5f76 616c 7565 2069   exclude_value i
+00005060: 7320 6e6f 7420 4e6f 6e65 0d0a 2020 2020  s not None..    
+00005070: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00005080: 205b 6e6f 5f64 6174 615f 7661 6c75 655b   [no_data_value[
+00005090: 6261 6e64 5d5d 0d0a 2020 2020 2020 2020  band]]..        
+000050a0: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
+000050b0: 2020 2020 2062 616e 6420 3d20 4e6f 6e65       band = None
+000050c0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+000050d0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+000050e0: 6c75 6465 5f76 616c 7565 203d 2028 0d0a  lude_value = (..
+000050f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005100: 5b73 656c 662e 6e6f 5f64 6174 615f 7661  [self.no_data_va
+00005110: 6c75 655b 6261 6e64 5d2c 2065 7863 6c75  lue[band], exclu
+00005120: 6465 5f76 616c 7565 5d0d 0a20 2020 2020  de_value]..     
+00005130: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
+00005140: 636c 7564 655f 7661 6c75 6520 6973 206e  clude_value is n
+00005150: 6f74 204e 6f6e 650d 0a20 2020 2020 2020  ot None..       
+00005160: 2020 2020 2020 2020 2065 6c73 6520 5b73           else [s
+00005170: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
+00005180: 655b 6261 6e64 5d5d 0d0a 2020 2020 2020  e[band]]..      
+00005190: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+000051a0: 2020 2061 7272 203d 2073 656c 662e 7265     arr = self.re
+000051b0: 6164 5f61 7272 6179 2862 616e 643d 6261  ad_array(band=ba
+000051c0: 6e64 290d 0a20 2020 2020 2020 2063 6c65  nd)..        cle
+000051d0: 6f20 3d20 4172 7261 7928 0d0a 2020 2020  o = Array(..    
+000051e0: 2020 2020 2020 2020 6172 722c 0d0a 2020          arr,..  
+000051f0: 2020 2020 2020 2020 2020 6578 636c 7564            exclud
+00005200: 655f 7661 6c75 653d 6578 636c 7564 655f  e_value=exclude_
+00005210: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
+00005220: 2020 2020 7267 623d 7267 622c 0d0a 2020      rgb=rgb,..  
+00005230: 2020 2020 2020 2020 2020 7375 7266 6163            surfac
+00005240: 655f 7265 666c 6563 7461 6e63 653d 7375  e_reflectance=su
+00005250: 7266 6163 655f 7265 666c 6563 7461 6e63  rface_reflectanc
+00005260: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00005270: 6375 746f 6666 3d63 7574 6f66 662c 0d0a  cutoff=cutoff,..
+00005280: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+00005290: 2020 2066 6967 2c20 6178 203d 2063 6c65     fig, ax = cle
+000052a0: 6f2e 706c 6f74 282a 2a6b 7761 7267 7329  o.plot(**kwargs)
+000052b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000052c0: 2066 6967 2c20 6178 0d0a 0d0a 2020 2020   fig, ax....    
+000052d0: 6465 6620 5f67 6574 5f74 696d 655f 7661  def _get_time_va
+000052e0: 7269 6162 6c65 2873 656c 6629 3a0d 0a20  riable(self):.. 
+000052f0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00005300: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00005310: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00005320: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00005330: 2020 2020 2020 2023 2074 696d 655f 7661         # time_va
+00005340: 7273 203d 205b 2869 2c20 7365 6c66 2e6d  rs = [(i, self.m
+00005350: 6574 615f 6461 7461 2e67 6574 2869 2929  eta_data.get(i))
+00005360: 2066 6f72 2069 2069 6e20 7365 6c66 2e6d   for i in self.m
+00005370: 6574 615f 6461 7461 2e6b 6579 7328 2920  eta_data.keys() 
+00005380: 6966 2069 2e73 7461 7274 7377 6974 6828  if i.startswith(
+00005390: 2274 696d 6522 295d 0d0a 2020 2020 2020  "time")]..      
+000053a0: 2020 2320 7469 6d65 5f76 6172 5f6e 616d    # time_var_nam
+000053b0: 6520 3d20 7469 6d65 5f76 6172 735b 305d  e = time_vars[0]
+000053c0: 5b30 5d2e 7370 6c69 7428 2223 2229 5b30  [0].split("#")[0
+000053d0: 5d0d 0a20 2020 2020 2020 2065 7874 7261  ]..        extra
+000053e0: 5f64 696d 203d 2073 656c 662e 6d65 7461  _dim = self.meta
+000053f0: 5f64 6174 612e 6765 7428 224e 4554 4344  _data.get("NETCD
+00005400: 465f 4449 4d5f 4558 5452 4122 290d 0a20  F_DIM_EXTRA").. 
+00005410: 2020 2020 2020 2069 6620 6578 7472 615f         if extra_
+00005420: 6469 6d20 6973 206e 6f74 204e 6f6e 653a  dim is not None:
+00005430: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
+00005440: 6d65 5f76 6172 5f6e 616d 6520 3d20 6578  me_var_name = ex
+00005450: 7472 615f 6469 6d2e 7265 706c 6163 6528  tra_dim.replace(
+00005460: 227b 222c 2022 2229 2e72 6570 6c61 6365  "{", "").replace
+00005470: 2822 7d22 2c20 2222 290d 0a20 2020 2020  ("}", "")..     
+00005480: 2020 2020 2020 2075 6e69 7473 203d 2073         units = s
+00005490: 656c 662e 6d65 7461 5f64 6174 612e 6765  elf.meta_data.ge
+000054a0: 7428 6622 7b74 696d 655f 7661 725f 6e61  t(f"{time_var_na
+000054b0: 6d65 7d23 756e 6974 7322 290d 0a20 2020  me}#units")..   
+000054c0: 2020 2020 2020 2020 2066 756e 6320 3d20           func = 
+000054d0: 6372 6561 7465 5f74 696d 655f 636f 6e76  create_time_conv
+000054e0: 6572 7369 6f6e 5f66 756e 6328 756e 6974  ersion_func(unit
+000054f0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00005500: 7469 6d65 5f76 616c 7320 3d20 7365 6c66  time_vals = self
+00005510: 2e5f 7265 6164 5f76 6172 6961 626c 6528  ._read_variable(
+00005520: 7469 6d65 5f76 6172 5f6e 616d 6529 0d0a  time_var_name)..
+00005530: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00005540: 5f73 7461 6d70 203d 206c 6973 7428 6d61  _stamp = list(ma
+00005550: 7028 6675 6e63 2c20 7469 6d65 5f76 616c  p(func, time_val
+00005560: 735b 305d 2929 0d0a 2020 2020 2020 2020  s[0]))..        
+00005570: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00005580: 2020 2074 696d 655f 7374 616d 7020 3d20     time_stamp = 
+00005590: 4e6f 6e65 0d0a 2020 2020 2020 2020 7265  None..        re
+000055a0: 7475 726e 2074 696d 655f 7374 616d 700d  turn time_stamp.
+000055b0: 0a0d 0a20 2020 2064 6566 205f 6765 745f  ...    def _get_
+000055c0: 6c61 745f 6c6f 6e28 7365 6c66 293a 0d0a  lat_lon(self):..
+000055d0: 2020 2020 2020 2020 6c6f 6e20 3d20 7365          lon = se
+000055e0: 6c66 2e5f 7265 6164 5f76 6172 6961 626c  lf._read_variabl
+000055f0: 6528 226c 6f6e 2229 0d0a 2020 2020 2020  e("lon")..      
+00005600: 2020 6c61 7420 3d20 7365 6c66 2e5f 7265    lat = self._re
+00005610: 6164 5f76 6172 6961 626c 6528 226c 6174  ad_variable("lat
+00005620: 2229 0d0a 2020 2020 2020 2020 7265 7475  ")..        retu
+00005630: 726e 206c 6174 2c20 6c6f 6e0d 0a0d 0a20  rn lat, lon.... 
+00005640: 2020 2064 6566 205f 7265 6164 5f76 6172     def _read_var
+00005650: 6961 626c 6528 7365 6c66 2c20 7661 723a  iable(self, var:
+00005660: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
+00005670: 7265 7475 726e 2067 6461 6c2e 4f70 656e  return gdal.Open
+00005680: 2866 224e 4554 4344 463a 7b73 656c 662e  (f"NETCDF:{self.
+00005690: 6669 6c65 5f6e 616d 657d 3a7b 7661 727d  file_name}:{var}
+000056a0: 2229 2e52 6561 6441 7341 7272 6179 2829  ").ReadAsArray()
+000056b0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
+000056c0: 6574 686f 640d 0a20 2020 2064 6566 205f  ethod..    def _
+000056d0: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
+000056e0: 7365 7428 0d0a 2020 2020 2020 2020 636f  set(..        co
+000056f0: 6c73 3a20 696e 742c 0d0a 2020 2020 2020  ls: int,..      
+00005700: 2020 726f 7773 3a20 696e 742c 0d0a 2020    rows: int,..  
+00005710: 2020 2020 2020 6261 6e64 733a 2069 6e74        bands: int
+00005720: 2c0d 0a20 2020 2020 2020 2064 7479 7065  ,..        dtype
+00005730: 3a20 696e 742c 0d0a 2020 2020 2020 2020  : int,..        
+00005740: 6472 6976 6572 3a20 7374 7220 3d20 224d  driver: str = "M
+00005750: 454d 222c 0d0a 2020 2020 2020 2020 7061  EM",..        pa
+00005760: 7468 3a20 7374 7220 3d20 4e6f 6e65 2c0d  th: str = None,.
+00005770: 0a20 2020 2029 202d 3e20 6764 616c 2e44  .    ) -> gdal.D
+00005780: 6174 6173 6574 3a0d 0a20 2020 2020 2020  ataset:..       
+00005790: 2022 2222 4372 6561 7465 2047 4441 4c20   """Create GDAL 
+000057a0: 6472 6976 6572 2e0d 0a0d 0a20 2020 2020  driver.....     
+000057b0: 2020 2020 2020 2063 7265 6174 6573 2061         creates a
+000057c0: 2064 7269 7665 7220 616e 6420 7361 7665   driver and save
+000057d0: 2069 7420 746f 2064 6973 6b20 616e 6420   it to disk and 
+000057e0: 696e 206d 656d 6f72 7920 6966 2070 6174  in memory if pat
+000057f0: 6820 6973 206e 6f74 2067 6976 656e 2e0d  h is not given..
+00005800: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00005810: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00005820: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00005830: 2020 2063 6f6c 733a 205b 696e 745d 0d0a     cols: [int]..
+00005840: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00005850: 6572 206f 6620 636f 6c75 6d6e 732e 0d0a  er of columns...
+00005860: 2020 2020 2020 2020 726f 7773 3a20 5b69          rows: [i
+00005870: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
+00005880: 206e 756d 6265 7220 6f66 2072 6f77 732e   number of rows.
+00005890: 0d0a 2020 2020 2020 2020 6261 6e64 733a  ..        bands:
+000058a0: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
+000058b0: 2020 2020 6e75 6d62 6572 206f 6620 6261      number of ba
+000058c0: 6e64 732e 0d0a 2020 2020 2020 2020 6472  nds...        dr
+000058d0: 6976 6572 3a20 5b73 7472 5d0d 0a20 2020  iver: [str]..   
+000058e0: 2020 2020 2020 2020 2064 7269 7665 7220           driver 
+000058f0: 7479 7065 205b 2247 5469 6666 222c 2022  type ["GTiff", "
+00005900: 4d45 4d22 5d2e 0d0a 2020 2020 2020 2020  MEM"]...        
+00005910: 7061 7468 3a20 5b73 7472 5d0d 0a20 2020  path: [str]..   
+00005920: 2020 2020 2020 2020 2070 6174 6820 746f           path to
+00005930: 2073 6176 6520 7468 6520 4754 6966 6620   save the GTiff 
+00005940: 6472 6976 6572 2e0d 0a20 2020 2020 2020  driver...       
+00005950: 2064 7479 7065 3a0d 0a20 2020 2020 2020   dtype:..       
+00005960: 2020 2020 2067 6461 6c20 6461 7461 2074       gdal data t
+00005970: 7970 652c 2075 7365 2074 6865 2066 756e  ype, use the fun
+00005980: 6374 696f 6e73 2069 6e20 7468 6520 7574  ctions in the ut
+00005990: 696c 7320 6d6f 6475 6c65 2074 6f20 6d61  ils module to ma
+000059a0: 7020 6461 7461 2074 7970 6573 2066 726f  p data types fro
+000059b0: 6d20 6e75 6d70 7920 6f72 206f 6772 2074  m numpy or ogr t
+000059c0: 6f20 6764 616c 2e0d 0a0d 0a20 2020 2020  o gdal.....     
+000059d0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+000059e0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+000059f0: 2020 2020 2067 6461 6c20 6472 6976 6572       gdal driver
+00005a00: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00005a10: 2020 2020 2020 2069 6620 7061 7468 3a0d         if path:.
+00005a20: 0a20 2020 2020 2020 2020 2020 2064 7269  .            dri
+00005a30: 7665 7220 3d20 2247 5469 6666 2220 6966  ver = "GTiff" if
+00005a40: 2064 7269 7665 7220 3d3d 2022 4d45 4d22   driver == "MEM"
+00005a50: 2065 6c73 6520 6472 6976 6572 0d0a 2020   else driver..  
+00005a60: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00005a70: 2069 7369 6e73 7461 6e63 6528 7061 7468   isinstance(path
+00005a80: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+00005a90: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00005aa0: 7970 6545 7272 6f72 2822 5468 6520 7061  ypeError("The pa
+00005ab0: 7468 2069 6e70 7574 2073 686f 756c 6420  th input should 
+00005ac0: 6265 2073 7472 696e 6722 290d 0a20 2020  be string")..   
+00005ad0: 2020 2020 2020 2020 2069 6620 6472 6976           if driv
+00005ae0: 6572 203d 3d20 2247 5469 6666 223a 0d0a  er == "GTiff":..
+00005af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b00: 6966 206e 6f74 2070 6174 682e 656e 6473  if not path.ends
+00005b10: 7769 7468 2822 2e74 6966 2229 3a0d 0a20  with(".tif"):.. 
+00005b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b30: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00005b40: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+00005b50: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+00005b60: 6520 7061 7468 2074 6f20 7361 7665 2074  e path to save t
+00005b70: 6865 2063 7265 6174 6564 2072 6173 7465  he created raste
+00005b80: 7220 7368 6f75 6c64 2065 6e64 2077 6974  r should end wit
+00005b90: 6820 2e74 6966 220d 0a20 2020 2020 2020  h .tif"..       
+00005ba0: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+00005bb0: 2020 2020 2020 2020 2020 2020 2320 4c5a              # LZ
+00005bc0: 5720 6973 2061 206c 6f73 736c 6573 7320  W is a lossless 
+00005bd0: 636f 6d70 7265 7373 696f 6e20 6d65 7468  compression meth
+00005be0: 6f64 2061 6368 6965 7665 2074 6865 2068  od achieve the h
+00005bf0: 6967 6873 7420 636f 6d70 7265 7373 696f  ighst compressio
+00005c00: 6e20 6275 7420 7769 7468 206c 6f74 206f  n but with lot o
+00005c10: 6620 636f 6d70 7574 6174 696f 6e0d 0a20  f computation.. 
+00005c20: 2020 2020 2020 2020 2020 2073 7263 203d             src =
+00005c30: 2067 6461 6c2e 4765 7444 7269 7665 7242   gdal.GetDriverB
+00005c40: 794e 616d 6528 6472 6976 6572 292e 4372  yName(driver).Cr
+00005c50: 6561 7465 280d 0a20 2020 2020 2020 2020  eate(..         
+00005c60: 2020 2020 2020 2070 6174 682c 2063 6f6c         path, col
+00005c70: 732c 2072 6f77 732c 2062 616e 6473 2c20  s, rows, bands, 
+00005c80: 6474 7970 652c 205b 2243 4f4d 5052 4553  dtype, ["COMPRES
+00005c90: 533d 4c5a 5722 5d0d 0a20 2020 2020 2020  S=LZW"]..       
+00005ca0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00005cb0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00005cc0: 2020 2023 2066 6f72 206d 656d 6f72 7920     # for memory 
+00005cd0: 6472 6976 6572 730d 0a20 2020 2020 2020  drivers..       
+00005ce0: 2020 2020 2064 7269 7665 7220 3d20 224d       driver = "M
+00005cf0: 454d 220d 0a20 2020 2020 2020 2020 2020  EM"..           
+00005d00: 2073 7263 203d 2067 6461 6c2e 4765 7444   src = gdal.GetD
+00005d10: 7269 7665 7242 794e 616d 6528 6472 6976  riverByName(driv
+00005d20: 6572 292e 4372 6561 7465 2822 222c 2063  er).Create("", c
+00005d30: 6f6c 732c 2072 6f77 732c 2062 616e 6473  ols, rows, bands
+00005d40: 2c20 6474 7970 6529 0d0a 2020 2020 2020  , dtype)..      
+00005d50: 2020 7265 7475 726e 2073 7263 0d0a 0d0a    return src....
+00005d60: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+00005d70: 0d0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
+00005d80: 5f66 726f 6d5f 6172 7261 7928 0d0a 2020  _from_array(..  
+00005d90: 2020 2020 2020 636c 732c 0d0a 2020 2020        cls,..    
+00005da0: 2020 2020 6172 723a 2055 6e69 6f6e 5b73      arr: Union[s
+00005db0: 7472 2c20 6764 616c 2e44 6174 6173 6574  tr, gdal.Dataset
+00005dc0: 2c20 6e70 2e6e 6461 7272 6179 5d2c 0d0a  , np.ndarray],..
+00005dd0: 2020 2020 2020 2020 6765 6f3a 2055 6e69          geo: Uni
+00005de0: 6f6e 5b73 7472 2c20 7475 706c 655d 2c0d  on[str, tuple],.
+00005df0: 0a20 2020 2020 2020 2065 7073 673a 2055  .        epsg: U
+00005e00: 6e69 6f6e 5b73 7472 2c20 696e 745d 2c0d  nion[str, int],.
+00005e10: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
+00005e20: 5f76 616c 7565 3a20 556e 696f 6e5b 416e  _value: Union[An
+00005e30: 792c 206c 6973 745d 203d 2044 4546 4155  y, list] = DEFAU
+00005e40: 4c54 5f4e 4f5f 4441 5441 5f56 414c 5545  LT_NO_DATA_VALUE
+00005e50: 2c0d 0a20 2020 2029 3a0d 0a20 2020 2020  ,..    ):..     
+00005e60: 2020 2022 2222 6372 6561 7465 5f72 6173     """create_ras
+00005e70: 7465 722e 0d0a 0d0a 2020 2020 2020 2020  ter.....        
+00005e80: 2020 2020 2d20 6372 6561 7465 5f72 6173      - create_ras
+00005e90: 7465 7220 6d65 7468 6f64 2063 7265 6174  ter method creat
+00005ea0: 6573 2061 2072 6173 7465 7220 6672 6f6d  es a raster from
+00005eb0: 2061 2067 6976 656e 2061 7272 6179 2061   a given array a
+00005ec0: 6e64 2067 656f 7472 616e 7366 6f72 6d20  nd geotransform 
+00005ed0: 6461 7461 0d0a 2020 2020 2020 2020 2020  data..          
+00005ee0: 2020 616e 6420 7361 7665 2074 6865 2074    and save the t
+00005ef0: 6966 2066 696c 6520 6966 2061 2050 6174  if file if a Pat
+00005f00: 6820 6973 2067 6976 656e 206f 7220 6974  h is given or it
+00005f10: 2077 696c 6c20 7265 7475 726e 2074 6865   will return the
+00005f20: 2067 6461 6c2e 4461 7461 6375 6265 0d0a   gdal.Datacube..
+00005f30: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00005f40: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00005f50: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00005f60: 2020 6172 7220 3a20 5b61 7272 6179 5d2c    arr : [array],
+00005f70: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+00005f80: 2020 2020 2020 206e 756d 7079 2061 7272         numpy arr
+00005f90: 6179 2e20 5468 6520 6465 6661 756c 7420  ay. The default 
+00005fa0: 6973 2027 272e 0d0a 2020 2020 2020 2020  is ''...        
+00005fb0: 6765 6f20 3a20 5b6c 6973 745d 2c20 6f70  geo : [list], op
+00005fc0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+00005fd0: 2020 2020 6765 6f74 7261 6e73 666f 726d      geotransform
+00005fe0: 206c 6973 7420 5b6d 696e 696d 756d 206c   list [minimum l
+00005ff0: 6f6e 2c20 7069 7865 6c73 697a 652c 2072  on, pixelsize, r
+00006000: 6f74 6174 696f 6e2c 206d 6178 696d 756d  otation, maximum
+00006010: 206c 6174 2c20 726f 7461 7469 6f6e 2c0d   lat, rotation,.
+00006020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006030: 2070 6978 656c 7369 7a65 5d2e 2054 6865   pixelsize]. The
+00006040: 2064 6566 6175 6c74 2069 7320 2727 2e0d   default is ''..
+00006050: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
+00006060: 5f76 616c 7565 203a 2054 5950 452c 206f  _value : TYPE, o
+00006070: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+00006080: 2020 2020 2044 4553 4352 4950 5449 4f4e       DESCRIPTION
+00006090: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+000060a0: 202d 3939 3939 2e0d 0a20 2020 2020 2020   -9999...       
+000060b0: 2065 7073 673a 205b 696e 7465 6765 725d   epsg: [integer]
+000060c0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+000060d0: 7465 6765 7220 7265 6665 7265 6e63 6520  teger reference 
+000060e0: 6e75 6d62 6572 2074 6f20 7468 6520 6e65  number to the ne
+000060f0: 7720 7072 6f6a 6563 7469 6f6e 2028 6874  w projection (ht
+00006100: 7470 733a 2f2f 6570 7367 2e69 6f2f 290d  tps://epsg.io/).
+00006110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006120: 2028 6465 6661 756c 7420 3338 3537 2074   (default 3857 t
+00006130: 6865 2072 6566 6572 656e 6365 206e 6f20  he reference no 
+00006140: 6f66 2057 4753 3834 2077 6562 206d 6572  of WGS84 web mer
+00006150: 6361 746f 7220 290d 0a0d 0a20 2020 2020  cator )....     
+00006160: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00006170: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00006180: 2020 2020 2064 7374 203a 205b 4461 7461       dst : [Data
+00006190: 5365 745d 2e0d 0a20 2020 2020 2020 2020  Set]...         
+000061a0: 2020 2044 6174 6173 6574 206f 626a 6563     Dataset objec
+000061b0: 7420 7769 6c6c 2062 6520 7265 7475 726e  t will be return
+000061c0: 6564 2e0d 0a20 2020 2020 2020 2022 2222  ed...        """
+000061d0: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+000061e0: 2861 7272 2e73 6861 7065 2920 3d3d 2032  (arr.shape) == 2
+000061f0: 3a0d 0a20 2020 2020 2020 2020 2020 2062  :..            b
+00006200: 616e 6473 203d 2031 0d0a 2020 2020 2020  ands = 1..      
+00006210: 2020 2020 2020 726f 7773 203d 2069 6e74        rows = int
+00006220: 2861 7272 2e73 6861 7065 5b30 5d29 0d0a  (arr.shape[0])..
+00006230: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00006240: 203d 2069 6e74 2861 7272 2e73 6861 7065   = int(arr.shape
+00006250: 5b31 5d29 0d0a 2020 2020 2020 2020 656c  [1])..        el
+00006260: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00006270: 2062 616e 6473 203d 2061 7272 2e73 6861   bands = arr.sha
+00006280: 7065 5b30 5d0d 0a20 2020 2020 2020 2020  pe[0]..         
+00006290: 2020 2072 6f77 7320 3d20 696e 7428 6172     rows = int(ar
+000062a0: 722e 7368 6170 655b 315d 290d 0a20 2020  r.shape[1])..   
+000062b0: 2020 2020 2020 2020 2063 6f6c 7320 3d20           cols = 
+000062c0: 696e 7428 6172 722e 7368 6170 655b 325d  int(arr.shape[2]
+000062d0: 290d 0a0d 0a20 2020 2020 2020 2064 7479  )....        dty
+000062e0: 7065 203d 206e 756d 7079 5f74 6f5f 6764  pe = numpy_to_gd
+000062f0: 616c 5f64 7479 7065 2861 7272 290d 0a20  al_dtype(arr).. 
+00006300: 2020 2020 2020 2064 7374 5f64 7320 3d20         dst_ds = 
+00006310: 4461 7461 7365 742e 5f63 7265 6174 655f  Dataset._create_
+00006320: 6764 616c 5f64 6174 6173 6574 280d 0a20  gdal_dataset(.. 
+00006330: 2020 2020 2020 2020 2020 2063 6f6c 732c             cols,
+00006340: 2072 6f77 732c 2062 616e 6473 2c20 6474   rows, bands, dt
+00006350: 7970 652c 2064 7269 7665 723d 224d 454d  ype, driver="MEM
+00006360: 222c 2070 6174 683d 4e6f 6e65 0d0a 2020  ", path=None..  
+00006370: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+00006380: 2020 2073 7273 6520 3d20 4461 7461 7365     srse = Datase
+00006390: 742e 5f63 7265 6174 655f 7372 5f66 726f  t._create_sr_fro
+000063a0: 6d5f 6570 7367 2865 7073 673d 6570 7367  m_epsg(epsg=epsg
+000063b0: 290d 0a20 2020 2020 2020 2064 7374 5f64  )..        dst_d
+000063c0: 732e 5365 7450 726f 6a65 6374 696f 6e28  s.SetProjection(
+000063d0: 7372 7365 2e45 7870 6f72 7454 6f57 6b74  srse.ExportToWkt
+000063e0: 2829 290d 0a20 2020 2020 2020 2064 7374  ())..        dst
+000063f0: 5f6f 626a 203d 2063 6c73 2864 7374 5f64  _obj = cls(dst_d
+00006400: 7329 0d0a 2020 2020 2020 2020 6473 745f  s)..        dst_
+00006410: 6f62 6a2e 5f73 6574 5f6e 6f5f 6461 7461  obj._set_no_data
+00006420: 5f76 616c 7565 286e 6f5f 6461 7461 5f76  _value(no_data_v
+00006430: 616c 7565 3d6e 6f5f 6461 7461 5f76 616c  alue=no_data_val
+00006440: 7565 290d 0a0d 0a20 2020 2020 2020 2064  ue)....        d
+00006450: 7374 5f6f 626a 2e72 6173 7465 722e 5365  st_obj.raster.Se
+00006460: 7447 656f 5472 616e 7366 6f72 6d28 6765  tGeoTransform(ge
+00006470: 6f29 0d0a 2020 2020 2020 2020 6966 2062  o)..        if b
+00006480: 616e 6473 203d 3d20 313a 0d0a 2020 2020  ands == 1:..    
+00006490: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
+000064a0: 7261 7374 6572 2e47 6574 5261 7374 6572  raster.GetRaster
+000064b0: 4261 6e64 2831 292e 5772 6974 6541 7272  Band(1).WriteArr
+000064c0: 6179 2861 7272 290d 0a20 2020 2020 2020  ay(arr)..       
+000064d0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000064e0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+000064f0: 6765 2862 616e 6473 293a 0d0a 2020 2020  ge(bands):..    
+00006500: 2020 2020 2020 2020 2020 2020 6473 745f              dst_
+00006510: 6f62 6a2e 7261 7374 6572 2e47 6574 5261  obj.raster.GetRa
+00006520: 7374 6572 4261 6e64 2869 202b 2031 292e  sterBand(i + 1).
+00006530: 5772 6974 6541 7272 6179 2861 7272 5b69  WriteArray(arr[i
+00006540: 2c20 3a2c 203a 5d29 0d0a 0d0a 2020 2020  , :, :])....    
+00006550: 2020 2020 7265 7475 726e 2064 7374 5f6f      return dst_o
+00006560: 626a 0d0a 0d0a 2020 2020 4063 6c61 7373  bj....    @class
+00006570: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00006580: 6461 7461 7365 745f 6c69 6b65 280d 0a20  dataset_like(.. 
+00006590: 2020 2020 2020 2063 6c73 2c0d 0a20 2020         cls,..   
+000065a0: 2020 2020 2073 7263 2c0d 0a20 2020 2020       src,..     
+000065b0: 2020 2061 7272 6179 3a20 6e70 2e6e 6461     array: np.nda
+000065c0: 7272 6179 2c0d 0a20 2020 2020 2020 2064  rray,..        d
+000065d0: 7269 7665 723a 2073 7472 203d 2022 4d45  river: str = "ME
+000065e0: 4d22 2c0d 0a20 2020 2020 2020 2070 6174  M",..        pat
+000065f0: 683a 2073 7472 203d 204e 6f6e 652c 0d0a  h: str = None,..
+00006600: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b67      ) -> Union[g
+00006610: 6461 6c2e 4461 7461 7365 742c 204e 6f6e  dal.Dataset, Non
+00006620: 655d 3a0d 0a20 2020 2020 2020 2022 2222  e]:..        """
+00006630: 7261 7374 6572 4c69 6b65 2e0d 0a0d 0a20  rasterLike..... 
+00006640: 2020 2020 2020 2072 6173 7465 724c 696b         rasterLik
+00006650: 6520 6d65 7468 6f64 2063 7265 6174 6573  e method creates
+00006660: 2061 2047 656f 7469 6666 2072 6173 7465   a Geotiff raste
+00006670: 7220 6c69 6b65 2061 6e6f 7468 6572 2069  r like another i
+00006680: 6e70 7574 2072 6173 7465 722c 206e 6577  nput raster, new
+00006690: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
+000066a0: 2077 696c 6c20 6861 7665 2074 6865 2073   will have the s
+000066b0: 616d 6520 7072 6f6a 6563 7469 6f6e 2c20  ame projection, 
+000066c0: 636f 6f72 6469 6e61 7465 7320 6f72 2074  coordinates or t
+000066d0: 6865 2074 6f70 206c 6566 7420 636f 726e  he top left corn
+000066e0: 6572 206f 6620 7468 6520 6f72 6967 696e  er of the origin
+000066f0: 616c 0d0a 2020 2020 2020 2020 7261 7374  al..        rast
+00006700: 6572 2c20 6365 6c6c 2073 697a 652c 206e  er, cell size, n
+00006710: 6f64 6174 6120 7665 6c75 652c 2061 6e64  odata velue, and
+00006720: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
+00006730: 616e 6420 636f 6c75 6d6e 730d 0a20 2020  and columns..   
+00006740: 2020 2020 2074 6865 2072 6173 7465 7220       the raster 
+00006750: 616e 6420 7468 6520 6465 6d20 7368 6f75  and the dem shou
+00006760: 6c64 2068 6176 6520 7468 6520 7361 6d65  ld have the same
+00006770: 206e 756d 6265 7220 6f66 2063 6f6c 756d   number of colum
+00006780: 6e73 2061 6e64 2072 6f77 730d 0a0d 0a20  ns and rows.... 
+00006790: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000067a0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000067b0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
+000067c0: 7263 203a 205b 6764 616c 2e64 6174 6173  rc : [gdal.datas
+000067d0: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
+000067e0: 2073 6f75 7263 6520 7261 7374 6572 2074   source raster t
+000067f0: 6f20 6765 7420 7468 6520 7370 6174 6961  o get the spatia
+00006800: 6c20 696e 666f 726d 6174 696f 6e0d 0a20  l information.. 
+00006810: 2020 2020 2020 2061 7272 6179 203a 205b         array : [
+00006820: 6e75 6d70 7920 6172 7261 795d 0d0a 2020  numpy array]..  
+00006830: 2020 2020 2020 2020 2020 746f 2073 746f            to sto
+00006840: 7265 2069 6e20 7468 6520 6e65 7720 7261  re in the new ra
+00006850: 7374 6572 0d0a 2020 2020 2020 2020 6472  ster..        dr
+00006860: 6976 6572 3a5b 7374 725d 0d0a 2020 2020  iver:[str]..    
+00006870: 2020 2020 2020 2020 6764 616c 2064 7269          gdal dri
+00006880: 7665 7220 7479 7065 2e20 4465 6661 756c  ver type. Defaul
+00006890: 7420 6973 2022 4754 6966 6622 0d0a 2020  t is "GTiff"..  
+000068a0: 2020 2020 2020 7061 7468 203a 205b 5374        path : [St
+000068b0: 7269 6e67 5d0d 0a20 2020 2020 2020 2020  ring]..         
+000068c0: 2020 2070 6174 6820 746f 2073 6176 6520     path to save 
+000068d0: 7468 6520 6e65 7720 7261 7374 6572 2069  the new raster i
+000068e0: 6e63 6c75 6469 6e67 206e 6577 2072 6173  ncluding new ras
+000068f0: 7465 7220 6e61 6d65 2061 6e64 2065 7874  ter name and ext
+00006900: 656e 7369 6f6e 2028 2e74 6966 290d 0a0d  ension (.tif)...
+00006910: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00006920: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00006930: 2d0d 0a20 2020 2020 2020 204e 6f6e 653a  -..        None:
+00006940: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00006950: 2074 6865 2064 7269 7665 7220 6973 2022   the driver is "
+00006960: 4754 6966 6622 2074 6865 2066 756e 6374  GTiff" the funct
+00006970: 696f 6e20 7769 6c6c 2073 6176 6520 7468  ion will save th
+00006980: 6520 6e65 7720 7261 7374 6572 2074 6f20  e new raster to 
+00006990: 7468 6520 6769 7665 6e20 7061 7468 2e0d  the given path..
+000069a0: 0a20 2020 2020 2020 2044 6174 6163 7562  .        Datacub
+000069b0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000069c0: 6966 2074 6865 2064 7269 7665 7220 6973  if the driver is
+000069d0: 2022 4d45 4d22 2074 6865 2066 756e 6374   "MEM" the funct
+000069e0: 696f 6e20 7769 6c6c 2072 6574 7572 6e20  ion will return 
+000069f0: 7468 6520 6372 6561 7465 6420 7261 7374  the created rast
+00006a00: 6572 2069 6e20 6d65 6d6f 7279 2e0d 0a0d  er in memory....
+00006a10: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00006a20: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00006a30: 2d0d 0a20 2020 2020 2020 203e 3e3e 2061  -..        >>> a
+00006a40: 7272 6179 203d 206e 702e 6c6f 6164 2822  rray = np.load("
+00006a50: 5241 494e 5f35 6b2e 6e70 7922 290d 0a20  RAIN_5k.npy").. 
+00006a60: 2020 2020 2020 203e 3e3e 2073 7263 203d         >>> src =
+00006a70: 2067 6461 6c2e 4f70 656e 2822 4445 4d2e   gdal.Open("DEM.
+00006a80: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
+00006a90: 3e3e 206e 616d 6520 3d20 2272 6169 6e2e  >> name = "rain.
+00006aa0: 7469 6622 0d0a 2020 2020 2020 2020 3e3e  tif"..        >>
+00006ab0: 3e20 4461 7461 7365 742e 6461 7461 7365  > Dataset.datase
+00006ac0: 745f 6c69 6b65 2873 7263 2c20 6172 7261  t_like(src, arra
+00006ad0: 792c 2064 7269 7665 723d 2247 5469 6666  y, driver="GTiff
+00006ae0: 222c 2070 6174 683d 6e61 6d65 290d 0a20  ", path=name).. 
+00006af0: 2020 2020 2020 202d 206f 7220 6372 6561         - or crea
+00006b00: 7465 2061 2072 6173 7465 7220 696e 206d  te a raster in m
+00006b10: 656d 6f72 790d 0a20 2020 2020 2020 203e  emory..        >
+00006b20: 3e3e 2061 7272 6179 203d 206e 702e 6c6f  >> array = np.lo
+00006b30: 6164 2822 5241 494e 5f35 6b2e 6e70 7922  ad("RAIN_5k.npy"
+00006b40: 290d 0a20 2020 2020 2020 203e 3e3e 2073  )..        >>> s
+00006b50: 7263 203d 2067 6461 6c2e 4f70 656e 2822  rc = gdal.Open("
+00006b60: 4445 4d2e 7469 6622 290d 0a20 2020 2020  DEM.tif")..     
+00006b70: 2020 203e 3e3e 2064 7374 203d 2044 6174     >>> dst = Dat
+00006b80: 6173 6574 2e64 6174 6173 6574 5f6c 696b  aset.dataset_lik
+00006b90: 6528 7372 632c 2061 7272 6179 2c20 6472  e(src, array, dr
+00006ba0: 6976 6572 3d22 4d45 4d22 290d 0a20 2020  iver="MEM")..   
+00006bb0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00006bc0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00006bd0: 6e63 6528 6172 7261 792c 206e 702e 6e64  nce(array, np.nd
+00006be0: 6172 7261 7929 3a0d 0a20 2020 2020 2020  array):..       
+00006bf0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00006c00: 7272 6f72 2822 6172 7261 7920 7368 6f75  rror("array shou
+00006c10: 6c64 2062 6520 6f66 2074 7970 6520 6e75  ld be of type nu
+00006c20: 6d70 7920 6172 7261 7922 290d 0a0d 0a20  mpy array").... 
+00006c30: 2020 2020 2020 2069 6620 6c65 6e28 6172         if len(ar
+00006c40: 7261 792e 7368 6170 6529 203d 3d20 323a  ray.shape) == 2:
+00006c50: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+00006c60: 6e64 7320 3d20 310d 0a20 2020 2020 2020  nds = 1..       
+00006c70: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00006c80: 2020 2020 6261 6e64 7320 3d20 6172 7261      bands = arra
+00006c90: 792e 7368 6170 655b 305d 0d0a 0d0a 2020  y.shape[0]....  
+00006ca0: 2020 2020 2020 6474 7970 6520 3d20 6e75        dtype = nu
+00006cb0: 6d70 795f 746f 5f67 6461 6c5f 6474 7970  mpy_to_gdal_dtyp
+00006cc0: 6528 6172 7261 7929 0d0a 0d0a 2020 2020  e(array)....    
+00006cd0: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
+00006ce0: 742e 5f63 7265 6174 655f 6764 616c 5f64  t._create_gdal_d
+00006cf0: 6174 6173 6574 280d 0a20 2020 2020 2020  ataset(..       
+00006d00: 2020 2020 2073 7263 2e63 6f6c 756d 6e73       src.columns
+00006d10: 2c20 7372 632e 726f 7773 2c20 6261 6e64  , src.rows, band
+00006d20: 732c 2064 7479 7065 2c20 6472 6976 6572  s, dtype, driver
+00006d30: 3d64 7269 7665 722c 2070 6174 683d 7061  =driver, path=pa
+00006d40: 7468 0d0a 2020 2020 2020 2020 290d 0a0d  th..        )...
+00006d50: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
+00006d60: 4765 6f54 7261 6e73 666f 726d 2873 7263  GeoTransform(src
+00006d70: 2e67 656f 7472 616e 7366 6f72 6d29 0d0a  .geotransform)..
+00006d80: 2020 2020 2020 2020 6473 742e 5365 7450          dst.SetP
+00006d90: 726f 6a65 6374 696f 6e28 7372 632e 6372  rojection(src.cr
+00006da0: 7329 0d0a 2020 2020 2020 2020 2320 7365  s)..        # se
+00006db0: 7474 696e 6720 7468 6520 4e6f 4461 7461  tting the NoData
+00006dc0: 5661 6c75 6520 646f 6573 206e 6f74 2061  Value does not a
+00006dd0: 6363 6570 7420 646f 7562 6c65 2070 7265  ccept double pre
+00006de0: 6369 7369 6f6e 206e 756d 6265 7273 0d0a  cision numbers..
+00006df0: 2020 2020 2020 2020 6473 745f 6f62 6a20          dst_obj 
+00006e00: 3d20 636c 7328 6473 7429 0d0a 2020 2020  = cls(dst)..    
+00006e10: 2020 2020 6473 745f 6f62 6a2e 5f73 6574      dst_obj._set
+00006e20: 5f6e 6f5f 6461 7461 5f76 616c 7565 286e  _no_data_value(n
+00006e30: 6f5f 6461 7461 5f76 616c 7565 3d73 7263  o_data_value=src
+00006e40: 2e6e 6f5f 6461 7461 5f76 616c 7565 5b30  .no_data_value[0
+00006e50: 5d29 0d0a 0d0a 2020 2020 2020 2020 6473  ])....        ds
+00006e60: 745f 6f62 6a2e 7261 7374 6572 2e47 6574  t_obj.raster.Get
+00006e70: 5261 7374 6572 4261 6e64 2831 292e 5772  RasterBand(1).Wr
+00006e80: 6974 6541 7272 6179 2861 7272 6179 290d  iteArray(array).
+00006e90: 0a20 2020 2020 2020 2069 6620 7061 7468  .        if path
+00006ea0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+00006eb0: 2020 2020 2020 2020 2020 2064 7374 5f6f             dst_o
+00006ec0: 626a 2e72 6173 7465 722e 466c 7573 6843  bj.raster.FlushC
+00006ed0: 6163 6865 2829 0d0a 2020 2020 2020 2020  ache()..        
+00006ee0: 2020 2020 6473 745f 6f62 6a20 3d20 4e6f      dst_obj = No
+00006ef0: 6e65 0d0a 0d0a 2020 2020 2020 2020 7265  ne....        re
+00006f00: 7475 726e 2064 7374 5f6f 626a 0d0a 0d0a  turn dst_obj....
+00006f10: 2020 2020 6465 6620 5f67 6574 5f63 7273      def _get_crs
+00006f20: 2873 656c 6629 202d 3e20 7374 723a 0d0a  (self) -> str:..
+00006f30: 2020 2020 2020 2020 2222 2247 6574 2063          """Get c
+00006f40: 6f6f 7264 696e 6174 6520 7265 6665 7265  oordinate refere
+00006f50: 6e63 6520 7379 7374 656d 2e22 2222 0d0a  nce system."""..
+00006f60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00006f70: 656c 662e 7261 7374 6572 2e47 6574 5072  elf.raster.GetPr
+00006f80: 6f6a 6563 7469 6f6e 2829 0d0a 0d0a 2020  ojection()....  
+00006f90: 2020 6465 6620 7365 745f 6372 7328 7365    def set_crs(se
+00006fa0: 6c66 2c20 6372 733a 204f 7074 696f 6e61  lf, crs: Optiona
+00006fb0: 6c20 3d20 4e6f 6e65 2c20 6570 7367 3a20  l = None, epsg: 
+00006fc0: 696e 7420 3d20 4e6f 6e65 293a 0d0a 2020  int = None):..  
+00006fd0: 2020 2020 2020 2222 2273 6574 5f63 7273        """set_crs
+00006fe0: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
+00006ff0: 2053 6574 2074 6865 2043 6f6f 7264 696e   Set the Coordin
+00007000: 6174 6520 5265 6665 7265 6e63 6520 5379  ate Reference Sy
+00007010: 7374 656d 2028 4352 5329 206f 6620 610d  stem (CRS) of a.
+00007020: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00007030: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00007040: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00007050: 2020 2063 7273 3a20 5b73 7472 5d0d 0a20     crs: [str].. 
+00007060: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+00007070: 6e61 6c20 6966 2065 7073 6720 6973 2073  nal if epsg is s
+00007080: 7065 6369 6669 6564 0d0a 2020 2020 2020  pecified..      
+00007090: 2020 2020 2020 574b 5420 7374 7269 6e67        WKT string
+000070a0: 2e0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+000070b0: 2e65 2e20 2747 454f 4743 535b 2257 4753  .e. 'GEOGCS["WGS
+000070c0: 2038 3422 2c44 4154 554d 5b22 5747 535f   84",DATUM["WGS_
+000070d0: 3139 3834 222c 5350 4845 524f 4944 5b22  1984",SPHEROID["
+000070e0: 5747 5320 3834 222c 3633 3738 3133 372c  WGS 84",6378137,
+000070f0: 3239 382e 3235 3732 3233 3536 332c 4155  298.257223563,AU
+00007100: 5448 4f52 4954 595b 2245 5053 4722 2c22  THORITY["EPSG","
+00007110: 3730 3330 225d 5d2c 0d0a 2020 2020 2020  7030"]],..      
+00007120: 2020 2020 2020 4155 5448 4f52 4954 595b        AUTHORITY[
+00007130: 2245 5053 4722 2c22 3633 3236 225d 5d2c  "EPSG","6326"]],
+00007140: 5052 494d 454d 5b22 4772 6565 6e77 6963  PRIMEM["Greenwic
+00007150: 6822 2c30 2c41 5554 484f 5249 5459 5b22  h",0,AUTHORITY["
+00007160: 4550 5347 222c 2238 3930 3122 5d5d 2c55  EPSG","8901"]],U
+00007170: 4e49 545b 2264 6567 7265 6522 2c0d 0a20  NIT["degree",.. 
+00007180: 2020 2020 2020 2020 2020 2030 2e30 3137             0.017
+00007190: 3435 3332 3932 3531 3939 3433 332c 4155  4532925199433,AU
+000071a0: 5448 4f52 4954 595b 2245 5053 4722 2c22  THORITY["EPSG","
+000071b0: 3931 3232 225d 5d2c 4158 4953 5b22 4c61  9122"]],AXIS["La
+000071c0: 7469 7475 6465 222c 4e4f 5254 485d 2c41  titude",NORTH],A
+000071d0: 5849 535b 224c 6f6e 6769 7475 6465 222c  XIS["Longitude",
+000071e0: 4541 5354 5d2c 4155 5448 4f52 4954 595b  EAST],AUTHORITY[
+000071f0: 2245 5053 4722 2c22 3433 3236 225d 5d27  "EPSG","4326"]]'
+00007200: 0d0a 2020 2020 2020 2020 6570 7367 3a20  ..        epsg: 
+00007210: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
+00007220: 2020 206f 7074 696f 6e61 6c20 6966 2063     optional if c
+00007230: 7273 2069 7320 7370 6563 6966 6965 640d  rs is specified.
+00007240: 0a20 2020 2020 2020 2020 2020 2045 5053  .            EPS
+00007250: 4720 636f 6465 2073 7065 6369 6679 696e  G code specifyin
+00007260: 6720 7468 6520 7072 6f6a 6563 7469 6f6e  g the projection
+00007270: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00007280: 2020 2020 2020 2020 2320 6669 7273 7420          # first 
+00007290: 6368 616e 6765 2074 6865 2070 726f 6a65  change the proje
+000072a0: 6374 696f 6e20 6f66 2074 6865 2067 6461  ction of the gda
+000072b0: 6c20 6461 7461 7365 7420 6f62 6a65 6374  l dataset object
+000072c0: 0d0a 2020 2020 2020 2020 2320 7365 636f  ..        # seco
+000072d0: 6e64 2063 6861 6e67 6520 7468 6520 6570  nd change the ep
+000072e0: 7367 2061 7474 7269 6275 7465 206f 6620  sg attribute of 
+000072f0: 7468 6520 4461 7461 7365 7420 6f62 6a65  the Dataset obje
+00007300: 6374 0d0a 2020 2020 2020 2020 6966 2073  ct..        if s
+00007310: 656c 662e 6472 6976 6572 5f74 7970 6520  elf.driver_type 
+00007320: 3d3d 2022 6173 6369 6922 3a0d 0a20 2020  == "ascii":..   
+00007330: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00007340: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
+00007350: 2020 2020 2020 2020 2020 2022 5365 7474             "Sett
+00007360: 696e 6720 4352 5320 666f 7220 4153 4349  ing CRS for ASCI
+00007370: 4920 6669 6c65 2069 7320 6e6f 7420 706f  I file is not po
+00007380: 7373 6962 6c65 2c20 796f 7520 6361 6e20  ssible, you can 
+00007390: 7361 7665 2074 6865 2066 696c 6573 2074  save the files t
+000073a0: 6f20 6120 6765 6f74 6966 6620 616e 6420  o a geotiff and 
+000073b0: 7468 656e 2072 6573 6574 2074 6865 2063  then reset the c
+000073c0: 7273 220d 0a20 2020 2020 2020 2020 2020  rs"..           
+000073d0: 2029 0d0a 2020 2020 2020 2020 656c 7365   )..        else
+000073e0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+000073f0: 6620 6372 7320 6973 206e 6f74 204e 6f6e  f crs is not Non
+00007400: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00007410: 2020 2020 7365 6c66 2e72 6173 7465 722e      self.raster.
+00007420: 5365 7450 726f 6a65 6374 696f 6e28 6372  SetProjection(cr
+00007430: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00007440: 2020 2020 7365 6c66 2e5f 6570 7367 203d      self._epsg =
+00007450: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
+00007460: 6f6e 2e67 6574 5f65 7073 675f 6672 6f6d  on.get_epsg_from
+00007470: 5f50 726a 2863 7273 290d 0a20 2020 2020  _Prj(crs)..     
+00007480: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00007490: 2020 2020 2020 2020 2020 2020 2020 7372                sr
+000074a0: 203d 2044 6174 6173 6574 2e5f 6372 6561   = Dataset._crea
+000074b0: 7465 5f73 725f 6672 6f6d 5f65 7073 6728  te_sr_from_epsg(
+000074c0: 6570 7367 290d 0a20 2020 2020 2020 2020  epsg)..         
+000074d0: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
+000074e0: 6572 2e53 6574 5072 6f6a 6563 7469 6f6e  er.SetProjection
+000074f0: 2873 722e 4578 706f 7274 546f 576b 7428  (sr.ExportToWkt(
+00007500: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00007510: 2020 2020 7365 6c66 2e5f 6570 7367 203d      self._epsg =
+00007520: 2065 7073 670d 0a0d 0a20 2020 2064 6566   epsg....    def
+00007530: 205f 6765 745f 6570 7367 2873 656c 6629   _get_epsg(self)
+00007540: 202d 3e20 696e 743a 0d0a 2020 2020 2020   -> int:..      
+00007550: 2020 2222 2247 6574 4550 5347 2e0d 0a0d    """GetEPSG....
+00007560: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
+00007570: 7320 6675 6e63 7469 6f6e 2072 6561 6473  s function reads
+00007580: 2074 6865 2070 726f 6a65 6374 696f 6e20   the projection 
+00007590: 6f66 2061 2047 454f 4743 5320 6669 6c65  of a GEOGCS file
+000075a0: 206f 7220 7469 6666 2066 696c 650d 0a0d   or tiff file...
+000075b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000075c0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+000075d0: 2d0d 0a20 2020 2020 2020 2065 7073 6720  -..        epsg 
+000075e0: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
+000075f0: 2020 2020 2020 2020 2065 7073 6720 6e75           epsg nu
+00007600: 6d62 6572 0d0a 2020 2020 2020 2020 2222  mber..        ""
+00007610: 220d 0a20 2020 2020 2020 2070 726a 203d  "..        prj =
+00007620: 2073 656c 662e 5f67 6574 5f63 7273 2829   self._get_crs()
+00007630: 0d0a 2020 2020 2020 2020 6570 7367 203d  ..        epsg =
+00007640: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
+00007650: 6f6e 2e67 6574 5f65 7073 675f 6672 6f6d  on.get_epsg_from
+00007660: 5f50 726a 2870 726a 290d 0a0d 0a20 2020  _Prj(prj)....   
+00007670: 2020 2020 2072 6574 7572 6e20 6570 7367       return epsg
+00007680: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
+00007690: 7661 7269 6162 6c65 7328 7365 6c66 293a  variables(self):
+000076a0: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+000076b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000076c0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+000076d0: 2d0d 0a0d 0a20 2020 2020 2020 2022 2222  -....        """
+000076e0: 0d0a 2020 2020 2020 2020 7661 7269 6162  ..        variab
+000076f0: 6c65 7320 3d20 7b7d 0d0a 2020 2020 2020  les = {}..      
+00007700: 2020 666f 7220 692c 2076 6172 2069 6e20    for i, var in 
+00007710: 656e 756d 6572 6174 6528 7365 6c66 2e73  enumerate(self.s
+00007720: 7562 7365 7473 293a 0d0a 2020 2020 2020  ubsets):..      
+00007730: 2020 2020 2020 6e61 6d65 203d 2076 6172        name = var
+00007740: 5b31 5d2e 7370 6c69 7428 2220 2229 5b31  [1].split(" ")[1
+00007750: 5d0d 0a20 2020 2020 2020 2020 2020 2073  ]..            s
+00007760: 7263 203d 2067 6461 6c2e 4f70 656e 2873  rc = gdal.Open(s
+00007770: 656c 662e 7375 6273 6574 735b 695d 5b30  elf.subsets[i][0
+00007780: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00007790: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+000077a0: 3d20 4461 7461 7365 7428 7372 6329 0d0a  = Dataset(src)..
+000077b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000077c0: 2076 6172 6961 626c 6573 0d0a 0d0a 2020   variables....  
+000077d0: 2020 6465 6620 636f 756e 745f 646f 6d61    def count_doma
+000077e0: 696e 5f63 656c 6c73 2873 656c 6629 3a0d  in_cells(self):.
+000077f0: 0a20 2020 2020 2020 2022 2222 436f 756e  .        """Coun
+00007800: 7420 6365 6c6c 7320 696e 7369 6465 2074  t cells inside t
+00007810: 6865 2064 6f6d 6169 6e0d 0a0d 0a20 2020  he domain....   
+00007820: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00007830: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00007840: 2020 2020 2020 2069 6e74 3a0d 0a20 2020         int:..   
+00007850: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+00007860: 6f66 2063 656c 6c73 0d0a 2020 2020 2020  of cells..      
+00007870: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
+00007880: 2063 6f75 6e74 2063 656c 6c73 2069 6e73   count cells ins
+00007890: 6964 6520 7468 6520 646f 6d61 696e 0d0a  ide the domain..
+000078a0: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
+000078b0: 6c66 2e72 6173 7465 722e 5265 6164 4173  lf.raster.ReadAs
+000078c0: 4172 7261 7928 290d 0a20 2020 2020 2020  Array()..       
+000078d0: 2064 6f6d 6169 6e5f 636f 756e 7420 3d20   domain_count = 
+000078e0: 6e70 2e73 697a 6528 6172 725b 3a2c 203a  np.size(arr[:, :
+000078f0: 5d29 202d 206e 702e 636f 756e 745f 6e6f  ]) - np.count_no
+00007900: 6e7a 6572 6f28 0d0a 2020 2020 2020 2020  nzero(..        
+00007910: 2020 2020 2861 7272 5b6e 702e 6973 636c      (arr[np.iscl
+00007920: 6f73 6528 6172 722c 2073 656c 662e 6e6f  ose(arr, self.no
+00007930: 5f64 6174 615f 7661 6c75 655b 305d 2c20  _data_value[0], 
+00007940: 7274 6f6c 3d30 2e30 3031 295d 290d 0a20  rtol=0.001)]).. 
+00007950: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00007960: 2020 7265 7475 726e 2064 6f6d 6169 6e5f    return domain_
+00007970: 636f 756e 740d 0a0d 0a20 2020 2040 7374  count....    @st
+00007980: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
+00007990: 6465 6620 5f63 7265 6174 655f 7372 5f66  def _create_sr_f
+000079a0: 726f 6d5f 6570 7367 2865 7073 673a 2069  rom_epsg(epsg: i
+000079b0: 6e74 203d 204e 6f6e 6529 202d 3e20 5370  nt = None) -> Sp
+000079c0: 6174 6961 6c52 6566 6572 656e 6365 3a0d  atialReference:.
+000079d0: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
+000079e0: 7465 2061 2073 7061 7469 616c 2072 6566  te a spatial ref
+000079f0: 6572 656e 6365 206f 626a 6563 7420 6672  erence object fr
+00007a00: 6f6d 2065 7073 6720 6e75 6d62 6572 2e0d  om epsg number..
+00007a10: 0a0d 0a20 2020 2020 2020 2068 7474 7073  ...        https
+00007a20: 3a2f 2f67 6461 6c2e 6f72 672f 7475 746f  ://gdal.org/tuto
+00007a30: 7269 616c 732f 6f73 725f 6170 695f 7475  rials/osr_api_tu
+00007a40: 742e 6874 6d6c 0d0a 0d0a 2020 2020 2020  t.html....      
+00007a50: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00007a60: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00007a70: 0d0a 2020 2020 2020 2020 6570 7367 3a20  ..        epsg: 
+00007a80: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
+00007a90: 2020 2065 7073 6720 6e75 6d62 6572 2e0d     epsg number..
+00007aa0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00007ab0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+00007ac0: 2d2d 2d0d 0a20 2020 2020 2020 2053 7061  ---..        Spa
+00007ad0: 7469 616c 5265 6665 7265 6e63 6520 6f62  tialReference ob
+00007ae0: 6a65 6374 0d0a 2020 2020 2020 2020 2222  ject..        ""
+00007af0: 220d 0a20 2020 2020 2020 2073 7220 3d20  "..        sr = 
+00007b00: 6f73 722e 5370 6174 6961 6c52 6566 6572  osr.SpatialRefer
+00007b10: 656e 6365 2829 0d0a 2020 2020 2020 2020  ence()..        
+00007b20: 7372 2e49 6d70 6f72 7446 726f 6d45 5053  sr.ImportFromEPS
+00007b30: 4728 696e 7428 6570 7367 2929 0d0a 0d0a  G(int(epsg))....
+00007b40: 2020 2020 2020 2020 2320 6966 2065 7073          # if eps
+00007b50: 6720 6973 204e 6f6e 653a 0d0a 2020 2020  g is None:..    
+00007b60: 2020 2020 2320 2020 2020 7372 2e53 6574      #     sr.Set
+00007b70: 5765 6c6c 4b6e 6f77 6e47 656f 6743 5328  WellKnownGeogCS(
+00007b80: 2257 4753 3834 2229 0d0a 2020 2020 2020  "WGS84")..      
+00007b90: 2020 2320 656c 7365 3a0d 0a20 2020 2020    # else:..     
+00007ba0: 2020 2023 2020 2020 2074 7279 3a0d 0a20     #     try:.. 
+00007bb0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00007bc0: 2069 6620 6e6f 7420 7372 2e53 6574 5765   if not sr.SetWe
+00007bd0: 6c6c 4b6e 6f77 6e47 656f 6743 5328 6570  llKnownGeogCS(ep
+00007be0: 7367 2920 3d3d 2036 3a0d 0a20 2020 2020  sg) == 6:..     
+00007bf0: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00007c00: 2073 722e 5365 7457 656c 6c4b 6e6f 776e   sr.SetWellKnown
+00007c10: 4765 6f67 4353 2865 7073 6729 0d0a 2020  GeogCS(epsg)..  
+00007c20: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00007c30: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
+00007c40: 2020 2020 2020 2020 2020 2020 2074 7279               try
+00007c50: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+00007c60: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
+00007c70: 496d 706f 7274 4672 6f6d 4550 5347 2869  ImportFromEPSG(i
+00007c80: 6e74 2865 7073 6729 290d 0a20 2020 2020  nt(epsg))..     
+00007c90: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00007ca0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00007cb0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+00007cc0: 2020 2020 7372 2e49 6d70 6f72 7446 726f      sr.ImportFro
+00007cd0: 6d57 6b74 2865 7073 6729 0d0a 2020 2020  mWkt(epsg)..    
+00007ce0: 2020 2020 2320 2020 2020 6578 6365 7074      #     except
+00007cf0: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+00007d00: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00007d10: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00007d20: 2073 722e 496d 706f 7274 4672 6f6d 4550   sr.ImportFromEP
+00007d30: 5347 2869 6e74 2865 7073 6729 290d 0a20  SG(int(epsg)).. 
+00007d40: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00007d50: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00007d60: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+00007d70: 7372 2e49 6d70 6f72 7446 726f 6d57 6b74  sr.ImportFromWkt
+00007d80: 2865 7073 6729 0d0a 2020 2020 2020 2020  (epsg)..        
+00007d90: 7265 7475 726e 2073 720d 0a0d 0a20 2020  return sr....   
+00007da0: 2064 6566 2067 6574 5f62 616e 645f 6e61   def get_band_na
+00007db0: 6d65 7328 7365 6c66 2920 2d3e 204c 6973  mes(self) -> Lis
+00007dc0: 745b 7374 725d 3a0d 0a20 2020 2020 2020  t[str]:..       
+00007dd0: 2022 2222 4765 7420 6261 6e64 206e 616d   """Get band nam
+00007de0: 6573 2066 726f 6d20 6261 6e64 206d 6574  es from band met
+00007df0: 6120 6461 7461 2069 6620 6578 6973 7473  a data if exists
+00007e00: 206f 7468 6572 7769 7365 2077 696c 6c20   otherwise will 
+00007e10: 7265 7475 726e 2069 6465 7820 5b31 2c32  return idex [1,2
+00007e20: 2c20 2e2e 2e5d 0d0a 0d0a 2020 2020 2020  , ...]....      
+00007e30: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00007e40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00007e50: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00007e60: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00007e70: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
+00007e80: 7374 5b73 7472 5d0d 0a20 2020 2020 2020  st[str]..       
+00007e90: 2022 2222 0d0a 2020 2020 2020 2020 6e61   """..        na
+00007ea0: 6d65 7320 3d20 5b5d 0d0a 2020 2020 2020  mes = []..      
+00007eb0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00007ec0: 2831 2c20 7365 6c66 2e72 6173 7465 722e  (1, self.raster.
+00007ed0: 5261 7374 6572 436f 756e 7420 2b20 3129  RasterCount + 1)
+00007ee0: 3a0d 0a20 2020 2020 2020 2020 2020 2062  :..            b
+00007ef0: 616e 645f 6920 3d20 7365 6c66 2e72 6173  and_i = self.ras
+00007f00: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+00007f10: 6428 6929 0d0a 0d0a 2020 2020 2020 2020  d(i)....        
+00007f20: 2020 2020 6966 2062 616e 645f 692e 4765      if band_i.Ge
+00007f30: 7444 6573 6372 6970 7469 6f6e 2829 3a0d  tDescription():.
+00007f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007f50: 2023 2055 7365 2074 6865 2062 616e 645f   # Use the band_
+00007f60: 6920 6465 7363 7269 7074 696f 6e2e 0d0a  i description...
+00007f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007f80: 6e61 6d65 732e 6170 7065 6e64 2862 616e  names.append(ban
+00007f90: 645f 692e 4765 7444 6573 6372 6970 7469  d_i.GetDescripti
+00007fa0: 6f6e 2829 290d 0a20 2020 2020 2020 2020  on())..         
+00007fb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00007fc0: 2020 2020 2020 2020 2020 2320 4368 6563            # Chec
+00007fd0: 6b20 666f 7220 6d65 7465 6461 7461 2e0d  k for metedata..
+00007fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007ff0: 2062 616e 645f 695f 6e61 6d65 203d 2022   band_i_name = "
+00008000: 4261 6e64 5f7b 7d22 2e66 6f72 6d61 7428  Band_{}".format(
+00008010: 6261 6e64 5f69 2e47 6574 4261 6e64 2829  band_i.GetBand()
+00008020: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00008030: 2020 206d 6574 6164 6174 6120 3d20 6261     metadata = ba
+00008040: 6e64 5f69 2e47 6574 4461 7461 7365 7428  nd_i.GetDataset(
+00008050: 292e 4765 744d 6574 6164 6174 615f 4469  ).GetMetadata_Di
+00008060: 6374 2829 0d0a 0d0a 2020 2020 2020 2020  ct()....        
+00008070: 2020 2020 2020 2020 2320 4966 2069 6e20          # If in 
+00008080: 6d65 7461 6461 7461 2c20 7265 7475 726e  metadata, return
+00008090: 2074 6865 206d 6574 6164 6174 6120 656e   the metadata en
+000080a0: 7472 792c 2065 6c73 6520 4261 6e64 5f4e  try, else Band_N
+000080b0: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000080c0: 2020 2069 6620 6261 6e64 5f69 5f6e 616d     if band_i_nam
+000080d0: 6520 696e 206d 6574 6164 6174 6120 616e  e in metadata an
+000080e0: 6420 6d65 7461 6461 7461 5b62 616e 645f  d metadata[band_
+000080f0: 695f 6e61 6d65 5d3a 0d0a 2020 2020 2020  i_name]:..      
+00008100: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+00008110: 6d65 732e 6170 7065 6e64 286d 6574 6164  mes.append(metad
+00008120: 6174 615b 6261 6e64 5f69 5f6e 616d 655d  ata[band_i_name]
+00008130: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00008140: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00008150: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+00008160: 6d65 732e 6170 7065 6e64 2862 616e 645f  mes.append(band_
+00008170: 695f 6e61 6d65 290d 0a0d 0a20 2020 2020  i_name)....     
+00008180: 2020 2072 6574 7572 6e20 6e61 6d65 730d     return names.
+00008190: 0a0d 0a20 2020 2064 6566 205f 6368 6563  ...    def _chec
+000081a0: 6b5f 6e6f 5f64 6174 615f 7661 6c75 6528  k_no_data_value(
+000081b0: 7365 6c66 2c20 6e6f 5f64 6174 615f 7661  self, no_data_va
+000081c0: 6c75 653a 204c 6973 7429 3a0d 0a20 2020  lue: List):..   
+000081d0: 2020 2020 2022 2222 5661 6c69 6461 7465       """Validate
+000081e0: 2054 6865 206e 6f5f 6461 7461 5f76 616c   The no_data_val
+000081f0: 7565 2077 6974 6820 7468 6520 6474 7970  ue with the dtyp
+00008200: 6520 6f66 2074 6865 206f 626a 6563 742e  e of the object.
+00008210: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00008220: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00008230: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00008240: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+00008250: 650d 0a0d 0a20 2020 2020 2020 2052 6574  e....        Ret
+00008260: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+00008270: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206e  -----..        n
+00008280: 6f5f 6461 7461 5f76 616c 7565 3a0d 0a20  o_data_value:.. 
+00008290: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
+000082a0: 7274 2074 6865 206e 6f5f 6461 7461 5f76  rt the no_data_v
+000082b0: 616c 7565 2074 6f20 636f 6d6c 7920 7769  alue to comly wi
+000082c0: 7468 2074 6865 2064 7479 7065 0d0a 2020  th the dtype..  
+000082d0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+000082e0: 2020 2066 6f72 2069 2c20 7661 6c20 696e     for i, val in
+000082f0: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
+00008300: 6474 7970 6529 3a0d 0a20 2020 2020 2020  dtype):..       
+00008310: 2020 2020 2069 6620 6764 616c 5f74 6f5f       if gdal_to_
+00008320: 6e75 6d70 795f 6474 7970 6528 7661 6c29  numpy_dtype(val)
+00008330: 2e5f 5f63 6f6e 7461 696e 735f 5f28 2266  .__contains__("f
+00008340: 6c6f 6174 2229 3a0d 0a20 2020 2020 2020  loat"):..       
+00008350: 2020 2020 2020 2020 206e 6f5f 6461 7461           no_data
+00008360: 5f76 616c 7565 5b69 5d20 3d20 280d 0a20  _value[i] = (.. 
+00008370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008380: 2020 2066 6c6f 6174 286e 6f5f 6461 7461     float(no_data
+00008390: 5f76 616c 7565 5b69 5d29 0d0a 2020 2020  _value[i])..    
+000083a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083b0: 6966 2028 6e6f 5f64 6174 615f 7661 6c75  if (no_data_valu
+000083c0: 655b 695d 2069 7320 6e6f 7420 4e6f 6e65  e[i] is not None
+000083d0: 2061 6e64 206e 6f74 206e 702e 6973 6e61   and not np.isna
+000083e0: 6e28 6e6f 5f64 6174 615f 7661 6c75 655b  n(no_data_value[
+000083f0: 695d 2929 0d0a 2020 2020 2020 2020 2020  i]))..          
+00008400: 2020 2020 2020 2020 2020 656c 7365 204e            else N
+00008410: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
+00008420: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00008430: 2020 2020 656c 6966 2067 6461 6c5f 746f      elif gdal_to
+00008440: 5f6e 756d 7079 5f64 7479 7065 2876 616c  _numpy_dtype(val
+00008450: 292e 5f5f 636f 6e74 6169 6e73 5f5f 2822  ).__contains__("
+00008460: 696e 7422 293a 0d0a 2020 2020 2020 2020  int"):..        
+00008470: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
+00008480: 7661 6c75 655b 695d 203d 2028 0d0a 2020  value[i] = (..  
+00008490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000084a0: 2020 696e 7428 6e6f 5f64 6174 615f 7661    int(no_data_va
+000084b0: 6c75 655b 695d 290d 0a20 2020 2020 2020  lue[i])..       
+000084c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000084d0: 286e 6f5f 6461 7461 5f76 616c 7565 5b69  (no_data_value[i
+000084e0: 5d20 6973 206e 6f74 204e 6f6e 6520 616e  ] is not None an
+000084f0: 6420 6e6f 7420 6e70 2e69 736e 616e 286e  d not np.isnan(n
+00008500: 6f5f 6461 7461 5f76 616c 7565 5b69 5d29  o_data_value[i])
+00008510: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00008520: 2020 2020 2020 2065 6c73 6520 4e6f 6e65         else None
+00008530: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008540: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+00008550: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00008560: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00008570: 7065 4572 726f 7228 224e 6f44 6174 6156  peError("NoDataV
+00008580: 616c 7565 2068 6173 2061 2063 6f6d 706c  alue has a compl
+00008590: 6578 2064 6174 6120 7479 7065 2229 0d0a  ex data type")..
+000085a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000085b0: 206e 6f5f 6461 7461 5f76 616c 7565 0d0a   no_data_value..
+000085c0: 0d0a 2020 2020 6465 6620 5f73 6574 5f6e  ..    def _set_n
+000085d0: 6f5f 6461 7461 5f76 616c 7565 280d 0a20  o_data_value(.. 
+000085e0: 2020 2020 2020 2073 656c 662c 206e 6f5f         self, no_
+000085f0: 6461 7461 5f76 616c 7565 3a20 556e 696f  data_value: Unio
+00008600: 6e5b 416e 792c 206c 6973 745d 203d 2044  n[Any, list] = D
+00008610: 4546 4155 4c54 5f4e 4f5f 4441 5441 5f56  EFAULT_NO_DATA_V
+00008620: 414c 5545 0d0a 2020 2020 293a 0d0a 2020  ALUE..    ):..  
+00008630: 2020 2020 2020 2222 2273 6574 4e6f 4461        """setNoDa
+00008640: 7461 5661 6c75 652e 0d0a 0d0a 2020 2020  taValue.....    
+00008650: 2020 2020 2020 2020 2d20 5365 7420 7468          - Set th
+00008660: 6520 6e6f 2064 6174 6120 7661 6c75 6520  e no data value 
+00008670: 696e 2061 2061 6c6c 2072 6173 7465 7220  in a all raster 
+00008680: 6261 6e64 732e 0d0a 2020 2020 2020 2020  bands...        
+00008690: 2020 2020 2d20 4669 6c6c 7320 7468 6520      - Fills the 
+000086a0: 7768 6f6c 6520 7261 7374 6572 2077 6974  whole raster wit
+000086b0: 6820 7468 6520 6e6f 5f64 6174 615f 7661  h the no_data_va
+000086c0: 6c75 652e 0d0a 2020 2020 2020 2020 2020  lue...          
+000086d0: 2020 2d20 7573 6564 206f 6e6c 7920 7768    - used only wh
+000086e0: 656e 2063 7265 6174 696e 6720 616e 2065  en creating an e
+000086f0: 6d70 7479 2064 7269 7665 722e 0d0a 0d0a  mpty driver.....
+00008700: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00008710: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00008720: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00008730: 6e6f 5f64 6174 615f 7661 6c75 653a 205b  no_data_value: [
+00008740: 6e75 6d65 7269 635d 0d0a 2020 2020 2020  numeric]..      
+00008750: 2020 2020 2020 6e6f 2064 6174 6120 7661        no data va
+00008760: 6c75 6520 746f 2066 696c 6c20 7468 6520  lue to fill the 
+00008770: 6d61 736b 6564 2070 6172 7420 6f66 2074  masked part of t
+00008780: 6865 2061 7272 6179 0d0a 2020 2020 2020  he array..      
+00008790: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
+000087a0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+000087b0: 286e 6f5f 6461 7461 5f76 616c 7565 2c20  (no_data_value, 
+000087c0: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
+000087d0: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+000087e0: 6520 3d20 5b6e 6f5f 6461 7461 5f76 616c  e = [no_data_val
+000087f0: 7565 5d20 2a20 7365 6c66 2e62 616e 645f  ue] * self.band_
+00008800: 636f 756e 740d 0a0d 0a20 2020 2020 2020  count....       
+00008810: 2073 656c 662e 5f63 6865 636b 5f6e 6f5f   self._check_no_
+00008820: 6461 7461 5f76 616c 7565 286e 6f5f 6461  data_value(no_da
+00008830: 7461 5f76 616c 7565 290d 0a0d 0a20 2020  ta_value)....   
+00008840: 2020 2020 2066 6f72 2062 616e 6420 696e       for band in
+00008850: 2072 616e 6765 2873 656c 662e 6261 6e64   range(self.band
+00008860: 5f63 6f75 6e74 293a 0d0a 2020 2020 2020  _count):..      
+00008870: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00008880: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00008890: 2e5f 7365 745f 6e6f 5f64 6174 615f 7661  ._set_no_data_va
+000088a0: 6c75 655f 6261 636b 656e 6428 6261 6e64  lue_backend(band
+000088b0: 2c20 6e6f 5f64 6174 615f 7661 6c75 655b  , no_data_value[
+000088c0: 6261 6e64 5d29 0d0a 2020 2020 2020 2020  band])..        
+000088d0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+000088e0: 7469 6f6e 2061 7320 653a 0d0a 2020 2020  tion as e:..    
+000088f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00008900: 7472 2865 292e 5f5f 636f 6e74 6169 6e73  tr(e).__contains
+00008910: 5f5f 280d 0a20 2020 2020 2020 2020 2020  __(..           
+00008920: 2020 2020 2020 2020 2022 4174 7465 6d70           "Attemp
+00008930: 7420 746f 2077 7269 7465 2074 6f20 7265  t to write to re
+00008940: 6164 206f 6e6c 7920 6461 7461 7365 7420  ad only dataset 
+00008950: 696e 2047 4441 4c52 6173 7465 7242 616e  in GDALRasterBan
+00008960: 643a 3a46 696c 6c28 292e 220d 0a20 2020  d::Fill()."..   
+00008970: 2020 2020 2020 2020 2020 2020 2029 3a0d               ):.
+00008980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008990: 2020 2020 2072 6169 7365 2052 6561 644f       raise ReadO
+000089a0: 6e6c 7945 7272 6f72 280d 0a20 2020 2020  nlyError(..     
+000089b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089c0: 2020 2022 5468 6520 4461 7461 7365 7420     "The Dataset 
+000089d0: 6973 206f 7065 6e20 7769 7468 2061 2072  is open with a r
+000089e0: 6561 6420 6f6e 6c79 2c20 706c 6561 7365  ead only, please
+000089f0: 2072 6561 6420 7468 6520 7261 7374 6572   read the raster
+00008a00: 2075 7369 6e67 2075 7064 6174 6520 220d   using update ".
+00008a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008a20: 2020 2020 2020 2020 2022 6163 6365 7373           "access
+00008a30: 206d 6f64 6522 0d0a 2020 2020 2020 2020   mode"..        
+00008a40: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00008a50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00008a60: 6c69 6620 7374 7228 6529 2e5f 5f63 6f6e  lif str(e).__con
+00008a70: 7461 696e 735f 5f28 0d0a 2020 2020 2020  tains__(..      
+00008a80: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+00008a90: 6e20 6d65 7468 6f64 2027 4261 6e64 5f53  n method 'Band_S
+00008aa0: 6574 4e6f 4461 7461 5661 6c75 6527 2c20  etNoDataValue', 
+00008ab0: 6172 6775 6d65 6e74 2032 206f 6620 7479  argument 2 of ty
+00008ac0: 7065 2027 646f 7562 6c65 2722 0d0a 2020  pe 'double'"..  
+00008ad0: 2020 2020 2020 2020 2020 2020 2020 293a                ):
+00008ae0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008af0: 2020 2020 2020 7365 6c66 2e5f 7365 745f        self._set_
+00008b00: 6e6f 5f64 6174 615f 7661 6c75 655f 6261  no_data_value_ba
+00008b10: 636b 656e 6428 0d0a 2020 2020 2020 2020  ckend(..        
+00008b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b30: 6261 6e64 2c20 6e70 2e66 6c6f 6174 3634  band, np.float64
+00008b40: 286e 6f5f 6461 7461 5f76 616c 7565 5b62  (no_data_value[b
+00008b50: 616e 645d 290d 0a20 2020 2020 2020 2020  and])..         
+00008b60: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00008b70: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00008b80: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00008b90: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
+00008ba0: 6574 5f6e 6f5f 6461 7461 5f76 616c 7565  et_no_data_value
+00008bb0: 5f62 6163 6b65 6e64 2862 616e 642c 2044  _backend(band, D
+00008bc0: 4546 4155 4c54 5f4e 4f5f 4441 5441 5f56  EFAULT_NO_DATA_V
+00008bd0: 414c 5545 290d 0a20 2020 2020 2020 2020  ALUE)..         
+00008be0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+00008bf0: 722e 7761 726e 696e 6728 0d0a 2020 2020  r.warning(..    
+00008c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c10: 2020 2020 2274 6865 2074 7970 6520 6f66      "the type of
+00008c20: 2074 6865 2067 6976 656e 206e 6f5f 6461   the given no_da
+00008c30: 7461 5f76 616c 7565 2064 6966 6665 7273  ta_value differs
+00008c40: 2066 726f 6d20 7468 6520 6474 7970 6520   from the dtype 
+00008c50: 6f66 2074 6865 2072 6173 7465 7222 0d0a  of the raster"..
+00008c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c70: 2020 2020 2020 2020 6622 6e6f 5f64 6174          f"no_dat
+00008c80: 615f 7661 6c75 6520 6e6f 7720 6973 2073  a_value now is s
+00008c90: 6574 2074 6f20 7b44 4546 4155 4c54 5f4e  et to {DEFAULT_N
+00008ca0: 4f5f 4441 5441 5f56 414c 5545 7d20 696e  O_DATA_VALUE} in
+00008cb0: 2074 6865 2072 6173 7465 7222 0d0a 2020   the raster"..  
+00008cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008cd0: 2020 290d 0a0d 0a20 2020 2064 6566 205f    )....    def _
+00008ce0: 6361 6c63 756c 6174 655f 6262 6f78 2873  calculate_bbox(s
+00008cf0: 656c 6629 202d 3e20 4c69 7374 3a0d 0a20  elf) -> List:.. 
+00008d00: 2020 2020 2020 2022 2222 6361 6c63 756c         """calcul
+00008d10: 6174 6520 626f 756e 6469 6e67 2062 6f78  ate bounding box
+00008d20: 2222 220d 0a20 2020 2020 2020 2078 6d69  """..        xmi
+00008d30: 6e2c 2079 6d61 7820 3d20 7365 6c66 2e70  n, ymax = self.p
+00008d40: 6976 6f74 5f70 6f69 6e74 0d0a 2020 2020  ivot_point..    
+00008d50: 2020 2020 796d 696e 203d 2079 6d61 7820      ymin = ymax 
+00008d60: 2d20 7365 6c66 2e72 6f77 7320 2a20 7365  - self.rows * se
+00008d70: 6c66 2e63 656c 6c5f 7369 7a65 0d0a 2020  lf.cell_size..  
+00008d80: 2020 2020 2020 786d 6178 203d 2078 6d69        xmax = xmi
+00008d90: 6e20 2b20 7365 6c66 2e63 6f6c 756d 6e73  n + self.columns
+00008da0: 202a 2073 656c 662e 6365 6c6c 5f73 697a   * self.cell_siz
+00008db0: 650d 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+00008dc0: 6e20 5b78 6d69 6e2c 2079 6d69 6e2c 2078  n [xmin, ymin, x
+00008dd0: 6d61 782c 2079 6d61 785d 0d0a 0d0a 2020  max, ymax]....  
+00008de0: 2020 6465 6620 5f63 616c 6375 6c61 7465    def _calculate
+00008df0: 5f62 6f75 6e64 7328 7365 6c66 2920 2d3e  _bounds(self) ->
+00008e00: 2047 656f 4461 7461 4672 616d 653a 0d0a   GeoDataFrame:..
+00008e10: 2020 2020 2020 2020 2222 2267 6574 2074          """get t
+00008e20: 6865 2062 626f 7820 6173 2061 2067 656f  he bbox as a geo
+00008e30: 6461 7461 6672 616d 6520 7769 7468 2061  dataframe with a
+00008e40: 2070 6f6c 7967 6f6e 2067 656f 6d65 7472   polygon geometr
+00008e50: 7922 2222 0d0a 2020 2020 2020 2020 786d  y"""..        xm
+00008e60: 696e 2c20 796d 696e 2c20 786d 6178 2c20  in, ymin, xmax, 
+00008e70: 796d 6178 203d 2073 656c 662e 5f63 616c  ymax = self._cal
+00008e80: 6375 6c61 7465 5f62 626f 7828 290d 0a20  culate_bbox().. 
+00008e90: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
+00008ea0: 5b28 786d 696e 2c20 796d 6178 292c 2028  [(xmin, ymax), (
+00008eb0: 786d 696e 2c20 796d 696e 292c 2028 786d  xmin, ymin), (xm
+00008ec0: 6178 2c20 796d 696e 292c 2028 786d 6178  ax, ymin), (xmax
+00008ed0: 2c20 796d 6178 295d 0d0a 2020 2020 2020  , ymax)]..      
+00008ee0: 2020 706f 6c79 203d 2046 6561 7475 7265    poly = Feature
+00008ef0: 436f 6c6c 6563 7469 6f6e 2e63 7265 6174  Collection.creat
+00008f00: 655f 706f 6c79 676f 6e28 636f 6f72 6473  e_polygon(coords
+00008f10: 290d 0a20 2020 2020 2020 2067 6466 203d  )..        gdf =
+00008f20: 2067 7064 2e47 656f 4461 7461 4672 616d   gpd.GeoDataFram
+00008f30: 6528 6765 6f6d 6574 7279 3d5b 706f 6c79  e(geometry=[poly
+00008f40: 5d29 0d0a 2020 2020 2020 2020 6764 662e  ])..        gdf.
+00008f50: 7365 745f 6372 7328 6570 7367 3d73 656c  set_crs(epsg=sel
+00008f60: 662e 6570 7367 2c20 696e 706c 6163 653d  f.epsg, inplace=
+00008f70: 5472 7565 290d 0a20 2020 2020 2020 2072  True)..        r
+00008f80: 6574 7572 6e20 6764 660d 0a0d 0a20 2020  eturn gdf....   
+00008f90: 2064 6566 205f 7365 745f 6e6f 5f64 6174   def _set_no_dat
+00008fa0: 615f 7661 6c75 655f 6261 636b 656e 6428  a_value_backend(
+00008fb0: 7365 6c66 2c20 6261 6e64 5f69 3a20 696e  self, band_i: in
+00008fc0: 742c 206e 6f5f 6461 7461 5f76 616c 7565  t, no_data_value
+00008fd0: 3a20 416e 7929 3a0d 0a20 2020 2020 2020  : Any):..       
+00008fe0: 2022 2222 0d0a 2020 2020 2020 2020 2020   """..          
+00008ff0: 2020 2d20 6261 6e64 5f69 2073 7461 7274    - band_i start
+00009000: 7320 6672 6f6d 2030 2074 6f20 7468 6520  s from 0 to the 
+00009010: 6e75 6d62 6572 206f 6620 6261 6e64 732d  number of bands-
+00009020: 312e 0d0a 0d0a 2020 2020 2020 2020 5061  1.....        Pa
+00009030: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00009040: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00009050: 2020 2020 2020 6261 6e64 5f69 3a0d 0a20        band_i:.. 
+00009060: 2020 2020 2020 2020 2020 2062 616e 6420             band 
+00009070: 696e 6465 782c 2073 7461 7274 7320 6672  index, starts fr
+00009080: 6f6d 2030 2e0d 0a20 2020 2020 2020 206e  om 0...        n
+00009090: 6f5f 6461 7461 5f76 616c 7565 3a0d 0a20  o_data_value:.. 
+000090a0: 2020 2020 2020 2020 2020 204e 756d 6572             Numer
+000090b0: 6963 616c 2076 616c 7565 2e0d 0a20 2020  ical value...   
+000090c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000090d0: 2020 2320 6368 6563 6b20 6966 2074 6865    # check if the
+000090e0: 2064 7479 7065 206f 6620 7468 6520 6e6f   dtype of the no
+000090f0: 5f64 6174 615f 7661 6c75 6520 636f 6d70  _data_value comp
+00009100: 6c79 2077 6974 6820 7468 6520 6474 7970  ly with the dtyp
+00009110: 6520 6f66 2074 6865 2072 6173 7465 7220  e of the raster 
+00009120: 6974 7365 6c66 2e0d 0a20 2020 2020 2020  itself...       
+00009130: 206e 6f5f 6474 7970 6520 3d20 7374 7228   no_dtype = str(
+00009140: 7479 7065 286e 6f5f 6461 7461 5f76 616c  type(no_data_val
+00009150: 7565 2929 2e73 706c 6974 2822 2722 295b  ue)).split("'")[
+00009160: 315d 0d0a 2020 2020 2020 2020 706f 7465  1]..        pote
+00009170: 6e74 6961 6c5f 6474 7970 6573 203d 205b  ntial_dtypes = [
+00009180: 0d0a 2020 2020 2020 2020 2020 2020 6920  ..            i 
+00009190: 666f 7220 6920 696e 206c 6973 7428 4e55  for i in list(NU
+000091a0: 4d50 595f 4744 414c 5f44 4154 415f 5459  MPY_GDAL_DATA_TY
+000091b0: 5045 532e 6b65 7973 2829 2920 6966 2069  PES.keys()) if i
+000091c0: 2e5f 5f63 6f6e 7461 696e 735f 5f28 6e6f  .__contains__(no
+000091d0: 5f64 7479 7065 290d 0a20 2020 2020 2020  _dtype)..       
+000091e0: 205d 0d0a 2020 2020 2020 2020 706f 7465   ]..        pote
+000091f0: 6e74 6961 6c5f 6474 7970 6573 203d 205b  ntial_dtypes = [
+00009200: 4e55 4d50 595f 4744 414c 5f44 4154 415f  NUMPY_GDAL_DATA_
+00009210: 5459 5045 532e 6765 7428 6929 2066 6f72  TYPES.get(i) for
+00009220: 2069 2069 6e20 706f 7465 6e74 6961 6c5f   i in potential_
+00009230: 6474 7970 6573 5d0d 0a0d 0a20 2020 2020  dtypes]....     
+00009240: 2020 2069 6620 6e6f 5f64 6174 615f 7661     if no_data_va
+00009250: 6c75 6520 6973 206e 6f74 204e 6f6e 653a  lue is not None:
+00009260: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00009270: 206e 6f74 2073 656c 662e 6474 7970 655b   not self.dtype[
+00009280: 6261 6e64 5f69 5d20 696e 2070 6f74 656e  band_i] in poten
+00009290: 7469 616c 5f64 7479 7065 733a 0d0a 2020  tial_dtypes:..  
+000092a0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000092b0: 6973 6520 4e6f 4461 7461 5661 6c75 6545  ise NoDataValueE
+000092c0: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+000092d0: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
+000092e0: 2064 7479 7065 206f 6620 7468 6520 6769   dtype of the gi
+000092f0: 7665 6e20 6e6f 5f64 6174 615f 7661 6c75  ven no_data_valu
+00009300: 657b 6e6f 5f64 6174 615f 7661 6c75 657d  e{no_data_value}
+00009310: 3a20 7b6e 6f5f 6474 7970 657d 2064 6966  : {no_dtype} dif
+00009320: 6665 7273 2066 726f 6d20 7468 6520 6474  fers from the dt
+00009330: 7970 6520 6f66 2074 6865 2022 0d0a 2020  ype of the "..  
+00009340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009350: 2020 6622 6261 6e64 3a20 7b67 6461 6c5f    f"band: {gdal_
+00009360: 746f 5f6e 756d 7079 5f64 7479 7065 2873  to_numpy_dtype(s
+00009370: 656c 662e 6474 7970 655b 6261 6e64 5f69  elf.dtype[band_i
+00009380: 5d29 7d22 0d0a 2020 2020 2020 2020 2020  ])}"..          
+00009390: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+000093a0: 2020 2073 656c 662e 5f63 6861 6e67 655f     self._change_
+000093b0: 6e6f 5f64 6174 615f 7661 6c75 655f 6174  no_data_value_at
+000093c0: 7472 2862 616e 645f 692c 206e 6f5f 6461  tr(band_i, no_da
+000093d0: 7461 5f76 616c 7565 290d 0a20 2020 2020  ta_value)..     
+000093e0: 2020 2023 2069 6e69 7469 616c 697a 6520     # initialize 
+000093f0: 7468 6520 6261 6e64 2077 6974 6820 7468  the band with th
+00009400: 6520 6e6f 6461 7461 2076 616c 7565 2069  e nodata value i
+00009410: 6e73 7465 6164 206f 6620 300d 0a20 2020  nstead of 0..   
+00009420: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00009430: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
+00009440: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
+00009450: 2862 616e 645f 6920 2b20 3129 2e46 696c  (band_i + 1).Fil
+00009460: 6c28 6e6f 5f64 6174 615f 7661 6c75 6529  l(no_data_value)
+00009470: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+00009480: 2045 7863 6570 7469 6f6e 2061 7320 653a   Exception as e:
+00009490: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000094a0: 2073 7472 2865 292e 5f5f 636f 6e74 6169   str(e).__contai
+000094b0: 6e73 5f5f 2822 2061 7267 756d 656e 7420  ns__(" argument 
+000094c0: 3220 6f66 2074 7970 6520 2764 6f75 626c  2 of type 'doubl
+000094d0: 6527 2229 3a0d 0a20 2020 2020 2020 2020  e'"):..         
+000094e0: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
+000094f0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
+00009500: 2862 616e 645f 6920 2b20 3129 2e46 696c  (band_i + 1).Fil
+00009510: 6c28 6e70 2e66 6c6f 6174 3634 286e 6f5f  l(np.float64(no_
+00009520: 6461 7461 5f76 616c 7565 2929 0d0a 2020  data_value))..  
+00009530: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00009540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009550: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00009560: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00009570: 2020 2020 2020 2020 6622 4661 696c 6564          f"Failed
+00009580: 2074 6f20 6669 6c6c 2074 6865 2062 616e   to fill the ban
+00009590: 6420 7b62 616e 645f 697d 2077 6974 6820  d {band_i} with 
+000095a0: 7661 6c75 653a 207b 6e6f 5f64 6174 615f  value: {no_data_
+000095b0: 7661 6c75 657d 2c20 6265 6361 7573 6520  value}, because 
+000095c0: 6f66 207b 657d 220d 0a20 2020 2020 2020  of {e}"..       
+000095d0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+000095e0: 2020 2020 2320 7570 6461 7465 2074 6865      # update the
+000095f0: 206e 6f5f 6461 7461 5f76 616c 7565 2069   no_data_value i
+00009600: 6e20 7468 6520 4461 7461 7365 7420 6f62  n the Dataset ob
+00009610: 6a65 6374 0d0a 2020 2020 2020 2020 7365  ject..        se
+00009620: 6c66 2e6e 6f5f 6461 7461 5f76 616c 7565  lf.no_data_value
+00009630: 5b62 616e 645f 695d 203d 206e 6f5f 6461  [band_i] = no_da
+00009640: 7461 5f76 616c 7565 0d0a 0d0a 2020 2020  ta_value....    
+00009650: 6465 6620 5f63 6861 6e67 655f 6e6f 5f64  def _change_no_d
+00009660: 6174 615f 7661 6c75 655f 6174 7472 2873  ata_value_attr(s
+00009670: 656c 662c 2062 616e 643a 2069 6e74 2c20  elf, band: int, 
+00009680: 6e6f 5f64 6174 615f 7661 6c75 6529 3a0d  no_data_value):.
+00009690: 0a20 2020 2020 2020 2022 2222 4368 616e  .        """Chan
+000096a0: 6765 2074 6865 206e 6f5f 6461 7461 5f76  ge the no_data_v
+000096b0: 616c 7565 2061 7474 7269 6275 7465 2e0d  alue attribute..
+000096c0: 0a0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
+000096d0: 2043 6861 6e67 6520 6f6e 6c79 2074 6865   Change only the
+000096e0: 206e 6f5f 6461 7461 5f76 616c 7565 2061   no_data_value a
+000096f0: 7474 7269 6275 7465 2069 6e20 7468 6520  ttribute in the 
+00009700: 6764 616c 2044 6174 6163 7562 6520 6f62  gdal Datacube ob
+00009710: 6a65 6374 2e0d 0a20 2020 2020 2020 2020  ject...         
+00009720: 2020 202d 2043 6861 6e67 6520 7468 6520     - Change the 
+00009730: 6e6f 5f64 6174 615f 7661 6c75 6520 696e  no_data_value in
+00009740: 2074 6865 2044 6174 6173 6574 206f 626a   the Dataset obj
+00009750: 6563 7420 666f 7220 7468 6520 6769 7665  ect for the give
+00009760: 6e20 6261 6e64 2069 6e64 6578 2e0d 0a20  n band index... 
+00009770: 2020 2020 2020 2020 2020 202d 2054 6865             - The
+00009780: 2063 6f72 7265 7370 6f6e 6469 6e67 2076   corresponding v
+00009790: 616c 7565 2069 6e20 7468 6520 6172 7261  alue in the arra
+000097a0: 7920 7769 6c6c 206e 6f74 2062 6520 6368  y will not be ch
+000097b0: 616e 6765 642e 0d0a 2020 2020 2020 2020  anged...        
+000097c0: 2020 2020 2d20 4261 6e64 2069 6e64 6578      - Band index
+000097d0: 2073 7461 7274 7320 6672 6f6d 2030 0d0a   starts from 0..
+000097e0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000097f0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00009800: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00009810: 2020 6261 6e64 3a20 5b69 6e74 5d0d 0a20    band: [int].. 
+00009820: 2020 2020 2020 2020 2020 2062 616e 6420             band 
+00009830: 696e 6465 7820 7374 6172 7473 2066 726f  index starts fro
+00009840: 6d20 302e 0d0a 2020 2020 2020 2020 6e6f  m 0...        no
+00009850: 5f64 6174 615f 7661 6c75 653a 205b 416e  _data_value: [An
+00009860: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
+00009870: 6e6f 2064 6174 6120 7661 6c75 652e 0d0a  no data value...
+00009880: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00009890: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+000098a0: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
+000098b0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
+000098c0: 2862 616e 6420 2b20 3129 2e53 6574 4e6f  (band + 1).SetNo
+000098d0: 4461 7461 5661 6c75 6528 6e6f 5f64 6174  DataValue(no_dat
+000098e0: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
+000098f0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+00009900: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
+00009910: 2020 2020 2020 6966 2073 7472 2865 292e        if str(e).
+00009920: 5f5f 636f 6e74 6169 6e73 5f5f 280d 0a20  __contains__(.. 
+00009930: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00009940: 4174 7465 6d70 7420 746f 2077 7269 7465  Attempt to write
+00009950: 2074 6f20 7265 6164 206f 6e6c 7920 6461   to read only da
+00009960: 7461 7365 7420 696e 2047 4441 4c52 6173  taset in GDALRas
+00009970: 7465 7242 616e 643a 3a46 696c 6c28 292e  terBand::Fill().
+00009980: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
+00009990: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000099a0: 2020 2072 6169 7365 2052 6561 644f 6e6c     raise ReadOnl
+000099b0: 7945 7272 6f72 280d 0a20 2020 2020 2020  yError(..       
+000099c0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+000099d0: 6520 4461 7461 7365 7420 6973 206f 7065  e Dataset is ope
+000099e0: 6e20 7769 7468 2061 2072 6561 6420 6f6e  n with a read on
+000099f0: 6c79 2c20 706c 6561 7365 2072 6561 6420  ly, please read 
+00009a00: 7468 6520 7261 7374 6572 2075 7369 6e67  the raster using
+00009a10: 2075 7064 6174 6520 220d 0a20 2020 2020   update "..     
+00009a20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00009a30: 6163 6365 7373 206d 6f64 6522 0d0a 2020  access mode"..  
+00009a40: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00009a50: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00009a60: 6620 7374 7228 6529 2e5f 5f63 6f6e 7461  f str(e).__conta
+00009a70: 696e 735f 5f28 0d0a 2020 2020 2020 2020  ins__(..        
+00009a80: 2020 2020 2020 2020 2269 6e20 6d65 7468          "in meth
+00009a90: 6f64 2027 4261 6e64 5f53 6574 4e6f 4461  od 'Band_SetNoDa
+00009aa0: 7461 5661 6c75 6527 2c20 6172 6775 6d65  taValue', argume
+00009ab0: 6e74 2032 206f 6620 7479 7065 2027 646f  nt 2 of type 'do
+00009ac0: 7562 6c65 2722 0d0a 2020 2020 2020 2020  uble'"..        
+00009ad0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+00009ae0: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
+00009af0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+00009b00: 6428 6261 6e64 202b 2031 292e 5365 744e  d(band + 1).SetN
+00009b10: 6f44 6174 6156 616c 7565 280d 0a20 2020  oDataValue(..   
+00009b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b30: 206e 702e 666c 6f61 7436 3428 6e6f 5f64   np.float64(no_d
+00009b40: 6174 615f 7661 6c75 6529 0d0a 2020 2020  ata_value)..    
+00009b50: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00009b60: 2020 2020 2020 2073 656c 662e 5f6e 6f5f         self._no_
+00009b70: 6461 7461 5f76 616c 7565 5b62 616e 645d  data_value[band]
+00009b80: 203d 206e 6f5f 6461 7461 5f76 616c 7565   = no_data_value
+00009b90: 0d0a 0d0a 2020 2020 6465 6620 6368 616e  ....    def chan
+00009ba0: 6765 5f6e 6f5f 6461 7461 5f76 616c 7565  ge_no_data_value
+00009bb0: 2873 656c 662c 206e 6577 5f76 616c 7565  (self, new_value
+00009bc0: 3a20 416e 792c 206f 6c64 5f76 616c 7565  : Any, old_value
+00009bd0: 3a20 416e 7920 3d20 4e6f 6e65 293a 0d0a  : Any = None):..
+00009be0: 2020 2020 2020 2020 2222 2243 6861 6e67          """Chang
+00009bf0: 6520 4e6f 2044 6174 6120 5661 6c75 652e  e No Data Value.
+00009c00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00009c10: 2d20 5365 7420 7468 6520 6e6f 2064 6174  - Set the no dat
+00009c20: 6120 7661 6c75 6520 696e 2061 2061 6c6c  a value in a all
+00009c30: 2072 6173 7465 7220 6261 6e64 732e 0d0a   raster bands...
+00009c40: 2020 2020 2020 2020 2020 2020 2d20 4669              - Fi
+00009c50: 6c6c 7320 7468 6520 7768 6f6c 6520 7261  lls the whole ra
+00009c60: 7374 6572 2077 6974 6820 7468 6520 6e6f  ster with the no
+00009c70: 5f64 6174 615f 7661 6c75 652e 0d0a 2020  _data_value...  
+00009c80: 2020 2020 2020 2020 2020 2d20 4368 616e            - Chan
+00009c90: 6765 2074 6865 206e 6f5f 6461 7461 5f76  ge the no_data_v
+00009ca0: 616c 7565 2069 6e20 7468 6520 6172 7261  alue in the arra
+00009cb0: 7920 696e 2061 6c6c 2062 616e 6473 2e0d  y in all bands..
+00009cc0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00009cd0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00009ce0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00009cf0: 2020 206e 6577 5f76 616c 7565 3a20 5b6e     new_value: [n
+00009d00: 756d 6572 6963 5d0d 0a20 2020 2020 2020  umeric]..       
+00009d10: 2020 2020 206e 6f20 6461 7461 2076 616c       no data val
+00009d20: 7565 2074 6f20 7365 7420 696e 2074 6865  ue to set in the
+00009d30: 2072 6173 7465 7220 6261 6e64 732e 0d0a   raster bands...
+00009d40: 0d0a 2020 2020 2020 2020 6f6c 645f 7661  ..        old_va
+00009d50: 6c75 653a 205b 6e75 6d65 7269 635d 0d0a  lue: [numeric]..
+00009d60: 2020 2020 2020 2020 2020 2020 6f6c 6420              old 
+00009d70: 6e6f 2064 6174 6120 7661 6c75 6520 7468  no data value th
+00009d80: 6174 2061 7265 2061 6c72 6561 6479 2069  at are already i
+00009d90: 6e20 7468 6520 7261 7374 6572 2062 616e  n the raster ban
+00009da0: 6473 2e0d 0a20 2020 2020 2020 2022 2222  ds...        """
+00009db0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00009dc0: 2069 7369 6e73 7461 6e63 6528 6e65 775f   isinstance(new_
+00009dd0: 7661 6c75 652c 206c 6973 7429 3a0d 0a20  value, list):.. 
+00009de0: 2020 2020 2020 2020 2020 206e 6577 5f76             new_v
+00009df0: 616c 7565 203d 205b 6e65 775f 7661 6c75  alue = [new_valu
+00009e00: 655d 202a 2073 656c 662e 6261 6e64 5f63  e] * self.band_c
+00009e10: 6f75 6e74 0d0a 0d0a 2020 2020 2020 2020  ount....        
+00009e20: 6966 206f 6c64 5f76 616c 7565 2069 7320  if old_value is 
+00009e30: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
+00009e40: 2069 7369 6e73 7461 6e63 6528 6f6c 645f   isinstance(old_
+00009e50: 7661 6c75 652c 206c 6973 7429 3a0d 0a20  value, list):.. 
+00009e60: 2020 2020 2020 2020 2020 206f 6c64 5f76             old_v
+00009e70: 616c 7565 203d 205b 6f6c 645f 7661 6c75  alue = [old_valu
+00009e80: 655d 202a 2073 656c 662e 6261 6e64 5f63  e] * self.band_c
+00009e90: 6f75 6e74 0d0a 0d0a 2020 2020 2020 2020  ount....        
+00009ea0: 6473 7420 3d20 6764 616c 2e47 6574 4472  dst = gdal.GetDr
+00009eb0: 6976 6572 4279 4e61 6d65 2822 4d45 4d22  iverByName("MEM"
+00009ec0: 292e 4372 6561 7465 436f 7079 2822 222c  ).CreateCopy("",
+00009ed0: 2073 656c 662e 7261 7374 6572 2c20 3029   self.raster, 0)
+00009ee0: 0d0a 2020 2020 2020 2020 2320 6372 6561  ..        # crea
+00009ef0: 7465 2061 206e 6577 2064 6174 6173 6574  te a new dataset
+00009f00: 0d0a 2020 2020 2020 2020 6e65 775f 6461  ..        new_da
+00009f10: 7461 7365 7420 3d20 4461 7461 7365 7428  taset = Dataset(
+00009f20: 6473 7429 0d0a 2020 2020 2020 2020 6e65  dst)..        ne
+00009f30: 775f 6461 7461 7365 742e 5f73 6574 5f6e  w_dataset._set_n
+00009f40: 6f5f 6461 7461 5f76 616c 7565 286e 6577  o_data_value(new
+00009f50: 5f76 616c 7565 290d 0a0d 0a20 2020 2020  _value)....     
+00009f60: 2020 2066 6f72 2062 616e 6420 696e 2072     for band in r
+00009f70: 616e 6765 2873 656c 662e 6261 6e64 5f63  ange(self.band_c
+00009f80: 6f75 6e74 293a 0d0a 2020 2020 2020 2020  ount):..        
+00009f90: 2020 2020 6172 7220 3d20 7365 6c66 2e72      arr = self.r
+00009fa0: 6561 645f 6172 7261 7928 6261 6e64 290d  ead_array(band).
+00009fb0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+00009fc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00009fd0: 2020 2061 7272 5b6e 702e 6973 636c 6f73     arr[np.isclos
+00009fe0: 6528 6172 722c 206f 6c64 5f76 616c 7565  e(arr, old_value
+00009ff0: 2c20 7274 6f6c 3d30 2e30 3031 295d 203d  , rtol=0.001)] =
+0000a000: 206e 6577 5f76 616c 7565 5b62 616e 645d   new_value[band]
+0000a010: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+0000a020: 6365 7074 2054 7970 6545 7272 6f72 3a0d  cept TypeError:.
+0000a030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a040: 2072 6169 7365 204e 6f44 6174 6156 616c   raise NoDataVal
+0000a050: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
+0000a060: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000a070: 5468 6520 6474 7970 6520 6f66 2074 6865  The dtype of the
+0000a080: 2067 6976 656e 206e 6f5f 6461 7461 5f76   given no_data_v
+0000a090: 616c 7565 3a20 7b6e 6577 5f76 616c 7565  alue: {new_value
+0000a0a0: 5b62 616e 645d 7d20 6469 6666 6572 7320  [band]} differs 
+0000a0b0: 6672 6f6d 2074 6865 2064 7479 7065 206f  from the dtype o
+0000a0c0: 6620 7468 6520 220d 0a20 2020 2020 2020  f the "..       
+0000a0d0: 2020 2020 2020 2020 2020 2020 2066 2262               f"b
+0000a0e0: 616e 643a 207b 6764 616c 5f74 6f5f 6e75  and: {gdal_to_nu
+0000a0f0: 6d70 795f 6474 7970 6528 7365 6c66 2e64  mpy_dtype(self.d
+0000a100: 7479 7065 5b62 616e 645d 297d 220d 0a20  type[band])}".. 
+0000a110: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000a120: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
+0000a130: 775f 6461 7461 7365 742e 7261 7374 6572  w_dataset.raster
+0000a140: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
+0000a150: 616e 6420 2b20 3129 2e57 7269 7465 4172  and + 1).WriteAr
+0000a160: 7261 7928 6172 7229 0d0a 0d0a 2020 2020  ray(arr)....    
+0000a170: 2020 2020 7365 6c66 2e5f 5f69 6e69 745f      self.__init_
+0000a180: 5f28 6e65 775f 6461 7461 7365 742e 7261  _(new_dataset.ra
+0000a190: 7374 6572 290d 0a0d 0a20 2020 2064 6566  ster)....    def
+0000a1a0: 2067 6574 5f63 656c 6c5f 636f 6f72 6473   get_cell_coords
+0000a1b0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
+0000a1c0: 206c 6f63 6174 696f 6e3a 2073 7472 203d   location: str =
+0000a1d0: 2022 6365 6e74 6572 222c 206d 6173 6b3a   "center", mask:
+0000a1e0: 2062 6f6f 6c20 3d20 4661 6c73 650d 0a20   bool = False.. 
+0000a1f0: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+0000a200: 6179 3a0d 0a20 2020 2020 2020 2022 2222  ay:..        """
+0000a210: 4765 7443 6f6f 7264 732e 0d0a 0d0a 2020  GetCoords.....  
+0000a220: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
+0000a230: 6520 636f 6f72 6469 6e61 7465 7320 6f66  e coordinates of
+0000a240: 2074 6865 2063 656c 6c20 6365 6e74 7265   the cell centre
+0000a250: 7320 696e 7369 6465 2074 6865 2064 6f6d  s inside the dom
+0000a260: 6169 6e20 286f 6e6c 7920 7468 6520 6365  ain (only the ce
+0000a270: 6c6c 7320 7468 6174 0d0a 2020 2020 2020  lls that..      
+0000a280: 2020 646f 6573 206e 6f74 2068 6176 6520    does not have 
+0000a290: 6e6f 6461 7461 2076 616c 7565 290d 0a0d  nodata value)...
+0000a2a0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000a2b0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0000a2c0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0000a2d0: 206c 6f63 6174 696f 6e3a 205b 7374 725d   location: [str]
+0000a2e0: 0d0a 2020 2020 2020 2020 2020 2020 6c6f  ..            lo
+0000a2f0: 6361 7469 6f6e 206f 6620 7468 6520 636f  cation of the co
+0000a300: 6f72 6469 6e61 7465 7320 2263 656e 7465  ordinates "cente
+0000a310: 7222 2066 6f72 2074 6865 2063 656e 7465  r" for the cente
+0000a320: 7220 6f66 2061 2063 656c 6c2c 2063 6f72  r of a cell, cor
+0000a330: 6e65 7220 666f 7220 7468 6520 636f 726e  ner for the corn
+0000a340: 6572 206f 6620 7468 6520 6365 6c6c 2e0d  er of the cell..
+0000a350: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+0000a360: 2063 6f72 6e65 7220 6973 2074 6865 2074   corner is the t
+0000a370: 6f70 206c 6566 7420 636f 726e 6572 2e0d  op left corner..
+0000a380: 0a20 2020 2020 2020 206d 6173 6b3a 205b  .        mask: [
+0000a390: 626f 6f6c 5d0d 0a20 2020 2020 2020 2020  bool]..         
+0000a3a0: 2020 2054 7275 6520 746f 2045 7865 636c     True to Execl
+0000a3b0: 7564 6520 7468 6520 6365 6c6c 7320 6f75  ude the cells ou
+0000a3c0: 7420 6f66 2074 6865 2064 6f61 696e 2e20  t of the doain. 
+0000a3d0: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
+0000a3e0: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
+0000a3f0: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+0000a400: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
+0000a410: 6f6f 7264 7320 3a20 5b6e 702e 6e64 6172  oords : [np.ndar
+0000a420: 7261 795d 0d0a 2020 2020 2020 2020 2020  ray]..          
+0000a430: 2020 4172 7261 7920 7769 7468 2061 206c    Array with a l
+0000a440: 6973 7420 6f66 2074 6865 2063 6f6f 7264  ist of the coord
+0000a450: 696e 6174 6573 2074 6f20 6265 2069 6e74  inates to be int
+0000a460: 6572 706f 6c61 7465 642c 2077 6974 686f  erpolated, witho
+0000a470: 7574 2074 6865 204e 616e 0d0a 2020 2020  ut the Nan..    
+0000a480: 2020 2020 6d61 745f 7261 6e67 6520 3a20      mat_range : 
+0000a490: 5b6e 702e 6e64 6172 7261 795d 0d0a 2020  [np.ndarray]..  
+0000a4a0: 2020 2020 2020 2020 2020 4172 7261 7920            Array 
+0000a4b0: 7769 7468 2061 6c6c 2074 6865 2063 656e  with all the cen
+0000a4c0: 7472 6573 206f 6620 6365 6c6c 7320 696e  tres of cells in
+0000a4d0: 2074 6865 2064 6f6d 6169 6e20 6f66 2074   the domain of t
+0000a4e0: 6865 2044 454d 0d0a 2020 2020 2020 2020  he DEM..        
+0000a4f0: 2222 220d 0a20 2020 2020 2020 2023 2063  """..        # c
+0000a500: 6865 636b 2074 6865 206c 6f63 6174 696f  heck the locatio
+0000a510: 6e20 7061 7261 6d65 7465 720d 0a20 2020  n parameter..   
+0000a520: 2020 2020 206c 6f63 6174 696f 6e20 3d20       location = 
+0000a530: 6c6f 6361 7469 6f6e 2e6c 6f77 6572 2829  location.lower()
+0000a540: 0d0a 2020 2020 2020 2020 6966 206c 6f63  ..        if loc
+0000a550: 6174 696f 6e20 6e6f 7420 696e 205b 2263  ation not in ["c
+0000a560: 656e 7465 7222 2c20 2263 6f72 6e65 7222  enter", "corner"
+0000a570: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+0000a580: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000a590: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0000a5a0: 2020 2022 5468 6520 6c6f 6361 7469 6f6e     "The location
+0000a5b0: 2070 6172 616d 6574 6572 2063 616e 2068   parameter can h
+0000a5c0: 6176 6520 6f6e 6520 6f66 2074 6865 7365  ave one of these
+0000a5d0: 2076 616c 7565 733a 2027 6365 6e74 6572   values: 'center
+0000a5e0: 272c 2027 636f 726e 6572 272c 2022 0d0a  ', 'corner', "..
+0000a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a600: 6622 6275 7420 7468 6520 7661 6c75 653a  f"but the value:
+0000a610: 207b 6c6f 6361 7469 6f6e 7d20 6973 2067   {location} is g
+0000a620: 6976 656e 2e22 0d0a 2020 2020 2020 2020  iven."..        
+0000a630: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
+0000a640: 2069 6620 6c6f 6361 7469 6f6e 203d 3d20   if location == 
+0000a650: 2263 656e 7465 7222 3a0d 0a20 2020 2020  "center":..     
+0000a660: 2020 2020 2020 2023 2041 6464 696e 6720         # Adding 
+0000a670: 302e 352a 6365 6c6c 2073 697a 6520 746f  0.5*cell size to
+0000a680: 2067 6574 2074 6865 2063 656e 7472 650d   get the centre.
+0000a690: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
+0000a6a0: 5f76 616c 7565 203d 2030 2e35 0d0a 2020  _value = 0.5..  
+0000a6b0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0000a6c0: 2020 2020 2020 2020 2061 6464 5f76 616c           add_val
+0000a6d0: 7565 203d 2030 0d0a 2020 2020 2020 2020  ue = 0..        
+0000a6e0: 2320 4765 7474 696e 6720 6461 7461 2066  # Getting data f
+0000a6f0: 6f72 2074 6865 2077 686f 6c65 2067 7269  or the whole gri
+0000a700: 640d 0a20 2020 2020 2020 2028 0d0a 2020  d..        (..  
+0000a710: 2020 2020 2020 2020 2020 785f 696e 6974            x_init
+0000a720: 2c0d 0a20 2020 2020 2020 2020 2020 2063  ,..            c
+0000a730: 656c 6c5f 7369 7a65 5f78 2c0d 0a20 2020  ell_size_x,..   
+0000a740: 2020 2020 2020 2020 2078 795f 7370 616e           xy_span
+0000a750: 2c0d 0a20 2020 2020 2020 2020 2020 2079  ,..            y
+0000a760: 5f69 6e69 742c 0d0a 2020 2020 2020 2020  _init,..        
+0000a770: 2020 2020 7979 5f73 7061 6e2c 0d0a 2020      yy_span,..  
+0000a780: 2020 2020 2020 2020 2020 6365 6c6c 5f73            cell_s
+0000a790: 697a 655f 792c 0d0a 2020 2020 2020 2020  ize_y,..        
+0000a7a0: 2920 3d20 7365 6c66 2e67 656f 7472 616e  ) = self.geotran
+0000a7b0: 7366 6f72 6d0d 0a20 2020 2020 2020 2069  sform..        i
+0000a7c0: 6620 6365 6c6c 5f73 697a 655f 7820 213d  f cell_size_x !=
+0000a7d0: 2063 656c 6c5f 7369 7a65 5f79 3a0d 0a20   cell_size_y:.. 
+0000a7e0: 2020 2020 2020 2020 2020 2069 6620 6e70             if np
+0000a7f0: 2e61 6273 2863 656c 6c5f 7369 7a65 5f78  .abs(cell_size_x
+0000a800: 2920 213d 206e 702e 6162 7328 6365 6c6c  ) != np.abs(cell
+0000a810: 5f73 697a 655f 7929 3a0d 0a20 2020 2020  _size_y):..     
+0000a820: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0000a830: 722e 7761 726e 696e 6728 0d0a 2020 2020  r.warning(..    
+0000a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a850: 6622 5468 6520 6769 7665 6e20 7261 7374  f"The given rast
+0000a860: 6572 2064 6f65 7320 6e6f 7420 6861 7665  er does not have
+0000a870: 2061 2073 7175 6172 6520 6365 6c6c 732c   a square cells,
+0000a880: 2074 6865 2063 656c 6c20 7369 7a65 2069   the cell size i
+0000a890: 7320 7b63 656c 6c5f 7369 7a65 5f78 7d2a  s {cell_size_x}*
+0000a8a0: 7b63 656c 6c5f 7369 7a65 5f79 7d20 220d  {cell_size_y} ".
+0000a8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a8c0: 2029 0d0a 0d0a 2020 2020 2020 2020 2320   )....        # 
+0000a8d0: 6461 7461 2069 6e20 7468 6520 6172 7261  data in the arra
+0000a8e0: 790d 0a20 2020 2020 2020 206e 6f5f 7661  y..        no_va
+0000a8f0: 6c20 3d20 7365 6c66 2e6e 6f5f 6461 7461  l = self.no_data
+0000a900: 5f76 616c 7565 5b30 5d0d 0a20 2020 2020  _value[0]..     
+0000a910: 2020 2061 7272 203d 2073 656c 662e 7265     arr = self.re
+0000a920: 6164 5f61 7272 6179 2862 616e 643d 3029  ad_array(band=0)
+0000a930: 0d0a 2020 2020 2020 2020 6966 206d 6173  ..        if mas
+0000a940: 6b20 6973 206e 6f74 204e 6f6e 6520 616e  k is not None an
+0000a950: 6420 6e6f 5f76 616c 206e 6f74 2069 6e20  d no_val not in 
+0000a960: 6172 723a 0d0a 2020 2020 2020 2020 2020  arr:..          
+0000a970: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
+0000a980: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0000a990: 2020 2022 5468 6520 6e6f 2064 6174 6120     "The no data 
+0000a9a0: 7661 6c75 6520 646f 6573 206e 6f74 2065  value does not e
+0000a9b0: 7869 7374 2069 6e20 7468 6520 6261 6e64  xist in the band
+0000a9c0: 2c20 736f 2061 6c6c 2074 6865 2063 656c  , so all the cel
+0000a9d0: 6c73 2077 696c 6c20 6265 2063 6f73 6964  ls will be cosid
+0000a9e0: 6572 6564 2061 6e64 2074 6865 2022 0d0a  ered and the "..
+0000a9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa00: 226d 6173 6b20 7769 6c6c 206e 6f74 2062  "mask will not b
+0000aa10: 6520 636f 7369 6465 7265 642e 220d 0a20  e cosidered.".. 
+0000aa20: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
+0000aa30: 2020 2020 2020 2020 6966 206d 6173 6b3a          if mask:
+0000aa40: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+0000aa50: 736b 203d 205b 6e6f 5f76 616c 5d0d 0a20  sk = [no_val].. 
+0000aa60: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0000aa70: 2020 2020 2020 2020 2020 6d61 736b 203d            mask =
+0000aa80: 204e 6f6e 650d 0a20 2020 2020 2020 2069   None..        i
+0000aa90: 6e64 6963 6573 203d 2067 6574 5f69 6e64  ndices = get_ind
+0000aaa0: 6963 6573 3228 6172 722c 206d 6173 6b3d  ices2(arr, mask=
+0000aab0: 6d61 736b 290d 0a0d 0a20 2020 2020 2020  mask)....       
+0000aac0: 2023 2065 7865 636c 7564 6520 7468 6520   # execlude the 
+0000aad0: 6e6f 5f64 6174 615f 7661 6c75 6573 2063  no_data_values c
+0000aae0: 656c 6c73 2e0d 0a20 2020 2020 2020 2066  ells...        f
+0000aaf0: 3120 3d20 5b69 5b30 5d20 666f 7220 6920  1 = [i[0] for i 
+0000ab00: 696e 2069 6e64 6963 6573 5d0d 0a20 2020  in indices]..   
+0000ab10: 2020 2020 2066 3220 3d20 5b69 5b31 5d20       f2 = [i[1] 
+0000ab20: 666f 7220 6920 696e 2069 6e64 6963 6573  for i in indices
+0000ab30: 5d0d 0a20 2020 2020 2020 2078 203d 205b  ]..        x = [
+0000ab40: 785f 696e 6974 202b 2063 656c 6c5f 7369  x_init + cell_si
+0000ab50: 7a65 5f78 202a 2028 6920 2b20 6164 645f  ze_x * (i + add_
+0000ab60: 7661 6c75 6529 2066 6f72 2069 2069 6e20  value) for i in 
+0000ab70: 6632 5d0d 0a20 2020 2020 2020 2079 203d  f2]..        y =
+0000ab80: 205b 795f 696e 6974 202b 2063 656c 6c5f   [y_init + cell_
+0000ab90: 7369 7a65 5f79 202a 2028 6920 2b20 6164  size_y * (i + ad
+0000aba0: 645f 7661 6c75 6529 2066 6f72 2069 2069  d_value) for i i
+0000abb0: 6e20 6631 5d0d 0a20 2020 2020 2020 2063  n f1]..        c
+0000abc0: 6f6f 7264 7320 3d20 6e70 2e61 7272 6179  oords = np.array
+0000abd0: 286c 6973 7428 7a69 7028 782c 2079 2929  (list(zip(x, y))
+0000abe0: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
+0000abf0: 7572 6e20 636f 6f72 6473 0d0a 0d0a 2020  urn coords....  
+0000ac00: 2020 6465 6620 6765 745f 6365 6c6c 5f70    def get_cell_p
+0000ac10: 6f6c 7967 6f6e 7328 7365 6c66 2c20 6d61  olygons(self, ma
+0000ac20: 736b 3d46 616c 7365 2920 2d3e 2047 656f  sk=False) -> Geo
+0000ac30: 4461 7461 4672 616d 653a 0d0a 2020 2020  DataFrame:..    
+0000ac40: 2020 2020 2222 2247 6574 2061 2070 6f6c      """Get a pol
+0000ac50: 7967 6f6e 2073 6861 7065 6c79 2067 656f  ygon shapely geo
+0000ac60: 6d65 7472 7920 666f 7220 7468 6520 7261  metry for the ra
+0000ac70: 7374 6572 2063 656c 6c73 2e0d 0a0d 0a20  ster cells..... 
+0000ac80: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000ac90: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000aca0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206d  -----..        m
+0000acb0: 6173 6b3a 205b 626f 6f6c 5d0d 0a20 2020  ask: [bool]..   
+0000acc0: 2020 2020 2020 2020 2054 7275 6520 746f           True to
+0000acd0: 2067 6574 2074 6865 2070 6f6c 7967 6f6e   get the polygon
+0000ace0: 7320 6f66 2074 6865 2063 656c 6c73 2069  s of the cells i
+0000acf0: 6e73 6964 6520 7468 6520 646f 6d61 696e  nside the domain
+0000ad00: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
+0000ad10: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+0000ad20: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2047  -----..        G
+0000ad30: 656f 4461 7461 4672 616d 653a 0d0a 2020  eoDataFrame:..  
+0000ad40: 2020 2020 2020 2020 2020 7769 7468 2074            with t
+0000ad50: 776f 2063 6f6c 756d 6e73 2c20 6765 6f6d  wo columns, geom
+0000ad60: 6574 7279 2c20 616e 6420 6964 0d0a 2020  etry, and id..  
+0000ad70: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0000ad80: 2020 2063 6f6f 7264 7320 3d20 7365 6c66     coords = self
+0000ad90: 2e67 6574 5f63 656c 6c5f 636f 6f72 6473  .get_cell_coords
+0000ada0: 286c 6f63 6174 696f 6e3d 2263 6f72 6e65  (location="corne
+0000adb0: 7222 2c20 6d61 736b 3d6d 6173 6b29 0d0a  r", mask=mask)..
+0000adc0: 2020 2020 2020 2020 6365 6c6c 5f73 697a          cell_siz
+0000add0: 6520 3d20 7365 6c66 2e67 656f 7472 616e  e = self.geotran
+0000ade0: 7366 6f72 6d5b 315d 0d0a 2020 2020 2020  sform[1]..      
+0000adf0: 2020 6570 7367 203d 2073 656c 662e 5f67    epsg = self._g
+0000ae00: 6574 5f65 7073 6728 290d 0a20 2020 2020  et_epsg()..     
+0000ae10: 2020 2078 203d 206e 702e 7a65 726f 7328     x = np.zeros(
+0000ae20: 2863 6f6f 7264 732e 7368 6170 655b 305d  (coords.shape[0]
+0000ae30: 2c20 3429 290d 0a20 2020 2020 2020 2079  , 4))..        y
+0000ae40: 203d 206e 702e 7a65 726f 7328 2863 6f6f   = np.zeros((coo
+0000ae50: 7264 732e 7368 6170 655b 305d 2c20 3429  rds.shape[0], 4)
+0000ae60: 290d 0a20 2020 2020 2020 2023 2066 696c  )..        # fil
+0000ae70: 6c20 7468 6520 746f 7020 6c65 6674 2063  l the top left c
+0000ae80: 6f72 6e65 7220 706f 696e 740d 0a20 2020  orner point..   
+0000ae90: 2020 2020 2078 5b3a 2c20 305d 203d 2063       x[:, 0] = c
+0000aea0: 6f6f 7264 735b 3a2c 2030 5d0d 0a20 2020  oords[:, 0]..   
+0000aeb0: 2020 2020 2079 5b3a 2c20 305d 203d 2063       y[:, 0] = c
+0000aec0: 6f6f 7264 735b 3a2c 2031 5d0d 0a20 2020  oords[:, 1]..   
+0000aed0: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
+0000aee0: 746f 7020 7269 6768 740d 0a20 2020 2020  top right..     
+0000aef0: 2020 2078 5b3a 2c20 315d 203d 2078 5b3a     x[:, 1] = x[:
+0000af00: 2c20 305d 202b 2063 656c 6c5f 7369 7a65  , 0] + cell_size
+0000af10: 0d0a 2020 2020 2020 2020 795b 3a2c 2031  ..        y[:, 1
+0000af20: 5d20 3d20 795b 3a2c 2030 5d0d 0a20 2020  ] = y[:, 0]..   
+0000af30: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
+0000af40: 626f 7474 6f6d 2072 6967 6874 0d0a 2020  bottom right..  
+0000af50: 2020 2020 2020 785b 3a2c 2032 5d20 3d20        x[:, 2] = 
+0000af60: 785b 3a2c 2030 5d20 2b20 6365 6c6c 5f73  x[:, 0] + cell_s
+0000af70: 697a 650d 0a20 2020 2020 2020 2079 5b3a  ize..        y[:
+0000af80: 2c20 325d 203d 2079 5b3a 2c20 305d 202d  , 2] = y[:, 0] -
+0000af90: 2063 656c 6c5f 7369 7a65 0d0a 0d0a 2020   cell_size....  
+0000afa0: 2020 2020 2020 2320 6669 6c6c 2074 6865        # fill the
+0000afb0: 2062 6f74 746f 6d20 6c65 6674 0d0a 2020   bottom left..  
+0000afc0: 2020 2020 2020 785b 3a2c 2033 5d20 3d20        x[:, 3] = 
+0000afd0: 785b 3a2c 2030 5d0d 0a20 2020 2020 2020  x[:, 0]..       
+0000afe0: 2079 5b3a 2c20 335d 203d 2079 5b3a 2c20   y[:, 3] = y[:, 
+0000aff0: 305d 202d 2063 656c 6c5f 7369 7a65 0d0a  0] - cell_size..
+0000b000: 0d0a 2020 2020 2020 2020 636f 6f72 6473  ..        coords
+0000b010: 5f74 7570 6c65 7320 3d20 5b6c 6973 7428  _tuples = [list(
+0000b020: 7a69 7028 785b 3a2c 2069 5d2c 2079 5b3a  zip(x[:, i], y[:
+0000b030: 2c20 695d 2929 2066 6f72 2069 2069 6e20  , i])) for i in 
+0000b040: 7261 6e67 6528 3429 5d0d 0a20 2020 2020  range(4)]..     
+0000b050: 2020 2070 6f6c 7973 5f63 6f6f 7264 7320     polys_coords 
+0000b060: 3d20 5b0d 0a20 2020 2020 2020 2020 2020  = [..           
+0000b070: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+0000b080: 2020 2020 636f 6f72 6473 5f74 7570 6c65      coords_tuple
+0000b090: 735b 305d 5b69 5d2c 0d0a 2020 2020 2020  s[0][i],..      
+0000b0a0: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
+0000b0b0: 5f74 7570 6c65 735b 315d 5b69 5d2c 0d0a  _tuples[1][i],..
+0000b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0d0: 636f 6f72 6473 5f74 7570 6c65 735b 325d  coords_tuples[2]
+0000b0e0: 5b69 5d2c 0d0a 2020 2020 2020 2020 2020  [i],..          
+0000b0f0: 2020 2020 2020 636f 6f72 6473 5f74 7570        coords_tup
+0000b100: 6c65 735b 335d 5b69 5d2c 0d0a 2020 2020  les[3][i],..    
+0000b110: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+0000b120: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0000b130: 7261 6e67 6528 6c65 6e28 7829 290d 0a20  range(len(x)).. 
+0000b140: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
+0000b150: 2020 706f 6c79 676f 6e73 203d 206c 6973    polygons = lis
+0000b160: 7428 6d61 7028 4665 6174 7572 6543 6f6c  t(map(FeatureCol
+0000b170: 6c65 6374 696f 6e2e 6372 6561 7465 5f70  lection.create_p
+0000b180: 6f6c 7967 6f6e 2c20 706f 6c79 735f 636f  olygon, polys_co
+0000b190: 6f72 6473 2929 0d0a 2020 2020 2020 2020  ords))..        
+0000b1a0: 6764 6620 3d20 6770 642e 4765 6f44 6174  gdf = gpd.GeoDat
+0000b1b0: 6146 7261 6d65 2867 656f 6d65 7472 793d  aFrame(geometry=
+0000b1c0: 706f 6c79 676f 6e73 290d 0a20 2020 2020  polygons)..     
+0000b1d0: 2020 2067 6466 2e73 6574 5f63 7273 2865     gdf.set_crs(e
+0000b1e0: 7073 673d 6570 7367 2c20 696e 706c 6163  psg=epsg, inplac
+0000b1f0: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
+0000b200: 2067 6466 5b22 6964 225d 203d 2067 6466   gdf["id"] = gdf
+0000b210: 2e69 6e64 6578 0d0a 2020 2020 2020 2020  .index..        
+0000b220: 7265 7475 726e 2067 6466 0d0a 0d0a 2020  return gdf....  
+0000b230: 2020 6465 6620 6765 745f 6365 6c6c 5f70    def get_cell_p
+0000b240: 6f69 6e74 7328 7365 6c66 2c20 6c6f 6361  oints(self, loca
+0000b250: 7469 6f6e 3a20 7374 7220 3d20 2263 656e  tion: str = "cen
+0000b260: 7465 7222 2c20 6d61 736b 3d46 616c 7365  ter", mask=False
+0000b270: 2920 2d3e 2047 656f 4461 7461 4672 616d  ) -> GeoDataFram
+0000b280: 653a 0d0a 2020 2020 2020 2020 2222 2247  e:..        """G
+0000b290: 6574 2061 2070 6f69 6e74 2073 6861 7065  et a point shape
+0000b2a0: 6c79 2067 656f 6d65 7472 7920 666f 7220  ly geometry for 
+0000b2b0: 7468 6520 7261 7374 6572 2063 656c 6c73  the raster cells
+0000b2c0: 2063 656e 7465 7220 706f 696e 742e 0d0a   center point...
+0000b2d0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0000b2e0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0000b2f0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0000b300: 2020 6c6f 6361 7469 6f6e 3a20 5b73 7472    location: [str
+0000b310: 5d0d 0a20 2020 2020 2020 2020 2020 206c  ]..            l
+0000b320: 6f63 6174 696f 6e20 6f66 2074 6865 2070  ocation of the p
+0000b330: 6f69 6e74 2c20 5b22 636f 726e 6572 222c  oint, ["corner",
+0000b340: 2022 6365 6e74 6572 225d 2e20 4465 6661   "center"]. Defa
+0000b350: 756c 7420 6973 2022 6365 6e74 6572 222e  ult is "center".
+0000b360: 0d0a 2020 2020 2020 2020 6d61 736b 3a20  ..        mask: 
+0000b370: 5b62 6f6f 6c5d 0d0a 2020 2020 2020 2020  [bool]..        
+0000b380: 2020 2020 5472 7565 2074 6f20 6765 7420      True to get 
+0000b390: 7468 6520 706f 6c79 676f 6e73 206f 6620  the polygons of 
+0000b3a0: 7468 6520 6365 6c6c 7320 696e 7369 6465  the cells inside
+0000b3b0: 2074 6865 2064 6f6d 6169 6e2e 0d0a 0d0a   the domain.....
+0000b3c0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+0000b3d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000b3e0: 0d0a 2020 2020 2020 2020 4765 6f44 6174  ..        GeoDat
+0000b3f0: 6146 7261 6d65 3a0d 0a20 2020 2020 2020  aFrame:..       
+0000b400: 2020 2020 2077 6974 6820 7477 6f20 636f       with two co
+0000b410: 6c75 6d6e 732c 2067 656f 6d65 7472 792c  lumns, geometry,
+0000b420: 2061 6e64 2069 640d 0a20 2020 2020 2020   and id..       
+0000b430: 2022 2222 0d0a 2020 2020 2020 2020 636f   """..        co
+0000b440: 6f72 6473 203d 2073 656c 662e 6765 745f  ords = self.get_
+0000b450: 6365 6c6c 5f63 6f6f 7264 7328 6c6f 6361  cell_coords(loca
+0000b460: 7469 6f6e 3d6c 6f63 6174 696f 6e2c 206d  tion=location, m
+0000b470: 6173 6b3d 6d61 736b 290d 0a20 2020 2020  ask=mask)..     
+0000b480: 2020 2065 7073 6720 3d20 7365 6c66 2e5f     epsg = self._
+0000b490: 6765 745f 6570 7367 2829 0d0a 0d0a 2020  get_epsg()....  
+0000b4a0: 2020 2020 2020 636f 6f72 6473 5f74 7570        coords_tup
+0000b4b0: 6c65 7320 3d20 6c69 7374 287a 6970 2863  les = list(zip(c
+0000b4c0: 6f6f 7264 735b 3a2c 2030 5d2c 2063 6f6f  oords[:, 0], coo
+0000b4d0: 7264 735b 3a2c 2031 5d29 290d 0a20 2020  rds[:, 1]))..   
+0000b4e0: 2020 2020 2070 6f69 6e74 7320 3d20 4665       points = Fe
+0000b4f0: 6174 7572 6543 6f6c 6c65 6374 696f 6e2e  atureCollection.
+0000b500: 6372 6561 7465 5f70 6f69 6e74 2863 6f6f  create_point(coo
+0000b510: 7264 735f 7475 706c 6573 290d 0a20 2020  rds_tuples)..   
+0000b520: 2020 2020 2067 6466 203d 2067 7064 2e47       gdf = gpd.G
+0000b530: 656f 4461 7461 4672 616d 6528 6765 6f6d  eoDataFrame(geom
+0000b540: 6574 7279 3d70 6f69 6e74 7329 0d0a 2020  etry=points)..  
+0000b550: 2020 2020 2020 6764 662e 7365 745f 6372        gdf.set_cr
+0000b560: 7328 6570 7367 3d65 7073 672c 2069 6e70  s(epsg=epsg, inp
+0000b570: 6c61 6365 3d54 7275 6529 0d0a 2020 2020  lace=True)..    
+0000b580: 2020 2020 6764 665b 2269 6422 5d20 3d20      gdf["id"] = 
+0000b590: 6764 662e 696e 6465 780d 0a20 2020 2020  gdf.index..     
+0000b5a0: 2020 2072 6574 7572 6e20 6764 660d 0a0d     return gdf...
+0000b5b0: 0a20 2020 2064 6566 2074 6f5f 6669 6c65  .    def to_file
+0000b5c0: 2873 656c 662c 2070 6174 683a 2073 7472  (self, path: str
+0000b5d0: 2c20 6261 6e64 3a20 696e 7420 3d20 3029  , band: int = 0)
+0000b5e0: 202d 3e20 4e6f 6e65 3a0d 0a20 2020 2020   -> None:..     
+0000b5f0: 2020 2022 2222 5361 7665 2074 6f20 6765     """Save to ge
+0000b600: 6f74 6966 6620 666f 726d 6174 2e0d 0a0d  otiff format....
+0000b610: 0a20 2020 2020 2020 2020 2020 2073 6176  .            sav
+0000b620: 6520 7361 7665 7320 6120 7261 7374 6572  e saves a raster
+0000b630: 2074 6f20 6120 7061 7468 2c20 7468 6520   to a path, the 
+0000b640: 7479 7065 206f 6620 7468 6520 6472 6976  type of the driv
+0000b650: 6572 2028 6765 6f72 6966 662f 6e65 7463  er (georiff/netc
+0000b660: 6466 2f61 7363 6969 2920 7769 6c6c 2062  df/ascii) will b
+0000b670: 6520 696d 706c 6965 6420 6672 6f6d 2074  e implied from t
+0000b680: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
+0000b690: 6578 7465 6e73 696f 6e20 6174 2074 6865  extension at the
+0000b6a0: 2065 6e64 206f 6620 7468 6520 6769 7665   end of the give
+0000b6b0: 6e20 7061 7468 2e0d 0a0d 0a20 2020 2020  n path.....     
+0000b6c0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0000b6d0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000b6e0: 2d0d 0a20 2020 2020 2020 2070 6174 683a  -..        path:
+0000b6f0: 205b 7374 7269 6e67 5d0d 0a20 2020 2020   [string]..     
+0000b700: 2020 2020 2020 2061 2070 6174 6820 696e         a path in
+0000b710: 636c 7564 6e67 2074 6865 206e 616d 6520  cludng the name 
+0000b720: 6f66 2074 6865 2072 6173 7465 7220 616e  of the raster an
+0000b730: 6420 6578 7465 6e74 696f 6e2e 0d0a 2020  d extention...  
+0000b740: 2020 2020 2020 2020 2020 3e3e 3e20 7061            >>> pa
+0000b750: 7468 203d 2022 6461 7461 2f63 726f 7070  th = "data/cropp
+0000b760: 6564 2e74 6966 220d 0a20 2020 2020 2020  ed.tif"..       
+0000b770: 2062 616e 643a 205b 696e 745d 0d0a 2020   band: [int]..  
+0000b780: 2020 2020 2020 2020 2020 6261 6e64 2069            band i
+0000b790: 6e64 6578 2c20 6e65 6564 6564 206f 6e6c  ndex, needed onl
+0000b7a0: 7920 696e 2063 6173 6520 6f66 2061 7363  y in case of asc
+0000b7b0: 6969 2064 7269 7665 7273 2e20 4465 6661  ii drivers. Defa
+0000b7c0: 756c 7420 6973 2030 2e0d 0a0d 0a20 2020  ult is 0.....   
+0000b7d0: 2020 2020 2045 7861 6d70 6c65 730d 0a20       Examples.. 
+0000b7e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
+0000b7f0: 0a20 2020 2020 2020 203e 3e3e 2072 6173  .        >>> ras
+0000b800: 7465 725f 6f62 6a20 3d20 4461 7461 7365  ter_obj = Datase
+0000b810: 742e 7265 6164 5f66 696c 6528 2270 6174  t.read_file("pat
+0000b820: 682f 746f 2f66 696c 652f 2a2a 2a2e 7469  h/to/file/***.ti
+0000b830: 6622 290d 0a20 2020 2020 2020 203e 3e3e  f")..        >>>
+0000b840: 206f 7574 7075 745f 7061 7468 203d 2022   output_path = "
+0000b850: 6578 616d 706c 6573 2f47 4953 2f64 6174  examples/GIS/dat
+0000b860: 612f 7361 7665 5f72 6173 7465 725f 7465  a/save_raster_te
+0000b870: 7374 2e74 6966 220d 0a20 2020 2020 2020  st.tif"..       
+0000b880: 203e 3e3e 2072 6173 7465 725f 6f62 6a2e   >>> raster_obj.
+0000b890: 746f 5f66 696c 6528 6f75 7470 7574 5f70  to_file(output_p
+0000b8a0: 6174 6829 0d0a 2020 2020 2020 2020 2222  ath)..        ""
+0000b8b0: 220d 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
+0000b8c0: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
+0000b8d0: 682c 2073 7472 293a 0d0a 2020 2020 2020  h, str):..      
+0000b8e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0000b8f0: 4572 726f 7228 2270 6174 6820 696e 7075  Error("path inpu
+0000b900: 7420 7368 6f75 6c64 2062 6520 7374 7269  t should be stri
+0000b910: 6e67 2074 7970 6522 290d 0a0d 0a20 2020  ng type")....   
+0000b920: 2020 2020 2065 7874 656e 7369 6f6e 203d       extension =
+0000b930: 2070 6174 682e 7370 6c69 7428 222e 2229   path.split(".")
+0000b940: 5b2d 315d 0d0a 2020 2020 2020 2020 6472  [-1]..        dr
+0000b950: 6976 6572 203d 2043 4154 414c 4f47 2e67  iver = CATALOG.g
+0000b960: 6574 5f64 7269 7665 725f 6e61 6d65 5f62  et_driver_name_b
+0000b970: 795f 6578 7465 6e73 696f 6e28 6578 7465  y_extension(exte
+0000b980: 6e73 696f 6e29 0d0a 2020 2020 2020 2020  nsion)..        
+0000b990: 2320 6966 206e 6f74 2043 4154 414c 4f47  # if not CATALOG
+0000b9a0: 2e65 7869 7374 7328 6472 6976 6572 293a  .exists(driver):
+0000b9b0: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
+0000b9c0: 7261 6973 6520 4472 6976 6572 4e6f 7445  raise DriverNotE
+0000b9d0: 7869 7374 4572 726f 7228 6622 5468 6520  xistError(f"The 
+0000b9e0: 6769 7665 6e20 6472 6976 6572 3a20 7b64  given driver: {d
+0000b9f0: 7269 7665 727d 2064 6f65 7320 6e6f 7420  river} does not 
+0000ba00: 6578 6973 7422 290d 0a20 2020 2020 2020  exist")..       
+0000ba10: 2064 7269 7665 725f 6e61 6d65 203d 2043   driver_name = C
+0000ba20: 4154 414c 4f47 2e67 6574 5f67 6461 6c5f  ATALOG.get_gdal_
+0000ba30: 6e61 6d65 2864 7269 7665 7229 0d0a 0d0a  name(driver)....
+0000ba40: 2020 2020 2020 2020 6966 2064 7269 7665          if drive
+0000ba50: 7220 3d3d 2022 6173 6369 6922 3a0d 0a20  r == "ascii":.. 
+0000ba60: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
+0000ba70: 2073 656c 662e 7265 6164 5f61 7272 6179   self.read_array
+0000ba80: 2862 616e 643d 6261 6e64 290d 0a20 2020  (band=band)..   
+0000ba90: 2020 2020 2020 2020 206e 6f5f 6461 7461           no_data
+0000baa0: 5f76 616c 7565 203d 2073 656c 662e 6e6f  _value = self.no
+0000bab0: 5f64 6174 615f 7661 6c75 655b 6261 6e64  _data_value[band
+0000bac0: 5d0d 0a20 2020 2020 2020 2020 2020 2078  ]..            x
+0000bad0: 6d69 6e2c 2079 6d69 6e2c 205f 2c20 5f20  min, ymin, _, _ 
+0000bae0: 3d20 7365 6c66 2e62 626f 780d 0a20 2020  = self.bbox..   
+0000baf0: 2020 2020 2020 2020 205f 696f 2e74 6f5f           _io.to_
+0000bb00: 6173 6369 6928 6172 722c 2073 656c 662e  ascii(arr, self.
+0000bb10: 6365 6c6c 5f73 697a 652c 2078 6d69 6e2c  cell_size, xmin,
+0000bb20: 2079 6d69 6e2c 206e 6f5f 6461 7461 5f76   ymin, no_data_v
+0000bb30: 616c 7565 2c20 7061 7468 290d 0a20 2020  alue, path)..   
+0000bb40: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0000bb50: 2020 2020 2020 2020 6473 7420 3d20 6764          dst = gd
+0000bb60: 616c 2e47 6574 4472 6976 6572 4279 4e61  al.GetDriverByNa
+0000bb70: 6d65 2864 7269 7665 725f 6e61 6d65 292e  me(driver_name).
+0000bb80: 4372 6561 7465 436f 7079 2870 6174 682c  CreateCopy(path,
+0000bb90: 2073 656c 662e 7261 7374 6572 2c20 3029   self.raster, 0)
+0000bba0: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+0000bbb0: 7420 3d20 4e6f 6e65 2020 2320 466c 7573  t = None  # Flus
+0000bbc0: 6820 7468 6520 6461 7461 7365 7420 746f  h the dataset to
+0000bbd0: 2064 6973 6b0d 0a20 2020 2020 2020 2020   disk..         
+0000bbe0: 2020 2023 2070 7269 6e74 2074 6f20 676f     # print to go
+0000bbf0: 2061 726f 756e 6420 7468 6520 6173 7369   around the assi
+0000bc00: 676e 6564 2062 7574 206e 6576 6572 2075  gned but never u
+0000bc10: 7365 6420 7072 652d 636f 6d6d 6974 2069  sed pre-commit i
+0000bc20: 7373 7565 0d0a 2020 2020 2020 2020 2020  ssue..          
+0000bc30: 2020 7072 696e 7428 6473 7429 0d0a 0d0a    print(dst)....
+0000bc40: 2020 2020 6465 6620 746f 5f70 6f6c 7967      def to_polyg
+0000bc50: 6f6e 280d 0a20 2020 2020 2020 2073 656c  on(..        sel
+0000bc60: 662c 0d0a 2020 2020 2020 2020 6261 6e64  f,..        band
+0000bc70: 3a20 696e 7420 3d20 302c 0d0a 2020 2020  : int = 0,..    
+0000bc80: 2020 2020 636f 6c5f 6e61 6d65 3a20 416e      col_name: An
+0000bc90: 7920 3d20 2269 6422 2c0d 0a20 2020 2020  y = "id",..     
+0000bca0: 2020 2070 6174 683a 2073 7472 203d 204e     path: str = N
+0000bcb0: 6f6e 652c 0d0a 2020 2020 2020 2020 6472  one,..        dr
+0000bcc0: 6976 6572 3a20 7374 7220 3d20 226d 656d  iver: str = "mem
+0000bcd0: 6f72 7922 2c0d 0a20 2020 2029 202d 3e20  ory",..    ) -> 
+0000bce0: 556e 696f 6e5b 4765 6f44 6174 6146 7261  Union[GeoDataFra
+0000bcf0: 6d65 2c20 4e6f 6e65 5d3a 0d0a 2020 2020  me, None]:..    
+0000bd00: 2020 2020 2222 2270 6f6c 7967 6f6e 697a      """polygoniz
+0000bd10: 652e 0d0a 0d0a 2020 2020 2020 2020 2020  e.....          
+0000bd20: 2020 5261 7374 6572 546f 506f 6c79 676f    RasterToPolygo
+0000bd30: 6e20 7461 6b65 7320 6120 6764 616c 2044  n takes a gdal D
+0000bd40: 6174 6163 7562 6520 6f62 6a65 6374 2061  atacube object a
+0000bd50: 6e64 2067 726f 7570 206e 6569 6768 626f  nd group neighbo
+0000bd60: 7269 6e67 2063 656c 6c73 2077 6974 6820  ring cells with 
+0000bd70: 7468 6520 7361 6d65 2076 616c 7565 2069  the same value i
+0000bd80: 6e74 6f20 6f6e 650d 0a20 2020 2020 2020  nto one..       
+0000bd90: 2020 2020 2070 6f6c 7967 6f6e 2c20 7468       polygon, th
+0000bda0: 6520 7265 7375 6c74 6564 2076 6563 746f  e resulted vecto
+0000bdb0: 7220 7769 6c6c 2062 6520 7361 7665 6420  r will be saved 
+0000bdc0: 746f 2064 6973 6b20 6173 2061 2067 656f  to disk as a geo
+0000bdd0: 6a73 6f6e 2066 696c 650d 0a0d 0a20 2020  json file....   
+0000bde0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+0000bdf0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000be00: 2d2d 2d0d 0a20 2020 2020 2020 2062 616e  ---..        ban
+0000be10: 643a 205b 696e 745d 0d0a 2020 2020 2020  d: [int]..      
+0000be20: 2020 2020 2020 7261 7374 6572 2062 616e        raster ban
+0000be30: 6420 696e 6465 7820 5b31 2c32 2c33 2c2e  d index [1,2,3,.
+0000be40: 2e5d 0d0a 2020 2020 2020 2020 7061 7468  .]..        path
+0000be50: 3a5b 7374 725d 0d0a 2020 2020 2020 2020  :[str]..        
+0000be60: 2020 2020 7061 7468 2077 6865 7265 2079      path where y
+0000be70: 6f75 2077 616e 7420 746f 2073 6176 6520  ou want to save 
+0000be80: 7468 6520 706f 6c79 676f 6e2c 2074 6865  the polygon, the
+0000be90: 2070 6174 6820 7368 6f75 6c64 2069 6e63   path should inc
+0000bea0: 6c75 6465 2074 6865 2065 7874 656e 7369  lude the extensi
+0000beb0: 6f6e 2061 7420 7468 6520 656e 640d 0a20  on at the end.. 
+0000bec0: 2020 2020 2020 2020 2020 2028 692e 652e             (i.e.
+0000bed0: 2070 6174 682f 7665 6374 6f72 5f6e 616d   path/vector_nam
+0000bee0: 652e 6765 6f6a 736f 6e29 0d0a 2020 2020  e.geojson)..    
+0000bef0: 2020 2020 636f 6c5f 6e61 6d65 3a0d 0a20      col_name:.. 
+0000bf00: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+0000bf10: 6f66 2074 6865 2063 6f6c 756d 6e20 7768  of the column wh
+0000bf20: 6572 6520 7468 6520 7261 7374 6572 2064  ere the raster d
+0000bf30: 6174 6120 7769 6c6c 2062 6520 7374 6f72  ata will be stor
+0000bf40: 6564 2e0d 0a20 2020 2020 2020 2064 7269  ed...        dri
+0000bf50: 7665 723a 205b 7374 725d 0d0a 2020 2020  ver: [str]..    
+0000bf60: 2020 2020 2020 2020 7665 6374 6f72 2064          vector d
+0000bf70: 7269 7665 722c 2066 6f72 2061 6c6c 2070  river, for all p
+0000bf80: 6f73 7369 626c 6520 6472 6976 6572 7320  ossible drivers 
+0000bf90: 6368 6563 6b20 6874 7470 733a 2f2f 6764  check https://gd
+0000bfa0: 616c 2e6f 7267 2f64 7269 7665 7273 2f76  al.org/drivers/v
+0000bfb0: 6563 746f 722f 696e 6465 782e 6874 6d6c  ector/index.html
+0000bfc0: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
+0000bfd0: 4465 6661 756c 7420 6973 2022 4765 6f4a  Default is "GeoJ
+0000bfe0: 534f 4e22 2e0d 0a0d 0a20 2020 2020 2020  SON".....       
+0000bff0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0000c000: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0000c010: 2020 204e 6f6e 650d 0a20 2020 2020 2020     None..       
+0000c020: 2022 2222 0d0a 2020 2020 2020 2020 6261   """..        ba
+0000c030: 6e64 203d 2073 656c 662e 7261 7374 6572  nd = self.raster
+0000c040: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
+0000c050: 616e 6420 2b20 3129 0d0a 2020 2020 2020  and + 1)..      
+0000c060: 2020 7372 7320 3d20 6f73 722e 5370 6174    srs = osr.Spat
+0000c070: 6961 6c52 6566 6572 656e 6365 2877 6b74  ialReference(wkt
+0000c080: 3d73 656c 662e 6372 7329 0d0a 2020 2020  =self.crs)..    
+0000c090: 2020 2020 6966 2070 6174 6820 6973 204e      if path is N
+0000c0a0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+0000c0b0: 2020 6473 745f 6c61 7965 726e 616d 6520    dst_layername 
+0000c0c0: 3d20 2269 6422 0d0a 2020 2020 2020 2020  = "id"..        
+0000c0d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0000c0e0: 2020 2064 7374 5f6c 6179 6572 6e61 6d65     dst_layername
+0000c0f0: 203d 2070 6174 682e 7370 6c69 7428 222e   = path.split(".
+0000c100: 2229 5b30 5d2e 7370 6c69 7428 222f 2229  ")[0].split("/")
+0000c110: 5b2d 315d 0d0a 0d0a 2020 2020 2020 2020  [-1]....        
+0000c120: 6473 745f 6473 203d 2046 6561 7475 7265  dst_ds = Feature
+0000c130: 436f 6c6c 6563 7469 6f6e 2e63 7265 6174  Collection.creat
+0000c140: 655f 6473 2864 7269 7665 722c 2070 6174  e_ds(driver, pat
+0000c150: 6829 0d0a 2020 2020 2020 2020 6473 745f  h)..        dst_
+0000c160: 6c61 7965 7220 3d20 6473 745f 6473 2e43  layer = dst_ds.C
+0000c170: 7265 6174 654c 6179 6572 2864 7374 5f6c  reateLayer(dst_l
+0000c180: 6179 6572 6e61 6d65 2c20 7372 733d 7372  ayername, srs=sr
+0000c190: 7329 0d0a 2020 2020 2020 2020 6474 7970  s)..        dtyp
+0000c1a0: 6520 3d20 6764 616c 5f74 6f5f 6f67 725f  e = gdal_to_ogr_
+0000c1b0: 6474 7970 6528 7365 6c66 2e72 6173 7465  dtype(self.raste
+0000c1c0: 7229 0d0a 2020 2020 2020 2020 6e65 7746  r)..        newF
+0000c1d0: 6965 6c64 203d 206f 6772 2e46 6965 6c64  ield = ogr.Field
+0000c1e0: 4465 666e 2863 6f6c 5f6e 616d 652c 2064  Defn(col_name, d
+0000c1f0: 7479 7065 290d 0a20 2020 2020 2020 2064  type)..        d
+0000c200: 7374 5f6c 6179 6572 2e43 7265 6174 6546  st_layer.CreateF
+0000c210: 6965 6c64 286e 6577 4669 656c 6429 0d0a  ield(newField)..
+0000c220: 2020 2020 2020 2020 6764 616c 2e50 6f6c          gdal.Pol
+0000c230: 7967 6f6e 697a 6528 6261 6e64 2c20 6261  ygonize(band, ba
+0000c240: 6e64 2c20 6473 745f 6c61 7965 722c 2030  nd, dst_layer, 0
+0000c250: 2c20 5b5d 2c20 6361 6c6c 6261 636b 3d4e  , [], callback=N
+0000c260: 6f6e 6529 0d0a 2020 2020 2020 2020 6966  one)..        if
+0000c270: 2070 6174 683a 0d0a 2020 2020 2020 2020   path:..        
+0000c280: 2020 2020 6473 745f 6c61 7965 7220 3d20      dst_layer = 
+0000c290: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+0000c2a0: 2020 6473 745f 6473 203d 204e 6f6e 650d    dst_ds = None.
+0000c2b0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000c2c0: 2020 2020 2020 2020 2020 2020 7665 6374              vect
+0000c2d0: 6f72 203d 2046 6561 7475 7265 436f 6c6c  or = FeatureColl
+0000c2e0: 6563 7469 6f6e 2864 7374 5f64 7329 0d0a  ection(dst_ds)..
+0000c2f0: 2020 2020 2020 2020 2020 2020 6764 6620              gdf 
+0000c300: 3d20 7665 6374 6f72 2e5f 6473 5f74 6f5f  = vector._ds_to_
+0000c310: 6764 6628 290d 0a20 2020 2020 2020 2020  gdf()..         
+0000c320: 2020 2072 6574 7572 6e20 6764 660d 0a0d     return gdf...
+0000c330: 0a20 2020 2064 6566 2074 6f5f 6765 6f64  .    def to_geod
+0000c340: 6174 6166 7261 6d65 280d 0a20 2020 2020  ataframe(..     
+0000c350: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
+0000c360: 2020 7665 6374 6f72 5f6d 6173 6b3a 2055    vector_mask: U
+0000c370: 6e69 6f6e 5b73 7472 2c20 4765 6f44 6174  nion[str, GeoDat
+0000c380: 6146 7261 6d65 5d20 3d20 4e6f 6e65 2c0d  aFrame] = None,.
+0000c390: 0a20 2020 2020 2020 2061 6464 5f67 656f  .        add_geo
+0000c3a0: 6d65 7472 793a 2073 7472 203d 204e 6f6e  metry: str = Non
+0000c3b0: 652c 0d0a 2020 2020 2020 2020 7469 6c65  e,..        tile
+0000c3c0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
+0000c3d0: 0a20 2020 2020 2020 2074 696c 655f 7369  .        tile_si
+0000c3e0: 7a65 3a20 696e 7420 3d20 3135 3030 2c0d  ze: int = 1500,.
+0000c3f0: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
+0000c400: 4461 7461 4672 616d 652c 2047 656f 4461  DataFrame, GeoDa
+0000c410: 7461 4672 616d 655d 3a0d 0a20 2020 2020  taFrame]:..     
+0000c420: 2020 2022 2222 436f 6e76 6572 7420 6120     """Convert a 
+0000c430: 7261 7374 6572 2074 6f20 6120 4765 6f44  raster to a GeoD
+0000c440: 6174 6146 7261 6d65 2e0d 0a0d 0a20 2020  ataFrame.....   
+0000c450: 2020 2020 2020 2020 2054 6865 2066 756e           The fun
+0000c460: 6374 696f 6e20 646f 2074 6865 2066 6f6c  ction do the fol
+0000c470: 6c6f 7769 6e67 0d0a 2020 2020 2020 2020  lowing..        
+0000c480: 2020 2020 2d20 466c 6174 7465 6e20 7468      - Flatten th
+0000c490: 6520 6172 7261 7920 696e 2065 6163 6820  e array in each 
+0000c4a0: 6261 6e64 2069 6e20 7468 6520 7261 7374  band in the rast
+0000c4b0: 6572 2074 6865 6e20 6d61 736b 2074 6865  er then mask the
+0000c4c0: 2076 616c 7565 7320 6966 2061 2076 6563   values if a vec
+0000c4d0: 746f 725f 6d61 736b 0d0a 2020 2020 2020  tor_mask..      
+0000c4e0: 2020 2020 2020 6669 6c65 2069 7320 6769        file is gi
+0000c4f0: 7665 6e20 6f74 6865 7277 6973 6520 6974  ven otherwise it
+0000c500: 2077 696c 6c20 666c 6174 7465 6e20 616c   will flatten al
+0000c510: 6c20 7661 6c75 6573 2e0d 0a20 2020 2020  l values...     
+0000c520: 2020 2020 2020 202d 2050 7574 2074 6865         - Put the
+0000c530: 2076 616c 7565 7320 666f 7220 6561 6368   values for each
+0000c540: 2062 616e 6420 696e 2061 2063 6f6c 756d   band in a colum
+0000c550: 6e20 696e 2061 2064 6174 6166 7261 6d65  n in a dataframe
+0000c560: 2075 6e64 6572 2074 6865 206e 616d 6520   under the name 
+0000c570: 6f66 2074 6865 2072 6173 7465 7220 6261  of the raster ba
+0000c580: 6e64 2c20 6275 7420 6966 206e 6f20 6d65  nd, but if no me
+0000c590: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
+0000c5a0: 6461 7461 2069 6e20 7468 6520 7261 7374  data in the rast
+0000c5b0: 6572 2062 616e 6420 6578 6973 7473 2c20  er band exists, 
+0000c5c0: 616e 2069 6e64 6578 206e 756d 6265 7220  an index number 
+0000c5d0: 7769 6c6c 2062 6520 7573 6564 205b 312c  will be used [1,
+0000c5e0: 2032 2c20 332c 202e 2e2e 5d0d 0a20 2020   2, 3, ...]..   
+0000c5f0: 2020 2020 2020 2020 202d 2054 6865 2066           - The f
+0000c600: 756e 6374 696f 6e20 6861 7320 6120 6164  unction has a ad
+0000c610: 645f 6765 6f6d 6574 7279 2070 6172 616d  d_geometry param
+0000c620: 6574 6572 2077 6974 6820 7477 6f20 706f  eter with two po
+0000c630: 7373 6962 6c65 2076 616c 7565 7320 5b22  ssible values ["
+0000c640: 706f 696e 7422 2c20 2270 6f6c 7967 6f6e  point", "polygon
+0000c650: 225d 2c20 7768 6963 6820 796f 7520 6361  "], which you ca
+0000c660: 6e0d 0a20 2020 2020 2020 2020 2020 2073  n..            s
+0000c670: 7065 6369 6679 2074 6865 2074 7970 6520  pecify the type 
+0000c680: 6f66 2073 6861 7065 6c79 2067 656f 6d65  of shapely geome
+0000c690: 7472 7920 796f 7520 7761 6e74 2074 6f20  try you want to 
+0000c6a0: 6372 6561 7465 2066 726f 6d20 6561 6368  create from each
+0000c6b0: 2063 656c 6c2c 0d0a 2020 2020 2020 2020   cell,..        
+0000c6c0: 2020 2020 2020 2020 2d20 4966 2070 6f69          - If poi
+0000c6d0: 6e74 2069 7320 6368 6f73 656e 2c20 7468  nt is chosen, th
+0000c6e0: 6520 6372 6561 7465 6420 706f 696e 7420  e created point 
+0000c6f0: 7769 6c6c 2062 6520 6174 2074 6865 2063  will be at the c
+0000c700: 656e 7465 7220 6f66 2065 6163 6820 6365  enter of each ce
+0000c710: 6c6c 0d0a 2020 2020 2020 2020 2020 2020  ll..            
+0000c720: 2020 2020 2d20 4966 2061 2070 6f6c 7967      - If a polyg
+0000c730: 6f6e 2069 7320 6368 6f73 656e 2c20 6120  on is chosen, a 
+0000c740: 7371 7561 7265 2070 6f6c 7967 6f6e 2077  square polygon w
+0000c750: 696c 6c20 6265 2063 7265 6174 6564 2074  ill be created t
+0000c760: 6861 7420 636f 7665 7273 2074 6865 2065  hat covers the e
+0000c770: 6e74 6972 6520 6365 6c6c 2e0d 0a0d 0a20  ntire cell..... 
+0000c780: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000c790: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000c7a0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2076  -----..        v
+0000c7b0: 6563 746f 725f 6d61 736b 203a 204f 7074  ector_mask : Opt
+0000c7c0: 696f 6e61 6c5b 4765 6f44 6174 6146 7261  ional[GeoDataFra
+0000c7d0: 6d65 2f73 7472 5d0d 0a20 2020 2020 2020  me/str]..       
+0000c7e0: 2020 2020 2047 656f 4461 7461 4672 616d       GeoDataFram
+0000c7f0: 6520 666f 7220 7468 6520 7665 6374 6f72  e for the vector
+0000c800: 5f6d 6173 6b20 6669 6c65 2070 6174 6820  _mask file path 
+0000c810: 746f 2076 6563 746f 725f 6d61 736b 2066  to vector_mask f
+0000c820: 696c 652e 2049 6620 6769 7665 6e2c 2069  ile. If given, i
+0000c830: 7420 7769 6c6c 2062 6520 7573 6564 2074  t will be used t
+0000c840: 6f20 636c 6970 2074 6865 2072 6173 7465  o clip the raste
+0000c850: 720d 0a20 2020 2020 2020 2061 6464 5f67  r..        add_g
+0000c860: 656f 6d65 7472 793a 205b 7374 725d 0d0a  eometry: [str]..
+0000c870: 2020 2020 2020 2020 2020 2020 2250 6f6c              "Pol
+0000c880: 7967 6f6e 222c 206f 7220 2250 6f69 6e74  ygon", or "Point
+0000c890: 2220 6966 2079 6f75 2077 616e 7420 746f  " if you want to
+0000c8a0: 2061 6464 2061 2070 6f6c 7967 6f6e 2067   add a polygon g
+0000c8b0: 656f 6d65 7472 7920 6f66 2074 6865 2063  eometry of the c
+0000c8c0: 656c 6c73 2061 7320 2063 6f6c 756d 6e20  ells as  column 
+0000c8d0: 696e 2064 6174 6166 7261 6d65 2e0d 0a20  in dataframe... 
+0000c8e0: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+0000c8f0: 6c74 2069 7320 4e6f 6e65 2e0d 0a20 2020  lt is None...   
+0000c900: 2020 2020 2074 696c 653a 205b 626f 6f6c       tile: [bool
+0000c910: 5d0d 0a20 2020 2020 2020 2020 2020 2054  ]..            T
+0000c920: 7275 6520 746f 2075 7365 2074 696c 6573  rue to use tiles
+0000c930: 2069 6e20 6578 7472 6163 7469 6e67 2074   in extracting t
+0000c940: 6865 2076 616c 7565 7320 6672 6f6d 2074  he values from t
+0000c950: 6865 2072 6173 7465 722e 2044 6566 6175  he raster. Defau
+0000c960: 6c74 2069 7320 4661 6c73 652e 0d0a 2020  lt is False...  
+0000c970: 2020 2020 2020 7469 6c65 5f73 697a 653a        tile_size:
+0000c980: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
+0000c990: 2020 2020 7469 6c65 2073 697a 652e 2044      tile size. D
+0000c9a0: 6566 6175 6c74 2069 7320 3135 3030 2e0d  efault is 1500..
+0000c9b0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000c9c0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+0000c9d0: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
+0000c9e0: 6146 7261 6d65 2f47 656f 4461 7461 4672  aFrame/GeoDataFr
+0000c9f0: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
+0000ca00: 2063 6f6c 756d 6e64 4c3a 0d0a 2020 2020   columndL:..    
+0000ca10: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0000ca20: 7072 696e 7428 6764 662e 636f 6c75 6d6e  print(gdf.column
+0000ca30: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+0000ca40: 2020 2020 3e3e 3e20 496e 6465 7828 5b27      >>> Index(['
+0000ca50: 4261 6e64 5f31 272c 2027 6765 6f6d 6574  Band_1', 'geomet
+0000ca60: 7279 275d 2c20 6474 7970 653d 276f 626a  ry'], dtype='obj
+0000ca70: 6563 7427 290d 0a0d 0a20 2020 2020 2020  ect')....       
+0000ca80: 2074 6865 2072 6573 756c 7465 6420 6765   the resulted ge
+0000ca90: 6f64 6174 6166 7261 6d65 2077 696c 6c20  odataframe will 
+0000caa0: 6861 7665 2074 6865 2062 616e 6420 7661  have the band va
+0000cab0: 6c75 6520 756e 6465 7220 7468 6520 6e61  lue under the na
+0000cac0: 6d65 206f 6620 7468 6520 6261 6e64 2028  me of the band (
+0000cad0: 6966 2074 6865 2072 6173 7465 7220 6669  if the raster fi
+0000cae0: 6c65 2068 6173 2061 206d 6574 6164 6174  le has a metadat
+0000caf0: 612c 0d0a 2020 2020 2020 2020 6966 206e  a,..        if n
+0000cb00: 6f74 2c20 7468 6520 6261 6e64 7320 7769  ot, the bands wi
+0000cb10: 6c6c 2062 6520 696e 6465 7865 6420 6672  ll be indexed fr
+0000cb20: 6f6d 2031 2074 6f20 7468 6520 6e75 6d62  om 1 to the numb
+0000cb30: 6572 206f 6620 6261 6e64 7329 0d0a 2020  er of bands)..  
+0000cb40: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0000cb50: 2020 2074 656d 705f 6469 7220 3d20 4e6f     temp_dir = No
+0000cb60: 6e65 0d0a 0d0a 2020 2020 2020 2020 2320  ne....        # 
+0000cb70: 4765 7420 7261 7374 6572 2062 616e 6420  Get raster band 
+0000cb80: 6e61 6d65 732e 206f 7065 6e20 7468 6520  names. open the 
+0000cb90: 6461 7461 7365 7420 7573 696e 6720 6764  dataset using gd
+0000cba0: 616c 2e4f 7065 6e0d 0a20 2020 2020 2020  al.Open..       
+0000cbb0: 2062 616e 645f 6e61 6d65 7320 3d20 7365   band_names = se
+0000cbc0: 6c66 2e67 6574 5f62 616e 645f 6e61 6d65  lf.get_band_name
+0000cbd0: 7328 290d 0a0d 0a20 2020 2020 2020 2023  s()....        #
+0000cbe0: 2043 7265 6174 6520 6120 6d61 736b 2066   Create a mask f
+0000cbf0: 726f 6d20 7468 6520 7069 7865 6c73 2074  rom the pixels t
+0000cc00: 6f75 6368 6564 2062 7920 7468 6520 7665  ouched by the ve
+0000cc10: 6374 6f72 5f6d 6173 6b2e 0d0a 2020 2020  ctor_mask...    
+0000cc20: 2020 2020 6966 2076 6563 746f 725f 6d61      if vector_ma
+0000cc30: 736b 2069 7320 6e6f 7420 4e6f 6e65 3a0d  sk is not None:.
+0000cc40: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+0000cc50: 7265 6174 6520 6120 7465 6d70 6f72 6172  reate a temporar
+0000cc60: 7920 6469 7265 6374 6f72 7920 666f 7220  y directory for 
+0000cc70: 6669 6c65 732e 0d0a 2020 2020 2020 2020  files...        
+0000cc80: 2020 2020 7465 6d70 5f64 6972 203d 2074      temp_dir = t
+0000cc90: 656d 7066 696c 652e 6d6b 6474 656d 7028  empfile.mkdtemp(
+0000cca0: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
+0000ccb0: 6577 5f76 6563 746f 725f 7061 7468 203d  ew_vector_path =
+0000ccc0: 206f 732e 7061 7468 2e6a 6f69 6e28 7465   os.path.join(te
+0000ccd0: 6d70 5f64 6972 2c20 6622 7b75 7569 642e  mp_dir, f"{uuid.
+0000cce0: 7575 6964 3128 297d 2229 0d0a 0d0a 2020  uuid1()}")....  
+0000ccf0: 2020 2020 2020 2020 2020 2320 7265 6164            # read
+0000cd00: 2074 6865 2076 6563 746f 7220 7769 7468   the vector with
+0000cd10: 2067 656f 7061 6e64 6173 0d0a 2020 2020   geopandas..    
+0000cd20: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000cd30: 7461 6e63 6528 7665 6374 6f72 5f6d 6173  tance(vector_mas
+0000cd40: 6b2c 2047 656f 4461 7461 4672 616d 6529  k, GeoDataFrame)
+0000cd50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000cd60: 2020 2076 6563 746f 7220 3d20 4665 6174     vector = Feat
+0000cd70: 7572 6543 6f6c 6c65 6374 696f 6e28 7665  ureCollection(ve
+0000cd80: 6374 6f72 5f6d 6173 6b29 0d0a 2020 2020  ctor_mask)..    
+0000cd90: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+0000cda0: 6e73 7461 6e63 6528 7665 6374 6f72 5f6d  nstance(vector_m
+0000cdb0: 6173 6b2c 2046 6561 7475 7265 436f 6c6c  ask, FeatureColl
+0000cdc0: 6563 7469 6f6e 293a 0d0a 2020 2020 2020  ection):..      
+0000cdd0: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
+0000cde0: 203d 2076 6563 746f 725f 6d61 736b 0d0a   = vector_mask..
+0000cdf0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000ce00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000ce10: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0000ce20: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+0000ce30: 2020 2020 2020 2020 2066 2254 6865 2076           f"The v
+0000ce40: 6563 746f 725f 6d61 736b 2073 686f 756c  ector_mask shoul
+0000ce50: 6420 6265 206f 6620 7479 7065 3a20 5b47  d be of type: [G
+0000ce60: 656f 4461 7461 4672 616d 652f 4665 6174  eoDataFrame/Feat
+0000ce70: 7572 6543 6f6c 6c65 6374 696f 6e5d 2c20  ureCollection], 
+0000ce80: 6769 7665 6e3a 2022 0d0a 2020 2020 2020  given: "..      
+0000ce90: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000cea0: 7b74 7970 6528 7665 6374 6f72 5f6d 6173  {type(vector_mas
+0000ceb0: 6b29 7d22 0d0a 2020 2020 2020 2020 2020  k)}"..          
+0000cec0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+0000ced0: 2020 2020 2020 2023 2061 6464 2061 2075         # add a u
+0000cee0: 6e69 7175 6520 7661 6c75 6520 666f 7220  nique value for 
+0000cef0: 6561 6368 2072 6f77 7320 746f 2075 7365  each rows to use
+0000cf00: 2069 7420 746f 2072 6173 7465 7269 7a65   it to rasterize
+0000cf10: 2074 6865 2076 6563 746f 720d 0a20 2020   the vector..   
+0000cf20: 2020 2020 2020 2020 2076 6563 746f 722e           vector.
+0000cf30: 6665 6174 7572 655b 2262 7572 6e5f 7661  feature["burn_va
+0000cf40: 6c75 6522 5d20 3d20 6c69 7374 2872 616e  lue"] = list(ran
+0000cf50: 6765 2831 2c20 6c65 6e28 7665 6374 6f72  ge(1, len(vector
+0000cf60: 2e66 6561 7475 7265 2920 2b20 3129 290d  .feature) + 1)).
+0000cf70: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+0000cf80: 6176 6520 7468 6520 6e65 7720 7665 6374  ave the new vect
+0000cf90: 6f72 2074 6f20 6469 736b 2074 6f20 7265  or to disk to re
+0000cfa0: 6164 2069 7420 7769 7468 206f 6772 206c  ad it with ogr l
+0000cfb0: 6174 6572 0d0a 2020 2020 2020 2020 2020  ater..          
+0000cfc0: 2020 7665 6374 6f72 2e66 6561 7475 7265    vector.feature
+0000cfd0: 2e74 6f5f 6669 6c65 286e 6577 5f76 6563  .to_file(new_vec
+0000cfe0: 746f 725f 7061 7468 2c20 6472 6976 6572  tor_path, driver
+0000cff0: 3d22 4765 6f4a 534f 4e22 290d 0a0d 0a20  ="GeoJSON").... 
+0000d000: 2020 2020 2020 2020 2020 2023 2072 6173             # ras
+0000d010: 7465 7269 7a65 2074 6865 2076 6563 746f  terize the vecto
+0000d020: 7220 6279 2062 7572 6e69 6e67 2074 6865  r by burning the
+0000d030: 2075 6e69 7175 6520 7661 6c75 6573 2061   unique values a
+0000d040: 7320 6365 6c6c 2076 616c 7565 732e 0d0a  s cell values...
+0000d050: 2020 2020 2020 2020 2020 2020 2320 7261              # ra
+0000d060: 7374 6572 697a 6564 5f76 6563 746f 725f  sterized_vector_
+0000d070: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
+0000d080: 6f69 6e28 7465 6d70 5f64 6972 2c20 6622  oin(temp_dir, f"
+0000d090: 7b75 7569 642e 7575 6964 3128 297d 2e74  {uuid.uuid1()}.t
+0000d0a0: 6966 2229 0d0a 2020 2020 2020 2020 2020  if")..          
+0000d0b0: 2020 7261 7374 6572 697a 6564 5f76 6563    rasterized_vec
+0000d0c0: 746f 7220 3d20 7665 6374 6f72 2e74 6f5f  tor = vector.to_
+0000d0d0: 6461 7461 7365 7428 0d0a 2020 2020 2020  dataset(..      
+0000d0e0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+0000d0f0: 743d 7365 6c66 2c20 636f 6c75 6d6e 5f6e  t=self, column_n
+0000d100: 616d 653d 2262 7572 6e5f 7661 6c75 6522  ame="burn_value"
+0000d110: 0d0a 2020 2020 2020 2020 2020 2020 2920  ..            ) 
+0000d120: 2023 2072 6173 7465 7269 7a65 645f 7665   # rasterized_ve
+0000d130: 6374 6f72 5f70 6174 682c 0d0a 2020 2020  ctor_path,..    
+0000d140: 2020 2020 2020 2020 6966 2061 6464 5f67          if add_g
+0000d150: 656f 6d65 7472 793a 0d0a 2020 2020 2020  eometry:..      
+0000d160: 2020 2020 2020 2020 2020 6966 2061 6464            if add
+0000d170: 5f67 656f 6d65 7472 792e 6c6f 7765 7228  _geometry.lower(
+0000d180: 2920 3d3d 2022 706f 696e 7422 3a0d 0a20  ) == "point":.. 
+0000d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d1a0: 2020 2063 6f6f 7264 7320 3d20 7261 7374     coords = rast
+0000d1b0: 6572 697a 6564 5f76 6563 746f 722e 6765  erized_vector.ge
+0000d1c0: 745f 6365 6c6c 5f70 6f69 6e74 7328 6d61  t_cell_points(ma
+0000d1d0: 736b 3d54 7275 6529 0d0a 2020 2020 2020  sk=True)..      
+0000d1e0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0000d1f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d200: 2020 2020 2063 6f6f 7264 7320 3d20 7261       coords = ra
+0000d210: 7374 6572 697a 6564 5f76 6563 746f 722e  sterized_vector.
+0000d220: 6765 745f 6365 6c6c 5f70 6f6c 7967 6f6e  get_cell_polygon
+0000d230: 7328 6d61 736b 3d54 7275 6529 0d0a 0d0a  s(mask=True)....
+0000d240: 2020 2020 2020 2020 2020 2020 2320 4c6f              # Lo
+0000d250: 6f70 206f 7665 7220 6d61 736b 2076 616c  op over mask val
+0000d260: 7565 7320 746f 2065 7874 7261 6374 2070  ues to extract p
+0000d270: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
+0000d280: 2020 2020 2320 4461 7461 4672 616d 6573      # DataFrames
+0000d290: 206f 6620 6561 6368 2074 696c 652e 0d0a   of each tile...
+0000d2a0: 2020 2020 2020 2020 2020 2020 6466 5f6c              df_l
+0000d2b0: 6973 7420 3d20 5b5d 0d0a 2020 2020 2020  ist = []..      
+0000d2c0: 2020 2020 2020 6d61 736b 5f61 7272 203d        mask_arr =
+0000d2d0: 2072 6173 7465 7269 7a65 645f 7665 6374   rasterized_vect
+0000d2e0: 6f72 2e72 6173 7465 722e 4765 7452 6173  or.raster.GetRas
+0000d2f0: 7465 7242 616e 6428 3129 2e52 6561 6441  terBand(1).ReadA
+0000d300: 7341 7272 6179 2829 0d0a 0d0a 2020 2020  sArray()....    
+0000d310: 2020 2020 2020 2020 666f 7220 6172 7220          for arr 
+0000d320: 696e 2073 656c 662e 6765 745f 7469 6c65  in self.get_tile
+0000d330: 2874 696c 655f 7369 7a65 293a 0d0a 0d0a  (tile_size):....
+0000d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d350: 6d61 736b 5f64 6673 203d 205b 5d0d 0a20  mask_dfs = [].. 
+0000d360: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000d370: 6f72 206d 6173 6b5f 7661 6c20 696e 2076  or mask_val in v
+0000d380: 6563 746f 722e 6665 6174 7572 655b 2262  ector.feature["b
+0000d390: 7572 6e5f 7661 6c75 6522 5d2e 7661 6c75  urn_value"].valu
+0000d3a0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
+0000d3b0: 2020 2020 2020 2020 2023 2045 7874 7261           # Extra
+0000d3c0: 6374 206f 6e6c 7920 6d61 736b 6564 2070  ct only masked p
+0000d3d0: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
+0000d3e0: 2020 2020 2020 2020 2020 2020 666c 6174              flat
+0000d3f0: 7465 6e5f 6d61 736b 6564 5f76 616c 7565  ten_masked_value
+0000d400: 7320 3d20 6765 745f 7069 7865 6c73 280d  s = get_pixels(.
+0000d410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d420: 2020 2020 2020 2020 2061 7272 2c20 6d61           arr, ma
+0000d430: 736b 5f61 7272 2c20 6d61 736b 5f76 616c  sk_arr, mask_val
+0000d440: 3d6d 6173 6b5f 7661 6c0d 0a20 2020 2020  =mask_val..     
+0000d450: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000d460: 2e74 7261 6e73 706f 7365 2829 0d0a 2020  .transpose()..  
+0000d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d480: 2020 6669 645f 7078 203d 206e 702e 6f6e    fid_px = np.on
+0000d490: 6573 2866 6c61 7474 656e 5f6d 6173 6b65  es(flatten_maske
+0000d4a0: 645f 7661 6c75 6573 2e73 6861 7065 5b30  d_values.shape[0
+0000d4b0: 5d29 202a 206d 6173 6b5f 7661 6c0d 0a0d  ]) * mask_val...
+0000d4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d4d0: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
+0000d4e0: 4461 7461 4672 616d 6520 6f66 206d 6173  DataFrame of mas
+0000d4f0: 6b65 6420 666c 6174 7465 6e5f 6d61 736b  ked flatten_mask
+0000d500: 6564 5f76 616c 7565 7320 616e 6420 7468  ed_values and th
+0000d510: 6569 7220 4649 442e 0d0a 2020 2020 2020  eir FID...      
+0000d520: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0000d530: 736b 5f64 6620 3d20 7064 2e44 6174 6146  sk_df = pd.DataF
+0000d540: 7261 6d65 2866 6c61 7474 656e 5f6d 6173  rame(flatten_mas
+0000d550: 6b65 645f 7661 6c75 6573 2c20 636f 6c75  ked_values, colu
+0000d560: 6d6e 733d 6261 6e64 5f6e 616d 6573 290d  mns=band_names).
+0000d570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d580: 2020 2020 206d 6173 6b5f 6466 5b22 6275       mask_df["bu
+0000d590: 726e 5f76 616c 7565 225d 203d 2066 6964  rn_value"] = fid
+0000d5a0: 5f70 780d 0a20 2020 2020 2020 2020 2020  _px..           
+0000d5b0: 2020 2020 2020 2020 206d 6173 6b5f 6466           mask_df
+0000d5c0: 732e 6170 7065 6e64 286d 6173 6b5f 6466  s.append(mask_df
+0000d5d0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000d5e0: 2020 2020 2023 2043 6f6e 6361 7420 7468       # Concat th
+0000d5f0: 6520 6d61 736b 2044 6174 6146 7261 6d65  e mask DataFrame
+0000d600: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+0000d610: 2020 2020 6d61 736b 5f64 6620 3d20 7064      mask_df = pd
+0000d620: 2e63 6f6e 6361 7428 6d61 736b 5f64 6673  .concat(mask_dfs
+0000d630: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000d640: 2020 2020 2023 204a 6f69 6e20 7769 7468       # Join with
+0000d650: 2070 6978 656c 7320 7769 7468 2076 6563   pixels with vec
+0000d660: 746f 7220 6174 7472 6962 7574 6573 2075  tor attributes u
+0000d670: 7369 6e67 2074 6865 2046 4944 2e0d 0a20  sing the FID... 
+0000d680: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000d690: 665f 6c69 7374 2e61 7070 656e 6428 0d0a  f_list.append(..
+0000d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d6b0: 2020 2020 6d61 736b 5f64 662e 6d65 7267      mask_df.merg
+0000d6c0: 6528 7665 6374 6f72 2e66 6561 7475 7265  e(vector.feature
+0000d6d0: 2c20 686f 773d 226c 6566 7422 2c20 6f6e  , how="left", on
+0000d6e0: 3d22 6275 726e 5f76 616c 7565 2229 0d0a  ="burn_value")..
+0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d700: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000d710: 2023 204d 6572 6765 2061 6c6c 2074 6865   # Merge all the
+0000d720: 2074 696c 6573 2e0d 0a20 2020 2020 2020   tiles...       
+0000d730: 2020 2020 206f 7574 5f64 6620 3d20 7064       out_df = pd
+0000d740: 2e63 6f6e 6361 7428 6466 5f6c 6973 7429  .concat(df_list)
+0000d750: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000d760: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000d770: 7469 6c65 3a0d 0a20 2020 2020 2020 2020  tile:..         
+0000d780: 2020 2020 2020 2064 665f 6c69 7374 203d         df_list =
+0000d790: 205b 5d20 2023 2044 6174 6146 7261 6d65   []  # DataFrame
+0000d7a0: 7320 6f66 2065 6163 6820 7469 6c65 2e0d  s of each tile..
+0000d7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d7c0: 2066 6f72 2061 7272 2069 6e20 4461 7461   for arr in Data
+0000d7d0: 7365 742e 6765 745f 7469 6c65 2873 656c  set.get_tile(sel
+0000d7e0: 662e 7261 7374 6572 293a 0d0a 2020 2020  f.raster):..    
+0000d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d800: 2320 4173 7375 6d65 206d 756c 7469 6261  # Assume multiba
+0000d810: 6e64 0d0a 2020 2020 2020 2020 2020 2020  nd..            
+0000d820: 2020 2020 2020 2020 6964 7820 3d20 2831          idx = (1
+0000d830: 2c20 3229 0d0a 2020 2020 2020 2020 2020  , 2)..          
+0000d840: 2020 2020 2020 2020 2020 6966 2061 7272            if arr
+0000d850: 2e6e 6469 6d20 3d3d 2032 3a0d 0a20 2020  .ndim == 2:..   
+0000d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d870: 2020 2020 2023 2048 616e 646c 6520 7369       # Handle si
+0000d880: 6e67 6c65 2062 616e 6420 7261 7374 6572  ngle band raster
+0000d890: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0000d8a0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+0000d8b0: 2028 302c 2031 290d 0a0d 0a20 2020 2020   (0, 1)....     
+0000d8c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000d8d0: 6173 6b5f 6172 7220 3d20 6e70 2e6f 6e65  ask_arr = np.one
+0000d8e0: 7328 2861 7272 2e73 6861 7065 5b69 6478  s((arr.shape[idx
+0000d8f0: 5b30 5d5d 2c20 6172 722e 7368 6170 655b  [0]], arr.shape[
+0000d900: 6964 785b 315d 5d29 290d 0a20 2020 2020  idx[1]]))..     
+0000d910: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000d920: 6978 656c 7320 3d20 6765 745f 7069 7865  ixels = get_pixe
+0000d930: 6c73 2861 7272 2c20 6d61 736b 5f61 7272  ls(arr, mask_arr
+0000d940: 292e 7472 616e 7370 6f73 6528 290d 0a20  ).transpose().. 
+0000d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d960: 2020 2064 665f 6c69 7374 2e61 7070 656e     df_list.appen
+0000d970: 6428 7064 2e44 6174 6146 7261 6d65 2870  d(pd.DataFrame(p
+0000d980: 6978 656c 732c 2063 6f6c 756d 6e73 3d62  ixels, columns=b
+0000d990: 616e 645f 6e61 6d65 7329 290d 0a0d 0a20  and_names)).... 
+0000d9a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000d9b0: 204d 6572 6765 2061 6c6c 2074 6865 2074   Merge all the t
+0000d9c0: 696c 6573 2e0d 0a20 2020 2020 2020 2020  iles...         
+0000d9d0: 2020 2020 2020 206f 7574 5f64 6620 3d20         out_df = 
+0000d9e0: 7064 2e63 6f6e 6361 7428 6466 5f6c 6973  pd.concat(df_lis
+0000d9f0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+0000da00: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0000da10: 2020 2020 2020 2023 2057 6172 6e69 6e67         # Warning
+0000da20: 3a20 6e6f 7420 6368 6563 6b65 6420 7965  : not checked ye
+0000da30: 7420 666f 7220 6d75 6c74 6920 6261 6e64  t for multi band
+0000da40: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0000da50: 2020 2061 7272 203d 2073 656c 662e 7261     arr = self.ra
+0000da60: 7374 6572 2e52 6561 6441 7341 7272 6179  ster.ReadAsArray
+0000da70: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0000da80: 2020 2020 7069 7865 6c73 203d 2061 7272      pixels = arr
+0000da90: 2e66 6c61 7474 656e 2829 0d0a 2020 2020  .flatten()..    
+0000daa0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
+0000dab0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+0000dac0: 6528 7069 7865 6c73 2c20 636f 6c75 6d6e  e(pixels, column
+0000dad0: 733d 6261 6e64 5f6e 616d 6573 290d 0a0d  s=band_names)...
+0000dae0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000daf0: 6164 645f 6765 6f6d 6574 7279 3a0d 0a20  add_geometry:.. 
+0000db00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000db10: 6620 6164 645f 6765 6f6d 6574 7279 2e6c  f add_geometry.l
+0000db20: 6f77 6572 2829 203d 3d20 2270 6f69 6e74  ower() == "point
+0000db30: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+0000db40: 2020 2020 2020 2020 636f 6f72 6473 203d          coords =
+0000db50: 2073 656c 662e 6765 745f 6365 6c6c 5f70   self.get_cell_p
+0000db60: 6f69 6e74 7328 6d61 736b 3d54 7275 6529  oints(mask=True)
+0000db70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000db80: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000db90: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+0000dba0: 7264 7320 3d20 7365 6c66 2e67 6574 5f63  rds = self.get_c
+0000dbb0: 656c 6c5f 706f 6c79 676f 6e73 286d 6173  ell_polygons(mas
+0000dbc0: 6b3d 5472 7565 290d 0a0d 0a20 2020 2020  k=True)....     
+0000dbd0: 2020 206f 7574 5f64 6620 3d20 6f75 745f     out_df = out_
+0000dbe0: 6466 2e64 726f 7028 636f 6c75 6d6e 733d  df.drop(columns=
+0000dbf0: 5b22 6275 726e 5f76 616c 7565 222c 2022  ["burn_value", "
+0000dc00: 6765 6f6d 6574 7279 225d 2c20 6572 726f  geometry"], erro
+0000dc10: 7273 3d22 6967 6e6f 7265 2229 0d0a 2020  rs="ignore")..  
+0000dc20: 2020 2020 2020 6966 2061 6464 5f67 656f        if add_geo
+0000dc30: 6d65 7472 793a 0d0a 2020 2020 2020 2020  metry:..        
+0000dc40: 2020 2020 6f75 745f 6466 203d 2067 7064      out_df = gpd
+0000dc50: 2e47 656f 4461 7461 4672 616d 6528 6f75  .GeoDataFrame(ou
+0000dc60: 745f 6466 2c20 6765 6f6d 6574 7279 3d63  t_df, geometry=c
+0000dc70: 6f6f 7264 735b 2267 656f 6d65 7472 7922  oords["geometry"
+0000dc80: 5d29 0d0a 0d0a 2020 2020 2020 2020 2320  ])....        # 
+0000dc90: 544f 444f 206d 6173 6b20 6e6f 2064 6174  TODO mask no dat
+0000dca0: 6120 7661 6c75 6573 2e0d 0a0d 0a20 2020  a values.....   
+0000dcb0: 2020 2020 2023 2052 656d 6f76 6520 7465       # Remove te
+0000dcc0: 6d70 6f72 6172 7920 6669 6c65 732e 0d0a  mporary files...
+0000dcd0: 2020 2020 2020 2020 6966 2074 656d 705f          if temp_
+0000dce0: 6469 7220 6973 206e 6f74 204e 6f6e 653a  dir is not None:
+0000dcf0: 0d0a 2020 2020 2020 2020 2020 2020 7368  ..            sh
+0000dd00: 7574 696c 2e72 6d74 7265 6528 7465 6d70  util.rmtree(temp
+0000dd10: 5f64 6972 2c20 6967 6e6f 7265 5f65 7272  _dir, ignore_err
+0000dd20: 6f72 733d 5472 7565 290d 0a0d 0a20 2020  ors=True)....   
+0000dd30: 2020 2020 2023 2052 6574 7572 6e20 6472       # Return dr
+0000dd40: 6f70 7069 6e67 2061 6e79 2065 7874 7261  opping any extra
+0000dd50: 2063 6f6c 732e 0d0a 2020 2020 2020 2020   cols...        
+0000dd60: 7265 7475 726e 206f 7574 5f64 660d 0a0d  return out_df...
+0000dd70: 0a20 2020 2064 6566 2061 7070 6c79 2873  .    def apply(s
+0000dd80: 656c 662c 2066 756e 2c20 6261 6e64 3a20  elf, fun, band: 
+0000dd90: 696e 7420 3d20 3029 3a0d 0a20 2020 2020  int = 0):..     
+0000dda0: 2020 2022 2222 6d61 7041 6c67 6562 7261     """mapAlgebra
+0000ddb0: 2e0d 0a0d 0a20 2020 2020 2020 202d 206d  .....        - m
+0000ddc0: 6170 416c 6765 6272 6120 6578 6563 7574  apAlgebra execut
+0000ddd0: 6573 2061 206d 6174 6865 6d61 7469 6361  es a mathematica
+0000dde0: 6c20 6f70 6572 6174 696f 6e20 6f6e 2072  l operation on r
+0000ddf0: 6173 7465 7220 6172 7261 7920 616e 6420  aster array and 
+0000de00: 7265 7475 726e 730d 0a20 2020 2020 2020  returns..       
+0000de10: 2074 6865 2072 6573 756c 740d 0a20 2020   the result..   
+0000de20: 2020 2020 202d 2054 6865 206d 6170 416c       - The mapAl
+0000de30: 6765 6272 6120 6578 6563 7574 6573 2074  gebra executes t
+0000de40: 6865 2066 756e 6374 696f 6e20 6f6e 6c79  he function only
+0000de50: 206f 6e20 6f6e 6520 6365 6c6c 2061 7420   on one cell at 
+0000de60: 6120 7469 6d65 2e0d 0a0d 0a20 2020 2020  a time.....     
+0000de70: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0000de80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000de90: 2d0d 0a20 2020 2020 2020 2066 756e 3a20  -..        fun: 
+0000dea0: 5b66 756e 6374 696f 6e5d 0d0a 2020 2020  [function]..    
+0000deb0: 2020 2020 2020 2020 6465 6669 6e65 6420          defined 
+0000dec0: 6675 6e63 7469 6f6e 2074 6861 7420 7461  function that ta
+0000ded0: 6b65 7320 6f6e 6520 696e 7075 7420 7768  kes one input wh
+0000dee0: 6963 6820 6973 2074 6865 2063 656c 6c20  ich is the cell 
+0000def0: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
+0000df00: 6261 6e64 3a20 5b69 6e74 5d0d 0a20 2020  band: [int]..   
+0000df10: 2020 2020 2020 2020 2062 616e 6420 6e75           band nu
+0000df20: 6d62 6572 2e0d 0a0d 0a20 2020 2020 2020  mber.....       
+0000df30: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0000df40: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0000df50: 2020 2044 6174 6163 7562 650d 0a20 2020     Datacube..   
+0000df60: 2020 2020 2020 2020 2067 6461 6c20 6461           gdal da
+0000df70: 7461 7365 7420 6f62 6a65 6374 0d0a 0d0a  taset object....
+0000df80: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0000df90: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0000dfa0: 2d2d 0d0a 2020 2020 2020 2020 3e3e 3e20  --..        >>> 
+0000dfb0: 7372 635f 7261 7374 6572 203d 2067 6461  src_raster = gda
+0000dfc0: 6c2e 4f70 656e 2822 6576 6170 2e74 6966  l.Open("evap.tif
+0000dfd0: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
+0000dfe0: 6675 6e63 203d 206e 702e 6162 730d 0a20  func = np.abs.. 
+0000dff0: 2020 2020 2020 203e 3e3e 206e 6577 5f72         >>> new_r
+0000e000: 6173 7465 7220 3d20 4461 7461 7365 742e  aster = Dataset.
+0000e010: 6170 706c 7928 7372 635f 7261 7374 6572  apply(src_raster
+0000e020: 2c20 6675 6e63 290d 0a20 2020 2020 2020  , func)..       
+0000e030: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+0000e040: 206e 6f74 2063 616c 6c61 626c 6528 6675   not callable(fu
+0000e050: 6e29 3a0d 0a20 2020 2020 2020 2020 2020  n):..           
+0000e060: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0000e070: 2822 7365 636f 6e64 2061 7267 756d 656e  ("second argumen
+0000e080: 7420 7368 6f75 6c64 2062 6520 6120 6675  t should be a fu
+0000e090: 6e63 7469 6f6e 2229 0d0a 0d0a 2020 2020  nction")....    
+0000e0a0: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+0000e0b0: 6520 3d20 7365 6c66 2e6e 6f5f 6461 7461  e = self.no_data
+0000e0c0: 5f76 616c 7565 5b62 616e 645d 0d0a 2020  _value[band]..  
+0000e0d0: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
+0000e0e0: 3d20 7365 6c66 2e72 6561 645f 6172 7261  = self.read_arra
+0000e0f0: 7928 6261 6e64 290d 0a20 2020 2020 2020  y(band)..       
+0000e100: 2064 7479 7065 203d 2073 656c 662e 6474   dtype = self.dt
+0000e110: 7970 655b 6261 6e64 5d0d 0a0d 0a20 2020  ype[band]....   
+0000e120: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
+0000e130: 6e65 7720 6172 7261 7920 7769 7468 2074  new array with t
+0000e140: 6865 206e 6f64 6174 6120 7661 6c75 650d  he nodata value.
+0000e150: 0a20 2020 2020 2020 206e 6577 5f61 7272  .        new_arr
+0000e160: 6179 203d 206e 702e 6f6e 6573 2828 7365  ay = np.ones((se
+0000e170: 6c66 2e72 6f77 732c 2073 656c 662e 636f  lf.rows, self.co
+0000e180: 6c75 6d6e 7329 2920 2a20 6e6f 5f64 6174  lumns)) * no_dat
+0000e190: 615f 7661 6c75 650d 0a20 2020 2020 2020  a_value..       
+0000e1a0: 2023 2065 7865 6375 7465 2074 6865 2066   # execute the f
+0000e1b0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
+0000e1c0: 6365 6c6c 0d0a 2020 2020 2020 2020 2320  cell..        # 
+0000e1d0: 544f 444f 3a20 6f70 7469 6d69 7a65 2065  TODO: optimize e
+0000e1e0: 7865 6375 7469 6e67 2061 2066 756e 6374  xecuting a funct
+0000e1f0: 696f 6e20 6f76 6572 2061 2077 686f 6c65  ion over a whole
+0000e200: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
+0000e210: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
+0000e220: 656c 662e 726f 7773 293a 0d0a 2020 2020  elf.rows):..    
+0000e230: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+0000e240: 2072 616e 6765 2873 656c 662e 636f 6c75   range(self.colu
+0000e250: 6d6e 7329 3a0d 0a20 2020 2020 2020 2020  mns):..         
+0000e260: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
+0000e270: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
+0000e280: 6179 5b69 2c20 6a5d 2c20 6e6f 5f64 6174  ay[i, j], no_dat
+0000e290: 615f 7661 6c75 652c 2072 746f 6c3d 302e  a_value, rtol=0.
+0000e2a0: 3030 3129 3a0d 0a20 2020 2020 2020 2020  001):..         
+0000e2b0: 2020 2020 2020 2020 2020 206e 6577 5f61             new_a
+0000e2c0: 7272 6179 5b69 2c20 6a5d 203d 2066 756e  rray[i, j] = fun
+0000e2d0: 2873 7263 5f61 7272 6179 5b69 2c20 6a5d  (src_array[i, j]
+0000e2e0: 290d 0a0d 0a20 2020 2020 2020 2023 2063  )....        # c
+0000e2f0: 7265 6174 6520 7468 6520 6f75 7470 7574  reate the output
+0000e300: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
+0000e310: 2064 7374 203d 2044 6174 6173 6574 2e5f   dst = Dataset._
+0000e320: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
+0000e330: 7365 7428 0d0a 2020 2020 2020 2020 2020  set(..          
+0000e340: 2020 7365 6c66 2e63 6f6c 756d 6e73 2c20    self.columns, 
+0000e350: 7365 6c66 2e72 6f77 732c 2031 2c20 6474  self.rows, 1, dt
+0000e360: 7970 652c 2064 7269 7665 723d 224d 454d  ype, driver="MEM
+0000e370: 220d 0a20 2020 2020 2020 2029 0d0a 2020  "..        )..  
+0000e380: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
+0000e390: 6765 6f74 7261 6e73 666f 726d 0d0a 2020  geotransform..  
+0000e3a0: 2020 2020 2020 6473 742e 5365 7447 656f        dst.SetGeo
+0000e3b0: 5472 616e 7366 6f72 6d28 7365 6c66 2e67  Transform(self.g
+0000e3c0: 656f 7472 616e 7366 6f72 6d29 0d0a 2020  eotransform)..  
+0000e3d0: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
+0000e3e0: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
+0000e3f0: 2020 2020 6473 742e 5365 7450 726f 6a65      dst.SetProje
+0000e400: 6374 696f 6e28 7365 6c66 2e63 7273 290d  ction(self.crs).
+0000e410: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
+0000e420: 203d 2044 6174 6173 6574 2864 7374 290d   = Dataset(dst).
+0000e430: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
+0000e440: 2e5f 7365 745f 6e6f 5f64 6174 615f 7661  ._set_no_data_va
+0000e450: 6c75 6528 6e6f 5f64 6174 615f 7661 6c75  lue(no_data_valu
+0000e460: 653d 6e6f 5f64 6174 615f 7661 6c75 6529  e=no_data_value)
+0000e470: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
+0000e480: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
+0000e490: 6572 4261 6e64 2862 616e 6420 2b20 3129  erBand(band + 1)
+0000e4a0: 2e57 7269 7465 4172 7261 7928 6e65 775f  .WriteArray(new_
+0000e4b0: 6172 7261 7929 0d0a 0d0a 2020 2020 2020  array)....      
+0000e4c0: 2020 7265 7475 726e 2064 7374 5f6f 626a    return dst_obj
+0000e4d0: 0d0a 0d0a 2020 2020 6465 6620 6669 6c6c  ....    def fill
+0000e4e0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
+0000e4f0: 2076 616c 3a20 556e 696f 6e5b 666c 6f61   val: Union[floa
+0000e500: 742c 2069 6e74 5d2c 2064 7269 7665 723a  t, int], driver:
+0000e510: 2073 7472 203d 2022 4d45 4d22 2c20 7061   str = "MEM", pa
+0000e520: 7468 3a20 7374 7220 3d20 4e6f 6e65 0d0a  th: str = None..
+0000e530: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b4e      ) -> Union[N
+0000e540: 6f6e 652c 2067 6461 6c2e 4461 7461 7365  one, gdal.Datase
+0000e550: 745d 3a0d 0a20 2020 2020 2020 2022 2222  t]:..        """
+0000e560: 4669 6c6c 2e0d 0a0d 0a20 2020 2020 2020  Fill.....       
+0000e570: 2020 2020 2046 696c 6c20 7461 6b65 7320       Fill takes 
+0000e580: 6120 7261 7374 6572 2061 6e64 2066 696c  a raster and fil
+0000e590: 6c20 6974 2077 6974 6820 6f6e 6520 7661  l it with one va
+0000e5a0: 6c75 650d 0a0d 0a20 2020 2020 2020 2050  lue....        P
+0000e5b0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0000e5c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000e5d0: 2020 2020 2020 2076 616c 3a20 5b6e 756d         val: [num
+0000e5e0: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
+0000e5f0: 2020 206e 756d 6572 6963 2076 616c 7565     numeric value
+0000e600: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
+0000e610: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
+0000e620: 2020 2020 2064 7269 7665 7220 7479 7065       driver type
+0000e630: 205b 2247 5469 6666 222c 2022 4d45 4d22   ["GTiff", "MEM"
+0000e640: 5d0d 0a20 2020 2020 2020 2070 6174 6820  ]..        path 
+0000e650: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
+0000e660: 2020 2020 2070 6174 6820 696e 636c 7564       path includ
+0000e670: 696e 6720 7468 6520 6578 7465 6e73 696f  ing the extensio
+0000e680: 6e20 282e 7469 6629 0d0a 0d0a 2020 2020  n (.tif)....    
+0000e690: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0000e6a0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0000e6b0: 2020 2020 2020 7261 7374 6572 203a 205b        raster : [
+0000e6c0: 4e6f 6e65 2f67 6461 6c2e 4461 7461 6375  None/gdal.Datacu
+0000e6d0: 6265 5d0d 0a20 2020 2020 2020 2020 2020  be]..           
+0000e6e0: 2069 6620 7468 6520 7261 7374 6572 2069   if the raster i
+0000e6f0: 7320 7361 7665 6420 6469 7265 6374 6c79  s saved directly
+0000e700: 2074 6f20 7468 6520 7061 7468 2079 6f75   to the path you
+0000e710: 2070 726f 7669 6465 6420 7468 6520 7265   provided the re
+0000e720: 7475 726e 6564 2076 616c 7565 2077 696c  turned value wil
+0000e730: 6c20 6265 204e 6f6e 652c 206f 7468 6572  l be None, other
+0000e740: 7769 7365 2074 6865 0d0a 2020 2020 2020  wise the..      
+0000e750: 2020 2020 2020 7265 7475 726e 6564 2076        returned v
+0000e760: 616c 7565 2077 696c 6c20 6265 2074 6865  alue will be the
+0000e770: 2067 6461 6c2e 4461 7461 6375 6265 2069   gdal.Datacube i
+0000e780: 7473 656c 662e 0d0a 2020 2020 2020 2020  tself...        
+0000e790: 2222 220d 0a20 2020 2020 2020 206e 6f5f  """..        no_
+0000e7a0: 6461 7461 5f76 616c 7565 203d 2073 656c  data_value = sel
+0000e7b0: 662e 6e6f 5f64 6174 615f 7661 6c75 655b  f.no_data_value[
+0000e7c0: 305d 0d0a 2020 2020 2020 2020 7372 635f  0]..        src_
+0000e7d0: 6172 7261 7920 3d20 7365 6c66 2e72 6173  array = self.ras
+0000e7e0: 7465 722e 5265 6164 4173 4172 7261 7928  ter.ReadAsArray(
+0000e7f0: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
+0000e800: 6e6f 5f64 6174 615f 7661 6c75 6520 6973  no_data_value is
+0000e810: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0000e820: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+0000e830: 6520 3d20 6e70 2e6e 616e 0d0a 0d0a 2020  e = np.nan....  
+0000e840: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
+0000e850: 6973 6e61 6e28 6e6f 5f64 6174 615f 7661  isnan(no_data_va
+0000e860: 6c75 6529 3a0d 0a20 2020 2020 2020 2020  lue):..         
+0000e870: 2020 2073 7263 5f61 7272 6179 5b7e 6e70     src_array[~np
+0000e880: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
+0000e890: 6179 2c20 6e6f 5f64 6174 615f 7661 6c75  ay, no_data_valu
+0000e8a0: 652c 2072 746f 6c3d 302e 3030 3030 3031  e, rtol=0.000001
+0000e8b0: 295d 203d 2076 616c 0d0a 2020 2020 2020  )] = val..      
+0000e8c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000e8d0: 2020 2020 2073 7263 5f61 7272 6179 5b7e       src_array[~
+0000e8e0: 6e70 2e69 736e 616e 2873 7263 5f61 7272  np.isnan(src_arr
+0000e8f0: 6179 295d 203d 2076 616c 0d0a 2020 2020  ay)] = val..    
+0000e900: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
+0000e910: 742e 6461 7461 7365 745f 6c69 6b65 2873  t.dataset_like(s
+0000e920: 656c 662c 2073 7263 5f61 7272 6179 2c20  elf, src_array, 
+0000e930: 6472 6976 6572 3d64 7269 7665 722c 2070  driver=driver, p
+0000e940: 6174 683d 7061 7468 290d 0a20 2020 2020  ath=path)..     
+0000e950: 2020 2072 6574 7572 6e20 6473 740d 0a0d     return dst...
+0000e960: 0a20 2020 2064 6566 2072 6573 616d 706c  .    def resampl
+0000e970: 6528 7365 6c66 2c20 6365 6c6c 5f73 697a  e(self, cell_siz
+0000e980: 653a 2055 6e69 6f6e 5b69 6e74 2c20 666c  e: Union[int, fl
+0000e990: 6f61 745d 2c20 6d65 7468 6f64 3a20 7374  oat], method: st
+0000e9a0: 7220 3d20 226e 6561 7265 7374 206e 6569  r = "nearest nei
+0000e9b0: 626f 7572 2229 3a0d 0a20 2020 2020 2020  bour"):..       
+0000e9c0: 2022 2222 7265 7361 6d70 6c65 2e0d 0a0d   """resample....
+0000e9d0: 0a20 2020 2020 2020 2072 6573 616d 706c  .        resampl
+0000e9e0: 6520 6d65 7468 6f64 2072 6570 726f 6a65  e method reproje
+0000e9f0: 6374 2061 2072 6173 7465 7220 746f 2061  ct a raster to a
+0000ea00: 6e79 2070 726f 6a65 6374 696f 6e0d 0a20  ny projection.. 
+0000ea10: 2020 2020 2020 2028 6465 6661 756c 7420         (default 
+0000ea20: 7468 6520 5747 5338 3420 7765 6220 6d65  the WGS84 web me
+0000ea30: 7263 6174 6f72 2070 726f 6a65 6374 696f  rcator projectio
+0000ea40: 6e2c 2077 6974 686f 7574 2072 6573 616d  n, without resam
+0000ea50: 706c 696e 6729 0d0a 2020 2020 2020 2020  pling)..        
+0000ea60: 5468 6520 6675 6e63 7469 6f6e 2072 6574  The function ret
+0000ea70: 7572 6e73 2061 2047 4441 4c20 696e 2d6d  urns a GDAL in-m
+0000ea80: 656d 6f72 7920 6669 6c65 206f 626a 6563  emory file objec
+0000ea90: 742c 2077 6865 7265 2079 6f75 2063 616e  t, where you can
+0000eaa0: 2052 6561 6441 7341 7272 6179 2065 7463   ReadAsArray etc
+0000eab0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+0000eac0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0000ead0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0000eae0: 2020 2020 2063 656c 6c5f 7369 7a65 203a       cell_size :
+0000eaf0: 205b 696e 7465 6765 725d 0d0a 2020 2020   [integer]..    
+0000eb00: 2020 2020 2020 2020 206e 6577 2063 656c           new cel
+0000eb10: 6c20 7369 7a65 2074 6f20 7265 7361 6d70  l size to resamp
+0000eb20: 6c65 2074 6865 2072 6173 7465 722e 0d0a  le the raster...
+0000eb30: 2020 2020 2020 2020 2020 2020 2864 6566              (def
+0000eb40: 6175 6c74 2065 6d70 7479 2073 6f20 7261  ault empty so ra
+0000eb50: 7374 6572 2077 696c 6c20 6e6f 7420 6265  ster will not be
+0000eb60: 2072 6573 616d 706c 6564 290d 0a20 2020   resampled)..   
+0000eb70: 2020 2020 206d 6574 686f 6420 3a20 5b53       method : [S
+0000eb80: 7472 696e 675d 0d0a 2020 2020 2020 2020  tring]..        
+0000eb90: 2020 2020 7265 7361 6d70 6c69 6e67 2074      resampling t
+0000eba0: 6563 686e 6971 7565 2064 6566 6175 6c74  echnique default
+0000ebb0: 2069 7320 224e 6561 7265 7374 220d 0a20   is "Nearest".. 
+0000ebc0: 2020 2020 2020 2020 2020 2068 7474 7073             https
+0000ebd0: 3a2f 2f67 6973 6765 6f67 7261 7068 792e  ://gisgeography.
+0000ebe0: 636f 6d2f 7261 7374 6572 2d72 6573 616d  com/raster-resam
+0000ebf0: 706c 696e 672f 0d0a 2020 2020 2020 2020  pling/..        
+0000ec00: 2020 2020 226e 6561 7265 7374 206e 6569      "nearest nei
+0000ec10: 626f 7572 2220 666f 7220 6e65 6172 6573  bour" for neares
+0000ec20: 7420 6e65 6967 6862 6f75 722c 2263 7562  t neighbour,"cub
+0000ec30: 6963 2220 666f 7220 6375 6269 6320 636f  ic" for cubic co
+0000ec40: 6e76 6f6c 7574 696f 6e2c 0d0a 2020 2020  nvolution,..    
+0000ec50: 2020 2020 2020 2020 2262 696c 696e 6561          "bilinea
+0000ec60: 7222 2066 6f72 2062 696c 696e 6561 720d  r" for bilinear.
+0000ec70: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000ec80: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+0000ec90: 2d2d 2d0d 0a20 2020 2020 2020 2072 6173  ---..        ras
+0000eca0: 7465 7220 3a20 5b44 6174 6173 6574 5d0d  ter : [Dataset].
+0000ecb0: 0a20 2020 2020 2020 2020 2020 2020 4461  .             Da
+0000ecc0: 7461 7365 7420 6f62 6a65 6374 2e0d 0a20  taset object... 
+0000ecd0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0000ece0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0000ecf0: 7461 6e63 6528 6d65 7468 6f64 2c20 7374  tance(method, st
+0000ed00: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
+0000ed10: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0000ed20: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0000ed30: 2020 2022 2070 6c65 6173 6520 656e 7465     " please ente
+0000ed40: 7220 636f 7272 6563 7420 6d65 7468 6f64  r correct method
+0000ed50: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+0000ed60: 6e20 7365 6520 646f 636d 656e 7461 7469  n see docmentati
+0000ed70: 6f6e 2022 0d0a 2020 2020 2020 2020 2020  on "..          
+0000ed80: 2020 290d 0a20 2020 2020 2020 2069 6620    )..        if 
+0000ed90: 6d65 7468 6f64 206e 6f74 2069 6e20 494e  method not in IN
+0000eda0: 5445 5250 4f4c 4154 494f 4e5f 4d45 5448  TERPOLATION_METH
+0000edb0: 4f44 532e 6b65 7973 2829 3a0d 0a20 2020  ODS.keys():..   
+0000edc0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000edd0: 616c 7565 4572 726f 7228 0d0a 2020 2020  alueError(..    
+0000ede0: 2020 2020 2020 2020 2020 2020 6622 5468              f"Th
+0000edf0: 6520 6769 7665 6e20 696e 7465 7270 6f6c  e given interpol
+0000ee00: 6174 696f 6e20 6d65 7468 6f64 2064 6f65  ation method doe
+0000ee10: 7320 6e6f 7420 6578 6973 742c 2065 7869  s not exist, exi
+0000ee20: 7374 696e 6720 6d65 7468 6f64 7320 6172  sting methods ar
+0000ee30: 6520 7b49 4e54 4552 504f 4c41 5449 4f4e  e {INTERPOLATION
+0000ee40: 5f4d 4554 484f 4453 2e6b 6579 7328 297d  _METHODS.keys()}
+0000ee50: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
+0000ee60: 0d0a 0d0a 2020 2020 2020 2020 6d65 7468  ....        meth
+0000ee70: 6f64 203d 2049 4e54 4552 504f 4c41 5449  od = INTERPOLATI
+0000ee80: 4f4e 5f4d 4554 484f 4453 2e67 6574 286d  ON_METHODS.get(m
+0000ee90: 6574 686f 6429 0d0a 0d0a 2020 2020 2020  ethod)....      
+0000eea0: 2020 7372 5f73 7263 203d 206f 7372 2e53    sr_src = osr.S
+0000eeb0: 7061 7469 616c 5265 6665 7265 6e63 6528  patialReference(
+0000eec0: 776b 743d 7365 6c66 2e63 7273 290d 0a0d  wkt=self.crs)...
+0000eed0: 0a20 2020 2020 2020 2075 6c78 203d 2073  .        ulx = s
+0000eee0: 656c 662e 6765 6f74 7261 6e73 666f 726d  elf.geotransform
+0000eef0: 5b30 5d0d 0a20 2020 2020 2020 2075 6c79  [0]..        uly
+0000ef00: 203d 2073 656c 662e 6765 6f74 7261 6e73   = self.geotrans
+0000ef10: 666f 726d 5b33 5d0d 0a20 2020 2020 2020  form[3]..       
+0000ef20: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
+0000ef30: 2072 6967 6874 206c 6f77 6572 2063 6f72   right lower cor
+0000ef40: 6e65 7220 706f 696e 740d 0a20 2020 2020  ner point..     
+0000ef50: 2020 206c 7278 203d 2073 656c 662e 6765     lrx = self.ge
+0000ef60: 6f74 7261 6e73 666f 726d 5b30 5d20 2b20  otransform[0] + 
+0000ef70: 7365 6c66 2e67 656f 7472 616e 7366 6f72  self.geotransfor
+0000ef80: 6d5b 315d 202a 2073 656c 662e 636f 6c75  m[1] * self.colu
+0000ef90: 6d6e 730d 0a20 2020 2020 2020 206c 7279  mns..        lry
+0000efa0: 203d 2073 656c 662e 6765 6f74 7261 6e73   = self.geotrans
+0000efb0: 666f 726d 5b33 5d20 2b20 7365 6c66 2e67  form[3] + self.g
+0000efc0: 656f 7472 616e 7366 6f72 6d5b 355d 202a  eotransform[5] *
+0000efd0: 2073 656c 662e 726f 7773 0d0a 0d0a 2020   self.rows....  
+0000efe0: 2020 2020 2020 2320 6e65 7720 6765 6f74        # new geot
+0000eff0: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
+0000f000: 2020 6e65 775f 6765 6f20 3d20 280d 0a20    new_geo = (.. 
+0000f010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000f020: 6765 6f74 7261 6e73 666f 726d 5b30 5d2c  geotransform[0],
+0000f030: 0d0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
+0000f040: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
+0000f050: 2020 2020 2020 7365 6c66 2e67 656f 7472        self.geotr
+0000f060: 616e 7366 6f72 6d5b 325d 2c0d 0a20 2020  ansform[2],..   
+0000f070: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
+0000f080: 6f74 7261 6e73 666f 726d 5b33 5d2c 0d0a  otransform[3],..
+0000f090: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000f0a0: 2e67 656f 7472 616e 7366 6f72 6d5b 345d  .geotransform[4]
+0000f0b0: 2c0d 0a20 2020 2020 2020 2020 2020 202d  ,..            -
+0000f0c0: 3120 2a20 6365 6c6c 5f73 697a 652c 0d0a  1 * cell_size,..
+0000f0d0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+0000f0e0: 2020 2023 2063 7265 6174 6520 6120 6e65     # create a ne
+0000f0f0: 7720 7261 7374 6572 0d0a 2020 2020 2020  w raster..      
+0000f100: 2020 636f 6c73 203d 2069 6e74 286e 702e    cols = int(np.
+0000f110: 726f 756e 6428 6162 7328 6c72 7820 2d20  round(abs(lrx - 
+0000f120: 756c 7829 202f 2063 656c 6c5f 7369 7a65  ulx) / cell_size
+0000f130: 2929 0d0a 2020 2020 2020 2020 726f 7773  ))..        rows
+0000f140: 203d 2069 6e74 286e 702e 726f 756e 6428   = int(np.round(
+0000f150: 6162 7328 756c 7920 2d20 6c72 7929 202f  abs(uly - lry) /
+0000f160: 2063 656c 6c5f 7369 7a65 2929 0d0a 2020   cell_size))..  
+0000f170: 2020 2020 2020 6474 7970 6520 3d20 7365        dtype = se
+0000f180: 6c66 2e64 7479 7065 5b30 5d0d 0a20 2020  lf.dtype[0]..   
+0000f190: 2020 2020 2062 616e 6473 203d 2073 656c       bands = sel
+0000f1a0: 662e 6261 6e64 5f63 6f75 6e74 0d0a 0d0a  f.band_count....
+0000f1b0: 2020 2020 2020 2020 6473 7420 3d20 4461          dst = Da
+0000f1c0: 7461 7365 742e 5f63 7265 6174 655f 6764  taset._create_gd
+0000f1d0: 616c 5f64 6174 6173 6574 2863 6f6c 732c  al_dataset(cols,
+0000f1e0: 2072 6f77 732c 2062 616e 6473 2c20 6474   rows, bands, dt
+0000f1f0: 7970 6529 0d0a 2020 2020 2020 2020 2320  ype)..        # 
+0000f200: 7365 7420 7468 6520 6765 6f74 7261 6e73  set the geotrans
+0000f210: 666f 726d 0d0a 2020 2020 2020 2020 6473  form..        ds
+0000f220: 742e 5365 7447 656f 5472 616e 7366 6f72  t.SetGeoTransfor
+0000f230: 6d28 6e65 775f 6765 6f29 0d0a 2020 2020  m(new_geo)..    
+0000f240: 2020 2020 2320 7365 7420 7468 6520 7072      # set the pr
+0000f250: 6f6a 6563 7469 6f6e 0d0a 2020 2020 2020  ojection..      
+0000f260: 2020 6473 742e 5365 7450 726f 6a65 6374    dst.SetProject
+0000f270: 696f 6e28 7372 5f73 7263 2e45 7870 6f72  ion(sr_src.Expor
+0000f280: 7454 6f57 6b74 2829 290d 0a20 2020 2020  tToWkt())..     
+0000f290: 2020 2064 7374 5f6f 626a 203d 2044 6174     dst_obj = Dat
+0000f2a0: 6173 6574 2864 7374 290d 0a20 2020 2020  aset(dst)..     
+0000f2b0: 2020 2023 2073 6574 2074 6865 206e 6f20     # set the no 
+0000f2c0: 6461 7461 2076 616c 7565 0d0a 2020 2020  data value..    
+0000f2d0: 2020 2020 6473 745f 6f62 6a2e 5f73 6574      dst_obj._set
+0000f2e0: 5f6e 6f5f 6461 7461 5f76 616c 7565 2873  _no_data_value(s
+0000f2f0: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
+0000f300: 6529 0d0a 2020 2020 2020 2020 2320 7065  e)..        # pe
+0000f310: 7266 6f72 6d20 7468 6520 7072 6f6a 6563  rform the projec
+0000f320: 7469 6f6e 2026 2072 6573 616d 706c 696e  tion & resamplin
+0000f330: 670d 0a20 2020 2020 2020 2067 6461 6c2e  g..        gdal.
+0000f340: 5265 7072 6f6a 6563 7449 6d61 6765 280d  ReprojectImage(.
+0000f350: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000f360: 662e 7261 7374 6572 2c0d 0a20 2020 2020  f.raster,..     
+0000f370: 2020 2020 2020 2064 7374 5f6f 626a 2e72         dst_obj.r
+0000f380: 6173 7465 722c 0d0a 2020 2020 2020 2020  aster,..        
+0000f390: 2020 2020 7372 5f73 7263 2e45 7870 6f72      sr_src.Expor
+0000f3a0: 7454 6f57 6b74 2829 2c0d 0a20 2020 2020  tToWkt(),..     
+0000f3b0: 2020 2020 2020 2073 725f 7372 632e 4578         sr_src.Ex
+0000f3c0: 706f 7274 546f 576b 7428 292c 0d0a 2020  portToWkt(),..  
+0000f3d0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0000f3e0: 2c0d 0a20 2020 2020 2020 2029 0d0a 0d0a  ,..        )....
+0000f3f0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+0000f400: 7374 5f6f 626a 0d0a 0d0a 2020 2020 6465  st_obj....    de
+0000f410: 6620 746f 5f63 7273 280d 0a20 2020 2020  f to_crs(..     
+0000f420: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
+0000f430: 2020 746f 5f65 7073 673a 2069 6e74 2c0d    to_epsg: int,.
+0000f440: 0a20 2020 2020 2020 206d 6574 686f 643a  .        method:
+0000f450: 2073 7472 203d 2022 6e65 6172 6573 7420   str = "nearest 
+0000f460: 6e65 6962 6f75 7222 2c0d 0a20 2020 2020  neibour",..     
+0000f470: 2020 206d 6169 6e74 6169 6e5f 616c 6967     maintain_alig
+0000f480: 686d 656e 743a 2069 6e74 203d 2046 616c  hment: int = Fal
+0000f490: 7365 2c0d 0a20 2020 2029 3a0d 0a20 2020  se,..    ):..   
+0000f4a0: 2020 2020 2022 2222 746f 5f65 7073 672e       """to_epsg.
+0000f4b0: 0d0a 0d0a 2020 2020 2020 2020 746f 5f65  ....        to_e
+0000f4c0: 7073 6720 7265 7072 6f6a 6563 7473 2061  psg reprojects a
+0000f4d0: 2072 6173 7465 7220 746f 2061 6e79 2070   raster to any p
+0000f4e0: 726f 6a65 6374 696f 6e0d 0a20 2020 2020  rojection..     
+0000f4f0: 2020 2028 6465 6661 756c 7420 7468 6520     (default the 
+0000f500: 5747 5338 3420 7765 6220 6d65 7263 6174  WGS84 web mercat
+0000f510: 6f72 2070 726f 6a65 6374 696f 6e2c 2077  or projection, w
+0000f520: 6974 686f 7574 2072 6573 616d 706c 696e  ithout resamplin
+0000f530: 6729 0d0a 0d0a 2020 2020 2020 2020 5061  g)....        Pa
+0000f540: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0000f550: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0000f560: 2020 2020 2020 746f 5f65 7073 673a 205b        to_epsg: [
+0000f570: 696e 7465 6765 725d 0d0a 2020 2020 2020  integer]..      
+0000f580: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
+0000f590: 6e75 6d62 6572 2074 6f20 7468 6520 6e65  number to the ne
+0000f5a0: 7720 7072 6f6a 6563 7469 6f6e 2028 6874  w projection (ht
+0000f5b0: 7470 733a 2f2f 6570 7367 2e69 6f2f 290d  tps://epsg.io/).
+0000f5c0: 0a20 2020 2020 2020 2020 2020 2028 6465  .            (de
+0000f5d0: 6661 756c 7420 3338 3537 2074 6865 2072  fault 3857 the r
+0000f5e0: 6566 6572 656e 6365 206e 6f20 6f66 2057  eference no of W
+0000f5f0: 4753 3834 2077 6562 206d 6572 6361 746f  GS84 web mercato
+0000f600: 7220 290d 0a20 2020 2020 2020 206d 6574  r )..        met
+0000f610: 686f 643a 205b 5374 7269 6e67 5d0d 0a20  hod: [String].. 
+0000f620: 2020 2020 2020 2020 2020 2072 6573 616d             resam
+0000f630: 706c 696e 6720 7465 6368 6e69 7175 6520  pling technique 
+0000f640: 6465 6661 756c 7420 6973 2022 4e65 6172  default is "Near
+0000f650: 6573 7422 0d0a 2020 2020 2020 2020 2020  est"..          
+0000f660: 2020 6874 7470 733a 2f2f 6769 7367 656f    https://gisgeo
+0000f670: 6772 6170 6879 2e63 6f6d 2f72 6173 7465  graphy.com/raste
+0000f680: 722d 7265 7361 6d70 6c69 6e67 2f0d 0a20  r-resampling/.. 
+0000f690: 2020 2020 2020 2020 2020 2022 6e65 6172             "near
+0000f6a0: 6573 7420 6e65 6962 6f75 7222 2066 6f72  est neibour" for
+0000f6b0: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
+0000f6c0: 7572 2c22 6375 6269 6322 2066 6f72 2063  ur,"cubic" for c
+0000f6d0: 7562 6963 2063 6f6e 766f 6c75 7469 6f6e  ubic convolution
+0000f6e0: 2c0d 0a20 2020 2020 2020 2020 2020 2022  ,..            "
+0000f6f0: 6269 6c69 6e65 6172 2220 666f 7220 6269  bilinear" for bi
+0000f700: 6c69 6e65 6172 0d0a 2020 2020 2020 2020  linear..        
+0000f710: 6d61 696e 7461 696e 5f61 6c69 6768 6d65  maintain_alighme
+0000f720: 6e74 203a 205b 626f 6f6c 5d0d 0a20 2020  nt : [bool]..   
+0000f730: 2020 2020 2020 2020 2054 7275 6520 746f           True to
+0000f740: 206d 6169 6e74 6169 6e20 7468 6520 6e75   maintain the nu
+0000f750: 6d62 6572 206f 6620 726f 7773 2061 6e64  mber of rows and
+0000f760: 2063 6f6c 756d 6e73 206f 6620 7468 6520   columns of the 
+0000f770: 7261 7374 6572 2074 6865 2073 616d 6520  raster the same 
+0000f780: 6166 7465 7220 7265 7072 6f6a 6563 7469  after reprojecti
+0000f790: 6f6e 2e20 4465 6661 756c 7420 6973 2046  on. Default is F
+0000f7a0: 616c 7365 2e0d 0a0d 0a20 2020 2020 2020  alse.....       
+0000f7b0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0000f7c0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0000f7d0: 2020 2072 6173 7465 723a 0d0a 2020 2020     raster:..    
+0000f7e0: 2020 2020 2020 2020 6764 616c 2064 6174          gdal dat
+0000f7f0: 6173 6574 2028 796f 7520 6361 6e20 7265  aset (you can re
+0000f800: 6164 2069 7420 6279 2052 6561 6441 7341  ad it by ReadAsA
+0000f810: 7272 6179 290d 0a0d 0a20 2020 2020 2020  rray)....       
+0000f820: 2045 7861 6d70 6c65 730d 0a20 2020 2020   Examples..     
+0000f830: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
+0000f840: 2020 2020 203e 3e3e 2066 726f 6d20 7079       >>> from py
+0000f850: 7261 6d69 6473 2e64 6174 6173 6574 2069  ramids.dataset i
+0000f860: 6d70 6f72 7420 4461 7461 7365 740d 0a20  mport Dataset.. 
+0000f870: 2020 2020 2020 203e 3e3e 2073 7263 203d         >>> src =
+0000f880: 2044 6174 6173 6574 2e72 6561 645f 6669   Dataset.read_fi
+0000f890: 6c65 2822 7061 7468 2f72 6173 7465 725f  le("path/raster_
+0000f8a0: 6e61 6d65 2e74 6966 2229 0d0a 2020 2020  name.tif")..    
+0000f8b0: 2020 2020 3e3e 3e20 7072 6f6a 6563 7465      >>> projecte
+0000f8c0: 645f 7261 7374 6572 203d 2073 7263 2e74  d_raster = src.t
+0000f8d0: 6f5f 6372 7328 746f 5f65 7073 673d 3338  o_crs(to_epsg=38
+0000f8e0: 3537 290d 0a20 2020 2020 2020 2022 2222  57)..        """
+0000f8f0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0000f900: 2069 7369 6e73 7461 6e63 6528 746f 5f65   isinstance(to_e
+0000f910: 7073 672c 2069 6e74 293a 0d0a 2020 2020  psg, int):..    
+0000f920: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0000f930: 7065 4572 726f 7228 0d0a 2020 2020 2020  peError(..      
+0000f940: 2020 2020 2020 2020 2020 2270 6c65 6173            "pleas
+0000f950: 6520 656e 7465 7220 636f 7272 6563 7420  e enter correct 
+0000f960: 696e 7465 6765 7220 6e75 6d62 6572 2066  integer number f
+0000f970: 6f72 2074 6f5f 6570 7367 206d 6f72 6520  or to_epsg more 
+0000f980: 696e 666f 726d 6174 696f 6e20 220d 0a20  information ".. 
+0000f990: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000f9a0: 2268 7474 7073 3a2f 2f65 7073 672e 696f  "https://epsg.io
+0000f9b0: 2f2c 2067 6976 656e 207b 7479 7065 2874  /, given {type(t
+0000f9c0: 6f5f 6570 7367 297d 220d 0a20 2020 2020  o_epsg)}"..     
+0000f9d0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+0000f9e0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+0000f9f0: 6e63 6528 6d65 7468 6f64 2c20 7374 7229  nce(method, str)
+0000fa00: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0000fa10: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
+0000fa20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fa30: 2022 706c 6561 7365 2065 6e74 6572 2063   "please enter c
+0000fa40: 6f72 7265 6374 206d 6574 686f 6420 6d6f  orrect method mo
+0000fa50: 7265 2069 6e66 6f72 6d61 7469 6f6e 2073  re information s
+0000fa60: 6565 2022 2022 646f 636d 656e 7461 7469  ee " "docmentati
+0000fa70: 6f6e 2022 0d0a 2020 2020 2020 2020 2020  on "..          
+0000fa80: 2020 290d 0a20 2020 2020 2020 2069 6620    )..        if 
+0000fa90: 6d65 7468 6f64 206e 6f74 2069 6e20 494e  method not in IN
+0000faa0: 5445 5250 4f4c 4154 494f 4e5f 4d45 5448  TERPOLATION_METH
+0000fab0: 4f44 532e 6b65 7973 2829 3a0d 0a20 2020  ODS.keys():..   
+0000fac0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000fad0: 616c 7565 4572 726f 7228 0d0a 2020 2020  alueError(..    
+0000fae0: 2020 2020 2020 2020 2020 2020 6622 5468              f"Th
+0000faf0: 6520 6769 7665 6e20 696e 7465 7270 6f6c  e given interpol
+0000fb00: 6174 696f 6e20 6d65 7468 6f64 2064 6f65  ation method doe
+0000fb10: 7320 6e6f 7420 6578 6973 742c 2065 7869  s not exist, exi
+0000fb20: 7374 696e 6720 6d65 7468 6f64 7320 6172  sting methods ar
+0000fb30: 6520 7b49 4e54 4552 504f 4c41 5449 4f4e  e {INTERPOLATION
+0000fb40: 5f4d 4554 484f 4453 2e6b 6579 7328 297d  _METHODS.keys()}
+0000fb50: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
+0000fb60: 0d0a 0d0a 2020 2020 2020 2020 6d65 7468  ....        meth
+0000fb70: 6f64 203d 2049 4e54 4552 504f 4c41 5449  od = INTERPOLATI
+0000fb80: 4f4e 5f4d 4554 484f 4453 2e67 6574 286d  ON_METHODS.get(m
+0000fb90: 6574 686f 6429 0d0a 0d0a 2020 2020 2020  ethod)....      
+0000fba0: 2020 6966 206d 6169 6e74 6169 6e5f 616c    if maintain_al
+0000fbb0: 6967 686d 656e 743a 0d0a 2020 2020 2020  ighment:..      
+0000fbc0: 2020 2020 2020 6473 745f 6f62 6a20 3d20        dst_obj = 
+0000fbd0: 7365 6c66 2e5f 7265 7072 6f6a 6563 745f  self._reproject_
+0000fbe0: 7769 7468 5f52 6570 726f 6a65 6374 496d  with_ReprojectIm
+0000fbf0: 6167 6528 746f 5f65 7073 672c 206d 6574  age(to_epsg, met
+0000fc00: 686f 6429 0d0a 2020 2020 2020 2020 656c  hod)..        el
+0000fc10: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000fc20: 2064 7374 203d 2067 6461 6c2e 5761 7270   dst = gdal.Warp
+0000fc30: 2822 222c 2073 656c 662e 7261 7374 6572  ("", self.raster
+0000fc40: 2c20 6473 7453 5253 3d66 2245 5053 473a  , dstSRS=f"EPSG:
+0000fc50: 7b74 6f5f 6570 7367 7d22 2c20 666f 726d  {to_epsg}", form
+0000fc60: 6174 3d22 5652 5422 290d 0a20 2020 2020  at="VRT")..     
+0000fc70: 2020 2020 2020 2064 7374 5f6f 626a 203d         dst_obj =
+0000fc80: 2044 6174 6173 6574 2864 7374 290d 0a0d   Dataset(dst)...
+0000fc90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000fca0: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
+0000fcb0: 6566 205f 7265 7072 6f6a 6563 745f 7769  ef _reproject_wi
+0000fcc0: 7468 5f52 6570 726f 6a65 6374 496d 6167  th_ReprojectImag
+0000fcd0: 6528 0d0a 2020 2020 2020 2020 7365 6c66  e(..        self
+0000fce0: 2c20 746f 5f65 7073 673a 2069 6e74 2c20  , to_epsg: int, 
+0000fcf0: 6d65 7468 6f64 3a20 7374 7220 3d20 226e  method: str = "n
+0000fd00: 6561 7265 7374 206e 6569 626f 7572 220d  earest neibour".
+0000fd10: 0a20 2020 2029 202d 3e20 6f62 6a65 6374  .    ) -> object
+0000fd20: 3a0d 0a20 2020 2020 2020 2073 7263 5f67  :..        src_g
+0000fd30: 7420 3d20 7365 6c66 2e67 656f 7472 616e  t = self.geotran
+0000fd40: 7366 6f72 6d0d 0a20 2020 2020 2020 2073  sform..        s
+0000fd50: 7263 5f78 203d 2073 656c 662e 636f 6c75  rc_x = self.colu
+0000fd60: 6d6e 730d 0a20 2020 2020 2020 2073 7263  mns..        src
+0000fd70: 5f79 203d 2073 656c 662e 726f 7773 0d0a  _y = self.rows..
+0000fd80: 0d0a 2020 2020 2020 2020 7372 635f 7372  ..        src_sr
+0000fd90: 203d 206f 7372 2e53 7061 7469 616c 5265   = osr.SpatialRe
+0000fda0: 6665 7265 6e63 6528 776b 743d 7365 6c66  ference(wkt=self
+0000fdb0: 2e63 7273 290d 0a20 2020 2020 2020 2073  .crs)..        s
+0000fdc0: 7263 5f65 7073 6720 3d20 7365 6c66 2e65  rc_epsg = self.e
+0000fdd0: 7073 670d 0a0d 0a20 2020 2020 2020 2023  psg....        #
+0000fde0: 2323 2064 6973 7469 6e61 7469 6f6e 2072  ## distination r
+0000fdf0: 6173 7465 720d 0a20 2020 2020 2020 2023  aster..        #
+0000fe00: 2073 7061 7469 616c 2072 6566 0d0a 2020   spatial ref..  
+0000fe10: 2020 2020 2020 6473 745f 7372 203d 2073        dst_sr = s
+0000fe20: 656c 662e 5f63 7265 6174 655f 7372 5f66  elf._create_sr_f
+0000fe30: 726f 6d5f 6570 7367 2874 6f5f 6570 7367  rom_epsg(to_epsg
+0000fe40: 290d 0a0d 0a20 2020 2020 2020 2023 2069  )....        # i
+0000fe50: 6e20 6361 7365 2074 6865 2073 6f75 7263  n case the sourc
+0000fe60: 6520 6372 7320 6973 2047 4353 2061 6e64  e crs is GCS and
+0000fe70: 206c 6f6e 6769 7475 6465 2069 7320 696e   longitude is in
+0000fe80: 2074 6865 2077 6573 7420 6865 6d69 7370   the west hemisp
+0000fe90: 6865 7265 2067 6461 6c0d 0a20 2020 2020  here gdal..     
+0000fea0: 2020 2023 2072 6561 6473 206c 6f6e 6769     # reads longi
+0000feb0: 7475 6465 2066 726f 6d20 3020 746f 2033  tude from 0 to 3
+0000fec0: 3630 2061 6e64 2074 7261 6e73 666f 726d  60 and transform
+0000fed0: 6174 696f 6e20 6661 6374 6f72 2077 6f6e  ation factor won
+0000fee0: 7420 776f 726b 2077 6974 6820 7661 6c75  t work with valu
+0000fef0: 6573 0d0a 2020 2020 2020 2020 2320 6772  es..        # gr
+0000ff00: 6561 7465 7220 7468 616e 2031 3830 0d0a  eater than 180..
+0000ff10: 2020 2020 2020 2020 6966 2073 7263 5f65          if src_e
+0000ff20: 7073 6720 213d 2074 6f5f 6570 7367 3a0d  psg != to_epsg:.
+0000ff30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000ff40: 7372 635f 6570 7367 203d 3d20 2234 3332  src_epsg == "432
+0000ff50: 3622 2061 6e64 2073 7263 5f67 745b 305d  6" and src_gt[0]
+0000ff60: 203e 2031 3830 3a0d 0a20 2020 2020 2020   > 180:..       
+0000ff70: 2020 2020 2020 2020 206c 6e67 5f6e 6577           lng_new
+0000ff80: 203d 2073 7263 5f67 745b 305d 202d 2033   = src_gt[0] - 3
+0000ff90: 3630 0d0a 2020 2020 2020 2020 2020 2020  60..            
+0000ffa0: 2020 2020 2320 7472 616e 7366 6f72 6d61      # transforma
+0000ffb0: 7469 6f6e 2066 6163 746f 7273 0d0a 2020  tion factors..  
+0000ffc0: 2020 2020 2020 2020 2020 2020 2020 7478                tx
+0000ffd0: 203d 206f 7372 2e43 6f6f 7264 696e 6174   = osr.Coordinat
+0000ffe0: 6554 7261 6e73 666f 726d 6174 696f 6e28  eTransformation(
+0000fff0: 7372 635f 7372 2c20 6473 745f 7372 290d  src_sr, dst_sr).
+00010000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010010: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
+00010020: 2072 6967 6874 2075 7070 6572 2063 6f72   right upper cor
+00010030: 6e65 7220 706f 696e 740d 0a20 2020 2020  ner point..     
+00010040: 2020 2020 2020 2020 2020 2028 756c 782c             (ulx,
+00010050: 2075 6c79 2c20 756c 7a29 203d 2074 782e   uly, ulz) = tx.
+00010060: 5472 616e 7366 6f72 6d50 6f69 6e74 286c  TransformPoint(l
+00010070: 6e67 5f6e 6577 2c20 7372 635f 6774 5b33  ng_new, src_gt[3
+00010080: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00010090: 2020 2020 2320 7472 616e 7366 6f72 6d20      # transform 
+000100a0: 7468 6520 7269 6768 7420 6c6f 7765 7220  the right lower 
+000100b0: 636f 726e 6572 2070 6f69 6e74 0d0a 2020  corner point..  
+000100c0: 2020 2020 2020 2020 2020 2020 2020 286c                (l
+000100d0: 7278 2c20 6c72 792c 206c 727a 2920 3d20  rx, lry, lrz) = 
+000100e0: 7478 2e54 7261 6e73 666f 726d 506f 696e  tx.TransformPoin
+000100f0: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+00010100: 2020 2020 2020 2020 6c6e 675f 6e65 7720          lng_new 
+00010110: 2b20 7372 635f 6774 5b31 5d20 2a20 7372  + src_gt[1] * sr
+00010120: 635f 782c 2073 7263 5f67 745b 335d 202b  c_x, src_gt[3] +
+00010130: 2073 7263 5f67 745b 355d 202a 2073 7263   src_gt[5] * src
+00010140: 5f79 0d0a 2020 2020 2020 2020 2020 2020  _y..            
+00010150: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+00010160: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00010170: 2020 2020 2020 2020 2020 7873 203d 205b            xs = [
+00010180: 7372 635f 6774 5b30 5d2c 2073 7263 5f67  src_gt[0], src_g
+00010190: 745b 305d 202b 2073 7263 5f67 745b 315d  t[0] + src_gt[1]
+000101a0: 202a 2073 7263 5f78 5d0d 0a20 2020 2020   * src_x]..     
+000101b0: 2020 2020 2020 2020 2020 2079 7320 3d20             ys = 
+000101c0: 5b73 7263 5f67 745b 335d 2c20 7372 635f  [src_gt[3], src_
+000101d0: 6774 5b33 5d20 2b20 7372 635f 6774 5b35  gt[3] + src_gt[5
+000101e0: 5d20 2a20 7372 635f 795d 0d0a 0d0a 2020  ] * src_y]....  
+000101f0: 2020 2020 2020 2020 2020 2020 2020 5b75                [u
+00010200: 6c79 2c20 6c72 795d 2c20 5b75 6c78 2c20  ly, lry], [ulx, 
+00010210: 6c72 785d 203d 2046 6561 7475 7265 436f  lrx] = FeatureCo
+00010220: 6c6c 6563 7469 6f6e 2e72 6570 726f 6a65  llection.reproje
+00010230: 6374 5f70 6f69 6e74 7328 0d0a 2020 2020  ct_points(..    
+00010240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010250: 7973 2c20 7873 2c20 6672 6f6d 5f65 7073  ys, xs, from_eps
+00010260: 673d 7372 635f 6570 7367 2c20 746f 5f65  g=src_epsg, to_e
+00010270: 7073 673d 746f 5f65 7073 670d 0a20 2020  psg=to_epsg..   
+00010280: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+00010290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000102a0: 2320 6f6c 6420 7472 616e 7366 6f72 6d0d  # old transform.
+000102b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000102c0: 2023 2023 2074 7261 6e73 666f 726d 2074   # # transform t
+000102d0: 6865 2072 6967 6874 2075 7070 6572 2063  he right upper c
+000102e0: 6f72 6e65 7220 706f 696e 740d 0a20 2020  orner point..   
+000102f0: 2020 2020 2020 2020 2020 2020 2023 2028               # (
+00010300: 756c 782c 2075 6c79 2c20 756c 7a29 203d  ulx, uly, ulz) =
+00010310: 2074 782e 5472 616e 7366 6f72 6d50 6f69   tx.TransformPoi
+00010320: 6e74 2873 7263 5f67 745b 305d 2c20 7372  nt(src_gt[0], sr
+00010330: 635f 6774 5b33 5d29 0d0a 2020 2020 2020  c_gt[3])..      
+00010340: 2020 2020 2020 2020 2020 2320 2320 7472            # # tr
+00010350: 616e 7366 6f72 6d20 7468 6520 7269 6768  ansform the righ
+00010360: 7420 6c6f 7765 7220 636f 726e 6572 2070  t lower corner p
+00010370: 6f69 6e74 0d0a 2020 2020 2020 2020 2020  oint..          
+00010380: 2020 2020 2020 2320 286c 7278 2c20 6c72        # (lrx, lr
+00010390: 792c 206c 727a 2920 3d20 7478 2e54 7261  y, lrz) = tx.Tra
+000103a0: 6e73 666f 726d 506f 696e 7428 0d0a 2020  nsformPoint(..  
+000103b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000103c0: 2020 2020 7372 635f 6774 5b30 5d20 2b20      src_gt[0] + 
+000103d0: 7372 635f 6774 5b31 5d20 2a20 7372 635f  src_gt[1] * src_
+000103e0: 782c 2073 7263 5f67 745b 335d 202b 2073  x, src_gt[3] + s
+000103f0: 7263 5f67 745b 355d 202a 2073 7263 5f79  rc_gt[5] * src_y
+00010400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010410: 2020 2320 290d 0a0d 0a20 2020 2020 2020    # )....       
+00010420: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00010430: 2020 2020 756c 7820 3d20 7372 635f 6774      ulx = src_gt
+00010440: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+00010450: 2075 6c79 203d 2073 7263 5f67 745b 335d   uly = src_gt[3]
+00010460: 0d0a 2020 2020 2020 2020 2020 2020 6c72  ..            lr
+00010470: 7820 3d20 7372 635f 6774 5b30 5d20 2b20  x = src_gt[0] + 
+00010480: 7372 635f 6774 5b31 5d20 2a20 7372 635f  src_gt[1] * src_
+00010490: 780d 0a20 2020 2020 2020 2020 2020 206c  x..            l
+000104a0: 7279 203d 2073 7263 5f67 745b 335d 202b  ry = src_gt[3] +
+000104b0: 2073 7263 5f67 745b 355d 202a 2073 7263   src_gt[5] * src
+000104c0: 5f79 0d0a 0d0a 2020 2020 2020 2020 2320  _y....        # 
+000104d0: 6765 7420 7468 6520 6365 6c6c 2073 697a  get the cell siz
+000104e0: 6520 696e 2074 6865 2073 6f75 7263 6520  e in the source 
+000104f0: 7261 7374 6572 2061 6e64 2063 6f6e 7665  raster and conve
+00010500: 7274 2069 7420 746f 2074 6865 206e 6577  rt it to the new
+00010510: 2063 7273 0d0a 2020 2020 2020 2020 2320   crs..        # 
+00010520: 7820 636f 6f72 6469 6e61 7465 7320 6f72  x coordinates or
+00010530: 206c 6f6e 6769 7475 6465 730d 0a20 2020   longitudes..   
+00010540: 2020 2020 2078 7320 3d20 5b73 7263 5f67       xs = [src_g
+00010550: 745b 305d 2c20 7372 635f 6774 5b30 5d20  t[0], src_gt[0] 
+00010560: 2b20 7372 635f 6774 5b31 5d5d 0d0a 2020  + src_gt[1]]..  
+00010570: 2020 2020 2020 2320 7920 636f 6f72 6469        # y coordi
+00010580: 6e61 7465 7320 6f72 206c 6174 6974 7564  nates or latitud
+00010590: 6573 0d0a 2020 2020 2020 2020 7973 203d  es..        ys =
+000105a0: 205b 7372 635f 6774 5b33 5d2c 2073 7263   [src_gt[3], src
+000105b0: 5f67 745b 335d 5d0d 0a0d 0a20 2020 2020  _gt[3]]....     
+000105c0: 2020 2069 6620 7372 635f 6570 7367 2021     if src_epsg !
+000105d0: 3d20 746f 5f65 7073 673a 0d0a 2020 2020  = to_epsg:..    
+000105e0: 2020 2020 2020 2020 2320 7472 616e 7366          # transf
+000105f0: 6f72 6d20 7468 6520 7477 6f20 706f 696e  orm the two poin
+00010600: 7473 2063 6f6f 7264 696e 6174 6573 2074  ts coordinates t
+00010610: 6f20 7468 6520 6e65 7720 6372 7320 746f  o the new crs to
+00010620: 2063 616c 6375 6c61 7465 2074 6865 206e   calculate the n
+00010630: 6577 2063 656c 6c20 7369 7a65 0d0a 2020  ew cell size..  
+00010640: 2020 2020 2020 2020 2020 6e65 775f 7973            new_ys
+00010650: 2c20 6e65 775f 7873 203d 2046 6561 7475  , new_xs = Featu
+00010660: 7265 436f 6c6c 6563 7469 6f6e 2e72 6570  reCollection.rep
+00010670: 726f 6a65 6374 5f70 6f69 6e74 7328 0d0a  roject_points(..
+00010680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010690: 7973 2c20 7873 2c20 6672 6f6d 5f65 7073  ys, xs, from_eps
+000106a0: 673d 7372 635f 6570 7367 2c20 746f 5f65  g=src_epsg, to_e
+000106b0: 7073 673d 746f 5f65 7073 672c 2070 7265  psg=to_epsg, pre
+000106c0: 6369 7369 6f6e 3d36 0d0a 2020 2020 2020  cision=6..      
+000106d0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000106e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000106f0: 2020 2020 6e65 775f 7873 203d 2078 730d      new_xs = xs.
+00010700: 0a20 2020 2020 2020 2020 2020 2023 206e  .            # n
+00010710: 6577 5f79 7320 3d20 7973 0d0a 0d0a 2020  ew_ys = ys....  
+00010720: 2020 2020 2020 2320 544f 444f 3a20 7468        # TODO: th
+00010730: 6520 6675 6e63 7469 6f6e 2064 6f65 7320  e function does 
+00010740: 6e6f 7420 616c 7761 7973 206d 6169 6e74  not always maint
+00010750: 6169 6e20 616c 6967 6e6d 656e 742c 2062  ain alignment, b
+00010760: 6173 6564 206f 6e20 7468 6520 636f 6e76  ased on the conv
+00010770: 6572 7369 6f6e 206f 6620 7468 6520 6365  ersion of the ce
+00010780: 6c6c 5f73 697a 6520 616e 6420 7468 650d  ll_size and the.
+00010790: 0a20 2020 2020 2020 2023 2070 6976 6f74  .        # pivot
+000107a0: 2070 6f69 6e74 0d0a 2020 2020 2020 2020   point..        
+000107b0: 7069 7865 6c5f 7370 6163 696e 6720 3d20  pixel_spacing = 
+000107c0: 6e70 2e61 6273 286e 6577 5f78 735b 305d  np.abs(new_xs[0]
+000107d0: 202d 206e 6577 5f78 735b 315d 290d 0a0d   - new_xs[1])...
+000107e0: 0a20 2020 2020 2020 2023 2063 7265 6174  .        # creat
+000107f0: 6520 6120 6e65 7720 7261 7374 6572 0d0a  e a new raster..
+00010800: 2020 2020 2020 2020 636f 6c73 203d 2069          cols = i
+00010810: 6e74 286e 702e 726f 756e 6428 6162 7328  nt(np.round(abs(
+00010820: 6c72 7820 2d20 756c 7829 202f 2070 6978  lrx - ulx) / pix
+00010830: 656c 5f73 7061 6369 6e67 2929 0d0a 2020  el_spacing))..  
+00010840: 2020 2020 2020 726f 7773 203d 2069 6e74        rows = int
+00010850: 286e 702e 726f 756e 6428 6162 7328 756c  (np.round(abs(ul
+00010860: 7920 2d20 6c72 7929 202f 2070 6978 656c  y - lry) / pixel
+00010870: 5f73 7061 6369 6e67 2929 0d0a 0d0a 2020  _spacing))....  
+00010880: 2020 2020 2020 6474 7970 6520 3d20 7365        dtype = se
+00010890: 6c66 2e64 7479 7065 5b30 5d0d 0a20 2020  lf.dtype[0]..   
+000108a0: 2020 2020 2064 7374 203d 2044 6174 6173       dst = Datas
+000108b0: 6574 2e5f 6372 6561 7465 5f67 6461 6c5f  et._create_gdal_
+000108c0: 6461 7461 7365 7428 636f 6c73 2c20 726f  dataset(cols, ro
+000108d0: 7773 2c20 7365 6c66 2e62 616e 645f 636f  ws, self.band_co
+000108e0: 756e 742c 2064 7479 7065 290d 0a0d 0a20  unt, dtype).... 
+000108f0: 2020 2020 2020 2023 206e 6577 2067 656f         # new geo
+00010900: 7472 616e 7366 6f72 6d0d 0a20 2020 2020  transform..     
+00010910: 2020 206e 6577 5f67 656f 203d 2028 0d0a     new_geo = (..
+00010920: 2020 2020 2020 2020 2020 2020 756c 782c              ulx,
+00010930: 0d0a 2020 2020 2020 2020 2020 2020 7069  ..            pi
+00010940: 7865 6c5f 7370 6163 696e 672c 0d0a 2020  xel_spacing,..  
+00010950: 2020 2020 2020 2020 2020 7372 635f 6774            src_gt
+00010960: 5b32 5d2c 0d0a 2020 2020 2020 2020 2020  [2],..          
+00010970: 2020 756c 792c 0d0a 2020 2020 2020 2020    uly,..        
+00010980: 2020 2020 7372 635f 6774 5b34 5d2c 0d0a      src_gt[4],..
+00010990: 2020 2020 2020 2020 2020 2020 6e70 2e73              np.s
+000109a0: 6967 6e28 7372 635f 6774 5b2d 315d 2920  ign(src_gt[-1]) 
+000109b0: 2a20 7069 7865 6c5f 7370 6163 696e 672c  * pixel_spacing,
+000109c0: 0d0a 2020 2020 2020 2020 290d 0a20 2020  ..        )..   
+000109d0: 2020 2020 2023 2073 6574 2074 6865 2067       # set the g
+000109e0: 656f 7472 616e 7366 6f72 6d0d 0a20 2020  eotransform..   
+000109f0: 2020 2020 2064 7374 2e53 6574 4765 6f54       dst.SetGeoT
+00010a00: 7261 6e73 666f 726d 286e 6577 5f67 656f  ransform(new_geo
+00010a10: 290d 0a20 2020 2020 2020 2023 2073 6574  )..        # set
+00010a20: 2074 6865 2070 726f 6a65 6374 696f 6e0d   the projection.
+00010a30: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
+00010a40: 5072 6f6a 6563 7469 6f6e 2864 7374 5f73  Projection(dst_s
+00010a50: 722e 4578 706f 7274 546f 576b 7428 2929  r.ExportToWkt())
+00010a60: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
+00010a70: 7468 6520 6e6f 2064 6174 6120 7661 6c75  the no data valu
+00010a80: 650d 0a20 2020 2020 2020 2064 7374 5f6f  e..        dst_o
+00010a90: 626a 203d 2044 6174 6173 6574 2864 7374  bj = Dataset(dst
+00010aa0: 290d 0a20 2020 2020 2020 2064 7374 5f6f  )..        dst_o
+00010ab0: 626a 2e5f 7365 745f 6e6f 5f64 6174 615f  bj._set_no_data_
+00010ac0: 7661 6c75 6528 7365 6c66 2e6e 6f5f 6461  value(self.no_da
+00010ad0: 7461 5f76 616c 7565 290d 0a20 2020 2020  ta_value)..     
+00010ae0: 2020 2023 2070 6572 666f 726d 2074 6865     # perform the
+00010af0: 2070 726f 6a65 6374 696f 6e20 2620 7265   projection & re
+00010b00: 7361 6d70 6c69 6e67 0d0a 2020 2020 2020  sampling..      
+00010b10: 2020 6764 616c 2e52 6570 726f 6a65 6374    gdal.Reproject
+00010b20: 496d 6167 6528 0d0a 2020 2020 2020 2020  Image(..        
+00010b30: 2020 2020 7365 6c66 2e72 6173 7465 722c      self.raster,
+00010b40: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+00010b50: 745f 6f62 6a2e 7261 7374 6572 2c0d 0a20  t_obj.raster,.. 
+00010b60: 2020 2020 2020 2020 2020 2073 7263 5f73             src_s
+00010b70: 722e 4578 706f 7274 546f 576b 7428 292c  r.ExportToWkt(),
+00010b80: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+00010b90: 745f 7372 2e45 7870 6f72 7454 6f57 6b74  t_sr.ExportToWkt
+00010ba0: 2829 2c0d 0a20 2020 2020 2020 2020 2020  (),..           
+00010bb0: 206d 6574 686f 642c 0d0a 2020 2020 2020   method,..      
+00010bc0: 2020 290d 0a20 2020 2020 2020 2072 6574    )..        ret
+00010bd0: 7572 6e20 6473 745f 6f62 6a0d 0a0d 0a20  urn dst_obj.... 
+00010be0: 2020 2064 6566 2066 696c 6c5f 6761 7073     def fill_gaps
+00010bf0: 2873 656c 662c 206d 6173 6b2c 2073 7263  (self, mask, src
+00010c00: 5f61 7272 6179 293a 0d0a 2020 2020 2020  _array):..      
+00010c10: 2020 2222 2266 696c 6c5f 6761 7073 2e0d    """fill_gaps..
+00010c20: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00010c30: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00010c40: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00010c50: 2020 206d 6173 6b3a 205b 6e70 2e6e 6461     mask: [np.nda
+00010c60: 7272 6179 5d0d 0a20 2020 2020 2020 2073  rray]..        s
+00010c70: 7263 5f61 7272 6179 3a20 5b6e 702e 6e64  rc_array: [np.nd
+00010c80: 6172 7261 795d 0d0a 0d0a 2020 2020 2020  array]....      
+00010c90: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00010ca0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00010cb0: 2020 2020 6e70 2e6e 6461 7272 6179 0d0a      np.ndarray..
+00010cc0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00010cd0: 2020 2020 2023 2061 6c69 676e 2066 756e       # align fun
+00010ce0: 6374 696f 6e20 6f6e 6c79 2065 7175 6174  ction only equat
+00010cf0: 6520 7468 6520 6e6f 206f 6620 726f 7773  e the no of rows
+00010d00: 2061 6e64 2063 6f6c 756d 6e73 206f 6e6c   and columns onl
+00010d10: 790d 0a20 2020 2020 2020 2023 206d 6174  y..        # mat
+00010d20: 6368 206e 6f64 6174 6176 616c 7565 2069  ch nodatavalue i
+00010d30: 6e73 6572 7473 206e 6f64 6174 6176 616c  nserts nodataval
+00010d40: 7565 2069 6e20 7372 6320 7261 7374 6572  ue in src raster
+00010d50: 2074 6f20 616c 6c20 706c 6163 6573 206c   to all places l
+00010d60: 696b 6520 6d61 736b 0d0a 2020 2020 2020  ike mask..      
+00010d70: 2020 2320 7374 696c 6c20 706c 6163 6573    # still places
+00010d80: 2074 6861 7420 6861 7320 6e6f 6461 7461   that has nodata
+00010d90: 7661 6c75 6520 696e 2074 6865 2073 7263  value in the src
+00010da0: 2072 6173 7465 7220 6275 7420 6974 2069   raster but it i
+00010db0: 7320 6e6f 7420 6e6f 6461 7461 7661 6c75  s not nodatavalu
+00010dc0: 6520 696e 2074 6865 206d 6173 6b0d 0a20  e in the mask.. 
+00010dd0: 2020 2020 2020 2023 2061 6e64 206e 6f77         # and now
+00010de0: 2068 6173 2074 6f20 6265 2066 696c 6c65   has to be fille
+00010df0: 6420 7769 7468 2076 616c 7565 730d 0a20  d with values.. 
+00010e00: 2020 2020 2020 2023 2063 6f6d 7061 7265         # compare
+00010e10: 206e 6f20 6f66 2065 6c65 6d65 6e74 2074   no of element t
+00010e20: 6861 7420 6973 206e 6f74 206e 6f64 6174  hat is not nodat
+00010e30: 6176 616c 7565 2069 6e20 626f 7468 2072  avalue in both r
+00010e40: 6173 7465 7273 2074 6f20 6d61 6b65 2073  asters to make s
+00010e50: 7572 6520 7468 6579 2061 7265 206d 6174  ure they are mat
+00010e60: 6368 6564 0d0a 2020 2020 2020 2020 2320  ched..        # 
+00010e70: 6966 2062 6f74 6820 696e 7075 7473 2061  if both inputs a
+00010e80: 7265 2072 6173 7465 7273 0d0a 2020 2020  re rasters..    
+00010e90: 2020 2020 6d61 736b 5f61 7272 6179 203d      mask_array =
+00010ea0: 206d 6173 6b2e 7265 6164 5f61 7272 6179   mask.read_array
+00010eb0: 2829 0d0a 2020 2020 2020 2020 726f 7720  ()..        row 
+00010ec0: 3d20 6d61 736b 2e72 6f77 730d 0a20 2020  = mask.rows..   
+00010ed0: 2020 2020 2063 6f6c 203d 206d 6173 6b2e       col = mask.
+00010ee0: 636f 6c75 6d6e 730d 0a20 2020 2020 2020  columns..       
+00010ef0: 206d 6173 6b5f 6e6f 7661 6c20 3d20 6d61   mask_noval = ma
+00010f00: 736b 2e6e 6f5f 6461 7461 5f76 616c 7565  sk.no_data_value
+00010f10: 5b30 5d0d 0a0d 0a20 2020 2020 2020 2069  [0]....        i
+00010f20: 6620 6973 696e 7374 616e 6365 286d 6173  f isinstance(mas
+00010f30: 6b2c 2044 6174 6173 6574 2920 616e 6420  k, Dataset) and 
+00010f40: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
+00010f50: 2044 6174 6173 6574 293a 0d0a 2020 2020   Dataset):..    
+00010f60: 2020 2020 2020 2020 2320 7468 6572 6520          # there 
+00010f70: 6d69 6768 7420 6265 2063 656c 6c73 2074  might be cells t
+00010f80: 6861 7420 6172 6520 6f75 7420 6f66 2064  hat are out of d
+00010f90: 6f6d 6169 6e20 696e 2074 6865 2073 7263  omain in the src
+00010fa0: 2062 7574 206e 6f74 206f 7574 206f 6620   but not out of 
+00010fb0: 646f 6d61 696e 2069 6e20 7468 6520 6d61  domain in the ma
+00010fc0: 736b 0d0a 2020 2020 2020 2020 2020 2020  sk..            
+00010fd0: 2320 736f 2063 6861 6e67 6520 616c 6c20  # so change all 
+00010fe0: 7468 6520 7372 635f 6e6f 7661 6c20 746f  the src_noval to
+00010ff0: 206d 6173 6b5f 6e6f 7661 6c20 696e 2074   mask_noval in t
+00011000: 6865 2073 7263 5f61 7272 6179 0d0a 2020  he src_array..  
+00011010: 2020 2020 2020 2020 2020 2320 7372 635f            # src_
+00011020: 6172 7261 795b 6e70 2e69 7363 6c6f 7365  array[np.isclose
+00011030: 2873 7263 5f61 7272 6179 2c20 7365 6c66  (src_array, self
+00011040: 2e6e 6f5f 6461 7461 5f76 616c 7565 5b30  .no_data_value[0
+00011050: 5d2c 2072 746f 6c3d 302e 3030 3129 5d20  ], rtol=0.001)] 
+00011060: 3d20 6d61 736b 5f6e 6f76 616c 0d0a 2020  = mask_noval..  
+00011070: 2020 2020 2020 2020 2020 2320 7468 656e            # then
+00011080: 2063 6f75 6e74 2074 6865 6d20 286f 7574   count them (out
+00011090: 206f 6620 646f 6d61 696e 2063 656c 6c73   of domain cells
+000110a0: 2920 696e 2074 6865 2073 7263 5f61 7272  ) in the src_arr
+000110b0: 6179 0d0a 2020 2020 2020 2020 2020 2020  ay..            
+000110c0: 656c 656d 5f73 7263 203d 2073 7263 5f61  elem_src = src_a
+000110d0: 7272 6179 2e73 697a 6520 2d20 6e70 2e63  rray.size - np.c
+000110e0: 6f75 6e74 5f6e 6f6e 7a65 726f 280d 0a20  ount_nonzero(.. 
+000110f0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00011100: 7372 635f 6172 7261 795b 6e70 2e69 7363  src_array[np.isc
+00011110: 6c6f 7365 2873 7263 5f61 7272 6179 2c20  lose(src_array, 
+00011120: 7365 6c66 2e6e 6f5f 6461 7461 5f76 616c  self.no_data_val
+00011130: 7565 5b30 5d2c 2072 746f 6c3d 302e 3030  ue[0], rtol=0.00
+00011140: 3129 5d29 0d0a 2020 2020 2020 2020 2020  1)])..          
+00011150: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+00011160: 2023 2063 6f75 6e74 2074 6865 206f 7574   # count the out
+00011170: 206f 6620 646f 6d69 616e 2063 656c 6c73   of domian cells
+00011180: 2069 6e20 7468 6520 6d61 736b 0d0a 2020   in the mask..  
+00011190: 2020 2020 2020 2020 2020 656c 656d 5f6d            elem_m
+000111a0: 6173 6b20 3d20 6d61 736b 5f61 7272 6179  ask = mask_array
+000111b0: 2e73 697a 6520 2d20 6e70 2e63 6f75 6e74  .size - np.count
+000111c0: 5f6e 6f6e 7a65 726f 280d 0a20 2020 2020  _nonzero(..     
+000111d0: 2020 2020 2020 2020 2020 2028 6d61 736b             (mask
+000111e0: 5f61 7272 6179 5b6e 702e 6973 636c 6f73  _array[np.isclos
+000111f0: 6528 6d61 736b 5f61 7272 6179 2c20 6d61  e(mask_array, ma
+00011200: 736b 5f6e 6f76 616c 2c20 7274 6f6c 3d30  sk_noval, rtol=0
+00011210: 2e30 3031 295d 290d 0a20 2020 2020 2020  .001)])..       
+00011220: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
+00011230: 2020 2020 2020 2320 6966 206e 6f74 2065        # if not e
+00011240: 7175 616c 2074 6865 6e20 7374 6f72 6520  qual then store 
+00011250: 696e 6469 6365 7320 6f66 2074 686f 7365  indices of those
+00011260: 2063 656c 6c73 2074 6861 7420 646f 6573   cells that does
+00011270: 6e27 7420 6d61 7463 6873 0d0a 2020 2020  n't matchs..    
+00011280: 2020 2020 2020 2020 6966 2065 6c65 6d5f          if elem_
+00011290: 6d61 736b 203e 2065 6c65 6d5f 7372 633a  mask > elem_src:
+000112a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000112b0: 2020 726f 7773 203d 205b 0d0a 2020 2020    rows = [..    
+000112c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000112d0: 690d 0a20 2020 2020 2020 2020 2020 2020  i..             
+000112e0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000112f0: 7261 6e67 6528 726f 7729 0d0a 2020 2020  range(row)..    
+00011300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011310: 666f 7220 6a20 696e 2072 616e 6765 2863  for j in range(c
+00011320: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
+00011330: 2020 2020 2020 2020 2069 6620 6e70 2e69           if np.i
+00011340: 7363 6c6f 7365 2873 7263 5f61 7272 6179  sclose(src_array
+00011350: 5b69 2c20 6a5d 2c20 7365 6c66 2e6e 6f5f  [i, j], self.no_
+00011360: 6461 7461 5f76 616c 7565 5b30 5d2c 2072  data_value[0], r
+00011370: 746f 6c3d 302e 3030 3129 0d0a 2020 2020  tol=0.001)..    
+00011380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011390: 616e 6420 6e6f 7420 6e70 2e69 7363 6c6f  and not np.isclo
+000113a0: 7365 286d 6173 6b5f 6172 7261 795b 692c  se(mask_array[i,
+000113b0: 206a 5d2c 206d 6173 6b5f 6e6f 7661 6c2c   j], mask_noval,
+000113c0: 2072 746f 6c3d 302e 3030 3129 0d0a 2020   rtol=0.001)..  
+000113d0: 2020 2020 2020 2020 2020 2020 2020 5d0d                ].
+000113e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000113f0: 2063 6f6c 7320 3d20 5b0d 0a20 2020 2020   cols = [..     
+00011400: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+00011410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00011420: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00011430: 616e 6765 2872 6f77 290d 0a20 2020 2020  ange(row)..     
+00011440: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00011450: 6f72 206a 2069 6e20 7261 6e67 6528 636f  or j in range(co
+00011460: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
+00011470: 2020 2020 2020 2020 6966 206e 702e 6973          if np.is
+00011480: 636c 6f73 6528 7372 635f 6172 7261 795b  close(src_array[
+00011490: 692c 206a 5d2c 2073 656c 662e 6e6f 5f64  i, j], self.no_d
+000114a0: 6174 615f 7661 6c75 655b 305d 2c20 7274  ata_value[0], rt
+000114b0: 6f6c 3d30 2e30 3031 290d 0a20 2020 2020  ol=0.001)..     
+000114c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000114d0: 6e64 206e 6f74 206e 702e 6973 636c 6f73  nd not np.isclos
+000114e0: 6528 6d61 736b 5f61 7272 6179 5b69 2c20  e(mask_array[i, 
+000114f0: 6a5d 2c20 6d61 736b 5f6e 6f76 616c 2c20  j], mask_noval, 
+00011500: 7274 6f6c 3d30 2e30 3031 290d 0a20 2020  rtol=0.001)..   
+00011510: 2020 2020 2020 2020 2020 2020 205d 0d0a               ]..
+00011520: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00011530: 7465 7270 6f6c 6174 6520 7468 6f73 6520  terpolate those 
+00011540: 6d69 7373 696e 6720 6365 6c6c 7320 6279  missing cells by
+00011550: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
+00011560: 7572 0d0a 2020 2020 2020 2020 2020 2020  ur..            
+00011570: 6966 2065 6c65 6d5f 6d61 736b 203e 2065  if elem_mask > e
+00011580: 6c65 6d5f 7372 633a 0d0a 2020 2020 2020  lem_src:..      
+00011590: 2020 2020 2020 2020 2020 7372 635f 6172            src_ar
+000115a0: 7261 7920 3d20 4461 7461 7365 742e 5f6e  ray = Dataset._n
+000115b0: 6561 7265 7374 5f6e 6569 6768 626f 7572  earest_neighbour
+000115c0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+000115d0: 2020 2020 2020 2073 7263 5f61 7272 6179         src_array
+000115e0: 2c20 7365 6c66 2e6e 6f5f 6461 7461 5f76  , self.no_data_v
+000115f0: 616c 7565 5b30 5d2c 2072 6f77 732c 2063  alue[0], rows, c
+00011600: 6f6c 730d 0a20 2020 2020 2020 2020 2020  ols..           
+00011610: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00011620: 2020 2020 7265 7475 726e 2073 7263 5f61      return src_a
+00011630: 7272 6179 0d0a 0d0a 2020 2020 6465 6620  rray....    def 
+00011640: 5f63 726f 705f 616c 6c69 676e 6564 280d  _crop_alligned(.
+00011650: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
+00011660: 2020 2020 2020 2020 6d61 736b 3a20 556e          mask: Un
+00011670: 696f 6e5b 6764 616c 2e44 6174 6173 6574  ion[gdal.Dataset
+00011680: 2c20 6e70 2e6e 6461 7272 6179 5d2c 0d0a  , np.ndarray],..
+00011690: 2020 2020 2020 2020 6d61 736b 5f6e 6f76          mask_nov
+000116a0: 616c 3a20 556e 696f 6e5b 696e 742c 2066  al: Union[int, f
+000116b0: 6c6f 6174 5d20 3d20 4e6f 6e65 2c0d 0a20  loat] = None,.. 
+000116c0: 2020 2020 2020 2066 696c 6c5f 6761 7073         fill_gaps
+000116d0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
+000116e0: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
+000116f0: 6e70 2e6e 6461 7272 6179 2c20 6764 616c  np.ndarray, gdal
+00011700: 2e44 6174 6173 6574 5d3a 0d0a 2020 2020  .Dataset]:..    
+00011710: 2020 2020 2222 2263 726f 7041 6c6c 6967      """cropAllig
+00011720: 6e65 642e 0d0a 0d0a 2020 2020 2020 2020  ned.....        
+00011730: 6372 6f70 416c 6c69 676e 6564 2063 6c69  cropAlligned cli
+00011740: 702f 6372 6f70 2028 6d61 7463 6865 7320  p/crop (matches 
+00011750: 7468 6520 6c6f 6361 7469 6f6e 206f 6620  the location of 
+00011760: 6e6f 6461 7461 2076 616c 7565 2066 726f  nodata value fro
+00011770: 6d20 6d61 736b 2074 6f20 7372 630d 0a20  m mask to src.. 
+00011780: 2020 2020 2020 2072 6173 7465 7229 2c0d         raster),.
+00011790: 0a20 2020 2020 2020 2020 2020 202d 2042  .            - B
+000117a0: 6f74 6820 7261 7374 6572 7320 6861 7665  oth rasters have
+000117b0: 2074 6f20 6861 7665 2074 6865 2073 616d   to have the sam
+000117c0: 6520 6469 6d65 6e73 696f 6e73 2028 6e6f  e dimensions (no
+000117d0: 206f 6620 726f 7773 2026 2063 6f6c 756d   of rows & colum
+000117e0: 6e73 290d 0a20 2020 2020 2020 2020 2020  ns)..           
+000117f0: 2073 6f20 4d61 7463 6852 6173 7465 7241   so MatchRasterA
+00011800: 6c69 676e 6d65 6e74 2073 686f 756c 6420  lignment should 
+00011810: 6265 2075 7365 6420 7072 696f 7220 746f  be used prior to
+00011820: 2074 6869 7320 6675 6e63 7469 6f6e 2074   this function t
+00011830: 6f20 616c 6967 6e20 626f 7468 0d0a 2020  o align both..  
+00011840: 2020 2020 2020 2020 2020 7261 7374 6572            raster
+00011850: 730d 0a0d 0a20 2020 2020 2020 2050 6172  s....        Par
+00011860: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00011870: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00011880: 2020 2020 206d 6173 6b3a 205b 4461 7461       mask: [Data
+00011890: 7365 742f 6e70 2e6e 6461 7272 6179 5d0d  set/np.ndarray].
+000118a0: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+000118b0: 6b20 7261 7374 6572 2074 6f20 6765 7420  k raster to get 
+000118c0: 7468 6520 6c6f 6361 7469 6f6e 206f 6620  the location of 
+000118d0: 7468 6520 4e6f 4461 7461 5661 6c75 6520  the NoDataValue 
+000118e0: 616e 640d 0a20 2020 2020 2020 2020 2020  and..           
+000118f0: 2077 6865 7265 2069 7420 6973 2069 6e20   where it is in 
+00011900: 7468 6520 6172 7261 790d 0a20 2020 2020  the array..     
+00011910: 2020 206d 6173 6b5f 6e6f 7661 6c3a 205b     mask_noval: [
+00011920: 6e75 6d65 7269 635d 0d0a 2020 2020 2020  numeric]..      
+00011930: 2020 2020 2020 696e 2063 6173 6520 7468        in case th
+00011940: 6520 6d61 736b 2069 7320 6e70 2e6e 6461  e mask is np.nda
+00011950: 7272 6179 2c20 7468 6520 6d61 736b 5f6e  rray, the mask_n
+00011960: 6f76 616c 2068 6176 6520 746f 2062 6520  oval have to be 
+00011970: 6769 7665 6e2e 0d0a 2020 2020 2020 2020  given...        
+00011980: 6669 6c6c 5f67 6170 733a 205b 626f 6f6c  fill_gaps: [bool
+00011990: 5d0d 0a20 2020 2020 2020 2020 2020 2044  ]..            D
+000119a0: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
+000119b0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+000119c0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+000119d0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6473  ----..        ds
+000119e0: 743a 205b 6764 616c 2e64 6174 6173 6574  t: [gdal.dataset
+000119f0: 5d0d 0a20 2020 2020 2020 2020 2020 2074  ]..            t
+00011a00: 6865 2073 6563 6f6e 6420 7261 7374 6572  he second raster
+00011a10: 2077 6974 6820 4e6f 4461 7461 5661 6c75   with NoDataValu
+00011a20: 6520 7374 6f72 6564 2069 6e20 6974 7320  e stored in its 
+00011a30: 6365 6c6c 730d 0a20 2020 2020 2020 2020  cells..         
+00011a40: 2020 2065 7861 6374 6c79 2074 6865 2073     exactly the s
+00011a50: 616d 6520 6c69 6b65 2073 7263 2072 6173  ame like src ras
+00011a60: 7465 720d 0a20 2020 2020 2020 2022 2222  ter..        """
+00011a70: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00011a80: 6e73 7461 6e63 6528 6d61 736b 2c20 4461  nstance(mask, Da
+00011a90: 7461 7365 7429 3a0d 0a20 2020 2020 2020  taset):..       
+00011aa0: 2020 2020 206d 6173 6b5f 6774 203d 206d       mask_gt = m
+00011ab0: 6173 6b2e 6765 6f74 7261 6e73 666f 726d  ask.geotransform
+00011ac0: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00011ad0: 736b 5f65 7073 6720 3d20 6d61 736b 2e65  sk_epsg = mask.e
+00011ae0: 7073 670d 0a20 2020 2020 2020 2020 2020  psg..           
+00011af0: 2072 6f77 203d 206d 6173 6b2e 726f 7773   row = mask.rows
+00011b00: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00011b10: 6c20 3d20 6d61 736b 2e63 6f6c 756d 6e73  l = mask.columns
+00011b20: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00011b30: 736b 5f6e 6f76 616c 203d 206d 6173 6b2e  sk_noval = mask.
+00011b40: 6e6f 5f64 6174 615f 7661 6c75 655b 305d  no_data_value[0]
+00011b50: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00011b60: 736b 5f61 7272 6179 203d 206d 6173 6b2e  sk_array = mask.
+00011b70: 7265 6164 5f61 7272 6179 2829 0d0a 2020  read_array()..  
+00011b80: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00011b90: 7461 6e63 6528 6d61 736b 2c20 6e70 2e6e  tance(mask, np.n
+00011ba0: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
+00011bb0: 2020 2020 2020 6966 206d 6173 6b5f 6e6f        if mask_no
+00011bc0: 7661 6c20 6973 204e 6f6e 653a 0d0a 2020  val is None:..  
+00011bd0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00011be0: 6973 6520 5661 6c75 6545 7272 6f72 280d  ise ValueError(.
+00011bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011c00: 2020 2020 2022 596f 7520 6861 7665 2074       "You have t
+00011c10: 6f20 656e 7465 7220 7468 6520 7661 6c75  o enter the valu
+00011c20: 6520 6f66 2074 6865 206e 6f5f 7661 6c20  e of the no_val 
+00011c30: 7061 7261 6d65 7465 7220 7768 656e 2074  parameter when t
+00011c40: 6865 206d 6173 6b20 6973 2061 206e 756d  he mask is a num
+00011c50: 7079 2061 7272 6179 220d 0a20 2020 2020  py array"..     
+00011c60: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00011c70: 2020 2020 2020 2020 2020 6d61 736b 5f61            mask_a
+00011c80: 7272 6179 203d 206d 6173 6b2e 636f 7079  rray = mask.copy
+00011c90: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00011ca0: 726f 772c 2063 6f6c 203d 206d 6173 6b2e  row, col = mask.
+00011cb0: 7368 6170 650d 0a20 2020 2020 2020 2065  shape..        e
+00011cc0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00011cd0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00011ce0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00011cf0: 2020 2020 2254 6865 2073 6563 6f6e 6420      "The second 
+00011d00: 7061 7261 6d65 7465 7220 276d 6173 6b27  parameter 'mask'
+00011d10: 2068 6173 2074 6f20 6265 2065 6974 6865   has to be eithe
+00011d20: 7220 6764 616c 2e44 6174 6163 7562 6520  r gdal.Datacube 
+00011d30: 6f72 206e 756d 7079 2061 7272 6179 220d  or numpy array".
+00011d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011d50: 2066 2267 6976 656e 202d 207b 7479 7065   f"given - {type
+00011d60: 286d 6173 6b29 7d22 0d0a 2020 2020 2020  (mask)}"..      
+00011d70: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+00011d80: 2020 2062 616e 645f 636f 756e 7420 3d20     band_count = 
+00011d90: 7365 6c66 2e62 616e 645f 636f 756e 740d  self.band_count.
+00011da0: 0a20 2020 2020 2020 2073 7263 5f73 7265  .        src_sre
+00011db0: 6620 3d20 6f73 722e 5370 6174 6961 6c52  f = osr.SpatialR
+00011dc0: 6566 6572 656e 6365 2877 6b74 3d73 656c  eference(wkt=sel
+00011dd0: 662e 6372 7329 0d0a 2020 2020 2020 2020  f.crs)..        
+00011de0: 7372 635f 6172 7261 7920 3d20 7365 6c66  src_array = self
+00011df0: 2e72 6561 645f 6172 7261 7928 290d 0a0d  .read_array()...
+00011e00: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00011e10: 726f 7720 3d3d 2073 656c 662e 726f 7773  row == self.rows
+00011e20: 206f 7220 6e6f 7420 636f 6c20 3d3d 2073   or not col == s
+00011e30: 656c 662e 636f 6c75 6d6e 733a 0d0a 2020  elf.columns:..  
+00011e40: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00011e50: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
+00011e60: 2020 2020 2020 2020 2020 2020 2022 5477               "Tw
+00011e70: 6f20 7261 7374 6572 7320 6861 7320 6469  o rasters has di
+00011e80: 6666 6572 656e 7420 6e75 6d62 6572 206f  fferent number o
+00011e90: 6620 636f 6c75 6d6e 7320 6f72 2072 6f77  f columns or row
+00011ea0: 7320 706c 6561 7365 2072 6573 616d 706c  s please resampl
+00011eb0: 6520 6f72 206d 6174 6368 2062 6f74 6820  e or match both 
+00011ec0: 7261 7374 6572 7322 0d0a 2020 2020 2020  rasters"..      
+00011ed0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+00011ee0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00011ef0: 286d 6173 6b2c 2044 6174 6173 6574 293a  (mask, Dataset):
+00011f00: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00011f10: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00011f20: 2020 2020 6e6f 7420 7365 6c66 2e70 6976      not self.piv
+00011f30: 6f74 5f70 6f69 6e74 203d 3d20 6d61 736b  ot_point == mask
+00011f40: 2e70 6976 6f74 5f70 6f69 6e74 0d0a 2020  .pivot_point..  
+00011f50: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00011f60: 206e 6f74 2073 656c 662e 6365 6c6c 5f73   not self.cell_s
+00011f70: 697a 6520 3d3d 206d 6173 6b2e 6365 6c6c  ize == mask.cell
+00011f80: 5f73 697a 650d 0a20 2020 2020 2020 2020  _size..         
+00011f90: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
+00011fa0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00011fb0: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
+00011fc0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+00011fd0: 6f63 6174 696f 6e20 6f66 2075 7070 6572  ocation of upper
+00011fe0: 206c 6566 7420 636f 726e 6572 206f 6620   left corner of 
+00011ff0: 626f 7468 2072 6173 7465 7273 2061 7265  both rasters are
+00012000: 206e 6f74 2074 6865 2073 616d 6520 6f72   not the same or
+00012010: 2063 656c 6c20 7369 7a65 2069 7320 220d   cell size is ".
+00012020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012030: 2020 2020 2022 6469 6666 6572 656e 7420       "different 
+00012040: 706c 6561 7365 206d 6174 6368 2062 6f74  please match bot
+00012050: 6820 7261 7374 6572 7320 6669 7273 7420  h rasters first 
+00012060: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00012070: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
+00012080: 2020 2020 6966 206e 6f74 206d 6173 6b5f      if not mask_
+00012090: 6570 7367 203d 3d20 7365 6c66 2e65 7073  epsg == self.eps
+000120a0: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+000120b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+000120c0: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+000120d0: 2020 2020 2020 2020 2020 2022 4461 7461             "Data
+000120e0: 7365 7420 4120 2620 4220 6172 6520 7573  set A & B are us
+000120f0: 696e 6720 6469 6666 6572 656e 7420 636f  ing different co
+00012100: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
+00012110: 706c 6561 7365 2072 6570 726f 6a65 6374  please reproject
+00012120: 206f 6e65 206f 6620 7468 656d 2074 6f20   one of them to 
+00012130: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00012140: 2020 2020 2020 2022 7468 6520 6f74 6865         "the othe
+00012150: 7220 7261 7374 6572 2063 6f6f 7264 696e  r raster coordin
+00012160: 6174 6520 7379 7374 656d 220d 0a20 2020  ate system"..   
+00012170: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+00012180: 0d0a 2020 2020 2020 2020 6966 2062 616e  ..        if ban
+00012190: 645f 636f 756e 7420 3e20 313a 0d0a 2020  d_count > 1:..  
+000121a0: 2020 2020 2020 2020 2020 666f 7220 6261            for ba
+000121b0: 6e64 2069 6e20 7261 6e67 6528 7365 6c66  nd in range(self
+000121c0: 2e62 616e 645f 636f 756e 7429 3a0d 0a20  .band_count):.. 
+000121d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000121e0: 6620 6d61 736b 5f6e 6f76 616c 2069 7320  f mask_noval is 
+000121f0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00012200: 2020 2020 2020 2020 2020 2073 7263 5f61             src_a
+00012210: 7272 6179 5b62 616e 642c 206e 702e 6973  rray[band, np.is
+00012220: 6e61 6e28 6d61 736b 5f61 7272 6179 295d  nan(mask_array)]
+00012230: 203d 2073 656c 662e 6e6f 5f64 6174 615f   = self.no_data_
+00012240: 7661 6c75 655b 6261 6e64 5d0d 0a20 2020  value[band]..   
+00012250: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00012260: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00012270: 2020 2020 2020 2020 7372 635f 6172 7261          src_arra
+00012280: 795b 0d0a 2020 2020 2020 2020 2020 2020  y[..            
+00012290: 2020 2020 2020 2020 2020 2020 6261 6e64              band
+000122a0: 2c20 6e70 2e69 7363 6c6f 7365 286d 6173  , np.isclose(mas
+000122b0: 6b5f 6172 7261 792c 206d 6173 6b5f 6e6f  k_array, mask_no
+000122c0: 7661 6c2c 2072 746f 6c3d 302e 3030 3129  val, rtol=0.001)
+000122d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000122e0: 2020 2020 2020 5d20 3d20 7365 6c66 2e6e        ] = self.n
+000122f0: 6f5f 6461 7461 5f76 616c 7565 5b62 616e  o_data_value[ban
+00012300: 645d 0d0a 2020 2020 2020 2020 656c 7365  d]..        else
+00012310: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00012320: 6620 6d61 736b 5f6e 6f76 616c 2069 7320  f mask_noval is 
+00012330: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00012340: 2020 2020 2020 2073 7263 5f61 7272 6179         src_array
+00012350: 5b6e 702e 6973 6e61 6e28 6d61 736b 5f61  [np.isnan(mask_a
+00012360: 7272 6179 295d 203d 2073 656c 662e 6e6f  rray)] = self.no
+00012370: 5f64 6174 615f 7661 6c75 655b 305d 0d0a  _data_value[0]..
+00012380: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00012390: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000123a0: 2020 2073 7263 5f61 7272 6179 5b0d 0a20     src_array[.. 
+000123b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123c0: 2020 206e 702e 6973 636c 6f73 6528 6d61     np.isclose(ma
+000123d0: 736b 5f61 7272 6179 2c20 6d61 736b 5f6e  sk_array, mask_n
+000123e0: 6f76 616c 2c20 7274 6f6c 3d30 2e30 3031  oval, rtol=0.001
+000123f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00012400: 2020 205d 203d 2073 656c 662e 6e6f 5f64     ] = self.no_d
+00012410: 6174 615f 7661 6c75 655b 305d 0d0a 0d0a  ata_value[0]....
+00012420: 2020 2020 2020 2020 6966 2066 696c 6c5f          if fill_
+00012430: 6761 7073 3a0d 0a20 2020 2020 2020 2020  gaps:..         
+00012440: 2020 2073 7263 5f61 7272 6179 203d 2073     src_array = s
+00012450: 656c 662e 6669 6c6c 5f67 6170 7328 6d61  elf.fill_gaps(ma
+00012460: 736b 2c20 7372 635f 6172 7261 7929 0d0a  sk, src_array)..
+00012470: 0d0a 2020 2020 2020 2020 6473 7420 3d20  ..        dst = 
+00012480: 4461 7461 7365 742e 5f63 7265 6174 655f  Dataset._create_
+00012490: 6764 616c 5f64 6174 6173 6574 280d 0a20  gdal_dataset(.. 
+000124a0: 2020 2020 2020 2020 2020 2063 6f6c 2c20             col, 
+000124b0: 726f 772c 2062 616e 645f 636f 756e 742c  row, band_count,
+000124c0: 2073 656c 662e 6474 7970 655b 305d 2c20   self.dtype[0], 
+000124d0: 6472 6976 6572 3d22 4d45 4d22 0d0a 2020  driver="MEM"..  
+000124e0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000124f0: 2023 2062 7574 2077 6974 6820 6c6f 7420   # but with lot 
+00012500: 6f66 2063 6f6d 7075 7461 7469 6f6e 0d0a  of computation..
+00012510: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
+00012520: 206d 6173 6b20 6973 2061 6e20 6172 7261   mask is an arra
+00012530: 7920 616e 6420 7468 6520 6d61 736b 5f67  y and the mask_g
+00012540: 7420 6973 206e 6f74 2064 6566 696e 6564  t is not defined
+00012550: 2075 7365 2074 6865 2073 7263 5f67 7420   use the src_gt 
+00012560: 6173 2062 6f74 6820 7468 6520 6d61 736b  as both the mask
+00012570: 2061 6e64 2074 6865 2073 7263 0d0a 2020   and the src..  
+00012580: 2020 2020 2020 2320 6172 6520 616c 6967        # are alig
+00012590: 6e65 6420 736f 2074 6865 7920 6861 7665  ned so they have
+000125a0: 2074 6865 2073 616d 2067 740d 0a20 2020   the sam gt..   
+000125b0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+000125c0: 2020 2020 2020 2023 2073 6574 2074 6865         # set the
+000125d0: 2067 656f 7472 616e 7366 6f72 6d0d 0a20   geotransform.. 
+000125e0: 2020 2020 2020 2020 2020 2064 7374 2e53             dst.S
+000125f0: 6574 4765 6f54 7261 6e73 666f 726d 286d  etGeoTransform(m
+00012600: 6173 6b5f 6774 290d 0a20 2020 2020 2020  ask_gt)..       
+00012610: 2020 2020 2023 2073 6574 2074 6865 2070       # set the p
+00012620: 726f 6a65 6374 696f 6e0d 0a20 2020 2020  rojection..     
+00012630: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
+00012640: 6f6a 6563 7469 6f6e 286d 6173 6b2e 6372  ojection(mask.cr
+00012650: 7329 0d0a 2020 2020 2020 2020 6578 6365  s)..        exce
+00012660: 7074 2055 6e62 6f75 6e64 4c6f 6361 6c45  pt UnboundLocalE
+00012670: 7272 6f72 3a0d 0a20 2020 2020 2020 2020  rror:..         
+00012680: 2020 2064 7374 2e53 6574 4765 6f54 7261     dst.SetGeoTra
+00012690: 6e73 666f 726d 2873 656c 662e 6765 6f74  nsform(self.geot
+000126a0: 7261 6e73 666f 726d 290d 0a20 2020 2020  ransform)..     
+000126b0: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
+000126c0: 6f6a 6563 7469 6f6e 2873 7263 5f73 7265  ojection(src_sre
+000126d0: 662e 4578 706f 7274 546f 576b 7428 2929  f.ExportToWkt())
+000126e0: 0d0a 0d0a 2020 2020 2020 2020 6473 745f  ....        dst_
+000126f0: 6f62 6a20 3d20 4461 7461 7365 7428 6473  obj = Dataset(ds
+00012700: 7429 0d0a 2020 2020 2020 2020 2320 7365  t)..        # se
+00012710: 7420 7468 6520 6e6f 2064 6174 6120 7661  t the no data va
+00012720: 6c75 650d 0a20 2020 2020 2020 2064 7374  lue..        dst
+00012730: 5f6f 626a 2e5f 7365 745f 6e6f 5f64 6174  _obj._set_no_dat
+00012740: 615f 7661 6c75 6528 7365 6c66 2e6e 6f5f  a_value(self.no_
+00012750: 6461 7461 5f76 616c 7565 290d 0a20 2020  data_value)..   
+00012760: 2020 2020 2069 6620 6261 6e64 5f63 6f75       if band_cou
+00012770: 6e74 203e 2031 3a0d 0a20 2020 2020 2020  nt > 1:..       
+00012780: 2020 2020 2066 6f72 2062 616e 6420 696e       for band in
+00012790: 2072 616e 6765 2862 616e 645f 636f 756e   range(band_coun
+000127a0: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+000127b0: 2020 2020 2064 7374 5f6f 626a 2e72 6173       dst_obj.ras
+000127c0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+000127d0: 6428 6261 6e64 202b 2031 292e 5772 6974  d(band + 1).Writ
+000127e0: 6541 7272 6179 2873 7263 5f61 7272 6179  eArray(src_array
+000127f0: 5b62 616e 642c 203a 2c20 3a5d 290d 0a20  [band, :, :]).. 
+00012800: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00012810: 2020 2020 2020 2020 2020 6473 745f 6f62            dst_ob
+00012820: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
+00012830: 6572 4261 6e64 2831 292e 5772 6974 6541  erBand(1).WriteA
+00012840: 7272 6179 2873 7263 5f61 7272 6179 290d  rray(src_array).
+00012850: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00012860: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
+00012870: 6566 205f 6368 6563 6b5f 616c 6967 6e6d  ef _check_alignm
+00012880: 656e 7428 7365 6c66 2c20 6d61 736b 2920  ent(self, mask) 
+00012890: 2d3e 2062 6f6f 6c3a 0d0a 2020 2020 2020  -> bool:..      
+000128a0: 2020 2222 2243 6865 636b 2069 6620 7261    """Check if ra
+000128b0: 7374 6572 2069 7320 616c 6967 6e65 6420  ster is aligned 
+000128c0: 7769 7468 2061 2067 6976 656e 206d 6173  with a given mas
+000128d0: 6b20 7261 7374 6572 2222 220d 0a20 2020  k raster"""..   
+000128e0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+000128f0: 7374 616e 6365 286d 6173 6b2c 2044 6174  stance(mask, Dat
+00012900: 6173 6574 293a 0d0a 2020 2020 2020 2020  aset):..        
+00012910: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00012920: 726f 7228 2254 6865 2073 6563 6f6e 6420  ror("The second 
+00012930: 7061 7261 6d65 7465 7220 7368 6f75 6c64  parameter should
+00012940: 2062 6520 6120 4461 7461 7365 7422 290d   be a Dataset").
+00012950: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
+00012960: 6e20 7365 6c66 2e72 6f77 7320 3d3d 206d  n self.rows == m
+00012970: 6173 6b2e 726f 7773 2061 6e64 2073 656c  ask.rows and sel
+00012980: 662e 636f 6c75 6d6e 7320 3d3d 206d 6173  f.columns == mas
+00012990: 6b2e 636f 6c75 6d6e 730d 0a0d 0a20 2020  k.columns....   
+000129a0: 2064 6566 2061 6c69 676e 280d 0a20 2020   def align(..   
+000129b0: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
+000129c0: 2020 2020 616c 6967 6e6d 656e 745f 7372      alignment_sr
+000129d0: 632c 0d0a 2020 2020 2920 2d3e 2067 6461  c,..    ) -> gda
+000129e0: 6c2e 4461 7461 7365 743a 0d0a 2020 2020  l.Dataset:..    
+000129f0: 2020 2020 2222 2261 6c69 676e 2e0d 0a0d      """align....
+00012a00: 0a20 2020 2020 2020 2061 6c69 676e 206d  .        align m
+00012a10: 6574 686f 6420 636f 7069 6573 2074 6865  ethod copies the
+00012a20: 2066 6f6c 6c6f 7769 6e67 2064 6174 610d   following data.
+00012a30: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
+00012a40: 6865 2063 6f6f 7264 696e 6174 6520 7379  he coordinate sy
+00012a50: 7374 656d 0d0a 2020 2020 2020 2020 2020  stem..          
+00012a60: 2020 2d20 5468 6520 6e75 6d62 6572 206f    - The number o
+00012a70: 6620 6f66 2072 6f77 7320 2620 636f 6c75  f of rows & colu
+00012a80: 6d6e 730d 0a20 2020 2020 2020 2020 2020  mns..           
+00012a90: 202d 2063 656c 6c20 7369 7a65 0d0a 2020   - cell size..  
+00012aa0: 2020 2020 2020 6672 6f6d 2061 6c69 676e        from align
+00012ab0: 6d65 6e74 5f73 7263 2074 6f20 6120 6461  ment_src to a da
+00012ac0: 7461 5f73 7263 2072 6173 7465 7220 2874  ta_src raster (t
+00012ad0: 6865 2073 6f75 7263 6520 6f66 2064 6174  he source of dat
+00012ae0: 6120 7661 6c75 6573 2069 6e20 6365 6c6c  a values in cell
+00012af0: 7329 0d0a 0d0a 2020 2020 2020 2020 7468  s)....        th
+00012b00: 6520 7265 7375 6c74 2077 696c 6c20 6265  e result will be
+00012b10: 2061 2072 6173 7465 7220 7769 7468 2074   a raster with t
+00012b20: 6865 2073 616d 6520 7374 7275 6374 7572  he same structur
+00012b30: 6520 6c69 6b65 2061 6c69 676e 6d65 6e74  e like alignment
+00012b40: 5f73 7263 2062 7574 2077 6974 680d 0a20  _src but with.. 
+00012b50: 2020 2020 2020 2076 616c 7565 7320 6672         values fr
+00012b60: 6f6d 2064 6174 615f 7372 6320 7573 696e  om data_src usin
+00012b70: 6720 4e65 6172 6573 7420 4e65 6967 6862  g Nearest Neighb
+00012b80: 6f75 7220 696e 7465 7270 6f6c 6174 696f  our interpolatio
+00012b90: 6e20 616c 676f 7269 7468 6d0d 0a0d 0a20  n algorithm.... 
+00012ba0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00012bb0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00012bc0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
+00012bd0: 6c69 676e 6d65 6e74 5f73 7263 203a 205b  lignment_src : [
+00012be0: 4461 7461 7365 745d 0d0a 2020 2020 2020  Dataset]..      
+00012bf0: 2020 2020 2020 7370 6174 6961 6c20 696e        spatial in
+00012c00: 666f 726d 6174 696f 6e20 736f 7572 6365  formation source
+00012c10: 2072 6173 7465 7220 746f 2067 6574 2074   raster to get t
+00012c20: 6865 2073 7061 7469 616c 2069 6e66 6f72  he spatial infor
+00012c30: 6d61 7469 6f6e 0d0a 2020 2020 2020 2020  mation..        
+00012c40: 2020 2020 2863 6f6f 7264 696e 6174 6520      (coordinate 
+00012c50: 7379 7374 656d 2c20 6e6f 206f 6620 726f  system, no of ro
+00012c60: 7773 2026 2063 6f6c 756d 6e73 290d 0a20  ws & columns).. 
+00012c70: 2020 2020 2020 2020 2020 2064 6174 6120             data 
+00012c80: 7661 6c75 6573 2073 6f75 7263 6520 7261  values source ra
+00012c90: 7374 6572 2074 6f20 6765 7420 7468 6520  ster to get the 
+00012ca0: 6461 7461 2028 7661 6c75 6573 206f 6620  data (values of 
+00012cb0: 6561 6368 2063 656c 6c29 0d0a 0d0a 2020  each cell)....  
+00012cc0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00012cd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00012ce0: 2020 2020 2020 2020 6473 7420 3a20 5b44          dst : [D
+00012cf0: 6174 6173 6574 5d0d 0a20 2020 2020 2020  ataset]..       
+00012d00: 2020 2020 2044 6174 6173 6574 206f 626a       Dataset obj
+00012d10: 6563 740d 0a0d 0a20 2020 2020 2020 2045  ect....        E
+00012d20: 7861 6d70 6c65 730d 0a20 2020 2020 2020  xamples..       
+00012d30: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
+00012d40: 2020 203e 3e3e 2041 203d 2067 6461 6c2e     >>> A = gdal.
+00012d50: 4f70 656e 2822 6578 616d 706c 6573 2f47  Open("examples/G
+00012d60: 4953 2f64 6174 612f 6163 6334 3030 302e  IS/data/acc4000.
+00012d70: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
+00012d80: 3e3e 2042 203d 2067 6461 6c2e 4f70 656e  >> B = gdal.Open
+00012d90: 2822 6578 616d 706c 6573 2f47 4953 2f64  ("examples/GIS/d
+00012da0: 6174 612f 736f 696c 5f72 6173 7465 722e  ata/soil_raster.
+00012db0: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
+00012dc0: 3e3e 2052 6173 7465 7242 4d61 7463 6865  >> RasterBMatche
+00012dd0: 6420 3d20 4461 7461 7365 742e 616c 6967  d = Dataset.alig
+00012de0: 6e28 412c 4229 0d0a 2020 2020 2020 2020  n(A,B)..        
+00012df0: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
+00012e00: 6973 696e 7374 616e 6365 2861 6c69 676e  isinstance(align
+00012e10: 6d65 6e74 5f73 7263 2c20 4461 7461 7365  ment_src, Datase
+00012e20: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+00012e30: 2073 7263 203d 2061 6c69 676e 6d65 6e74   src = alignment
+00012e40: 5f73 7263 0d0a 2020 2020 2020 2020 656c  _src..        el
+00012e50: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00012e60: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00012e70: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00012e80: 2020 2022 4669 7273 7420 7061 7261 6d65     "First parame
+00012e90: 7465 7220 7368 6f75 6c64 2062 6520 6120  ter should be a 
+00012ea0: 4461 7461 7365 7420 7265 6164 2075 7369  Dataset read usi
+00012eb0: 6e67 2044 6174 6173 6574 2e6f 7065 6e52  ng Dataset.openR
+00012ec0: 6173 7465 7220 6f72 2061 2070 6174 6820  aster or a path 
+00012ed0: 746f 2074 6865 2072 6173 7465 722c 2022  to the raster, "
+00012ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012ef0: 2020 6622 6769 7665 6e20 7b74 7970 6528    f"given {type(
+00012f00: 616c 6967 6e6d 656e 745f 7372 6329 7d22  alignment_src)}"
+00012f10: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+00012f20: 0a0d 0a20 2020 2020 2020 2023 2072 6570  ...        # rep
+00012f30: 726f 6a65 6374 2074 6865 2072 6173 7465  roject the raste
+00012f40: 7220 746f 206d 6174 6368 2074 6865 2070  r to match the p
+00012f50: 726f 6a65 6374 696f 6e20 6f66 2061 6c69  rojection of ali
+00012f60: 676e 6d65 6e74 5f73 7263 0d0a 2020 2020  gnment_src..    
+00012f70: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00012f80: 6570 7367 203d 3d20 7372 632e 6570 7367  epsg == src.epsg
+00012f90: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00012fa0: 6570 726f 6a65 6374 6564 5f52 6173 7465  eprojected_Raste
+00012fb0: 7242 203d 2073 656c 662e 746f 5f63 7273  rB = self.to_crs
+00012fc0: 2873 7263 2e65 7073 6729 0d0a 2020 2020  (src.epsg)..    
+00012fd0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00012fe0: 2020 2020 2020 2072 6570 726f 6a65 6374         reproject
+00012ff0: 6564 5f52 6173 7465 7242 203d 2073 656c  ed_RasterB = sel
+00013000: 660d 0a20 2020 2020 2020 2023 2063 7265  f..        # cre
+00013010: 6174 6520 6120 6e65 7720 7261 7374 6572  ate a new raster
+00013020: 0d0a 2020 2020 2020 2020 6473 7420 3d20  ..        dst = 
+00013030: 4461 7461 7365 742e 5f63 7265 6174 655f  Dataset._create_
+00013040: 6764 616c 5f64 6174 6173 6574 280d 0a20  gdal_dataset(.. 
+00013050: 2020 2020 2020 2020 2020 2073 7263 2e63             src.c
+00013060: 6f6c 756d 6e73 2c20 7372 632e 726f 7773  olumns, src.rows
+00013070: 2c20 7365 6c66 2e62 616e 645f 636f 756e  , self.band_coun
+00013080: 742c 2073 7263 2e64 7479 7065 5b30 5d2c  t, src.dtype[0],
+00013090: 2064 7269 7665 723d 224d 454d 220d 0a20   driver="MEM".. 
+000130a0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+000130b0: 2020 2320 7365 7420 7468 6520 6765 6f74    # set the geot
+000130c0: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
+000130d0: 2020 6473 742e 5365 7447 656f 5472 616e    dst.SetGeoTran
+000130e0: 7366 6f72 6d28 7372 632e 6765 6f74 7261  sform(src.geotra
+000130f0: 6e73 666f 726d 290d 0a20 2020 2020 2020  nsform)..       
+00013100: 2023 2073 6574 2074 6865 2070 726f 6a65   # set the proje
+00013110: 6374 696f 6e0d 0a20 2020 2020 2020 2064  ction..        d
+00013120: 7374 2e53 6574 5072 6f6a 6563 7469 6f6e  st.SetProjection
+00013130: 2873 7263 2e63 7273 290d 0a20 2020 2020  (src.crs)..     
+00013140: 2020 2023 2073 6574 2074 6865 206e 6f20     # set the no 
+00013150: 6461 7461 2076 616c 7565 0d0a 2020 2020  data value..    
+00013160: 2020 2020 6473 745f 6f62 6a20 3d20 4461      dst_obj = Da
+00013170: 7461 7365 7428 6473 7429 0d0a 2020 2020  taset(dst)..    
+00013180: 2020 2020 6473 745f 6f62 6a2e 5f73 6574      dst_obj._set
+00013190: 5f6e 6f5f 6461 7461 5f76 616c 7565 2873  _no_data_value(s
+000131a0: 7263 2e6e 6f5f 6461 7461 5f76 616c 7565  rc.no_data_value
+000131b0: 290d 0a20 2020 2020 2020 2023 2070 6572  )..        # per
+000131c0: 666f 726d 2074 6865 2070 726f 6a65 6374  form the project
+000131d0: 696f 6e20 2620 7265 7361 6d70 6c69 6e67  ion & resampling
+000131e0: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
+000131f0: 203d 2067 6461 6c2e 4752 415f 4e65 6172   = gdal.GRA_Near
+00013200: 6573 744e 6569 6768 626f 7572 0d0a 2020  estNeighbour..  
+00013210: 2020 2020 2020 2320 7265 7361 6d70 6c65        # resample
+00013220: 2074 6865 2072 6570 726f 6a65 6374 6564   the reprojected
+00013230: 5f52 6173 7465 7242 0d0a 2020 2020 2020  _RasterB..      
+00013240: 2020 6764 616c 2e52 6570 726f 6a65 6374    gdal.Reproject
+00013250: 496d 6167 6528 0d0a 2020 2020 2020 2020  Image(..        
+00013260: 2020 2020 7265 7072 6f6a 6563 7465 645f      reprojected_
+00013270: 5261 7374 6572 422e 7261 7374 6572 2c0d  RasterB.raster,.
+00013280: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
+00013290: 5f6f 626a 2e72 6173 7465 722c 0d0a 2020  _obj.raster,..  
+000132a0: 2020 2020 2020 2020 2020 7372 632e 6372            src.cr
+000132b0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+000132c0: 7372 632e 6372 732c 0d0a 2020 2020 2020  src.crs,..      
+000132d0: 2020 2020 2020 6d65 7468 6f64 2c0d 0a20        method,.. 
+000132e0: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+000132f0: 2020 2020 7265 7475 726e 2064 7374 5f6f      return dst_o
+00013300: 626a 0d0a 0d0a 2020 2020 6465 6620 5f63  bj....    def _c
+00013310: 726f 705f 7769 7468 5f72 6173 7465 7228  rop_with_raster(
+00013320: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
+00013330: 0a20 2020 2020 2020 206d 6173 6b3a 2055  .        mask: U
+00013340: 6e69 6f6e 5b67 6461 6c2e 4461 7461 7365  nion[gdal.Datase
+00013350: 742c 2073 7472 5d2c 0d0a 2020 2020 2920  t, str],..    ) 
+00013360: 2d3e 2067 6461 6c2e 4461 7461 7365 743a  -> gdal.Dataset:
+00013370: 0d0a 2020 2020 2020 2020 2222 2263 726f  ..        """cro
+00013380: 702e 0d0a 0d0a 2020 2020 2020 2020 2020  p.....          
+00013390: 2020 6372 6f70 206d 6574 686f 6420 6372    crop method cr
+000133a0: 6f70 7320 6120 7261 7374 6572 2075 7369  ops a raster usi
+000133b0: 6e67 2061 6e6f 7468 6572 2072 6173 7465  ng another raste
+000133c0: 7220 2862 6f74 6820 7261 7374 6572 7320  r (both rasters 
+000133d0: 646f 6573 206e 6f74 2068 6176 6520 746f  does not have to
+000133e0: 2062 6520 616c 6967 6e65 6429 2e0d 0a0d   be aligned)....
+000133f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00013400: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00013410: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00013420: 2020 6d61 736b 203a 205b 7374 7269 6e67    mask : [string
+00013430: 2f44 6174 6173 6574 5d0d 0a20 2020 2020  /Dataset]..     
+00013440: 2020 2020 2020 2074 6865 2072 6173 7465         the raste
+00013450: 7220 796f 7520 7761 6e74 2074 6f20 7573  r you want to us
+00013460: 6520 6173 2061 206d 6173 6b20 746f 2063  e as a mask to c
+00013470: 726f 7020 6f74 6865 7220 7261 7374 6572  rop other raster
+00013480: 2c0d 0a20 2020 2020 2020 2020 2020 2074  ,..            t
+00013490: 6865 206d 6173 6b20 6361 6e20 6265 2061  he mask can be a
+000134a0: 6c73 6f20 6120 7061 7468 206f 7220 6120  lso a path or a 
+000134b0: 6764 616c 206f 626a 6563 742e 0d0a 0d0a  gdal object.....
+000134c0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+000134d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000134e0: 0d0a 2020 2020 2020 2020 6473 7420 3a20  ..        dst : 
+000134f0: 5b44 6174 6173 6574 5d0d 0a20 2020 2020  [Dataset]..     
+00013500: 2020 2020 2020 2074 6865 2063 726f 7070         the cropp
+00013510: 6564 2072 6173 7465 7220 7769 6c6c 2062  ed raster will b
+00013520: 6520 7265 7475 726e 6564 2c20 6966 2074  e returned, if t
+00013530: 6865 2073 6176 6520 7061 7261 6d65 7465  he save paramete
+00013540: 7220 7761 7320 5472 7565 2c0d 0a20 2020  r was True,..   
+00013550: 2020 2020 2020 2020 2074 6865 2063 726f           the cro
+00013560: 7070 6564 2072 6173 7465 7220 7769 6c6c  pped raster will
+00013570: 2061 6c73 6f20 6265 2073 6176 6564 2074   also be saved t
+00013580: 6f20 6469 736b 2069 6e20 7468 6520 4f75  o disk in the Ou
+00013590: 7470 7574 5061 7468 0d0a 2020 2020 2020  tputPath..      
+000135a0: 2020 2020 2020 6469 7265 6374 6f72 792e        directory.
+000135b0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+000135c0: 2020 2020 2020 2023 2067 6574 2069 6e66         # get inf
+000135d0: 6f72 6d61 7469 6f6e 2066 726f 6d20 7468  ormation from th
+000135e0: 6520 6d61 736b 2072 6173 7465 720d 0a20  e mask raster.. 
+000135f0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00013600: 616e 6365 286d 6173 6b2c 2073 7472 293a  ance(mask, str):
+00013610: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00013620: 736b 203d 2044 6174 6173 6574 2e72 6561  sk = Dataset.rea
+00013630: 645f 6669 6c65 286d 6173 6b29 0d0a 2020  d_file(mask)..  
+00013640: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00013650: 7461 6e63 6528 6d61 736b 2c20 4461 7461  tance(mask, Data
+00013660: 7365 7429 3a0d 0a20 2020 2020 2020 2020  set):..         
+00013670: 2020 206d 6173 6b20 3d20 6d61 736b 0d0a     mask = mask..
+00013680: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00013690: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000136a0: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
+000136b0: 2020 2020 2020 2020 2020 2020 2022 5365               "Se
+000136c0: 636f 6e64 2070 6172 616d 6574 6572 2068  cond parameter h
+000136d0: 6173 2074 6f20 6265 2065 6974 6865 7220  as to be either 
+000136e0: 7061 7468 2074 6f20 7468 6520 6d61 736b  path to the mask
+000136f0: 2072 6173 7465 7220 6f72 2061 2067 6461   raster or a gda
+00013700: 6c2e 4461 7461 6375 6265 206f 626a 6563  l.Datacube objec
+00013710: 7422 0d0a 2020 2020 2020 2020 2020 2020  t"..            
+00013720: 290d 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+00013730: 7420 7365 6c66 2e5f 6368 6563 6b5f 616c  t self._check_al
+00013740: 6967 6e6d 656e 7428 6d61 736b 293a 0d0a  ignment(mask):..
+00013750: 2020 2020 2020 2020 2020 2020 2320 6669              # fi
+00013760: 7273 7420 616c 6967 6e20 7468 6520 6d61  rst align the ma
+00013770: 736b 2077 6974 6820 7468 6520 7372 6320  sk with the src 
+00013780: 7261 7374 6572 0d0a 2020 2020 2020 2020  raster..        
+00013790: 2020 2020 6d61 736b 203d 206d 6173 6b2e      mask = mask.
+000137a0: 616c 6967 6e28 7365 6c66 290d 0a20 2020  align(self)..   
+000137b0: 2020 2020 2023 2063 726f 7020 7468 6520       # crop the 
+000137c0: 7372 6320 7261 7374 6572 2077 6974 6820  src raster with 
+000137d0: 7468 6520 616c 6967 6e65 6420 6d61 736b  the aligned mask
+000137e0: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
+000137f0: 6a20 3d20 7365 6c66 2e5f 6372 6f70 5f61  j = self._crop_a
+00013800: 6c6c 6967 6e65 6428 6d61 736b 290d 0a0d  lligned(mask)...
+00013810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013820: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
+00013830: 6566 205f 6372 6f70 5f77 6974 685f 706f  ef _crop_with_po
+00013840: 6c79 676f 6e28 7365 6c66 2c20 706f 6c79  lygon(self, poly
+00013850: 3a20 4765 6f44 6174 6146 7261 6d65 293a  : GeoDataFrame):
+00013860: 0d0a 2020 2020 2020 2020 2222 2263 726f  ..        """cro
+00013870: 7057 6974 6850 6f6c 7967 6f6e 2e0d 0a0d  pWithPolygon....
+00013880: 0a20 2020 2020 2020 2020 2020 2063 6c69  .            cli
+00013890: 7020 7468 6520 5261 7374 6572 206f 626a  p the Raster obj
+000138a0: 6563 7420 7573 696e 6720 6120 706f 6c79  ect using a poly
+000138b0: 676f 6e20 7665 6374 6f72 2e0d 0a0d 0a20  gon vector..... 
+000138c0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000138d0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000138e0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2070  -----..        p
+000138f0: 6f6c 793a 205b 506f 6c79 676f 6e20 4765  oly: [Polygon Ge
+00013900: 6f44 6174 6146 7261 6d65 5d0d 0a20 2020  oDataFrame]..   
+00013910: 2020 2020 2020 2020 2047 656f 6461 7461           Geodata
+00013920: 4672 616d 6520 7769 7468 2061 2067 656f  Frame with a geo
+00013930: 6d65 7472 7920 6f66 2070 6f6c 7967 6f6e  metry of polygon
+00013940: 2074 7970 652e 0d0a 2020 2020 2020 2020   type...        
+00013950: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00013960: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00013970: 2020 4461 7461 7365 740d 0a20 2020 2020    Dataset..     
+00013980: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00013990: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+000139a0: 6528 706f 6c79 2c20 4765 6f44 6174 6146  e(poly, GeoDataF
+000139b0: 7261 6d65 293a 0d0a 2020 2020 2020 2020  rame):..        
+000139c0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+000139d0: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+000139e0: 2020 2020 2020 2254 6865 2073 6563 6f6e        "The secon
+000139f0: 6420 7061 7261 6d65 7465 723a 2070 6f6c  d parameter: pol
+00013a00: 7920 7368 6f75 6c64 2062 6520 6f66 2074  y should be of t
+00013a10: 7970 6520 4765 6f44 6174 6146 7261 6d65  ype GeoDataFrame
+00013a20: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+00013a30: 290d 0a0d 0a20 2020 2020 2020 2070 6f6c  )....        pol
+00013a40: 795f 6570 7367 203d 2070 6f6c 792e 6372  y_epsg = poly.cr
+00013a50: 732e 746f 5f65 7073 6728 290d 0a20 2020  s.to_epsg()..   
+00013a60: 2020 2020 2073 7263 5f65 7073 6720 3d20       src_epsg = 
+00013a70: 7365 6c66 2e65 7073 670d 0a20 2020 2020  self.epsg..     
+00013a80: 2020 2069 6620 706f 6c79 5f65 7073 6720     if poly_epsg 
+00013a90: 213d 2073 7263 5f65 7073 673a 0d0a 2020  != src_epsg:..  
+00013aa0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00013ab0: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
+00013ac0: 2020 2020 2020 2020 2020 2020 2022 5072               "Pr
+00013ad0: 6f6a 6563 7469 6f6e 2045 7272 6f72 3a20  ojection Error: 
+00013ae0: 7468 6520 7261 7374 6572 2061 6e64 2076  the raster and v
+00013af0: 6563 746f 7220 706f 6c79 676f 6e20 6861  ector polygon ha
+00013b00: 7665 2064 6966 6665 7265 6e74 2070 726f  ve different pro
+00013b10: 6a65 6374 696f 6e20 706c 6561 7365 2022  jection please "
+00013b20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013b30: 2020 2275 6e69 6679 2070 726f 6a65 6374    "unify project
+00013b40: 696f 6e22 0d0a 2020 2020 2020 2020 2020  ion"..          
+00013b50: 2020 290d 0a20 2020 2020 2020 2076 6563    )..        vec
+00013b60: 746f 7220 3d20 4665 6174 7572 6543 6f6c  tor = FeatureCol
+00013b70: 6c65 6374 696f 6e28 706f 6c79 290d 0a20  lection(poly).. 
+00013b80: 2020 2020 2020 206d 6173 6b20 3d20 7665         mask = ve
+00013b90: 6374 6f72 2e74 6f5f 6461 7461 7365 7428  ctor.to_dataset(
+00013ba0: 6461 7461 7365 743d 7365 6c66 290d 0a20  dataset=self).. 
+00013bb0: 2020 2020 2020 2063 726f 7070 6564 5f6f         cropped_o
+00013bc0: 626a 203d 2073 656c 662e 5f63 726f 705f  bj = self._crop_
+00013bd0: 7769 7468 5f72 6173 7465 7228 6d61 736b  with_raster(mask
+00013be0: 290d 0a0d 0a20 2020 2020 2020 2023 2078  )....        # x
+00013bf0: 6d69 6e2c 2079 6d69 6e2c 2078 6d61 782c  min, ymin, xmax,
+00013c00: 2079 6d61 7820 3d20 706f 6c79 2e62 6f75   ymax = poly.bou
+00013c10: 6e64 732e 7661 6c75 6573 2e74 6f6c 6973  nds.values.tolis
+00013c20: 7428 295b 305d 0d0a 2020 2020 2020 2020  t()[0]..        
+00013c30: 2320 7769 6e64 6f77 203d 2028 786d 696e  # window = (xmin
+00013c40: 2c20 796d 6178 2c20 786d 6178 2c20 796d  , ymax, xmax, ym
+00013c50: 696e 290d 0a20 2020 2020 2020 2023 2023  in)..        # #
+00013c60: 2067 6461 6c2e 5472 616e 736c 6174 654f   gdal.TranslateO
+00013c70: 7074 696f 6e73 2864 7374 2c20 7373 2c20  ptions(dst, ss, 
+00013c80: 7072 6f6a 5769 6e3d 7769 6e64 6f77 290d  projWin=window).
+00013c90: 0a20 2020 2020 2020 2023 2023 2063 6f70  .        # # cop
+00013ca0: 7920 7468 6520 7372 6320 7261 7374 6572  y the src raster
+00013cb0: 0d0a 2020 2020 2020 2020 2320 6472 7620  ..        # drv 
+00013cc0: 3d20 6764 616c 2e47 6574 4472 6976 6572  = gdal.GetDriver
+00013cd0: 4279 4e61 6d65 2822 4d45 4d22 290d 0a20  ByName("MEM").. 
+00013ce0: 2020 2020 2020 2023 2064 7374 203d 2064         # dst = d
+00013cf0: 7276 2e43 7265 6174 6543 6f70 7928 2222  rv.CreateCopy(""
+00013d00: 2c20 7365 6c66 2e72 6173 7465 722c 2030  , self.raster, 0
+00013d10: 290d 0a20 2020 2020 2020 2023 2074 7279  )..        # try
+00013d20: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+00013d30: 2067 6461 6c2e 5472 616e 736c 6174 6528   gdal.Translate(
+00013d40: 6473 742c 2073 656c 662e 7261 7374 6572  dst, self.raster
+00013d50: 2c20 7072 6f6a 5769 6e3d 7769 6e64 6f77  , projWin=window
+00013d60: 290d 0a20 2020 2020 2020 2023 2065 7863  )..        # exc
+00013d70: 6570 7420 5275 6e74 696d 6545 7272 6f72  ept RuntimeError
+00013d80: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+00013d90: 2070 6173 730d 0a0d 0a20 2020 2020 2020   pass....       
+00013da0: 2023 2063 726f 7070 6564 5f6f 626a 203d   # cropped_obj =
+00013db0: 2044 6174 6173 6574 2864 7374 290d 0a0d   Dataset(dst)...
+00013dc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013dd0: 6372 6f70 7065 645f 6f62 6a0d 0a0d 0a20  cropped_obj.... 
+00013de0: 2020 2064 6566 2063 726f 7028 7365 6c66     def crop(self
+00013df0: 2c20 6d61 736b 3a20 556e 696f 6e5b 4765  , mask: Union[Ge
+00013e00: 6f44 6174 6146 7261 6d65 5d29 3a0d 0a20  oDataFrame]):.. 
+00013e10: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00013e20: 2020 2020 2020 2020 2020 636c 6970 2074            clip t
+00013e30: 6865 2044 6174 6173 6574 206f 626a 6563  he Dataset objec
+00013e40: 7420 7573 696e 6720 6120 706f 6c79 676f  t using a polygo
+00013e50: 6e2f 616e 6f74 6865 7220 7261 7374 6572  n/another raster
+00013e60: 2028 626f 7468 2072 6173 7465 7273 2064   (both rasters d
+00013e70: 6f65 7320 6e6f 7420 6861 7665 2074 6f20  oes not have to 
+00013e80: 6265 2061 6c69 676e 6564 292e 0d0a 0d0a  be aligned).....
+00013e90: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00013ea0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00013eb0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00013ec0: 6d61 736b 3a20 5b50 6f6c 7967 6f6e 2047  mask: [Polygon G
+00013ed0: 656f 4461 7461 4672 616d 652f 4461 7461  eoDataFrame/Data
+00013ee0: 7365 7420 6f62 6a65 6374 5d0d 0a20 2020  set object]..   
+00013ef0: 2020 2020 2020 2020 2047 656f 6461 7461           Geodata
+00013f00: 4672 616d 6520 7769 7468 2061 2067 656f  Frame with a geo
+00013f10: 6d65 7472 7920 6f66 2070 6f6c 7967 6f6e  metry of polygon
+00013f20: 2074 7970 650d 0a0d 0a20 2020 2020 2020   type....       
+00013f30: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00013f40: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00013f50: 2020 2044 6174 6173 6574 204f 626a 6563     Dataset Objec
+00013f60: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+00013f70: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00013f80: 7461 6e63 6528 6d61 736b 2c20 4765 6f44  tance(mask, GeoD
+00013f90: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
+00013fa0: 2020 2020 2020 2020 6473 7420 3d20 7365          dst = se
+00013fb0: 6c66 2e5f 6372 6f70 5f77 6974 685f 706f  lf._crop_with_po
+00013fc0: 6c79 676f 6e28 6d61 736b 290d 0a20 2020  lygon(mask)..   
+00013fd0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+00013fe0: 616e 6365 286d 6173 6b2c 2044 6174 6173  ance(mask, Datas
+00013ff0: 6574 293a 0d0a 2020 2020 2020 2020 2020  et):..          
+00014000: 2020 6473 7420 3d20 7365 6c66 2e5f 6372    dst = self._cr
+00014010: 6f70 5f77 6974 685f 7261 7374 6572 286d  op_with_raster(m
+00014020: 6173 6b29 0d0a 2020 2020 2020 2020 656c  ask)..        el
+00014030: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00014040: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00014050: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00014060: 2020 2022 5468 6520 7365 636f 6e64 2070     "The second p
+00014070: 6172 616d 6574 6572 3a20 6d61 736b 2063  arameter: mask c
+00014080: 6f75 6c64 2062 6520 6569 7468 6572 2047  ould be either G
+00014090: 656f 4461 7461 4672 616d 6520 6f72 2044  eoDataFrame or D
+000140a0: 6174 6173 6574 206f 626a 6563 7422 0d0a  ataset object"..
+000140b0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
+000140c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000140d0: 6473 740d 0a0d 0a20 2020 2040 7374 6174  dst....    @stat
+000140e0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
+000140f0: 6620 5f6e 6561 7265 7374 5f6e 6569 6768  f _nearest_neigh
+00014100: 626f 7572 280d 0a20 2020 2020 2020 2061  bour(..        a
+00014110: 7272 6179 3a20 6e70 2e6e 6461 7272 6179  rray: np.ndarray
+00014120: 2c20 6e6f 6461 7461 7661 6c75 653a 2055  , nodatavalue: U
+00014130: 6e69 6f6e 5b66 6c6f 6174 2c20 696e 745d  nion[float, int]
+00014140: 2c20 726f 7773 3a20 6c69 7374 2c20 636f  , rows: list, co
+00014150: 6c73 3a20 6c69 7374 0d0a 2020 2020 2920  ls: list..    ) 
+00014160: 2d3e 206e 702e 6e64 6172 7261 793a 0d0a  -> np.ndarray:..
+00014170: 2020 2020 2020 2020 2222 226e 6561 7265          """neare
+00014180: 7374 4e65 6967 6862 6f75 722e 0d0a 0d0a  stNeighbour.....
+00014190: 2020 2020 2020 2020 2020 2020 2d20 6669              - fi
+000141a0: 6c6c 7320 7468 6520 6365 6c6c 7320 6f66  lls the cells of
+000141b0: 2061 2067 6976 656e 2069 6e64 6963 6573   a given indices
+000141c0: 2069 6e20 726f 7773 2061 6e64 2063 6f6c   in rows and col
+000141d0: 7320 7769 7468 2074 6865 2076 616c 7565  s with the value
+000141e0: 206f 6620 7468 6520 6e65 6172 6573 740d   of the nearest.
+000141f0: 0a20 2020 2020 2020 2020 2020 206e 6569  .            nei
+00014200: 6768 626f 7572 2e0d 0a20 2020 2020 2020  ghbour...       
+00014210: 2020 2020 202d 2053 7320 7468 6520 7261       - Ss the ra
+00014220: 7374 6572 2067 7269 6420 6973 2073 7175  ster grid is squ
+00014230: 6172 6520 736f 2074 6865 2034 2070 6572  are so the 4 per
+00014240: 7065 6e64 6963 756c 6172 2064 6972 6563  pendicular direc
+00014250: 7469 6f6e 2061 7265 206f 6620 7468 6520  tion are of the 
+00014260: 7361 6d65 2070 726f 7869 6d69 7479 2073  same proximity s
+00014270: 6f20 7468 6520 6675 6e63 7469 6f6e 0d0a  o the function..
+00014280: 2020 2020 2020 2020 2020 2020 6769 7665              give
+00014290: 7320 7072 696f 7269 7479 2074 6f20 7468  s priority to th
+000142a0: 6520 7269 6768 7420 7468 656e 206c 6566  e right then lef
+000142b0: 7420 7468 656e 2062 6f74 746f 6d20 7468  t then bottom th
+000142c0: 656e 2074 6f70 2061 6e64 2074 6865 2073  en top and the s
+000142d0: 616d 6520 666f 7220 3435 2064 6567 7265  ame for 45 degre
+000142e0: 6520 696e 636c 696e 6564 2064 6972 6563  e inclined direc
+000142f0: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
+00014300: 2020 7269 6768 7420 626f 7474 6f6d 2074    right bottom t
+00014310: 6865 6e20 6c65 6674 2062 6f74 746f 6d20  hen left bottom 
+00014320: 7468 656e 206c 6566 7420 546f 7020 7468  then left Top th
+00014330: 656e 2072 6967 6874 2054 6f70 2e0d 0a0d  en right Top....
+00014340: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00014350: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00014360: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00014370: 2061 7272 6179 3a20 5b6e 756d 7079 2e61   array: [numpy.a
+00014380: 7272 6179 5d0d 0a20 2020 2020 2020 2020  rray]..         
+00014390: 2020 2041 7272 6179 2074 6f20 6669 6c6c     Array to fill
+000143a0: 2073 6f6d 6520 6f66 2069 7473 2063 656c   some of its cel
+000143b0: 6c73 2077 6974 6820 4e65 6172 6573 7420  ls with Nearest 
+000143c0: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
+000143d0: 6e6f 6461 7461 7661 6c75 653a 205b 666c  nodatavalue: [fl
+000143e0: 6f61 7433 325d 0d0a 2020 2020 2020 2020  oat32]..        
+000143f0: 2020 2020 7661 6c75 6520 7374 6f72 6564      value stored
+00014400: 2069 6e20 6365 6c6c 7320 7468 6174 2069   in cells that i
+00014410: 7320 6f75 7420 6f66 2074 6865 2064 6f6d  s out of the dom
+00014420: 6169 6e0d 0a20 2020 2020 2020 2072 6f77  ain..        row
+00014430: 733a 205b 4c69 7374 5d0d 0a20 2020 2020  s: [List]..     
+00014440: 2020 2020 2020 206c 6973 7420 6f66 2074         list of t
+00014450: 6865 2072 6f77 7320 696e 6465 7820 6f66  he rows index of
+00014460: 2074 6865 2063 656c 6c73 2079 6f75 2077   the cells you w
+00014470: 616e 7420 746f 2066 696c 6c20 6974 2077  ant to fill it w
+00014480: 6974 680d 0a20 2020 2020 2020 2020 2020  ith..           
+00014490: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
+000144a0: 7572 2e0d 0a20 2020 2020 2020 2063 6f6c  ur...        col
+000144b0: 733a 205b 4c69 7374 5d0d 0a20 2020 2020  s: [List]..     
+000144c0: 2020 2020 2020 206c 6973 7420 6f66 2074         list of t
+000144d0: 6865 2063 6f6c 756d 6e20 696e 6465 7820  he column index 
+000144e0: 6f66 2074 6865 2063 656c 6c73 2079 6f75  of the cells you
+000144f0: 2077 616e 7420 746f 2066 696c 6c20 6974   want to fill it
+00014500: 2077 6974 680d 0a20 2020 2020 2020 2020   with..         
+00014510: 2020 206e 6561 7265 7374 206e 6569 6768     nearest neigh
+00014520: 626f 7572 2e0d 0a0d 0a20 2020 2020 2020  bour.....       
+00014530: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00014540: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00014550: 2020 2061 7272 6179 3a20 5b6e 756d 7079     array: [numpy
+00014560: 2061 7272 6179 5d0d 0a20 2020 2020 2020   array]..       
+00014570: 2020 2020 2043 656c 6c73 206f 6620 6769       Cells of gi
+00014580: 7665 6e20 696e 6469 6365 7320 7769 6c6c  ven indices will
+00014590: 2062 6520 6669 6c6c 6564 2077 6974 6820   be filled with 
+000145a0: 7661 6c75 6520 6f66 2074 6865 204e 6561  value of the Nea
+000145b0: 7265 7374 206e 6569 6768 626f 7572 0d0a  rest neighbour..
+000145c0: 0d0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+000145d0: 6573 0d0a 2020 2020 2020 2020 2d2d 2d2d  es..        ----
+000145e0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3e3e  ----..        >>
+000145f0: 3e20 7261 7374 6572 203d 2067 6461 6c2e  > raster = gdal.
+00014600: 4f70 656e 2822 6465 6d2e 7469 6622 290d  Open("dem.tif").
+00014610: 0a20 2020 2020 2020 203e 3e3e 2072 6571  .        >>> req
+00014620: 5f72 6f77 7320 3d20 5b33 2c31 325d 0d0a  _rows = [3,12]..
+00014630: 2020 2020 2020 2020 3e3e 3e20 7265 715f          >>> req_
+00014640: 636f 6c73 203d 205b 392c 325d 0d0a 2020  cols = [9,2]..  
+00014650: 2020 2020 2020 3e3e 3e20 6e65 775f 6172        >>> new_ar
+00014660: 7261 7920 3d20 4461 7461 7365 742e 5f6e  ray = Dataset._n
+00014670: 6561 7265 7374 5f6e 6569 6768 626f 7572  earest_neighbour
+00014680: 2872 6173 7465 722c 2072 6571 5f72 6f77  (raster, req_row
+00014690: 732c 2072 6571 5f63 6f6c 7329 0d0a 2020  s, req_cols)..  
+000146a0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+000146b0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+000146c0: 616e 6365 2861 7272 6179 2c20 6e70 2e6e  ance(array, np.n
+000146d0: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
+000146e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000146f0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00014700: 2020 2020 2020 2020 2273 7263 2073 686f          "src sho
+00014710: 756c 6420 6265 2072 6561 6420 7573 696e  uld be read usin
+00014720: 6720 6764 616c 2028 6764 616c 2064 6174  g gdal (gdal dat
+00014730: 6173 6574 2070 6c65 6173 6520 7265 6164  aset please read
+00014740: 2069 7420 7573 696e 6720 6764 616c 206c   it using gdal l
+00014750: 6962 7261 7279 2920 220d 0a20 2020 2020  ibrary) "..     
+00014760: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00014770: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00014780: 6e63 6528 726f 7773 2c20 6c69 7374 293a  nce(rows, list):
+00014790: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+000147a0: 6973 6520 5479 7065 4572 726f 7228 2272  ise TypeError("r
+000147b0: 6f77 7320 696e 7075 7420 6861 7320 746f  ows input has to
+000147c0: 2062 6520 6f66 2074 7970 6520 6c69 7374   be of type list
+000147d0: 2229 0d0a 2020 2020 2020 2020 6966 206e  ")..        if n
+000147e0: 6f74 2069 7369 6e73 7461 6e63 6528 636f  ot isinstance(co
+000147f0: 6c73 2c20 6c69 7374 293a 0d0a 2020 2020  ls, list):..    
+00014800: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00014810: 7065 4572 726f 7228 2263 6f6c 7320 696e  peError("cols in
+00014820: 7075 7420 6861 7320 746f 2062 6520 6f66  put has to be of
+00014830: 2074 7970 6520 6c69 7374 2229 0d0a 0d0a   type list")....
+00014840: 2020 2020 2020 2020 2320 2020 2061 7272          #    arr
+00014850: 6179 3d72 6173 7465 722e 5265 6164 4173  ay=raster.ReadAs
+00014860: 4172 7261 7928 290d 0a20 2020 2020 2020  Array()..       
+00014870: 2023 2020 2020 6e6f 6461 7461 7661 6c75   #    nodatavalu
+00014880: 653d 6e70 2e66 6c6f 6174 3332 2872 6173  e=np.float32(ras
+00014890: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+000148a0: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
+000148b0: 6c75 6528 2929 0d0a 0d0a 2020 2020 2020  lue())....      
+000148c0: 2020 6e6f 5f72 6f77 7320 3d20 6e70 2e73    no_rows = np.s
+000148d0: 6861 7065 2861 7272 6179 295b 305d 0d0a  hape(array)[0]..
+000148e0: 2020 2020 2020 2020 6e6f 5f63 6f6c 7320          no_cols 
+000148f0: 3d20 6e70 2e73 6861 7065 2861 7272 6179  = np.shape(array
+00014900: 295b 315d 0d0a 0d0a 2020 2020 2020 2020  )[1]....        
+00014910: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00014920: 656e 2872 6f77 7329 293a 0d0a 2020 2020  en(rows)):..    
+00014930: 2020 2020 2020 2020 2320 6769 7665 2074          # give t
+00014940: 6865 2063 656c 6c20 7468 6520 7661 6c75  he cell the valu
+00014950: 6520 6f66 2074 6865 2063 656c 6c20 7468  e of the cell th
+00014960: 6174 2069 7320 6174 2074 6865 2072 6967  at is at the rig
+00014970: 6874 0d0a 2020 2020 2020 2020 2020 2020  ht..            
+00014980: 6966 2061 7272 6179 5b72 6f77 735b 695d  if array[rows[i]
+00014990: 2c20 636f 6c73 5b69 5d20 2b20 315d 2021  , cols[i] + 1] !
+000149a0: 3d20 6e6f 6461 7461 7661 6c75 6520 616e  = nodatavalue an
+000149b0: 6420 636f 6c73 5b69 5d20 2b20 3120 3c3d  d cols[i] + 1 <=
+000149c0: 206e 6f5f 636f 6c73 3a0d 0a20 2020 2020   no_cols:..     
+000149d0: 2020 2020 2020 2020 2020 2061 7272 6179             array
+000149e0: 5b72 6f77 735b 695d 2c20 636f 6c73 5b69  [rows[i], cols[i
+000149f0: 5d5d 203d 2061 7272 6179 5b72 6f77 735b  ]] = array[rows[
+00014a00: 695d 2c20 636f 6c73 5b69 5d20 2b20 315d  i], cols[i] + 1]
+00014a10: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00014a20: 656c 6966 2061 7272 6179 5b72 6f77 735b  elif array[rows[
+00014a30: 695d 2c20 636f 6c73 5b69 5d20 2d20 315d  i], cols[i] - 1]
+00014a40: 2021 3d20 6e6f 6461 7461 7661 6c75 6520   != nodatavalue 
+00014a50: 616e 6420 636f 6c73 5b69 5d20 2d20 3120  and cols[i] - 1 
+00014a60: 3e20 303a 0d0a 2020 2020 2020 2020 2020  > 0:..          
+00014a70: 2020 2020 2020 2320 6769 7665 2074 6865        # give the
+00014a80: 2063 656c 6c20 7468 6520 7661 6c75 6520   cell the value 
+00014a90: 6f66 2074 6865 2063 656c 6c20 7468 6174  of the cell that
+00014aa0: 2069 7320 6174 2074 6865 206c 6566 740d   is at the left.
+00014ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014ac0: 2061 7272 6179 5b72 6f77 735b 695d 2c20   array[rows[i], 
+00014ad0: 636f 6c73 5b69 5d5d 203d 2061 7272 6179  cols[i]] = array
+00014ae0: 5b72 6f77 735b 695d 2c20 636f 6c73 5b69  [rows[i], cols[i
+00014af0: 5d20 2d20 315d 0d0a 0d0a 2020 2020 2020  ] - 1]....      
+00014b00: 2020 2020 2020 656c 6966 2061 7272 6179        elif array
+00014b10: 5b72 6f77 735b 695d 202d 2031 2c20 636f  [rows[i] - 1, co
+00014b20: 6c73 5b69 5d5d 2021 3d20 6e6f 6461 7461  ls[i]] != nodata
+00014b30: 7661 6c75 6520 616e 6420 726f 7773 5b69  value and rows[i
+00014b40: 5d20 2d20 3120 3e20 303a 0d0a 2020 2020  ] - 1 > 0:..    
+00014b50: 2020 2020 2020 2020 2020 2020 2320 6769              # gi
+00014b60: 7665 2074 6865 2063 656c 6c20 7468 6520  ve the cell the 
+00014b70: 7661 6c75 6520 6f66 2074 6865 2063 656c  value of the cel
+00014b80: 6c20 7468 6174 2069 7320 6174 2074 6865  l that is at the
+00014b90: 2062 6f74 746f 6d0d 0a20 2020 2020 2020   bottom..       
+00014ba0: 2020 2020 2020 2020 2061 7272 6179 5b72           array[r
+00014bb0: 6f77 735b 695d 2c20 636f 6c73 5b69 5d5d  ows[i], cols[i]]
+00014bc0: 203d 2061 7272 6179 5b72 6f77 735b 695d   = array[rows[i]
+00014bd0: 202d 2031 2c20 636f 6c73 5b69 5d5d 0d0a   - 1, cols[i]]..
+00014be0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00014bf0: 6966 2061 7272 6179 5b72 6f77 735b 695d  if array[rows[i]
+00014c00: 202b 2031 2c20 636f 6c73 5b69 5d5d 2021   + 1, cols[i]] !
+00014c10: 3d20 6e6f 6461 7461 7661 6c75 6520 616e  = nodatavalue an
+00014c20: 6420 726f 7773 5b69 5d20 2b20 3120 3c3d  d rows[i] + 1 <=
+00014c30: 206e 6f5f 726f 7773 3a0d 0a20 2020 2020   no_rows:..     
+00014c40: 2020 2020 2020 2020 2020 2023 2067 6976             # giv
+00014c50: 6520 7468 6520 6365 6c6c 2074 6865 2076  e the cell the v
+00014c60: 616c 7565 206f 6620 7468 6520 6365 6c6c  alue of the cell
+00014c70: 2074 6861 7420 6973 2061 7420 7468 6520   that is at the 
+00014c80: 546f 700d 0a20 2020 2020 2020 2020 2020  Top..           
+00014c90: 2020 2020 2061 7272 6179 5b72 6f77 735b       array[rows[
+00014ca0: 695d 2c20 636f 6c73 5b69 5d5d 203d 2061  i], cols[i]] = a
+00014cb0: 7272 6179 5b72 6f77 735b 695d 202b 2031  rray[rows[i] + 1
+00014cc0: 2c20 636f 6c73 5b69 5d5d 0d0a 0d0a 2020  , cols[i]]....  
+00014cd0: 2020 2020 2020 2020 2020 656c 6966 2028            elif (
+00014ce0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014cf0: 2020 6172 7261 795b 726f 7773 5b69 5d20    array[rows[i] 
+00014d00: 2d20 312c 2063 6f6c 735b 695d 202b 2031  - 1, cols[i] + 1
+00014d10: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
+00014d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014d30: 2020 616e 6420 726f 7773 5b69 5d20 2d20    and rows[i] - 
+00014d40: 3120 3e20 300d 0a20 2020 2020 2020 2020  1 > 0..         
+00014d50: 2020 2020 2020 2061 6e64 2063 6f6c 735b         and cols[
+00014d60: 695d 202b 2031 203c 3d20 6e6f 5f63 6f6c  i] + 1 <= no_col
+00014d70: 730d 0a20 2020 2020 2020 2020 2020 2029  s..            )
+00014d80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00014d90: 2020 2023 2067 6976 6520 7468 6520 6365     # give the ce
+00014da0: 6c6c 2074 6865 2076 616c 7565 206f 6620  ll the value of 
+00014db0: 7468 6520 6365 6c6c 2074 6861 7420 6973  the cell that is
+00014dc0: 2061 7420 7468 6520 7269 6768 7420 626f   at the right bo
+00014dd0: 7474 6f6d 0d0a 2020 2020 2020 2020 2020  ttom..          
+00014de0: 2020 2020 2020 6172 7261 795b 726f 7773        array[rows
+00014df0: 5b69 5d2c 2063 6f6c 735b 695d 5d20 3d20  [i], cols[i]] = 
+00014e00: 6172 7261 795b 726f 7773 5b69 5d20 2d20  array[rows[i] - 
+00014e10: 312c 2063 6f6c 735b 695d 202b 2031 5d0d  1, cols[i] + 1].
+00014e20: 0a0d 0a20 2020 2020 2020 2020 2020 2065  ...            e
+00014e30: 6c69 6620 280d 0a20 2020 2020 2020 2020  lif (..         
+00014e40: 2020 2020 2020 2061 7272 6179 5b72 6f77         array[row
+00014e50: 735b 695d 202d 2031 2c20 636f 6c73 5b69  s[i] - 1, cols[i
+00014e60: 5d20 2d20 315d 2021 3d20 6e6f 6461 7461  ] - 1] != nodata
+00014e70: 7661 6c75 650d 0a20 2020 2020 2020 2020  value..         
+00014e80: 2020 2020 2020 2061 6e64 2072 6f77 735b         and rows[
+00014e90: 695d 202d 2031 203e 2030 0d0a 2020 2020  i] - 1 > 0..    
+00014ea0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00014eb0: 636f 6c73 5b69 5d20 2d20 3120 3e20 300d  cols[i] - 1 > 0.
+00014ec0: 0a20 2020 2020 2020 2020 2020 2029 3a0d  .            ):.
+00014ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014ee0: 2023 2067 6976 6520 7468 6520 6365 6c6c   # give the cell
+00014ef0: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+00014f00: 6520 6365 6c6c 2074 6861 7420 6973 2061  e cell that is a
+00014f10: 7420 7468 6520 6c65 6674 2062 6f74 746f  t the left botto
+00014f20: 6d0d 0a20 2020 2020 2020 2020 2020 2020  m..             
+00014f30: 2020 2061 7272 6179 5b72 6f77 735b 695d     array[rows[i]
+00014f40: 2c20 636f 6c73 5b69 5d5d 203d 2061 7272  , cols[i]] = arr
+00014f50: 6179 5b72 6f77 735b 695d 202d 2031 2c20  ay[rows[i] - 1, 
+00014f60: 636f 6c73 5b69 5d20 2d20 315d 0d0a 0d0a  cols[i] - 1]....
+00014f70: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00014f80: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00014f90: 2020 2020 6172 7261 795b 726f 7773 5b69      array[rows[i
+00014fa0: 5d20 2b20 312c 2063 6f6c 735b 695d 202d  ] + 1, cols[i] -
+00014fb0: 2031 5d20 213d 206e 6f64 6174 6176 616c   1] != nodataval
+00014fc0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00014fd0: 2020 2020 616e 6420 726f 7773 5b69 5d20      and rows[i] 
+00014fe0: 2b20 3120 3c3d 206e 6f5f 726f 7773 0d0a  + 1 <= no_rows..
+00014ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015000: 616e 6420 636f 6c73 5b69 5d20 2d20 3120  and cols[i] - 1 
+00015010: 3e20 300d 0a20 2020 2020 2020 2020 2020  > 0..           
+00015020: 2029 3a0d 0a20 2020 2020 2020 2020 2020   ):..           
+00015030: 2020 2020 2023 2067 6976 6520 7468 6520       # give the 
+00015040: 6365 6c6c 2074 6865 2076 616c 7565 206f  cell the value o
+00015050: 6620 7468 6520 6365 6c6c 2074 6861 7420  f the cell that 
+00015060: 6973 2061 7420 7468 6520 6c65 6674 2054  is at the left T
+00015070: 6f70 0d0a 2020 2020 2020 2020 2020 2020  op..            
+00015080: 2020 2020 6172 7261 795b 726f 7773 5b69      array[rows[i
+00015090: 5d2c 2063 6f6c 735b 695d 5d20 3d20 6172  ], cols[i]] = ar
+000150a0: 7261 795b 726f 7773 5b69 5d20 2b20 312c  ray[rows[i] + 1,
+000150b0: 2063 6f6c 735b 695d 202d 2031 5d0d 0a0d   cols[i] - 1]...
+000150c0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+000150d0: 6620 280d 0a20 2020 2020 2020 2020 2020  f (..           
+000150e0: 2020 2020 2061 7272 6179 5b72 6f77 735b       array[rows[
+000150f0: 695d 202b 2031 2c20 636f 6c73 5b69 5d20  i] + 1, cols[i] 
+00015100: 2b20 315d 2021 3d20 6e6f 6461 7461 7661  + 1] != nodatava
+00015110: 6c75 650d 0a20 2020 2020 2020 2020 2020  lue..           
+00015120: 2020 2020 2061 6e64 2072 6f77 735b 695d       and rows[i]
+00015130: 202b 2031 203c 3d20 6e6f 5f72 6f77 730d   + 1 <= no_rows.
+00015140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015150: 2061 6e64 2063 6f6c 735b 695d 202b 2031   and cols[i] + 1
+00015160: 203c 3d20 6e6f 5f63 6f6c 730d 0a20 2020   <= no_cols..   
+00015170: 2020 2020 2020 2020 2029 3a0d 0a20 2020           ):..   
+00015180: 2020 2020 2020 2020 2020 2020 2023 2067               # g
+00015190: 6976 6520 7468 6520 6365 6c6c 2074 6865  ive the cell the
+000151a0: 2076 616c 7565 206f 6620 7468 6520 6365   value of the ce
+000151b0: 6c6c 2074 6861 7420 6973 2061 7420 7468  ll that is at th
+000151c0: 6520 7269 6768 7420 546f 700d 0a20 2020  e right Top..   
+000151d0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+000151e0: 6179 5b72 6f77 735b 695d 2c20 636f 6c73  ay[rows[i], cols
+000151f0: 5b69 5d5d 203d 2061 7272 6179 5b72 6f77  [i]] = array[row
+00015200: 735b 695d 202b 2031 2c20 636f 6c73 5b69  s[i] + 1, cols[i
+00015210: 5d20 2b20 315d 0d0a 2020 2020 2020 2020  ] + 1]..        
+00015220: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00015230: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00015240: 2822 7468 6520 6365 6c6c 2069 7320 6973  ("the cell is is
+00015250: 6f6c 6174 6564 2028 4e6f 2073 7572 726f  olated (No surro
+00015260: 756e 6469 6e67 2063 656c 6c73 2065 7869  unding cells exi
+00015270: 7374 2922 290d 0a20 2020 2020 2020 2072  st)")..        r
+00015280: 6574 7572 6e20 6172 7261 790d 0a0d 0a20  eturn array.... 
+00015290: 2020 2064 6566 206c 6f63 6174 655f 706f     def locate_po
+000152a0: 696e 7473 280d 0a20 2020 2020 2020 2073  ints(..        s
+000152b0: 656c 662c 0d0a 2020 2020 2020 2020 706f  elf,..        po
+000152c0: 696e 7473 3a20 556e 696f 6e5b 4765 6f44  ints: Union[GeoD
+000152d0: 6174 6146 7261 6d65 2c20 4665 6174 7572  ataFrame, Featur
+000152e0: 6543 6f6c 6c65 6374 696f 6e2c 2044 6174  eCollection, Dat
+000152f0: 6146 7261 6d65 5d2c 0d0a 2020 2020 2920  aFrame],..    ) 
+00015300: 2d3e 206e 702e 6e64 6172 7261 793a 0d0a  -> np.ndarray:..
+00015310: 2020 2020 2020 2020 2222 226e 6561 7265          """neare
+00015320: 7374 4365 6c6c 2e0d 0a0d 0a20 2020 2020  stCell.....     
+00015330: 2020 2020 2020 206e 6561 7265 7374 4365         nearestCe
+00015340: 6c6c 2063 616c 6375 6c61 7465 7320 7468  ll calculates th
+00015350: 6520 7468 6520 696e 6469 6365 7320 2872  e the indices (r
+00015360: 6f77 732c 2063 6f6c 2920 6f66 206e 6561  ows, col) of nea
+00015370: 7265 7374 2063 656c 6c20 696e 2061 2067  rest cell in a g
+00015380: 6976 656e 0d0a 2020 2020 2020 2020 2020  iven..          
+00015390: 2020 7261 7374 6572 2074 6f20 6120 7374    raster to a st
+000153a0: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
+000153b0: 2020 2063 6f6f 7264 696e 6174 6520 7379     coordinate sy
+000153c0: 7374 656d 206f 6620 7468 6520 7261 7374  stem of the rast
+000153d0: 6572 2068 6173 2074 6f20 6265 2070 726f  er has to be pro
+000153e0: 6a65 6374 6564 2074 6f20 6265 2061 626c  jected to be abl
+000153f0: 6520 746f 2063 616c 6375 6c61 7465 0d0a  e to calculate..
+00015400: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00015410: 6469 7374 616e 6365 0d0a 0d0a 2020 2020  distance....    
+00015420: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00015430: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00015440: 2d2d 0d0a 2020 2020 2020 2020 706f 696e  --..        poin
+00015450: 7473 3a20 5b44 6174 6166 7261 6d65 5d0d  ts: [Dataframe].
+00015460: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00015470: 6166 7261 6d65 2077 6974 6820 504f 494e  aframe with POIN
+00015480: 5420 6765 6f6d 6574 7279 2e0d 0a0d 0a20  T geometry..... 
+00015490: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+000154a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+000154b0: 0a20 2020 2020 2020 2061 7272 6179 3a0d  .        array:.
+000154c0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+000154d0: 6179 2077 6974 6820 6120 7368 6170 6520  ay with a shape 
+000154e0: 2861 6e79 2c20 3229 2c20 666f 7220 7468  (any, 2), for th
+000154f0: 6520 726f 772c 2063 6f6c 756d 6e20 696e  e row, column in
+00015500: 6469 6365 7320 696e 2074 6865 2061 7272  dices in the arr
+00015510: 6179 2e0d 0a20 2020 2020 2020 2020 2020  ay...           
+00015520: 2061 7272 6179 285b 5b20 352c 2020 345d   array([[ 5,  4]
+00015530: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00015540: 2020 2020 2020 5b20 322c 2020 395d 2c0d        [ 2,  9],.
+00015550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015560: 2020 2020 5b20 352c 2020 395d 5d29 0d0a      [ 5,  9]])..
+00015570: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00015580: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00015590: 6365 2870 6f69 6e74 732c 2047 656f 4461  ce(points, GeoDa
+000155a0: 7461 4672 616d 6529 3a0d 0a20 2020 2020  taFrame):..     
+000155b0: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
+000155c0: 4665 6174 7572 6543 6f6c 6c65 6374 696f  FeatureCollectio
+000155d0: 6e28 706f 696e 7473 290d 0a20 2020 2020  n(points)..     
+000155e0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+000155f0: 6365 2870 6f69 6e74 732c 2044 6174 6146  ce(points, DataF
+00015600: 7261 6d65 293a 0d0a 2020 2020 2020 2020  rame):..        
+00015610: 2020 2020 6966 2061 6c6c 2865 6c65 6d20      if all(elem 
+00015620: 6e6f 7420 696e 2070 6f69 6e74 732e 636f  not in points.co
+00015630: 6c75 6d6e 7320 666f 7220 656c 656d 2069  lumns for elem i
+00015640: 6e20 5b22 7822 2c20 2279 225d 293a 0d0a  n ["x", "y"]):..
+00015650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015660: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00015670: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00015680: 2020 2020 2020 2022 4966 2074 6865 2069         "If the i
+00015690: 6e70 7574 2069 6e20 6120 4461 7461 4672  nput in a DataFr
+000156a0: 616d 652c 2069 7420 7368 6f75 6c64 2068  ame, it should h
+000156b0: 6176 6520 7477 6f20 636f 6c75 6d6e 7320  ave two columns 
+000156c0: 782c 2061 6e64 2079 220d 0a20 2020 2020  x, and y"..     
+000156d0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+000156e0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+000156f0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00015700: 6973 696e 7374 616e 6365 2870 6f69 6e74  isinstance(point
+00015710: 732c 2046 6561 7475 7265 436f 6c6c 6563  s, FeatureCollec
+00015720: 7469 6f6e 293a 0d0a 2020 2020 2020 2020  tion):..        
+00015730: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00015740: 7065 4572 726f 7228 0d0a 2020 2020 2020  peError(..      
+00015750: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00015760: 706c 6561 7365 2063 6865 636b 2070 6f69  please check poi
+00015770: 6e74 7320 696e 7075 7420 6974 2073 686f  nts input it sho
+00015780: 756c 6420 6265 2047 656f 4461 7461 4672  uld be GeoDataFr
+00015790: 616d 652f 4665 6174 7572 6543 6f6c 6c65  ame/FeatureColle
+000157a0: 6374 696f 6e20 2d20 6769 7665 6e20 7b74  ction - given {t
+000157b0: 7970 6528 706f 696e 7473 297d 220d 0a20  ype(points)}".. 
+000157c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000157d0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+000157e0: 2069 7369 6e73 7461 6e63 6528 706f 696e   isinstance(poin
+000157f0: 7473 2c20 4461 7461 4672 616d 6529 3a0d  ts, DataFrame):.
+00015800: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+00015810: 6574 2074 6865 2078 2c20 7920 636f 6f72  et the x, y coor
+00015820: 6469 6e61 7465 732e 0d0a 2020 2020 2020  dinates...      
+00015830: 2020 2020 2020 706f 696e 7473 2e78 7928        points.xy(
+00015840: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+00015850: 6f69 6e74 7320 3d20 706f 696e 7473 2e66  oints = points.f
+00015860: 6561 7475 7265 2e6c 6f63 5b3a 2c20 5b22  eature.loc[:, ["
+00015870: 7822 2c20 2279 225d 5d2e 7661 6c75 6573  x", "y"]].values
+00015880: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00015890: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
+000158a0: 6e74 7320 3d20 706f 696e 7473 2e6c 6f63  nts = points.loc
+000158b0: 5b3a 2c20 5b22 7822 2c20 2279 225d 5d2e  [:, ["x", "y"]].
+000158c0: 7661 6c75 6573 0d0a 0d0a 2020 2020 2020  values....      
+000158d0: 2020 2320 7369 6e63 6520 6669 7273 7420    # since first 
+000158e0: 726f 7720 6973 2078 2d63 6f6f 7264 7320  row is x-coords 
+000158f0: 736f 2074 6865 2066 6972 7374 2063 6f6c  so the first col
+00015900: 756d 6e20 696e 2074 6865 2069 6e64 6963  umn in the indic
+00015910: 6573 2069 7320 7468 6520 636f 6c75 6d6e  es is the column
+00015920: 2069 6e64 6578 0d0a 2020 2020 2020 2020   index..        
+00015930: 696e 6469 6365 7320 3d20 6c6f 6361 7465  indices = locate
+00015940: 5f76 616c 7565 7328 706f 696e 7473 2c20  _values(points, 
+00015950: 7365 6c66 2e78 2c20 7365 6c66 2e79 290d  self.x, self.y).
+00015960: 0a20 2020 2020 2020 2023 2072 6561 7272  .        # rearr
+00015970: 616e 6765 2074 6865 2063 6f6c 756d 6e73  ange the columns
+00015980: 2074 6f20 6d61 6b65 2074 6865 2072 6f77   to make the row
+00015990: 2069 6e64 6578 2066 6972 7374 0d0a 2020   index first..  
+000159a0: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
+000159b0: 696e 6469 6365 735b 3a2c 205b 312c 2030  indices[:, [1, 0
+000159c0: 5d5d 0d0a 2020 2020 2020 2020 7265 7475  ]]..        retu
+000159d0: 726e 2069 6e64 6963 6573 0d0a 0d0a 2020  rn indices....  
+000159e0: 2020 6465 6620 6578 7472 6163 7428 0d0a    def extract(..
+000159f0: 2020 2020 2020 2020 7365 6c66 2c0d 0a20          self,.. 
+00015a00: 2020 2020 2020 2065 7863 6c75 6465 5f76         exclude_v
+00015a10: 616c 7565 3a20 416e 7920 3d20 4e6f 6e65  alue: Any = None
+00015a20: 2c0d 0a20 2020 2020 2020 2066 6561 7475  ,..        featu
+00015a30: 7265 3a20 556e 696f 6e5b 4665 6174 7572  re: Union[Featur
+00015a40: 6543 6f6c 6c65 6374 696f 6e2c 2047 656f  eCollection, Geo
+00015a50: 4461 7461 4672 616d 655d 203d 204e 6f6e  DataFrame] = Non
+00015a60: 652c 0d0a 2020 2020 2920 2d3e 204c 6973  e,..    ) -> Lis
+00015a70: 743a 0d0a 2020 2020 2020 2020 2222 2245  t:..        """E
+00015a80: 7874 7261 6374 2e0d 0a0d 0a20 2020 2020  xtract.....     
+00015a90: 2020 2020 2020 202d 2045 7874 7261 6374         - Extract
+00015aa0: 206d 6574 686f 6420 6765 7420 616c 6c20   method get all 
+00015ab0: 7468 6520 7661 6c75 6573 2069 6e20 6120  the values in a 
+00015ac0: 7261 7374 6572 2c20 616e 6420 6578 636c  raster, and excl
+00015ad0: 7564 6520 7468 6520 7661 6c75 6573 2069  ude the values i
+00015ae0: 6e20 7468 6520 6578 636c 7564 655f 7661  n the exclude_va
+00015af0: 6c75 6520 7061 7261 6d65 7465 722e 0d0a  lue parameter...
+00015b00: 2020 2020 2020 2020 2020 2020 2d20 4966              - If
+00015b10: 2074 6865 2066 6561 7475 7265 2070 6172   the feature par
+00015b20: 616d 6574 6572 2069 7320 6769 7665 6e20  ameter is given 
+00015b30: 7468 6520 7261 7374 6572 2077 696c 6c20  the raster will 
+00015b40: 6265 2063 6c69 7065 6420 746f 2074 6865  be cliped to the
+00015b50: 2065 7874 656e 7420 6f66 2074 6865 2067   extent of the g
+00015b60: 6976 656e 2066 6561 7475 7265 2061 6e64  iven feature and
+00015b70: 2074 6865 0d0a 2020 2020 2020 2020 2020   the..          
+00015b80: 2020 7661 6c75 6573 2077 6974 6869 6e20    values within 
+00015b90: 7468 6520 6665 6174 7572 6520 6172 6520  the feature are 
+00015ba0: 6578 7472 6163 7465 642e 0d0a 0d0a 2020  extracted.....  
+00015bb0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00015bc0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00015bd0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6578  ----..        ex
+00015be0: 636c 7564 655f 7661 6c75 653a 205b 4e75  clude_value: [Nu
+00015bf0: 6d65 7269 635d 0d0a 2020 2020 2020 2020  meric]..        
+00015c00: 2020 2020 7661 6c75 6573 2079 6f75 2077      values you w
+00015c10: 616e 7420 746f 2065 7863 6c75 6465 2066  ant to exclude f
+00015c20: 726f 6d20 6578 7465 6163 7465 6420 7661  rom exteacted va
+00015c30: 6c75 6573 0d0a 2020 2020 2020 2020 6665  lues..        fe
+00015c40: 6174 7572 653a 205b 4665 6174 7572 6543  ature: [FeatureC
+00015c50: 6f6c 6c65 6374 696f 6e2f 4765 6f44 6174  ollection/GeoDat
+00015c60: 6146 7261 6d65 5d0d 0a20 2020 2020 2020  aFrame]..       
+00015c70: 2020 2020 2076 6563 746f 7220 6669 6c65       vector file
+00015c80: 2063 6f6e 7461 696e 7320 6765 6f6d 6574   contains geomet
+00015c90: 7269 6573 2079 6f75 2077 616e 7420 746f  ries you want to
+00015ca0: 2065 7874 7261 6374 2074 6865 2076 616c   extract the val
+00015cb0: 7565 7320 6174 2074 6865 6972 206c 6f63  ues at their loc
+00015cc0: 6174 696f 6e2e 2044 6566 6175 6c74 2069  ation. Default i
+00015cd0: 7320 4e6f 6e65 2e0d 0a20 2020 2020 2020  s None...       
+00015ce0: 2022 2222 0d0a 2020 2020 2020 2020 6172   """..        ar
+00015cf0: 7220 3d20 7365 6c66 2e72 6561 645f 6172  r = self.read_ar
+00015d00: 7261 7928 290d 0a20 2020 2020 2020 206e  ray()..        n
+00015d10: 6f5f 6461 7461 5f76 616c 7565 203d 2028  o_data_value = (
+00015d20: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00015d30: 6c66 2e6e 6f5f 6461 7461 5f76 616c 7565  lf.no_data_value
+00015d40: 5b30 5d20 6966 2073 656c 662e 6e6f 5f64  [0] if self.no_d
+00015d50: 6174 615f 7661 6c75 655b 305d 2069 7320  ata_value[0] is 
+00015d60: 6e6f 7420 4e6f 6e65 2065 6c73 6520 6e70  not None else np
+00015d70: 2e6e 616e 0d0a 2020 2020 2020 2020 290d  .nan..        ).
+00015d80: 0a20 2020 2020 2020 2069 6620 6665 6174  .        if feat
+00015d90: 7572 6520 6973 204e 6f6e 653a 0d0a 2020  ure is None:..  
+00015da0: 2020 2020 2020 2020 2020 6d61 736b 203d            mask =
+00015db0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00015dc0: 2020 2020 5b6e 6f5f 6461 7461 5f76 616c      [no_data_val
+00015dd0: 7565 2c20 6578 636c 7564 655f 7661 6c75  ue, exclude_valu
+00015de0: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
+00015df0: 2020 2020 6966 2065 7863 6c75 6465 5f76      if exclude_v
+00015e00: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
+00015e10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015e20: 2020 656c 7365 205b 6e6f 5f64 6174 615f    else [no_data_
+00015e30: 7661 6c75 655d 0d0a 2020 2020 2020 2020  value]..        
+00015e40: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+00015e50: 2020 2076 616c 7565 7320 3d20 6765 745f     values = get_
+00015e60: 7069 7865 6c73 3228 6172 722c 206d 6173  pixels2(arr, mas
+00015e70: 6b29 0d0a 2020 2020 2020 2020 656c 7365  k)..        else
+00015e80: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00015e90: 6e64 6963 6573 203d 2073 656c 662e 6c6f  ndices = self.lo
+00015ea0: 6361 7465 5f70 6f69 6e74 7328 6665 6174  cate_points(feat
+00015eb0: 7572 6529 0d0a 2020 2020 2020 2020 2020  ure)..          
+00015ec0: 2020 7661 6c75 6573 203d 2061 7272 5b69    values = arr[i
+00015ed0: 6e64 6963 6573 5b3a 2c20 305d 2c20 696e  ndices[:, 0], in
+00015ee0: 6469 6365 735b 3a2c 2031 5d5d 0d0a 2020  dices[:, 1]]..  
+00015ef0: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+00015f00: 7565 730d 0a0d 0a20 2020 2064 6566 206f  ues....    def o
+00015f10: 7665 726c 6179 280d 0a20 2020 2020 2020  verlay(..       
+00015f20: 2073 656c 662c 0d0a 2020 2020 2020 2020   self,..        
+00015f30: 636c 6173 7365 735f 6d61 702c 0d0a 2020  classes_map,..  
+00015f40: 2020 2020 2020 6261 6e64 3a20 696e 7420        band: int 
+00015f50: 3d20 302c 0d0a 2020 2020 2020 2020 6578  = 0,..        ex
+00015f60: 636c 7564 655f 7661 6c75 653a 2055 6e69  clude_value: Uni
+00015f70: 6f6e 5b66 6c6f 6174 2c20 696e 745d 203d  on[float, int] =
+00015f80: 204e 6f6e 652c 0d0a 2020 2020 2920 2d3e   None,..    ) ->
+00015f90: 2044 6963 745b 4c69 7374 5b66 6c6f 6174   Dict[List[float
+00015fa0: 5d2c 204c 6973 745b 666c 6f61 745d 5d3a  ], List[float]]:
+00015fb0: 0d0a 2020 2020 2020 2020 2222 224f 7665  ..        """Ove
+00015fc0: 726c 6179 2e0d 0a0d 0a20 2020 2020 2020  rlay.....       
+00015fd0: 2020 2020 206f 7665 726c 6179 2065 7874       overlay ext
+00015fe0: 7261 6374 7320 616c 6c20 7468 6520 7661  racts all the va
+00015ff0: 6c75 6573 2069 6e20 7261 7374 6572 2066  lues in raster f
+00016000: 696c 652c 2069 6620 796f 7520 6861 7665  ile, if you have
+00016010: 2074 776f 206d 6170 7320 6f6e 6520 7769   two maps one wi
+00016020: 7468 2063 6c61 7373 6573 2c20 616e 6420  th classes, and 
+00016030: 7468 6520 6f74 6865 7220 6d61 700d 0a20  the other map.. 
+00016040: 2020 2020 2020 2020 2020 2063 6f6e 7461             conta
+00016050: 696e 7320 616e 7920 7479 7065 206f 6620  ins any type of 
+00016060: 7661 6c75 6573 2c20 616e 6420 796f 7520  values, and you 
+00016070: 7761 6e74 2074 6f20 6b6e 6f77 2074 6865  want to know the
+00016080: 2076 616c 7565 7320 696e 2065 6163 6820   values in each 
+00016090: 636c 6173 732e 0d0a 0d0a 2020 2020 2020  class.....      
+000160a0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+000160b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000160c0: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
+000160d0: 735f 6d61 703a 205b 4461 7461 7365 745d  s_map: [Dataset]
+000160e0: 0d0a 2020 2020 2020 2020 2020 2020 4461  ..            Da
+000160f0: 7461 7365 7420 4f62 6a65 6374 2066 6f72  taset Object for
+00016100: 2074 6865 2072 6173 7465 7220 7468 6174   the raster that
+00016110: 2068 6176 6520 636c 6173 7365 7320 796f   have classes yo
+00016120: 7520 7761 6e74 2074 6f20 6f76 6572 6c61  u want to overla
+00016130: 7920 7769 7468 2074 6865 2072 6173 7465  y with the raste
+00016140: 722e 0d0a 2020 2020 2020 2020 6261 6e64  r...        band
+00016150: 3a20 5b69 6e74 5d0d 0a20 2020 2020 2020  : [int]..       
+00016160: 2020 2020 2069 6620 7468 6520 7261 7374       if the rast
+00016170: 6572 2069 7320 6d75 6c74 692d 6261 6e64  er is multi-band
+00016180: 2072 6173 7465 7220 6368 6f6f 7365 2074   raster choose t
+00016190: 6865 2062 616e 6420 796f 7520 7761 6e74  he band you want
+000161a0: 2074 6f20 6f76 6572 6c61 7920 7769 7468   to overlay with
+000161b0: 2074 6865 2063 6c61 7373 6573 206d 6170   the classes map
+000161c0: 2e20 4465 6661 756c 7420 6973 2030 2e0d  . Default is 0..
+000161d0: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
+000161e0: 5f76 616c 7565 3a20 5b4e 756d 6572 6963  _value: [Numeric
+000161f0: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
+00016200: 616c 7565 7320 796f 7520 7761 6e74 2074  alues you want t
+00016210: 6f20 6578 636c 7564 6520 6672 6f6d 2065  o exclude from e
+00016220: 7874 7261 6374 6564 2076 616c 7565 732e  xtracted values.
+00016230: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00016240: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00016250: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4469  ----..        Di
+00016260: 6374 696f 6e61 7279 3a0d 0a20 2020 2020  ctionary:..     
+00016270: 2020 2020 2020 2064 6963 746f 6e61 7279         dictonary
+00016280: 2077 6974 6820 6120 6c69 7374 206f 6620   with a list of 
+00016290: 7661 6c75 6573 2069 6e20 7468 6520 6261  values in the ba
+000162a0: 7365 6d61 7020 6173 206b 6579 7320 616e  semap as keys an
+000162b0: 6420 666f 7220 6561 6368 206b 6579 2061  d for each key a
+000162c0: 206c 6973 7420 6f66 2061 6c6c 2074 6865   list of all the
+000162d0: 2069 6e74 6572 7365 6374 6564 0d0a 2020   intersected..  
+000162e0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+000162f0: 2069 6e20 7468 6520 6d61 7073 2066 726f   in the maps fro
+00016300: 6d20 7468 6520 7061 7468 2e0d 0a20 2020  m the path...   
+00016310: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00016320: 2020 6966 206e 6f74 2073 656c 662e 5f63    if not self._c
+00016330: 6865 636b 5f61 6c69 676e 6d65 6e74 2863  heck_alignment(c
+00016340: 6c61 7373 6573 5f6d 6170 293a 0d0a 2020  lasses_map):..  
+00016350: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00016360: 416c 6967 6e6d 656e 7445 7272 6f72 280d  AlignmentError(.
+00016370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016380: 2022 5468 6520 636c 6173 7320 4461 7461   "The class Data
+00016390: 7365 7420 6973 206e 6f74 2061 6c69 676e  set is not align
+000163a0: 6564 2077 6974 6820 7468 6520 6375 7272  ed with the curr
+000163b0: 656e 7420 7261 7374 6572 2c20 706c 6173  ent raster, plas
+000163c0: 6520 7573 6520 7468 6520 6d65 7468 6f64  e use the method
+000163d0: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+000163e0: 2020 2020 2227 616c 6967 6e27 2074 6f20      "'align' to 
+000163f0: 616c 6967 6e20 626f 7468 2072 6173 7465  align both raste
+00016400: 7273 2e22 0d0a 2020 2020 2020 2020 2020  rs."..          
+00016410: 2020 290d 0a20 2020 2020 2020 2061 7272    )..        arr
+00016420: 203d 2073 656c 662e 7265 6164 5f61 7272   = self.read_arr
+00016430: 6179 2862 616e 643d 6261 6e64 290d 0a20  ay(band=band).. 
+00016440: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
+00016450: 616c 7565 203d 2028 0d0a 2020 2020 2020  alue = (..      
+00016460: 2020 2020 2020 7365 6c66 2e6e 6f5f 6461        self.no_da
+00016470: 7461 5f76 616c 7565 5b30 5d20 6966 2073  ta_value[0] if s
+00016480: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
+00016490: 655b 305d 2069 7320 6e6f 7420 4e6f 6e65  e[0] is not None
+000164a0: 2065 6c73 6520 6e70 2e6e 616e 0d0a 2020   else np.nan..  
+000164b0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000164c0: 206d 6173 6b20 3d20 280d 0a20 2020 2020   mask = (..     
+000164d0: 2020 2020 2020 205b 6e6f 5f64 6174 615f         [no_data_
+000164e0: 7661 6c75 652c 2065 7863 6c75 6465 5f76  value, exclude_v
+000164f0: 616c 7565 5d0d 0a20 2020 2020 2020 2020  alue]..         
+00016500: 2020 2069 6620 6578 636c 7564 655f 7661     if exclude_va
+00016510: 6c75 6520 6973 206e 6f74 204e 6f6e 650d  lue is not None.
+00016520: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00016530: 6520 5b6e 6f5f 6461 7461 5f76 616c 7565  e [no_data_value
+00016540: 5d0d 0a20 2020 2020 2020 2029 0d0a 2020  ]..        )..  
+00016550: 2020 2020 2020 696e 6420 3d20 6765 745f        ind = get_
+00016560: 696e 6469 6365 7332 2861 7272 2c20 6d61  indices2(arr, ma
+00016570: 736b 290d 0a20 2020 2020 2020 2063 6c61  sk)..        cla
+00016580: 7373 6573 203d 2063 6c61 7373 6573 5f6d  sses = classes_m
+00016590: 6170 2e72 6561 645f 6172 7261 7928 290d  ap.read_array().
+000165a0: 0a20 2020 2020 2020 2076 616c 7565 7320  .        values 
+000165b0: 3d20 6469 6374 2829 0d0a 0d0a 2020 2020  = dict()....    
+000165c0: 2020 2020 2320 6578 7472 6163 7420 7661      # extract va
+000165d0: 6c75 6573 0d0a 2020 2020 2020 2020 666f  lues..        fo
+000165e0: 7220 692c 2069 6e64 5f69 2069 6e20 656e  r i, ind_i in en
+000165f0: 756d 6572 6174 6528 696e 6429 3a0d 0a20  umerate(ind):.. 
+00016600: 2020 2020 2020 2020 2020 2023 2066 6972             # fir
+00016610: 7374 2063 6865 636b 2069 6620 7468 6520  st check if the 
+00016620: 7375 622d 6261 7369 6e20 6861 7320 6120  sub-basin has a 
+00016630: 6c69 7374 2069 6e20 7468 6520 6469 6374  list in the dict
+00016640: 2069 6620 6e6f 7420 6372 6561 7465 2061   if not create a
+00016650: 206c 6973 740d 0a20 2020 2020 2020 2020   list..         
+00016660: 2020 206b 6579 203d 2063 6c61 7373 6573     key = classes
+00016670: 5b69 6e64 5f69 5b30 5d2c 2069 6e64 5f69  [ind_i[0], ind_i
+00016680: 5b31 5d5d 0d0a 2020 2020 2020 2020 2020  [1]]..          
+00016690: 2020 6966 206b 6579 206e 6f74 2069 6e20    if key not in 
+000166a0: 6c69 7374 2876 616c 7565 732e 6b65 7973  list(values.keys
+000166b0: 2829 293a 0d0a 2020 2020 2020 2020 2020  ()):..          
+000166c0: 2020 2020 2020 7661 6c75 6573 5b6b 6579        values[key
+000166d0: 5d20 3d20 6c69 7374 2829 0d0a 0d0a 2020  ] = list()....  
+000166e0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+000166f0: 5b6b 6579 5d2e 6170 7065 6e64 2861 7272  [key].append(arr
+00016700: 5b69 6e64 5f69 5b30 5d2c 2069 6e64 5f69  [ind_i[0], ind_i
+00016710: 5b31 5d5d 290d 0a0d 0a20 2020 2020 2020  [1]])....       
+00016720: 2072 6574 7572 6e20 7661 6c75 6573 0d0a   return values..
+00016730: 0d0a 2020 2020 6465 6620 666f 6f74 7072  ..    def footpr
+00016740: 696e 7428 0d0a 2020 2020 2020 2020 7365  int(..        se
+00016750: 6c66 2c0d 0a20 2020 2020 2020 2062 616e  lf,..        ban
+00016760: 643a 2069 6e74 203d 2030 2c0d 0a20 2020  d: int = 0,..   
+00016770: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
+00016780: 7565 733a 204f 7074 696f 6e61 6c5b 4c69  ues: Optional[Li
+00016790: 7374 5b41 6e79 5d5d 203d 204e 6f6e 652c  st[Any]] = None,
+000167a0: 0d0a 2020 2020 2920 2d3e 2055 6e69 6f6e  ..    ) -> Union
+000167b0: 5b47 656f 4461 7461 4672 616d 652c 204e  [GeoDataFrame, N
+000167c0: 6f6e 655d 3a0d 0a20 2020 2020 2020 2022  one]:..        "
+000167d0: 2222 666f 6f74 7072 696e 742e 0d0a 0d0a  ""footprint.....
+000167e0: 2020 2020 2020 2020 2020 2020 6578 7472              extr
+000167f0: 6163 745f 6578 7465 6e74 2074 616b 6573  act_extent takes
+00016800: 2061 2067 6461 6c20 7261 7374 6572 206f   a gdal raster o
+00016810: 626a 6563 7420 616e 6420 7265 7475 726e  bject and return
+00016820: 730d 0a0d 0a20 2020 2020 2020 2050 6172  s....        Par
+00016830: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00016840: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00016850: 2020 2020 2062 616e 643a 205b 696e 745d       band: [int]
+00016860: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+00016870: 6e64 2069 6e64 6578 2e20 4465 6661 756c  nd index. Defaul
+00016880: 7420 6973 2030 2e0d 0a20 2020 2020 2020  t is 0...       
+00016890: 2065 7863 6c75 6465 5f76 616c 7565 733a   exclude_values:
+000168a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000168b0: 2079 6f75 2077 616e 7420 746f 2065 7863   you want to exc
+000168c0: 6c75 6465 5f76 616c 7565 7320 6120 6365  lude_values a ce
+000168d0: 7274 6169 6e20 7661 6c75 6520 696e 2074  rtain value in t
+000168e0: 6865 2072 6173 7465 7220 7769 7468 2061  he raster with a
+000168f0: 6e6f 7468 6572 2076 616c 7565 2069 6e74  nother value int
+00016900: 6572 2074 6865 2074 776f 2076 616c 7565  er the two value
+00016910: 7320 6173 2061 206c 6973 7420 6f66 2074  s as a list of t
+00016920: 7570 6c65 7320 610d 0a20 2020 2020 2020  uples a..       
+00016930: 2020 2020 205b 2876 616c 7565 5f74 6f5f       [(value_to_
+00016940: 6265 5f65 7863 6c75 6465 5f76 616c 7565  be_exclude_value
+00016950: 7364 2c20 6e65 775f 7661 6c75 6529 5d0d  sd, new_value)].
+00016960: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00016970: 2065 7863 6c75 6465 5f76 616c 7565 7320   exclude_values 
+00016980: 3d20 5b30 5d0d 0a20 2020 2020 2020 2020  = [0]..         
+00016990: 2020 202d 2054 6869 7320 7061 7261 6d65     - This parame
+000169a0: 7465 7220 6973 2069 6e74 726f 6475 6365  ter is introduce
+000169b0: 6420 7061 7274 6963 756c 6172 6c79 2066  d particularly f
+000169c0: 6f72 2074 6865 2063 6173 6520 6f66 2072  or the case of r
+000169d0: 6173 7465 7273 2074 6861 7420 6861 7320  asters that has 
+000169e0: 7468 6520 6e6f 6461 7461 7661 6c75 6520  the nodatavalue 
+000169f0: 7374 6f72 6564 2069 6e20 7468 650d 0a20  stored in the.. 
+00016a00: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00016a10: 2064 6f65 7320 6e6f 7420 6d61 7463 6820   does not match 
+00016a20: 7468 6520 7661 6c75 6520 7374 6f72 6564  the value stored
+00016a30: 2069 6e20 6172 7261 792c 2073 6f20 7468   in array, so th
+00016a40: 6973 206f 7074 696f 6e20 6361 6e20 636f  is option can co
+00016a50: 7272 6563 7420 7468 6973 2062 6568 6176  rrect this behav
+00016a60: 696f 722e 0d0a 0d0a 2020 2020 2020 2020  ior.....        
+00016a70: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00016a80: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00016a90: 2020 4765 6f44 6174 6146 7261 6d65 3a0d    GeoDataFrame:.
+00016aa0: 0a20 2020 2020 2020 2020 2020 202d 2067  .            - g
+00016ab0: 656f 6461 7461 6672 616d 6520 636f 6e74  eodataframe cont
+00016ac0: 6169 6e69 6e67 2074 6865 2070 6f6c 7967  aining the polyg
+00016ad0: 6f6e 2072 6570 7265 7365 6e74 696e 6720  on representing 
+00016ae0: 7468 6520 6578 7465 6e74 206f 6620 7468  the extent of th
+00016af0: 6520 7261 7374 6572 2e20 7468 6520 6578  e raster. the ex
+00016b00: 7465 6e74 2063 6f6c 756d 6e20 7368 6f75  tent column shou
+00016b10: 6c64 0d0a 2020 2020 2020 2020 2020 2020  ld..            
+00016b20: 636f 6e74 6169 6e73 2061 2076 616c 7565  contains a value
+00016b30: 206f 6620 2032 206f 6e6c 792e 0d0a 2020   of  2 only...  
+00016b40: 2020 2020 2020 2020 2020 2d20 6966 2074            - if t
+00016b50: 6865 2064 6174 6173 6574 2068 6164 2073  he dataset had s
+00016b60: 6570 6172 6174 6520 706f 6c79 676f 6e73  eparate polygons
+00016b70: 2065 6163 6820 706f 6c79 676f 6e20 7769   each polygon wi
+00016b80: 6c6c 2062 6520 696e 2061 2073 6570 6172  ll be in a separ
+00016b90: 6174 6520 726f 772e 0d0a 2020 2020 2020  ate row...      
+00016ba0: 2020 2222 220d 0a20 2020 2020 2020 2061    """..        a
+00016bb0: 7272 203d 2073 656c 662e 7265 6164 5f61  rr = self.read_a
+00016bc0: 7272 6179 2862 616e 643d 6261 6e64 290d  rray(band=band).
+00016bd0: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
+00016be0: 5f76 616c 203d 2073 656c 662e 6e6f 5f64  _val = self.no_d
+00016bf0: 6174 615f 7661 6c75 655b 6261 6e64 5d0d  ata_value[band].
+00016c00: 0a0d 0a20 2020 2020 2020 2069 6620 6e6f  ...        if no
+00016c10: 5f64 6174 615f 7661 6c20 6973 204e 6f6e  _data_val is Non
+00016c20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00016c30: 6966 206e 6f74 2028 6e70 2e69 736e 616e  if not (np.isnan
+00016c40: 2861 7272 2929 2e61 6e79 2829 3a0d 0a20  (arr)).any():.. 
+00016c50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00016c60: 6f67 6765 722e 7761 726e 696e 6728 0d0a  ogger.warning(..
+00016c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c80: 2020 2020 2274 6865 206e 6f64 6174 6120      "the nodata 
+00016c90: 7661 6c75 6573 2073 746f 7265 6420 696e  values stored in
+00016ca0: 2074 6865 2072 6173 7465 7220 646f 6573   the raster does
+00016cb0: 206e 6f74 2065 7869 7374 2069 6e20 7468   not exist in th
+00016cc0: 6520 7261 7374 6572 2022 0d0a 2020 2020  e raster "..    
+00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ce0: 2273 6f20 6569 7468 6572 2074 6865 2072  "so either the r
+00016cf0: 6173 7465 7220 6578 7465 6e74 2069 7320  aster extent is 
+00016d00: 616c 6c20 6675 6c6c 2077 6974 6820 6461  all full with da
+00016d10: 7461 206f 7220 7468 6520 6e6f 6461 7461  ta or the nodata
+00016d20: 7661 6c75 6520 7374 6f72 6564 2069 6e20  value stored in 
+00016d30: 7468 6520 7261 7374 6572 2069 7322 0d0a  the raster is"..
+00016d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d50: 2020 2020 2220 6e6f 7420 636f 7272 6563      " not correc
+00016d60: 7422 0d0a 2020 2020 2020 2020 2020 2020  t"..            
+00016d70: 2020 2020 290d 0a20 2020 2020 2020 2065      )..        e
+00016d80: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00016d90: 2020 6966 206e 6f74 2028 6e70 2e69 7363    if not (np.isc
+00016da0: 6c6f 7365 2861 7272 2c20 6e6f 5f64 6174  lose(arr, no_dat
+00016db0: 615f 7661 6c2c 2072 746f 6c3d 302e 3030  a_val, rtol=0.00
+00016dc0: 3030 3129 292e 616e 7928 293a 0d0a 2020  001)).any():..  
+00016dd0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00016de0: 6767 6572 2e77 6172 6e69 6e67 280d 0a20  gger.warning(.. 
+00016df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e00: 2020 2022 7468 6520 6e6f 6461 7461 2076     "the nodata v
+00016e10: 616c 7565 7320 7374 6f72 6564 2069 6e20  alues stored in 
+00016e20: 7468 6520 7261 7374 6572 2064 6f65 7320  the raster does 
+00016e30: 6e6f 7420 6578 6973 7420 696e 2074 6865  not exist in the
+00016e40: 2072 6173 7465 7220 220d 0a20 2020 2020   raster "..     
+00016e50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00016e60: 736f 2065 6974 6865 7220 7468 6520 7261  so either the ra
+00016e70: 7374 6572 2065 7874 656e 7420 6973 2061  ster extent is a
+00016e80: 6c6c 2066 756c 6c20 7769 7468 2064 6174  ll full with dat
+00016e90: 6120 6f72 2074 6865 206e 6f64 6174 6176  a or the nodatav
+00016ea0: 616c 7565 2073 746f 7265 6420 696e 2074  alue stored in t
+00016eb0: 6865 2072 6173 7465 7220 6973 220d 0a20  he raster is".. 
+00016ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ed0: 2020 2022 206e 6f74 2063 6f72 7265 6374     " not correct
+00016ee0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00016ef0: 2020 2029 0d0a 2020 2020 2020 2020 2320     )..        # 
+00016f00: 6966 2079 6f75 2077 616e 7420 746f 2065  if you want to e
+00016f10: 7863 6c75 6465 5f76 616c 7565 7320 616e  xclude_values an
+00016f20: 7920 7661 6c75 6520 696e 2074 6865 2072  y value in the r
+00016f30: 6173 7465 720d 0a20 2020 2020 2020 2069  aster..        i
+00016f40: 6620 6578 636c 7564 655f 7661 6c75 6573  f exclude_values
+00016f50: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
+00016f60: 6f72 2076 616c 2069 6e20 6578 636c 7564  or val in exclud
+00016f70: 655f 7661 6c75 6573 3a0d 0a20 2020 2020  e_values:..     
+00016f80: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
+00016f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016fa0: 2020 2020 2023 2069 6e20 6361 7365 2074       # in case t
+00016fb0: 6865 2076 616c 3220 6973 204e 6f6e 6520  he val2 is None 
+00016fc0: 616e 6420 7468 6520 6172 7261 7920 6973  and the array is
+00016fd0: 2069 6e74 2074 7970 6520 7468 6520 666f   int type the fo
+00016fe0: 6c6c 6f77 696e 6720 6c69 6e65 2077 696c  llowing line wil
+00016ff0: 6c20 6769 7665 2065 7272 6f72 2061 7320  l give error as 
+00017000: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+00017010: 2020 2020 2020 2020 2020 2320 6973 2063            # is c
+00017020: 6f6e 7369 6465 7265 6420 6173 2066 6c6f  onsidered as flo
+00017030: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
+00017040: 2020 2020 2020 2020 6172 725b 6e70 2e69          arr[np.i
+00017050: 7363 6c6f 7365 2861 7272 2c20 7661 6c29  sclose(arr, val)
+00017060: 5d20 3d20 6e6f 5f64 6174 615f 7661 6c0d  ] = no_data_val.
+00017070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017080: 2065 7863 6570 7420 5479 7065 4572 726f   except TypeErro
+00017090: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+000170a0: 2020 2020 2020 2020 6172 7220 3d20 6172          arr = ar
+000170b0: 722e 6173 7479 7065 286e 702e 666c 6f61  r.astype(np.floa
+000170c0: 7433 3229 0d0a 2020 2020 2020 2020 2020  t32)..          
+000170d0: 2020 2020 2020 2020 2020 6172 725b 6e70            arr[np
+000170e0: 2e69 7363 6c6f 7365 2861 7272 2c20 7661  .isclose(arr, va
+000170f0: 6c29 5d20 3d20 6e6f 5f64 6174 615f 7661  l)] = no_data_va
+00017100: 6c0d 0a0d 0a20 2020 2020 2020 2023 2072  l....        # r
+00017110: 6570 6c61 6365 2061 6c6c 2074 6865 2076  eplace all the v
+00017120: 616c 7565 7320 7769 7468 2032 0d0a 2020  alues with 2..  
+00017130: 2020 2020 2020 6966 206e 6f5f 6461 7461        if no_data
+00017140: 5f76 616c 2069 7320 4e6f 6e65 3a0d 0a20  _val is None:.. 
+00017150: 2020 2020 2020 2020 2020 2023 2063 6865             # che
+00017160: 636b 2069 6620 7468 6520 7768 6f6c 6520  ck if the whole 
+00017170: 7261 7374 6572 2069 7320 6675 6c6c 206f  raster is full o
+00017180: 6620 6e6f 5f64 6174 615f 7661 6c75 650d  f no_data_value.
+00017190: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000171a0: 286e 702e 6973 6e61 6e28 6172 7229 292e  (np.isnan(arr)).
+000171b0: 616c 6c28 293a 0d0a 2020 2020 2020 2020  all():..        
+000171c0: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+000171d0: 6172 6e69 6e67 2822 7468 6520 7261 7374  arning("the rast
+000171e0: 6572 2069 7320 6675 6c6c 206f 6620 6e6f  er is full of no
+000171f0: 5f64 6174 615f 7661 6c75 6522 290d 0a20  _data_value").. 
+00017200: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00017210: 6574 7572 6e20 4e6f 6e65 0d0a 0d0a 2020  eturn None....  
+00017220: 2020 2020 2020 2020 2020 6172 725b 7e6e            arr[~n
+00017230: 702e 6973 6e61 6e28 6172 7229 5d20 3d20  p.isnan(arr)] = 
+00017240: 320d 0a20 2020 2020 2020 2065 6c73 653a  2..        else:
+00017250: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00017260: 6368 6563 6b20 6966 2074 6865 2077 686f  check if the who
+00017270: 6c65 2072 6173 7465 7220 6973 2066 756c  le raster is ful
+00017280: 6c20 6f66 206e 6f64 6174 6176 616c 7565  l of nodatavalue
+00017290: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000172a0: 2028 6e70 2e69 7363 6c6f 7365 2861 7272   (np.isclose(arr
+000172b0: 2c20 6e6f 5f64 6174 615f 7661 6c2c 2072  , no_data_val, r
+000172c0: 746f 6c3d 302e 3030 3030 3129 292e 616c  tol=0.00001)).al
+000172d0: 6c28 293a 0d0a 2020 2020 2020 2020 2020  l():..          
+000172e0: 2020 2020 2020 6c6f 6767 6572 2e77 6172        logger.war
+000172f0: 6e69 6e67 2822 7468 6520 7261 7374 6572  ning("the raster
+00017300: 2069 7320 6675 6c6c 206f 6620 6e6f 5f64   is full of no_d
+00017310: 6174 615f 7661 6c75 6522 290d 0a20 2020  ata_value")..   
+00017320: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00017330: 7572 6e20 4e6f 6e65 0d0a 0d0a 2020 2020  urn None....    
+00017340: 2020 2020 2020 2020 6172 725b 7e6e 702e          arr[~np.
+00017350: 6973 636c 6f73 6528 6172 722c 206e 6f5f  isclose(arr, no_
+00017360: 6461 7461 5f76 616c 2c20 7274 6f6c 3d30  data_val, rtol=0
+00017370: 2e30 3030 3031 295d 203d 2032 0d0a 2020  .00001)] = 2..  
+00017380: 2020 2020 2020 6e65 775f 6461 7461 7365        new_datase
+00017390: 7420 3d20 7365 6c66 2e63 7265 6174 655f  t = self.create_
+000173a0: 6672 6f6d 5f61 7272 6179 280d 0a20 2020  from_array(..   
+000173b0: 2020 2020 2020 2020 2061 7272 2c20 7365           arr, se
+000173c0: 6c66 2e67 656f 7472 616e 7366 6f72 6d2c  lf.geotransform,
+000173d0: 2073 656c 662e 6570 7367 2c20 7365 6c66   self.epsg, self
+000173e0: 2e6e 6f5f 6461 7461 5f76 616c 7565 0d0a  .no_data_value..
+000173f0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+00017400: 2020 2023 2074 6865 6e20 636f 6e76 6572     # then conver
+00017410: 7420 7468 6520 7261 7361 7465 7220 696e  t the rasater in
+00017420: 746f 2070 6f6c 7967 6f6e 0d0a 2020 2020  to polygon..    
+00017430: 2020 2020 6764 6620 3d20 6e65 775f 6461      gdf = new_da
+00017440: 7461 7365 742e 746f 5f70 6f6c 7967 6f6e  taset.to_polygon
+00017450: 2862 616e 643d 6261 6e64 290d 0a0d 0a20  (band=band).... 
+00017460: 2020 2020 2020 2072 6574 7572 6e20 6764         return gd
+00017470: 660d 0a0d 0a20 2020 2040 7374 6174 6963  f....    @static
+00017480: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00017490: 6e6f 726d 616c 697a 6528 6172 7261 793a  normalize(array:
+000174a0: 206e 702e 6e64 6172 7261 7929 3a0d 0a20   np.ndarray):.. 
+000174b0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+000174c0: 2020 2020 4e6f 726d 616c 697a 6573 206e      Normalizes n
+000174d0: 756d 7079 2061 7272 6179 7320 696e 746f  umpy arrays into
+000174e0: 2073 6361 6c65 2030 2e30 202d 2031 2e30   scale 0.0 - 1.0
+000174f0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00017500: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00017510: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00017520: 2020 2020 6172 7261 7920 3a20 5b61 7272      array : [arr
+00017530: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
+00017540: 206e 756d 7079 2061 7272 6179 0d0a 0d0a   numpy array....
+00017550: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+00017560: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00017570: 0d0a 2020 2020 2020 2020 6172 7261 790d  ..        array.
+00017580: 0a20 2020 2020 2020 2020 2020 2044 4553  .            DES
+00017590: 4352 4950 5449 4f4e 2e0d 0a20 2020 2020  CRIPTION...     
+000175a0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+000175b0: 6172 7261 795f 6d69 6e20 3d20 6172 7261  array_min = arra
+000175c0: 792e 6d69 6e28 290d 0a20 2020 2020 2020  y.min()..       
+000175d0: 2061 7272 6179 5f6d 6178 203d 2061 7272   array_max = arr
+000175e0: 6179 2e6d 6178 2829 0d0a 2020 2020 2020  ay.max()..      
+000175f0: 2020 7661 6c20 3d20 2861 7272 6179 202d    val = (array -
+00017600: 2061 7272 6179 5f6d 696e 2920 2f20 2861   array_min) / (a
+00017610: 7272 6179 5f6d 6178 202d 2061 7272 6179  rray_max - array
+00017620: 5f6d 696e 290d 0a20 2020 2020 2020 2072  _min)..        r
+00017630: 6574 7572 6e20 7661 6c0d 0a0d 0a20 2020  eturn val....   
+00017640: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+00017650: 2020 2020 6465 6620 5f77 696e 646f 7728      def _window(
+00017660: 7372 633a 2067 6461 6c2e 4461 7461 7365  src: gdal.Datase
+00017670: 742c 2073 697a 653a 2069 6e74 203d 2032  t, size: int = 2
+00017680: 3536 293a 0d0a 2020 2020 2020 2020 2222  56):..        ""
+00017690: 2244 6174 6173 6574 2073 7175 6172 6520  "Dataset square 
+000176a0: 7769 6e64 6f77 2073 697a 652f 6f66 6673  window size/offs
+000176b0: 6574 732e 0d0a 0d0a 2020 2020 2020 2020  ets.....        
+000176c0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+000176d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+000176e0: 2020 2020 2020 2020 7372 6320 3a20 5b67          src : [g
+000176f0: 6461 6c2e 4461 7461 6375 6265 5d0d 0a20  dal.Datacube].. 
+00017700: 2020 2020 2020 2020 2020 2067 6461 6c20             gdal 
+00017710: 4461 7461 6375 6265 206f 626a 6563 742e  Datacube object.
+00017720: 0d0a 2020 2020 2020 2020 7369 7a65 203a  ..        size :
+00017730: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
+00017740: 2020 2020 5369 7a65 206f 6620 7769 6e64      Size of wind
+00017750: 6f77 2069 6e20 7069 7865 6c73 2e20 4f6e  ow in pixels. On
+00017760: 6520 7661 6c75 6520 7265 7175 6972 6564  e value required
+00017770: 2077 6869 6368 2069 7320 7573 6564 2066   which is used f
+00017780: 6f72 2062 6f74 6820 7468 650d 0a20 2020  or both the..   
+00017790: 2020 2020 2020 2020 2078 2061 6e64 2079           x and y
+000177a0: 2073 697a 652e 2045 2e67 2032 3536 206d   size. E.g 256 m
+000177b0: 6561 6e73 2061 2032 3536 7832 3536 2077  eans a 256x256 w
+000177c0: 696e 646f 772e 0d0a 0d0a 2020 2020 2020  indow.....      
+000177d0: 2020 5969 656c 6473 0d0a 2020 2020 2020    Yields..      
+000177e0: 2020 2d2d 2d2d 2d2d 0d0a 2020 2020 2020    ------..      
+000177f0: 2020 7475 706c 655b 696e 745d 0d0a 2020    tuple[int]..  
+00017800: 2020 2020 2020 2020 2020 3420 656c 656d            4 elem
+00017810: 656e 7420 7475 706c 6520 636f 6e74 6169  ent tuple contai
+00017820: 6e69 6e67 2074 6865 2078 2073 697a 652c  ning the x size,
+00017830: 2079 2073 697a 652c 2078 206f 6666 7365   y size, x offse
+00017840: 7420 616e 6420 7920 6f66 6673 6574 0d0a  t and y offset..
+00017850: 2020 2020 2020 2020 2020 2020 6f66 2074              of t
+00017860: 6865 2077 696e 646f 772e 0d0a 2020 2020  he window...    
+00017870: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00017880: 2063 6f6c 7320 3d20 7372 632e 5261 7374   cols = src.Rast
+00017890: 6572 5853 697a 650d 0a20 2020 2020 2020  erXSize..       
+000178a0: 2072 6f77 7320 3d20 7372 632e 5261 7374   rows = src.Rast
+000178b0: 6572 5953 697a 650d 0a20 2020 2020 2020  erYSize..       
+000178c0: 2066 6f72 2078 6f66 6620 696e 2072 616e   for xoff in ran
+000178d0: 6765 2830 2c20 636f 6c73 2c20 7369 7a65  ge(0, cols, size
+000178e0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000178f0: 7873 697a 6520 3d20 7369 7a65 2069 6620  xsize = size if 
+00017900: 7369 7a65 202b 2078 6f66 6620 3c3d 2063  size + xoff <= c
+00017910: 6f6c 7320 656c 7365 2063 6f6c 7320 2d20  ols else cols - 
+00017920: 786f 6666 0d0a 2020 2020 2020 2020 2020  xoff..          
+00017930: 2020 666f 7220 796f 6666 2069 6e20 7261    for yoff in ra
+00017940: 6e67 6528 302c 2072 6f77 732c 2073 697a  nge(0, rows, siz
+00017950: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
+00017960: 2020 2020 2079 7369 7a65 203d 2073 697a       ysize = siz
+00017970: 6520 6966 2073 697a 6520 2b20 796f 6666  e if size + yoff
+00017980: 203c 3d20 726f 7773 2065 6c73 6520 726f   <= rows else ro
+00017990: 7773 202d 2079 6f66 660d 0a20 2020 2020  ws - yoff..     
+000179a0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+000179b0: 2078 7369 7a65 2c20 7973 697a 652c 2078   xsize, ysize, x
+000179c0: 6f66 662c 2079 6f66 660d 0a0d 0a20 2020  off, yoff....   
+000179d0: 2064 6566 2067 6574 5f74 696c 6528 7365   def get_tile(se
+000179e0: 6c66 2c20 7369 7a65 3d32 3536 293a 0d0a  lf, size=256):..
+000179f0: 2020 2020 2020 2020 2222 2267 6574 7320          """gets 
+00017a00: 6120 7261 7374 6572 2061 7272 6179 2069  a raster array i
+00017a10: 6e20 7469 6c65 732e 0d0a 0d0a 2020 2020  n tiles.....    
+00017a20: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00017a30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00017a40: 2d2d 0d0a 2020 2020 2020 2020 7369 7a65  --..        size
+00017a50: 203a 2069 6e74 0d0a 2020 2020 2020 2020   : int..        
+00017a60: 2020 2020 5369 7a65 206f 6620 7769 6e64      Size of wind
+00017a70: 6f77 2069 6e20 7069 7865 6c73 2e20 4f6e  ow in pixels. On
+00017a80: 6520 7661 6c75 6520 7265 7175 6972 6564  e value required
+00017a90: 2077 6869 6368 2069 7320 7573 6564 2066   which is used f
+00017aa0: 6f72 2062 6f74 6820 7468 650d 0a20 2020  or both the..   
+00017ab0: 2020 2020 2020 2020 2078 2061 6e64 2079           x and y
+00017ac0: 2073 697a 652e 2045 2e67 2032 3536 206d   size. E.g 256 m
+00017ad0: 6561 6e73 2061 2032 3536 7832 3536 2077  eans a 256x256 w
+00017ae0: 696e 646f 772e 0d0a 0d0a 2020 2020 2020  indow.....      
+00017af0: 2020 5969 656c 6473 0d0a 2020 2020 2020    Yields..      
+00017b00: 2020 2d2d 2d2d 2d2d 0d0a 2020 2020 2020    ------..      
+00017b10: 2020 6e70 2e6e 6461 7272 6179 0d0a 2020    np.ndarray..  
+00017b20: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
+00017b30: 7420 6172 7261 7920 696e 2066 6f72 6d20  t array in form 
+00017b40: 5b62 616e 645d 5b79 5d5b 785d 2e0d 0a20  [band][y][x]... 
+00017b50: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00017b60: 2020 2020 666f 7220 7873 697a 652c 2079      for xsize, y
+00017b70: 7369 7a65 2c20 786f 6666 2c20 796f 6666  size, xoff, yoff
+00017b80: 2069 6e20 7365 6c66 2e5f 7769 6e64 6f77   in self._window
+00017b90: 2873 656c 662e 7261 7374 6572 2c20 7369  (self.raster, si
+00017ba0: 7a65 3d73 697a 6529 3a0d 0a20 2020 2020  ze=size):..     
+00017bb0: 2020 2020 2020 2023 2072 6561 6420 7468         # read th
+00017bc0: 6520 6172 7261 7920 6174 2061 2063 6572  e array at a cer
+00017bd0: 7461 696e 2069 6e64 6563 6573 0d0a 2020  tain indeces..  
+00017be0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00017bf0: 7365 6c66 2e72 6173 7465 722e 5265 6164  self.raster.Read
+00017c00: 4173 4172 7261 7928 0d0a 2020 2020 2020  AsArray(..      
+00017c10: 2020 2020 2020 2020 2020 786f 6666 3d78            xoff=x
+00017c20: 6f66 662c 2079 6f66 663d 796f 6666 2c20  off, yoff=yoff, 
+00017c30: 7873 697a 653d 7873 697a 652c 2079 7369  xsize=xsize, ysi
+00017c40: 7a65 3d79 7369 7a65 0d0a 2020 2020 2020  ze=ysize..      
+00017c50: 2020 2020 2020 290d 0a0d 0a20 2020 2040        )....    @
+00017c60: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
+00017c70: 2020 6465 6620 5f67 726f 7570 4e65 6967    def _groupNeig
+00017c80: 6862 6f75 7273 280d 0a20 2020 2020 2020  hbours(..       
+00017c90: 2061 7272 6179 2c20 692c 206a 2c20 6c6f   array, i, j, lo
+00017ca0: 7765 7276 616c 7565 2c20 7570 7065 7276  wervalue, upperv
+00017cb0: 616c 7565 2c20 706f 7369 7469 6f6e 2c20  alue, position, 
+00017cc0: 7661 6c75 6573 2c20 636f 756e 742c 2063  values, count, c
+00017cd0: 6c75 7374 6572 0d0a 2020 2020 293a 0d0a  luster..    ):..
+00017ce0: 2020 2020 2020 2020 2222 2267 726f 7570          """group
+00017cf0: 206e 6569 6269 7572 696e 6720 6365 6c6c   neibiuring cell
+00017d00: 7320 7769 7468 2074 6865 2073 616d 6520  s with the same 
+00017d10: 7661 6c75 6573 2222 220d 0a0d 0a20 2020  values"""....   
+00017d20: 2020 2020 2023 2062 6f74 746f 6d20 6365       # bottom ce
+00017d30: 6c6c 0d0a 2020 2020 2020 2020 6966 2028  ll..        if (
+00017d40: 0d0a 2020 2020 2020 2020 2020 2020 6c6f  ..            lo
+00017d50: 7765 7276 616c 7565 203c 3d20 6172 7261  wervalue <= arra
+00017d60: 795b 6920 2b20 312c 206a 5d20 3c3d 2075  y[i + 1, j] <= u
+00017d70: 7070 6572 7661 6c75 650d 0a20 2020 2020  ppervalue..     
+00017d80: 2020 2020 2020 2061 6e64 2063 6c75 7374         and clust
+00017d90: 6572 5b69 202b 2031 2c20 6a5d 203d 3d20  er[i + 1, j] == 
+00017da0: 300d 0a20 2020 2020 2020 2020 2020 2061  0..            a
+00017db0: 6e64 2069 202b 2031 203c 2061 7272 6179  nd i + 1 < array
+00017dc0: 2e73 6861 7065 5b30 5d0d 0a20 2020 2020  .shape[0]..     
+00017dd0: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
+00017de0: 2020 2070 6f73 6974 696f 6e2e 6170 7065     position.appe
+00017df0: 6e64 285b 6920 2b20 312c 206a 5d29 0d0a  nd([i + 1, j])..
+00017e00: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00017e10: 6573 2e61 7070 656e 6428 6172 7261 795b  es.append(array[
+00017e20: 6920 2b20 312c 206a 5d29 0d0a 2020 2020  i + 1, j])..    
+00017e30: 2020 2020 2020 2020 636c 7573 7465 725b          cluster[
+00017e40: 6920 2b20 312c 206a 5d20 3d20 636f 756e  i + 1, j] = coun
+00017e50: 740d 0a20 2020 2020 2020 2020 2020 2044  t..            D
+00017e60: 6174 6173 6574 2e5f 6772 6f75 704e 6569  ataset._groupNei
+00017e70: 6768 626f 7572 7328 0d0a 2020 2020 2020  ghbours(..      
+00017e80: 2020 2020 2020 2020 2020 6172 7261 792c            array,
+00017e90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017ea0: 2020 6920 2b20 312c 0d0a 2020 2020 2020    i + 1,..      
+00017eb0: 2020 2020 2020 2020 2020 6a2c 0d0a 2020            j,..  
+00017ec0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00017ed0: 7765 7276 616c 7565 2c0d 0a20 2020 2020  wervalue,..     
+00017ee0: 2020 2020 2020 2020 2020 2075 7070 6572             upper
+00017ef0: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
+00017f00: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00017f10: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00017f20: 2020 2076 616c 7565 732c 0d0a 2020 2020     values,..    
+00017f30: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+00017f40: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+00017f50: 2020 2020 636c 7573 7465 722c 0d0a 2020      cluster,..  
+00017f60: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00017f70: 2020 2020 2023 2062 6f74 746f 6d20 7269       # bottom ri
+00017f80: 6768 740d 0a20 2020 2020 2020 2069 6620  ght..        if 
+00017f90: 280d 0a20 2020 2020 2020 2020 2020 206a  (..            j
+00017fa0: 202b 2031 203c 2061 7272 6179 2e73 6861   + 1 < array.sha
+00017fb0: 7065 5b31 5d0d 0a20 2020 2020 2020 2020  pe[1]..         
+00017fc0: 2020 2061 6e64 2069 202b 2031 203c 2061     and i + 1 < a
+00017fd0: 7272 6179 2e73 6861 7065 5b30 5d0d 0a20  rray.shape[0].. 
+00017fe0: 2020 2020 2020 2020 2020 2061 6e64 206c             and l
+00017ff0: 6f77 6572 7661 6c75 6520 3c3d 2061 7272  owervalue <= arr
+00018000: 6179 5b69 202b 2031 2c20 6a20 2b20 315d  ay[i + 1, j + 1]
+00018010: 203c 3d20 7570 7065 7276 616c 7565 0d0a   <= uppervalue..
+00018020: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00018030: 636c 7573 7465 725b 6920 2b20 312c 206a  cluster[i + 1, j
+00018040: 202b 2031 5d20 3d3d 2030 0d0a 2020 2020   + 1] == 0..    
+00018050: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+00018060: 2020 2020 706f 7369 7469 6f6e 2e61 7070      position.app
+00018070: 656e 6428 5b69 202b 2031 2c20 6a20 2b20  end([i + 1, j + 
+00018080: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+00018090: 2076 616c 7565 732e 6170 7065 6e64 2861   values.append(a
+000180a0: 7272 6179 5b69 202b 2031 2c20 6a20 2b20  rray[i + 1, j + 
+000180b0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+000180c0: 2063 6c75 7374 6572 5b69 202b 2031 2c20   cluster[i + 1, 
+000180d0: 6a20 2b20 315d 203d 2063 6f75 6e74 0d0a  j + 1] = count..
+000180e0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+000180f0: 7365 742e 5f67 726f 7570 4e65 6967 6862  set._groupNeighb
+00018100: 6f75 7273 280d 0a20 2020 2020 2020 2020  ours(..         
+00018110: 2020 2020 2020 2061 7272 6179 2c0d 0a20         array,.. 
+00018120: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018130: 202b 2031 2c0d 0a20 2020 2020 2020 2020   + 1,..         
+00018140: 2020 2020 2020 206a 202b 2031 2c0d 0a20         j + 1,.. 
+00018150: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00018160: 6f77 6572 7661 6c75 652c 0d0a 2020 2020  owervalue,..    
+00018170: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
+00018180: 7276 616c 7565 2c0d 0a20 2020 2020 2020  rvalue,..       
+00018190: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
+000181a0: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
+000181b0: 2020 2020 7661 6c75 6573 2c0d 0a20 2020      values,..   
+000181c0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
+000181d0: 6e74 2c0d 0a20 2020 2020 2020 2020 2020  nt,..           
+000181e0: 2020 2020 2063 6c75 7374 6572 2c0d 0a20       cluster,.. 
+000181f0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00018200: 2020 2020 2020 2320 7269 6768 740d 0a20        # right.. 
+00018210: 2020 2020 2020 2069 6620 280d 0a20 2020         if (..   
+00018220: 2020 2020 2020 2020 206a 202b 2031 203c           j + 1 <
+00018230: 2061 7272 6179 2e73 6861 7065 5b31 5d0d   array.shape[1].
+00018240: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00018250: 206c 6f77 6572 7661 6c75 6520 3c3d 2061   lowervalue <= a
+00018260: 7272 6179 5b69 2c20 6a20 2b20 315d 203c  rray[i, j + 1] <
+00018270: 3d20 7570 7065 7276 616c 7565 0d0a 2020  = uppervalue..  
+00018280: 2020 2020 2020 2020 2020 616e 6420 636c            and cl
+00018290: 7573 7465 725b 692c 206a 202b 2031 5d20  uster[i, j + 1] 
+000182a0: 3d3d 2030 0d0a 2020 2020 2020 2020 293a  == 0..        ):
+000182b0: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+000182c0: 7369 7469 6f6e 2e61 7070 656e 6428 5b69  sition.append([i
+000182d0: 2c20 6a20 2b20 315d 290d 0a20 2020 2020  , j + 1])..     
+000182e0: 2020 2020 2020 2076 616c 7565 732e 6170         values.ap
+000182f0: 7065 6e64 2861 7272 6179 5b69 2c20 6a20  pend(array[i, j 
+00018300: 2b20 315d 290d 0a20 2020 2020 2020 2020  + 1])..         
+00018310: 2020 2063 6c75 7374 6572 5b69 2c20 6a20     cluster[i, j 
+00018320: 2b20 315d 203d 2063 6f75 6e74 0d0a 2020  + 1] = count..  
+00018330: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
+00018340: 742e 5f67 726f 7570 4e65 6967 6862 6f75  t._groupNeighbou
+00018350: 7273 280d 0a20 2020 2020 2020 2020 2020  rs(..           
+00018360: 2020 2020 2061 7272 6179 2c0d 0a20 2020       array,..   
+00018370: 2020 2020 2020 2020 2020 2020 2069 2c0d               i,.
+00018380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018390: 206a 202b 2031 2c0d 0a20 2020 2020 2020   j + 1,..       
+000183a0: 2020 2020 2020 2020 206c 6f77 6572 7661           lowerva
+000183b0: 6c75 652c 0d0a 2020 2020 2020 2020 2020  lue,..          
+000183c0: 2020 2020 2020 7570 7065 7276 616c 7565        uppervalue
+000183d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000183e0: 2020 2070 6f73 6974 696f 6e2c 0d0a 2020     position,..  
+000183f0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00018400: 6c75 6573 2c0d 0a20 2020 2020 2020 2020  lues,..         
+00018410: 2020 2020 2020 2063 6f75 6e74 2c0d 0a20         count,.. 
+00018420: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00018430: 6c75 7374 6572 2c0d 0a20 2020 2020 2020  luster,..       
+00018440: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00018450: 2320 7570 7065 7220 7269 6768 740d 0a20  # upper right.. 
+00018460: 2020 2020 2020 2069 6620 280d 0a20 2020         if (..   
+00018470: 2020 2020 2020 2020 206a 202b 2031 203c           j + 1 <
+00018480: 2061 7272 6179 2e73 6861 7065 5b31 5d0d   array.shape[1].
+00018490: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+000184a0: 2069 202d 2031 203e 3d20 300d 0a20 2020   i - 1 >= 0..   
+000184b0: 2020 2020 2020 2020 2061 6e64 206c 6f77           and low
+000184c0: 6572 7661 6c75 6520 3c3d 2061 7272 6179  ervalue <= array
+000184d0: 5b69 202d 2031 2c20 6a20 2b20 315d 203c  [i - 1, j + 1] <
+000184e0: 3d20 7570 7065 7276 616c 7565 0d0a 2020  = uppervalue..  
+000184f0: 2020 2020 2020 2020 2020 616e 6420 636c            and cl
+00018500: 7573 7465 725b 6920 2d20 312c 206a 202b  uster[i - 1, j +
+00018510: 2031 5d20 3d3d 2030 0d0a 2020 2020 2020   1] == 0..      
+00018520: 2020 293a 0d0a 2020 2020 2020 2020 2020    ):..          
+00018530: 2020 706f 7369 7469 6f6e 2e61 7070 656e    position.appen
+00018540: 6428 5b69 202d 2031 2c20 6a20 2b20 315d  d([i - 1, j + 1]
+00018550: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+00018560: 616c 7565 732e 6170 7065 6e64 2861 7272  alues.append(arr
+00018570: 6179 5b69 202d 2031 2c20 6a20 2b20 315d  ay[i - 1, j + 1]
+00018580: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00018590: 6c75 7374 6572 5b69 202d 2031 2c20 6a20  luster[i - 1, j 
+000185a0: 2b20 315d 203d 2063 6f75 6e74 0d0a 2020  + 1] = count..  
+000185b0: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
+000185c0: 742e 5f67 726f 7570 4e65 6967 6862 6f75  t._groupNeighbou
+000185d0: 7273 280d 0a20 2020 2020 2020 2020 2020  rs(..           
+000185e0: 2020 2020 2061 7272 6179 2c0d 0a20 2020       array,..   
+000185f0: 2020 2020 2020 2020 2020 2020 2069 202d               i -
+00018600: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
+00018610: 2020 2020 206a 202b 2031 2c0d 0a20 2020       j + 1,..   
+00018620: 2020 2020 2020 2020 2020 2020 206c 6f77               low
+00018630: 6572 7661 6c75 652c 0d0a 2020 2020 2020  ervalue,..      
+00018640: 2020 2020 2020 2020 2020 7570 7065 7276            upperv
+00018650: 616c 7565 2c0d 0a20 2020 2020 2020 2020  alue,..         
+00018660: 2020 2020 2020 2070 6f73 6974 696f 6e2c         position,
+00018670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018680: 2020 7661 6c75 6573 2c0d 0a20 2020 2020    values,..     
+00018690: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
+000186a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000186b0: 2020 2063 6c75 7374 6572 2c0d 0a20 2020     cluster,..   
+000186c0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+000186d0: 2020 2020 2320 746f 700d 0a20 2020 2020      # top..     
+000186e0: 2020 2069 6620 280d 0a20 2020 2020 2020     if (..       
+000186f0: 2020 2020 2069 202d 2031 203e 3d20 300d       i - 1 >= 0.
+00018700: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00018710: 206c 6f77 6572 7661 6c75 6520 3c3d 2061   lowervalue <= a
+00018720: 7272 6179 5b69 202d 2031 2c20 6a5d 203c  rray[i - 1, j] <
+00018730: 3d20 7570 7065 7276 616c 7565 0d0a 2020  = uppervalue..  
+00018740: 2020 2020 2020 2020 2020 616e 6420 636c            and cl
+00018750: 7573 7465 725b 6920 2d20 312c 206a 5d20  uster[i - 1, j] 
+00018760: 3d3d 2030 0d0a 2020 2020 2020 2020 293a  == 0..        ):
+00018770: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+00018780: 7369 7469 6f6e 2e61 7070 656e 6428 5b69  sition.append([i
+00018790: 202d 2031 2c20 6a5d 290d 0a20 2020 2020   - 1, j])..     
+000187a0: 2020 2020 2020 2076 616c 7565 732e 6170         values.ap
+000187b0: 7065 6e64 2861 7272 6179 5b69 202d 2031  pend(array[i - 1
+000187c0: 2c20 6a5d 290d 0a20 2020 2020 2020 2020  , j])..         
+000187d0: 2020 2063 6c75 7374 6572 5b69 202d 2031     cluster[i - 1
+000187e0: 2c20 6a5d 203d 2063 6f75 6e74 0d0a 2020  , j] = count..  
+000187f0: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
+00018800: 742e 5f67 726f 7570 4e65 6967 6862 6f75  t._groupNeighbou
+00018810: 7273 280d 0a20 2020 2020 2020 2020 2020  rs(..           
+00018820: 2020 2020 2061 7272 6179 2c0d 0a20 2020       array,..   
+00018830: 2020 2020 2020 2020 2020 2020 2069 202d               i -
+00018840: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
+00018850: 2020 2020 206a 2c0d 0a20 2020 2020 2020       j,..       
+00018860: 2020 2020 2020 2020 206c 6f77 6572 7661           lowerva
+00018870: 6c75 652c 0d0a 2020 2020 2020 2020 2020  lue,..          
+00018880: 2020 2020 2020 7570 7065 7276 616c 7565        uppervalue
+00018890: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000188a0: 2020 2070 6f73 6974 696f 6e2c 0d0a 2020     position,..  
+000188b0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+000188c0: 6c75 6573 2c0d 0a20 2020 2020 2020 2020  lues,..         
+000188d0: 2020 2020 2020 2063 6f75 6e74 2c0d 0a20         count,.. 
+000188e0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000188f0: 6c75 7374 6572 2c0d 0a20 2020 2020 2020  luster,..       
+00018900: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00018910: 2320 746f 7020 6c65 6674 0d0a 2020 2020  # top left..    
+00018920: 2020 2020 6966 2028 0d0a 2020 2020 2020      if (..      
+00018930: 2020 2020 2020 6920 2d20 3120 3e3d 2030        i - 1 >= 0
+00018940: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
+00018950: 6420 6a20 2d20 3120 3e3d 2030 0d0a 2020  d j - 1 >= 0..  
+00018960: 2020 2020 2020 2020 2020 616e 6420 6c6f            and lo
+00018970: 7765 7276 616c 7565 203c 3d20 6172 7261  wervalue <= arra
+00018980: 795b 6920 2d20 312c 206a 202d 2031 5d20  y[i - 1, j - 1] 
+00018990: 3c3d 2075 7070 6572 7661 6c75 650d 0a20  <= uppervalue.. 
+000189a0: 2020 2020 2020 2020 2020 2061 6e64 2063             and c
+000189b0: 6c75 7374 6572 5b69 202d 2031 2c20 6a20  luster[i - 1, j 
+000189c0: 2d20 315d 203d 3d20 300d 0a20 2020 2020  - 1] == 0..     
+000189d0: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
+000189e0: 2020 2070 6f73 6974 696f 6e2e 6170 7065     position.appe
+000189f0: 6e64 285b 6920 2d20 312c 206a 202d 2031  nd([i - 1, j - 1
+00018a00: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00018a10: 7661 6c75 6573 2e61 7070 656e 6428 6172  values.append(ar
+00018a20: 7261 795b 6920 2d20 312c 206a 202d 2031  ray[i - 1, j - 1
+00018a30: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00018a40: 636c 7573 7465 725b 6920 2d20 312c 206a  cluster[i - 1, j
+00018a50: 202d 2031 5d20 3d20 636f 756e 740d 0a20   - 1] = count.. 
+00018a60: 2020 2020 2020 2020 2020 2044 6174 6173             Datas
+00018a70: 6574 2e5f 6772 6f75 704e 6569 6768 626f  et._groupNeighbo
+00018a80: 7572 7328 0d0a 2020 2020 2020 2020 2020  urs(..          
+00018a90: 2020 2020 2020 6172 7261 792c 0d0a 2020        array,..  
+00018aa0: 2020 2020 2020 2020 2020 2020 2020 6920                i 
+00018ab0: 2d20 312c 0d0a 2020 2020 2020 2020 2020  - 1,..          
+00018ac0: 2020 2020 2020 6a20 2d20 312c 0d0a 2020        j - 1,..  
+00018ad0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00018ae0: 7765 7276 616c 7565 2c0d 0a20 2020 2020  wervalue,..     
+00018af0: 2020 2020 2020 2020 2020 2075 7070 6572             upper
+00018b00: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
+00018b10: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00018b20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00018b30: 2020 2076 616c 7565 732c 0d0a 2020 2020     values,..    
+00018b40: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+00018b50: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+00018b60: 2020 2020 636c 7573 7465 722c 0d0a 2020      cluster,..  
+00018b70: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00018b80: 2020 2020 2023 206c 6566 740d 0a20 2020       # left..   
+00018b90: 2020 2020 2069 6620 280d 0a20 2020 2020       if (..     
+00018ba0: 2020 2020 2020 206a 202d 2031 203e 3d20         j - 1 >= 
+00018bb0: 300d 0a20 2020 2020 2020 2020 2020 2061  0..            a
+00018bc0: 6e64 206c 6f77 6572 7661 6c75 6520 3c3d  nd lowervalue <=
+00018bd0: 2061 7272 6179 5b69 2c20 6a20 2d20 315d   array[i, j - 1]
+00018be0: 203c 3d20 7570 7065 7276 616c 7565 0d0a   <= uppervalue..
+00018bf0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00018c00: 636c 7573 7465 725b 692c 206a 202d 2031  cluster[i, j - 1
+00018c10: 5d20 3d3d 2030 0d0a 2020 2020 2020 2020  ] == 0..        
+00018c20: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00018c30: 706f 7369 7469 6f6e 2e61 7070 656e 6428  position.append(
+00018c40: 5b69 2c20 6a20 2d20 315d 290d 0a20 2020  [i, j - 1])..   
+00018c50: 2020 2020 2020 2020 2076 616c 7565 732e           values.
+00018c60: 6170 7065 6e64 2861 7272 6179 5b69 2c20  append(array[i, 
+00018c70: 6a20 2d20 315d 290d 0a20 2020 2020 2020  j - 1])..       
+00018c80: 2020 2020 2063 6c75 7374 6572 5b69 2c20       cluster[i, 
+00018c90: 6a20 2d20 315d 203d 2063 6f75 6e74 0d0a  j - 1] = count..
+00018ca0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+00018cb0: 7365 742e 5f67 726f 7570 4e65 6967 6862  set._groupNeighb
+00018cc0: 6f75 7273 280d 0a20 2020 2020 2020 2020  ours(..         
+00018cd0: 2020 2020 2020 2061 7272 6179 2c0d 0a20         array,.. 
+00018ce0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018cf0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00018d00: 2020 206a 202d 2031 2c0d 0a20 2020 2020     j - 1,..     
+00018d10: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
+00018d20: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
+00018d30: 2020 2020 2020 2020 7570 7065 7276 616c          upperval
+00018d40: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
+00018d50: 2020 2020 2070 6f73 6974 696f 6e2c 0d0a       position,..
+00018d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d70: 7661 6c75 6573 2c0d 0a20 2020 2020 2020  values,..       
+00018d80: 2020 2020 2020 2020 2063 6f75 6e74 2c0d           count,.
+00018d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018da0: 2063 6c75 7374 6572 2c0d 0a20 2020 2020   cluster,..     
+00018db0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00018dc0: 2020 2320 626f 7474 6f6d 206c 6566 740d    # bottom left.
+00018dd0: 0a20 2020 2020 2020 2069 6620 280d 0a20  .        if (.. 
+00018de0: 2020 2020 2020 2020 2020 206a 202d 2031             j - 1
+00018df0: 203e 3d20 300d 0a20 2020 2020 2020 2020   >= 0..         
+00018e00: 2020 2061 6e64 2069 202b 2031 203c 2061     and i + 1 < a
+00018e10: 7272 6179 2e73 6861 7065 5b30 5d0d 0a20  rray.shape[0].. 
+00018e20: 2020 2020 2020 2020 2020 2061 6e64 206c             and l
+00018e30: 6f77 6572 7661 6c75 6520 3c3d 2061 7272  owervalue <= arr
+00018e40: 6179 5b69 202b 2031 2c20 6a20 2d20 315d  ay[i + 1, j - 1]
+00018e50: 203c 3d20 7570 7065 7276 616c 7565 0d0a   <= uppervalue..
+00018e60: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00018e70: 636c 7573 7465 725b 6920 2b20 312c 206a  cluster[i + 1, j
+00018e80: 202d 2031 5d20 3d3d 2030 0d0a 2020 2020   - 1] == 0..    
+00018e90: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+00018ea0: 2020 2020 706f 7369 7469 6f6e 2e61 7070      position.app
+00018eb0: 656e 6428 5b69 202b 2031 2c20 6a20 2d20  end([i + 1, j - 
+00018ec0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+00018ed0: 2076 616c 7565 732e 6170 7065 6e64 2861   values.append(a
+00018ee0: 7272 6179 5b69 202b 2031 2c20 6a20 2d20  rray[i + 1, j - 
+00018ef0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+00018f00: 2063 6c75 7374 6572 5b69 202b 2031 2c20   cluster[i + 1, 
+00018f10: 6a20 2d20 315d 203d 2063 6f75 6e74 0d0a  j - 1] = count..
+00018f20: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+00018f30: 7365 742e 5f67 726f 7570 4e65 6967 6862  set._groupNeighb
+00018f40: 6f75 7273 280d 0a20 2020 2020 2020 2020  ours(..         
+00018f50: 2020 2020 2020 2061 7272 6179 2c0d 0a20         array,.. 
+00018f60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018f70: 202b 2031 2c0d 0a20 2020 2020 2020 2020   + 1,..         
+00018f80: 2020 2020 2020 206a 202d 2031 2c0d 0a20         j - 1,.. 
+00018f90: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00018fa0: 6f77 6572 7661 6c75 652c 0d0a 2020 2020  owervalue,..    
+00018fb0: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
+00018fc0: 7276 616c 7565 2c0d 0a20 2020 2020 2020  rvalue,..       
+00018fd0: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
+00018fe0: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
+00018ff0: 2020 2020 7661 6c75 6573 2c0d 0a20 2020      values,..   
+00019000: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
+00019010: 6e74 2c0d 0a20 2020 2020 2020 2020 2020  nt,..           
+00019020: 2020 2020 2063 6c75 7374 6572 2c0d 0a20       cluster,.. 
+00019030: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
+00019040: 2020 2020 6465 6620 636c 7573 7465 7228      def cluster(
+00019050: 0d0a 2020 2020 2020 2020 7365 6c66 2c20  ..        self, 
+00019060: 6c6f 7765 725f 626f 756e 643a 2041 6e79  lower_bound: Any
+00019070: 2c20 7570 7065 725f 626f 756e 643a 2041  , upper_bound: A
+00019080: 6e79 0d0a 2020 2020 2920 2d3e 2054 7570  ny..    ) -> Tup
+00019090: 6c65 5b6e 702e 6e64 6172 7261 792c 2069  le[np.ndarray, i
+000190a0: 6e74 2c20 6c69 7374 2c20 6c69 7374 5d3a  nt, list, list]:
+000190b0: 0d0a 2020 2020 2020 2020 2222 2243 6c75  ..        """Clu
+000190c0: 7374 6572 0d0a 0d0a 2020 2020 2020 2020  ster....        
+000190d0: 2020 2020 2d20 6772 6f75 7020 616c 6c20      - group all 
+000190e0: 7468 6520 636f 6e6e 6563 7465 6420 7661  the connected va
+000190f0: 6c75 6573 2062 6574 7765 656e 2074 776f  lues between two
+00019100: 206e 756d 6265 7273 2069 6e20 6120 7261   numbers in a ra
+00019110: 7374 6572 2069 6e20 636c 7573 7465 7273  ster in clusters
+00019120: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+00019130: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00019140: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00019150: 2020 2020 206c 6f77 6572 5f62 6f75 6e64       lower_bound
+00019160: 203a 205b 6e75 6d65 7269 635d 0d0a 2020   : [numeric]..  
+00019170: 2020 2020 2020 2020 2020 6c6f 7765 7220            lower 
+00019180: 626f 756e 6420 6f66 2074 6865 2063 6c75  bound of the clu
+00019190: 7374 6572 2e0d 0a20 2020 2020 2020 2075  ster...        u
+000191a0: 7070 6572 5f62 6f75 6e64 203a 205b 6e75  pper_bound : [nu
+000191b0: 6d65 7269 635d 0d0a 2020 2020 2020 2020  meric]..        
+000191c0: 2020 2020 7570 7065 7220 626f 756e 6420      upper bound 
+000191d0: 6f66 2074 6865 2063 6c75 7374 6572 2e0d  of the cluster..
+000191e0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+000191f0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+00019200: 2d2d 2d0d 0a20 2020 2020 2020 2063 6c75  ---..        clu
+00019210: 7374 6572 203a 205b 6172 7261 795d 0d0a  ster : [array]..
+00019220: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+00019230: 7920 636f 6e74 6169 6e73 2069 6e74 6567  y contains integ
+00019240: 6572 206e 756d 6265 7273 2072 6570 7265  er numbers repre
+00019250: 7365 6e74 696e 6720 7468 6520 6e75 6d62  senting the numb
+00019260: 6572 206f 6620 7468 6520 636c 7573 7465  er of the cluste
+00019270: 722e 0d0a 2020 2020 2020 2020 636f 756e  r...        coun
+00019280: 7420 3a20 5b69 6e74 6567 6572 5d0d 0a20  t : [integer].. 
+00019290: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+000192a0: 7220 6f66 2074 6865 2063 6c75 7374 6572  r of the cluster
+000192b0: 7320 696e 2074 6865 2061 7272 6179 2e0d  s in the array..
+000192c0: 0a20 2020 2020 2020 2070 6f73 6974 696f  .        positio
+000192d0: 6e20 3a20 5b6c 6973 745d 0d0a 2020 2020  n : [list]..    
+000192e0: 2020 2020 2020 2020 6c69 7374 2063 6f6e          list con
+000192f0: 7461 696e 7320 7477 6f20 696e 6465 6365  tains two indece
+00019300: 7320 5b78 2c79 5d20 666f 7220 7468 6520  s [x,y] for the 
+00019310: 706f 7369 7469 6f6e 206f 6620 6561 6368  position of each
+00019320: 2076 616c 7565 202e 0d0a 2020 2020 2020   value ...      
+00019330: 2020 7661 6c75 6573 203a 205b 6e75 6d65    values : [nume
+00019340: 7269 635d 0d0a 2020 2020 2020 2020 2020  ric]..          
+00019350: 2020 7468 6520 7661 6c75 6573 2073 746f    the values sto
+00019360: 7265 6420 696e 2065 6163 6820 6365 6c6c  red in each cell
+00019370: 2069 6e20 7468 6520 636c 7573 7465 7220   in the cluster 
+00019380: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00019390: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
+000193a0: 656c 662e 7265 6164 5f61 7272 6179 2829  elf.read_array()
+000193b0: 0d0a 2020 2020 2020 2020 706f 7369 7469  ..        positi
+000193c0: 6f6e 203d 205b 5d0d 0a20 2020 2020 2020  on = []..       
+000193d0: 2076 616c 7565 7320 3d20 5b5d 0d0a 2020   values = []..  
+000193e0: 2020 2020 2020 636f 756e 7420 3d20 310d        count = 1.
+000193f0: 0a20 2020 2020 2020 2063 6c75 7374 6572  .        cluster
+00019400: 203d 206e 702e 7a65 726f 7328 7368 6170   = np.zeros(shap
+00019410: 653d 2864 6174 612e 7368 6170 655b 305d  e=(data.shape[0]
+00019420: 2c20 6461 7461 2e73 6861 7065 5b31 5d29  , data.shape[1])
+00019430: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
+00019440: 2069 2069 6e20 7261 6e67 6528 6461 7461   i in range(data
+00019450: 2e73 6861 7065 5b30 5d29 3a0d 0a20 2020  .shape[0]):..   
+00019460: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+00019470: 6e20 7261 6e67 6528 6461 7461 2e73 6861  n range(data.sha
+00019480: 7065 5b31 5d29 3a0d 0a0d 0a20 2020 2020  pe[1]):....     
+00019490: 2020 2020 2020 2020 2020 2069 6620 6c6f             if lo
+000194a0: 7765 725f 626f 756e 6420 3c3d 2064 6174  wer_bound <= dat
+000194b0: 615b 692c 206a 5d20 3c3d 2075 7070 6572  a[i, j] <= upper
+000194c0: 5f62 6f75 6e64 2061 6e64 2063 6c75 7374  _bound and clust
+000194d0: 6572 5b69 2c20 6a5d 203d 3d20 303a 0d0a  er[i, j] == 0:..
+000194e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000194f0: 2020 2020 7365 6c66 2e5f 6772 6f75 704e      self._groupN
+00019500: 6569 6768 626f 7572 7328 0d0a 2020 2020  eighbours(..    
+00019510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019520: 2020 2020 6461 7461 2c0d 0a20 2020 2020      data,..     
+00019530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019540: 2020 2069 2c0d 0a20 2020 2020 2020 2020     i,..         
+00019550: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+00019560: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00019570: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
+00019580: 5f62 6f75 6e64 2c0d 0a20 2020 2020 2020  _bound,..       
+00019590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000195a0: 2075 7070 6572 5f62 6f75 6e64 2c0d 0a20   upper_bound,.. 
+000195b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000195c0: 2020 2020 2020 2070 6f73 6974 696f 6e2c         position,
+000195d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000195e0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+000195f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00019600: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
+00019610: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00019620: 2020 2020 2020 2020 2020 2063 6c75 7374             clust
+00019630: 6572 2c0d 0a20 2020 2020 2020 2020 2020  er,..           
+00019640: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00019650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019660: 6966 2063 6c75 7374 6572 5b69 2c20 6a5d  if cluster[i, j]
+00019670: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+00019680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019690: 706f 7369 7469 6f6e 2e61 7070 656e 6428  position.append(
+000196a0: 5b69 2c20 6a5d 290d 0a20 2020 2020 2020  [i, j])..       
+000196b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000196c0: 2076 616c 7565 732e 6170 7065 6e64 2864   values.append(d
+000196d0: 6174 615b 692c 206a 5d29 0d0a 2020 2020  ata[i, j])..    
+000196e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000196f0: 2020 2020 636c 7573 7465 725b 692c 206a      cluster[i, j
+00019700: 5d20 3d20 636f 756e 740d 0a20 2020 2020  ] = count..     
+00019710: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00019720: 6f75 6e74 203d 2063 6f75 6e74 202b 2031  ount = count + 1
+00019730: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
+00019740: 726e 2063 6c75 7374 6572 2c20 636f 756e  rn cluster, coun
+00019750: 742c 2070 6f73 6974 696f 6e2c 2076 616c  t, position, val
+00019760: 7565 730d 0a0d 0a20 2020 2064 6566 206c  ues....    def l
+00019770: 6973 7441 7474 7269 6275 7465 7328 7365  istAttributes(se
+00019780: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
+00019790: 2250 7269 6e74 2041 7474 7269 6275 7465  "Print Attribute
+000197a0: 7320 4c69 7374 2e22 2222 0d0a 0d0a 2020  s List."""....  
+000197b0: 2020 2020 2020 7072 696e 7428 225c 6e22        print("\n"
+000197c0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+000197d0: 280d 0a20 2020 2020 2020 2020 2020 2066  (..            f
+000197e0: 2241 7474 7269 6275 7465 7320 4c69 7374  "Attributes List
+000197f0: 206f 663a 207b 2072 6570 7228 7365 6c66   of: { repr(self
+00019800: 2e5f 5f64 6963 745f 5f5b 276e 616d 6527  .__dict__['name'
+00019810: 5d29 7d20 2d20 7b73 656c 662e 5f5f 636c  ])} - {self.__cl
+00019820: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20  ass__.__name__} 
+00019830: 2049 6e73 7461 6e63 655c 6e22 0d0a 2020   Instance\n"..  
+00019840: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00019850: 2073 656c 665f 6b65 7973 203d 206c 6973   self_keys = lis
+00019860: 7428 7365 6c66 2e5f 5f64 6963 745f 5f2e  t(self.__dict__.
+00019870: 6b65 7973 2829 290d 0a20 2020 2020 2020  keys())..       
+00019880: 2073 656c 665f 6b65 7973 2e73 6f72 7428   self_keys.sort(
+00019890: 290d 0a20 2020 2020 2020 2066 6f72 206b  )..        for k
+000198a0: 6579 2069 6e20 7365 6c66 5f6b 6579 733a  ey in self_keys:
+000198b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000198c0: 206b 6579 2021 3d20 226e 616d 6522 3a0d   key != "name":.
+000198d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000198e0: 2070 7269 6e74 2873 7472 286b 6579 2920   print(str(key) 
+000198f0: 2b20 2220 3a20 2220 2b20 7265 7072 2873  + " : " + repr(s
+00019900: 656c 662e 5f5f 6469 6374 5f5f 5b6b 6579  elf.__dict__[key
+00019910: 5d29 290d 0a0d 0a20 2020 2020 2020 2070  ]))....        p
+00019920: 7269 6e74 2822 5c6e 2229 0d0a 0d0a 0d0a  rint("\n")......
+00019930: 636c 6173 7320 4461 7461 6375 6265 3a0d  class Datacube:.
+00019940: 0a20 2020 2022 2222 4461 7461 4375 6265  .    """DataCube
+00019950: 2e22 2222 0d0a 0d0a 2020 2020 6669 6c65  ."""....    file
+00019960: 733a 204c 6973 745b 7374 725d 0d0a 2020  s: List[str]..  
+00019970: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
+00019980: 6179 0d0a 0d0a 2020 2020 2222 220d 0a20  ay....    """.. 
+00019990: 2020 2066 696c 6573 3a0d 0a20 2020 2020     files:..     
+000199a0: 2020 206c 6973 7420 6f66 2067 656f 7469     list of geoti
+000199b0: 6666 2066 696c 6573 2720 6e61 6d65 730d  ff files' names.
+000199c0: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
+000199d0: 6465 6620 5f5f 696e 6974 5f5f 280d 0a20  def __init__(.. 
+000199e0: 2020 2020 2020 2073 656c 662c 0d0a 2020         self,..  
+000199f0: 2020 2020 2020 7372 633a 2044 6174 6173        src: Datas
+00019a00: 6574 2c0d 0a20 2020 2020 2020 2074 696d  et,..        tim
+00019a10: 655f 6c65 6e67 7468 3a20 696e 742c 0d0a  e_length: int,..
+00019a20: 2020 2020 2020 2020 6669 6c65 733a 204c          files: L
+00019a30: 6973 745b 7374 725d 203d 204e 6f6e 652c  ist[str] = None,
+00019a40: 0d0a 2020 2020 293a 0d0a 2020 2020 2020  ..    ):..      
+00019a50: 2020 7365 6c66 2e5f 6261 7365 203d 2073    self._base = s
+00019a60: 7263 0d0a 2020 2020 2020 2020 7365 6c66  rc..        self
+00019a70: 2e66 696c 6573 203d 2066 696c 6573 0d0a  .files = files..
+00019a80: 2020 2020 2020 2020 7365 6c66 2e5f 7469          self._ti
+00019a90: 6d65 5f6c 656e 6774 6820 3d20 7469 6d65  me_length = time
+00019aa0: 5f6c 656e 6774 680d 0a0d 0a20 2020 2020  _length....     
+00019ab0: 2020 2070 6173 730d 0a0d 0a20 2020 2064     pass....    d
+00019ac0: 6566 205f 5f73 7472 5f5f 2873 656c 6629  ef __str__(self)
+00019ad0: 3a0d 0a20 2020 2020 2020 206d 6573 7361  :..        messa
+00019ae0: 6765 203d 2066 2222 220d 0a20 2020 2020  ge = f"""..     
+00019af0: 2020 2020 2020 2046 696c 6573 3a20 7b6c         Files: {l
+00019b00: 656e 2873 656c 662e 6669 6c65 7329 7d0d  en(self.files)}.
+00019b10: 0a20 2020 2020 2020 2020 2020 2043 656c  .            Cel
+00019b20: 6c20 7369 7a65 3a20 7b73 656c 662e 5f62  l size: {self._b
+00019b30: 6173 652e 6365 6c6c 5f73 697a 657d 0d0a  ase.cell_size}..
+00019b40: 2020 2020 2020 2020 2020 2020 4550 5347              EPSG
+00019b50: 3a20 7b73 656c 662e 5f62 6173 652e 6570  : {self._base.ep
+00019b60: 7367 7d0d 0a20 2020 2020 2020 2020 2020  sg}..           
+00019b70: 2056 6172 6961 626c 6573 3a20 7b73 656c   Variables: {sel
+00019b80: 662e 5f62 6173 652e 7661 7269 6162 6c65  f._base.variable
+00019b90: 737d 0d0a 2020 2020 2020 2020 2020 2020  s}..            
+00019ba0: 4469 6d65 6e73 696f 6e3a 207b 7365 6c66  Dimension: {self
+00019bb0: 2e72 6f77 7320 2a20 7365 6c66 2e63 6f6c  .rows * self.col
+00019bc0: 756d 6e73 7d0d 0a20 2020 2020 2020 2020  umns}..         
+00019bd0: 2020 204d 6173 6b3a 207b 7365 6c66 2e5f     Mask: {self._
+00019be0: 6261 7365 2e6e 6f5f 6461 7461 5f76 616c  base.no_data_val
+00019bf0: 7565 5b30 5d7d 0d0a 2020 2020 2020 2020  ue[0]}..        
+00019c00: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
+00019c10: 7572 6e20 6d65 7373 6167 650d 0a0d 0a20  urn message.... 
+00019c20: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
+00019c30: 2020 6465 6620 6261 7365 2873 656c 6629    def base(self)
+00019c40: 202d 3e20 4461 7461 7365 743a 0d0a 2020   -> Dataset:..  
+00019c50: 2020 2020 2020 2222 2262 6173 652e 0d0a        """base...
+00019c60: 0d0a 2020 2020 2020 2020 4261 7365 2044  ..        Base D
+00019c70: 6174 6173 6574 0d0a 2020 2020 2020 2020  ataset..        
+00019c80: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
+00019c90: 7572 6e20 7365 6c66 2e5f 6261 7365 0d0a  urn self._base..
+00019ca0: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
+00019cb0: 0a20 2020 2064 6566 2074 696d 655f 6c65  .    def time_le
+00019cc0: 6e67 7468 2873 656c 6629 202d 3e20 696e  ngth(self) -> in
+00019cd0: 743a 0d0a 2020 2020 2020 2020 2222 226c  t:..        """l
+00019ce0: 656e 6774 6820 6f66 2074 6865 2064 6174  ength of the dat
+00019cf0: 6173 6574 2e22 2222 0d0a 2020 2020 2020  aset."""..      
+00019d00: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
+00019d10: 696d 655f 6c65 6e67 7468 0d0a 0d0a 2020  ime_length....  
+00019d20: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
+00019d30: 2064 6566 2072 6f77 7328 7365 6c66 293a   def rows(self):
+00019d40: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
+00019d50: 6265 7220 6f66 2072 6f77 7322 2222 0d0a  ber of rows"""..
+00019d60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00019d70: 656c 662e 5f62 6173 652e 726f 7773 0d0a  elf._base.rows..
+00019d80: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
+00019d90: 0a20 2020 2064 6566 2073 6861 7065 2873  .    def shape(s
+00019da0: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+00019db0: 2222 4e75 6d62 6572 206f 6620 726f 7773  ""Number of rows
+00019dc0: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
+00019dd0: 7572 6e20 7365 6c66 2e74 696d 655f 6c65  urn self.time_le
+00019de0: 6e67 7468 2c20 7365 6c66 2e72 6f77 732c  ngth, self.rows,
+00019df0: 2073 656c 662e 636f 6c75 6d6e 730d 0a0d   self.columns...
+00019e00: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
+00019e10: 2020 2020 6465 6620 636f 6c75 6d6e 7328      def columns(
+00019e20: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+00019e30: 2222 224e 756d 6265 7220 6f66 2063 6f6c  """Number of col
+00019e40: 756d 6e73 2222 220d 0a20 2020 2020 2020  umns"""..       
+00019e50: 2072 6574 7572 6e20 7365 6c66 2e5f 6261   return self._ba
+00019e60: 7365 2e63 6f6c 756d 6e73 0d0a 0d0a 2020  se.columns....  
+00019e70: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
+00019e80: 2020 2020 6465 6620 6372 6561 7465 5f63      def create_c
+00019e90: 7562 6528 636c 732c 2073 7263 3a20 4461  ube(cls, src: Da
+00019ea0: 7461 7365 742c 2064 6174 6173 6574 5f6c  taset, dataset_l
+00019eb0: 656e 6774 683a 2069 6e74 293a 0d0a 2020  ength: int):..  
+00019ec0: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
+00019ed0: 4461 7461 6375 6265 2e0d 0a0d 0a20 2020  Datacube.....   
+00019ee0: 2020 2020 2020 2020 202d 2043 7265 6174           - Creat
+00019ef0: 6520 4461 7461 6375 6265 2066 726f 6d20  e Datacube from 
+00019f00: 6120 7361 6d70 6c65 2072 6173 7465 7220  a sample raster 
+00019f10: 616e 640d 0a0d 0a20 2020 2020 2020 2050  and....        P
+00019f20: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00019f30: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00019f40: 2020 2020 2020 2073 7263 3a20 5b44 6174         src: [Dat
+00019f50: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
+00019f60: 2020 2052 4173 7465 7220 4f62 6a65 6374     RAster Object
+00019f70: 0d0a 2020 2020 2020 2020 6461 7461 7365  ..        datase
+00019f80: 745f 6c65 6e67 7468 3a20 5b69 6e74 5d0d  t_length: [int].
+00019f90: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
+00019fa0: 6774 6820 6f66 2074 6865 2064 6174 6173  gth of the datas
+00019fb0: 6574 2e0d 0a0d 0a20 2020 2020 2020 2052  et.....        R
+00019fc0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00019fd0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00019fe0: 2044 6174 6163 7562 6520 6f62 6a65 6374   Datacube object
+00019ff0: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+0001a000: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+0001a010: 6c73 2873 7263 2c20 6461 7461 7365 745f  ls(src, dataset_
+0001a020: 6c65 6e67 7468 290d 0a0d 0a20 2020 2064  length)....    d
+0001a030: 6566 2075 7064 6174 655f 6375 6265 2873  ef update_cube(s
+0001a040: 656c 662c 2061 7272 6179 3a20 6e70 2e6e  elf, array: np.n
+0001a050: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
+0001a060: 2020 2222 2255 7064 6174 6520 6461 7461    """Update data
+0001a070: 7365 7420 6461 7461 2e0d 0a0d 0a20 2020  set data.....   
+0001a080: 2020 2020 2020 2020 202d 2054 6869 7320           - This 
+0001a090: 6675 6e63 7469 6f6e 2063 7265 6174 6573  function creates
+0001a0a0: 2061 2047 656f 7469 6666 2072 6173 7465   a Geotiff raste
+0001a0b0: 7220 6c69 6b65 2061 6e6f 7468 6572 2069  r like another i
+0001a0c0: 6e70 7574 2072 6173 7465 722c 206e 6577  nput raster, new
+0001a0d0: 2072 6173 7465 7220 7769 6c6c 2068 6176   raster will hav
+0001a0e0: 6520 7468 6520 7361 6d65 0d0a 2020 2020  e the same..    
+0001a0f0: 2020 2020 2020 2020 7072 6f6a 6563 7469          projecti
+0001a100: 6f6e 2c20 636f 6f72 6469 6e61 7465 7320  on, coordinates 
+0001a110: 6f72 2074 6865 2074 6f70 206c 6566 7420  or the top left 
+0001a120: 636f 726e 6572 206f 6620 7468 6520 6f72  corner of the or
+0001a130: 6967 696e 616c 2072 6173 7465 722c 2063  iginal raster, c
+0001a140: 656c 6c20 7369 7a65 2c20 6e6f 6461 7461  ell size, nodata
+0001a150: 2076 656c 7565 2c20 616e 6420 6e75 6d62   velue, and numb
+0001a160: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
+0001a170: 6f66 2072 6f77 7320 616e 6420 636f 6c75  of rows and colu
+0001a180: 6d6e 730d 0a20 2020 2020 2020 2020 2020  mns..           
+0001a190: 202d 2074 6865 2072 6173 7465 7220 616e   - the raster an
+0001a1a0: 6420 7468 6520 6769 7665 6e20 6172 7261  d the given arra
+0001a1b0: 7920 7368 6f75 6c64 2068 6176 6520 7468  y should have th
+0001a1c0: 6520 7361 6d65 206e 756d 6265 7220 6f66  e same number of
+0001a1d0: 2063 6f6c 756d 6e73 2061 6e64 2072 6f77   columns and row
+0001a1e0: 732e 0d0a 0d0a 2020 2020 2020 2020 5061  s.....        Pa
+0001a1f0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0001a200: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0001a210: 2020 2020 2020 6172 7261 793a 205b 6e75        array: [nu
+0001a220: 6d70 7920 6172 7261 795d 0d0a 2020 2020  mpy array]..    
+0001a230: 2020 2020 2020 2020 3344 2061 7272 6179          3D array
+0001a240: 2074 6f20 6265 2073 746f 7265 7320 6173   to be stores as
+0001a250: 2061 2072 6173 7465 7273 2c20 7468 6520   a rasters, the 
+0001a260: 6469 6d65 6e73 696f 6e73 2073 686f 756c  dimensions shoul
+0001a270: 6420 6265 0d0a 2020 2020 2020 2020 2020  d be..          
+0001a280: 2020 5b72 6f77 732c 2063 6f6c 756d 6e73    [rows, columns
+0001a290: 2c20 7469 6d65 7365 7269 6573 206c 656e  , timeseries len
+0001a2a0: 6774 685d 0d0a 0d0a 2020 2020 2020 2020  gth]....        
+0001a2b0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+0001a2c0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+0001a2d0: 2020 7361 7665 2074 6865 206e 6577 2072    save the new r
+0001a2e0: 6173 7465 7220 746f 2074 6865 2067 6976  aster to the giv
+0001a2f0: 656e 2070 6174 680d 0a0d 0a20 2020 2020  en path....     
+0001a300: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
+0001a310: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
+0001a320: 2020 2020 2020 203e 3e3e 2073 7263 5f72         >>> src_r
+0001a330: 6173 7465 7220 3d20 6764 616c 2e4f 7065  aster = gdal.Ope
+0001a340: 6e28 2244 454d 2e74 6966 2229 0d0a 2020  n("DEM.tif")..  
+0001a350: 2020 2020 2020 3e3e 3e20 6e61 6d65 203d        >>> name =
+0001a360: 205b 2251 5f32 3031 325f 3031 5f30 315f   ["Q_2012_01_01_
+0001a370: 3031 2e74 6966 222c 2251 5f32 3031 325f  01.tif","Q_2012_
+0001a380: 3031 5f30 315f 3032 2e74 6966 222c 2251  01_01_02.tif","Q
+0001a390: 5f32 3031 325f 3031 5f30 315f 3033 2e74  _2012_01_01_03.t
+0001a3a0: 6966 222c 2251 5f32 3031 325f 3031 5f30  if","Q_2012_01_0
+0001a3b0: 315f 3034 2e74 6966 225d 0d0a 2020 2020  1_04.tif"]..    
+0001a3c0: 2020 2020 3e3e 3e20 4461 7461 6375 6265      >>> Datacube
+0001a3d0: 2e72 6173 7465 7273 4c69 6b65 2873 7263  .rastersLike(src
+0001a3e0: 5f72 6173 7465 722c 2064 6174 612c 206e  _raster, data, n
+0001a3f0: 616d 6529 0d0a 2020 2020 2020 2020 2222  ame)..        ""
+0001a400: 220d 0a20 2020 2020 2020 2073 656c 662e  "..        self.
+0001a410: 6461 7461 203d 2061 7272 6179 0d0a 0d0a  data = array....
+0001a420: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+0001a430: 0d0a 2020 2020 6465 6620 7265 6164 5f73  ..    def read_s
+0001a440: 6570 6172 6174 655f 6669 6c65 7328 0d0a  eparate_files(..
+0001a450: 2020 2020 2020 2020 636c 732c 0d0a 2020          cls,..  
+0001a460: 2020 2020 2020 7061 7468 3a20 556e 696f        path: Unio
+0001a470: 6e5b 7374 722c 204c 6973 745b 7374 725d  n[str, List[str]
+0001a480: 5d2c 0d0a 2020 2020 2020 2020 7769 7468  ],..        with
+0001a490: 5f6f 7264 6572 3a20 626f 6f6c 203d 2046  _order: bool = F
+0001a4a0: 616c 7365 2c0d 0a20 2020 2020 2020 2073  alse,..        s
+0001a4b0: 7461 7274 3a20 7374 7220 3d20 4e6f 6e65  tart: str = None
+0001a4c0: 2c0d 0a20 2020 2020 2020 2065 6e64 3a20  ,..        end: 
+0001a4d0: 7374 7220 3d20 4e6f 6e65 2c0d 0a20 2020  str = None,..   
+0001a4e0: 2020 2020 2066 6d74 3a20 7374 7220 3d20       fmt: str = 
+0001a4f0: 2225 592d 256d 2d25 6422 2c0d 0a20 2020  "%Y-%m-%d",..   
+0001a500: 2020 2020 2066 7265 713a 2073 7472 203d       freq: str =
+0001a510: 2022 6461 696c 7922 2c0d 0a20 2020 2020   "daily",..     
+0001a520: 2020 2073 6570 6172 6174 6f72 3a20 7374     separator: st
+0001a530: 7220 3d20 225f 222c 0d0a 2020 2020 2020  r = "_",..      
+0001a540: 2020 6578 7465 6e73 696f 6e3a 2073 7472    extension: str
+0001a550: 203d 2022 2e74 6966 222c 0d0a 2020 2020   = ".tif",..    
+0001a560: 293a 0d0a 2020 2020 2020 2020 2222 2272  ):..        """r
+0001a570: 6561 645f 7365 7061 7261 7465 5f66 696c  ead_separate_fil
+0001a580: 6573 2e0d 0a0d 0a20 2020 2020 2020 2020  es.....         
+0001a590: 2020 202d 2072 6561 6473 2072 6173 7465     - reads raste
+0001a5a0: 7273 2066 726f 6d20 6120 666f 6c64 6572  rs from a folder
+0001a5b0: 2061 6e64 2063 7265 6174 6573 2061 2033   and creates a 3
+0001a5c0: 6420 6172 7261 7920 7769 7468 2074 6865  d array with the
+0001a5d0: 2073 616d 6520 3264 2064 696d 656e 7369   same 2d dimensi
+0001a5e0: 6f6e 7320 6f66 2074 6865 2066 6972 7374  ons of the first
+0001a5f0: 2072 6173 7465 7220 696e 0d0a 2020 2020   raster in..    
+0001a600: 2020 2020 2020 2020 7468 6520 666f 6c64          the fold
+0001a610: 6572 2061 6e64 206c 656e 2061 7320 7468  er and len as th
+0001a620: 6520 6e75 6d62 6572 206f 6620 6669 6c65  e number of file
+0001a630: 730d 0a0d 0a20 2020 2020 2020 2069 6e73  s....        ins
+0001a640: 6964 6520 7468 6520 666f 6c64 6572 2e0d  ide the folder..
+0001a650: 0a20 2020 2020 2020 2020 2020 202d 2041  .            - A
+0001a660: 6c6c 2072 6173 7465 7273 2073 686f 756c  ll rasters shoul
+0001a670: 6420 6861 7665 2074 6865 2073 616d 6520  d have the same 
+0001a680: 6469 6d65 6e73 696f 6e73 0d0a 2020 2020  dimensions..    
+0001a690: 2020 2020 2020 2020 2d20 466f 6c64 6572          - Folder
+0001a6a0: 2073 686f 756c 6420 6f6e 6c79 2063 6f6e   should only con
+0001a6b0: 7461 696e 2072 6173 7465 7220 6669 6c65  tain raster file
+0001a6c0: 730d 0a20 2020 2020 2020 2020 2020 202d  s..            -
+0001a6d0: 2072 6173 7465 7220 6669 6c65 206e 616d   raster file nam
+0001a6e0: 6520 7368 6f75 6c64 2068 6176 6520 7468  e should have th
+0001a6f0: 6520 6461 7465 2061 7420 7468 6520 656e  e date at the en
+0001a700: 6420 6f66 2074 6865 2066 696c 6520 6e61  d of the file na
+0001a710: 6d65 2062 6566 6f72 6520 7468 6520 6578  me before the ex
+0001a720: 7465 6e73 696f 6e20 6469 7265 6374 6c79  tension directly
+0001a730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a740: 7769 7468 2074 6865 2059 5959 592e 4d4d  with the YYYY.MM
+0001a750: 2e44 4420 2f20 5959 5959 2d4d 4d2d 4444  .DD / YYYY-MM-DD
+0001a760: 206f 7220 5959 5959 5f4d 4d5f 4444 0d0a   or YYYY_MM_DD..
+0001a770: 2020 2020 2020 2020 2020 2020 2020 3e3e                >>
+0001a780: 3e20 2235 305f 4d53 5745 505f 3139 3739  > "50_MSWEP_1979
+0001a790: 2e30 312e 3031 2e74 6966 220d 0a0d 0a20  .01.01.tif".... 
+0001a7a0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0001a7b0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0001a7c0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2070  -----..        p
+0001a7d0: 6174 683a 5b53 7472 696e 672f 6c69 7374  ath:[String/list
+0001a7e0: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
+0001a7f0: 6174 6820 6f66 2074 6865 2066 6f6c 6465  ath of the folde
+0001a800: 7220 7468 6174 2063 6f6e 7461 696e 7320  r that contains 
+0001a810: 616c 6c20 7468 6520 7261 7374 6572 7320  all the rasters 
+0001a820: 6f72 0d0a 2020 2020 2020 2020 2020 2020  or..            
+0001a830: 6120 6c69 7374 2063 6f6e 7461 696e 7320  a list contains 
+0001a840: 7468 6520 7061 7468 7320 6f66 2074 6865  the paths of the
+0001a850: 2072 6173 7465 7273 2074 6f20 7265 6164   rasters to read
+0001a860: 2e0d 0a20 2020 2020 2020 2077 6974 685f  ...        with_
+0001a870: 6f72 6465 723a 205b 626f 6f6c 5d0d 0a20  order: [bool].. 
+0001a880: 2020 2020 2020 2020 2020 2054 7275 6520             True 
+0001a890: 6966 2074 6865 2072 6173 7465 7273 2066  if the rasters f
+0001a8a0: 6f6c 6c6f 7773 2061 2063 6572 7461 696e  ollows a certain
+0001a8b0: 206f 7264 6572 2c20 7468 656e 2074 6865   order, then the
+0001a8c0: 2072 6173 7465 7273 206e 616d 6573 2073   rasters names s
+0001a8d0: 686f 756c 6420 6861 7665 2061 0d0a 2020  hould have a..  
+0001a8e0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+0001a8f0: 2061 7420 7468 6520 6265 6769 6e6e 696e   at the beginnin
+0001a900: 6720 6f66 2074 6865 2066 696c 6520 6e61  g of the file na
+0001a910: 6d65 2069 6e64 6963 6174 696e 6720 7468  me indicating th
+0001a920: 6520 6f72 6465 722e 0d0a 2020 2020 2020  e order...      
+0001a930: 2020 2020 2020 3e3e 3e20 2230 315f 4d53        >>> "01_MS
+0001a940: 5745 505f 3139 3739 2e30 312e 3031 2e74  WEP_1979.01.01.t
+0001a950: 6966 220d 0a20 2020 2020 2020 2020 2020  if"..           
+0001a960: 203e 3e3e 2022 3032 5f4d 5357 4550 5f31   >>> "02_MSWEP_1
+0001a970: 3937 392e 3031 2e30 322e 7469 6622 0d0a  979.01.02.tif"..
+0001a980: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001a990: 2e2e 2e0d 0a20 2020 2020 2020 2020 2020  .....           
+0001a9a0: 203e 3e3e 2022 3230 5f4d 5357 4550 5f31   >>> "20_MSWEP_1
+0001a9b0: 3937 392e 3031 2e32 302e 7469 6622 0d0a  979.01.20.tif"..
+0001a9c0: 2020 2020 2020 2020 2020 2020 2d20 6375              - cu
+0001a9d0: 7272 656e 746c 7920 7468 6520 6675 6e63  rrently the func
+0001a9e0: 7469 6f6e 2064 6570 656e 6473 206d 6169  tion depends mai
+0001a9f0: 6e6c 7920 6f6e 2074 6865 2073 6570 6172  nly on the separ
+0001aa00: 6174 6f72 2022 5f22 2074 6861 7420 7365  ator "_" that se
+0001aa10: 7061 7261 7465 2074 6865 206f 7264 6572  parate the order
+0001aa20: 206e 756d 6265 7220 6672 6f6d 2074 6865   number from the
+0001aa30: 2072 6573 7420 6f66 0d0a 2020 2020 2020   rest of..      
+0001aa40: 2020 2020 2020 6669 6c65 206e 616d 652e        file name.
+0001aa50: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0001aa60: 7468 6520 7365 7061 7261 746f 7220 6265  the separator be
+0001aa70: 7477 6565 6e20 7468 6520 6461 7465 2070  tween the date p
+0001aa80: 6172 7473 2059 5959 592e 4d4d 2e44 4420  arts YYYY.MM.DD 
+0001aa90: 6972 2059 5959 595f 4d4d 5f44 4420 6f72  ir YYYY_MM_DD or
+0001aaa0: 2061 6e79 206f 7468 6572 2073 6570 6172   any other separ
+0001aab0: 6174 6f72 2064 6f65 7320 6e6f 7420 6d61  ator does not ma
+0001aac0: 7474 6572 2c0d 0a20 2020 2020 2020 2020  tter,..         
+0001aad0: 2020 2068 6f77 6576 6572 2074 6865 2073     however the s
+0001aae0: 6570 6172 6174 6f72 2068 6173 2074 6f20  eparator has to 
+0001aaf0: 6265 206f 6e6c 7920 6f6e 6520 6c65 7474  be only one lett
+0001ab00: 6572 2e0d 0a20 2020 2020 2020 2066 6d74  er...        fmt
+0001ab10: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
+0001ab20: 2020 2020 2066 6f72 6d61 7420 6f66 2074       format of t
+0001ab30: 6865 2067 6976 656e 2064 6174 650d 0a20  he given date.. 
+0001ab40: 2020 2020 2020 2073 7461 7274 3a20 5b73         start: [s
+0001ab50: 7472 5d0d 0a20 2020 2020 2020 2020 2020  tr]..           
+0001ab60: 2073 7461 7274 2064 6174 6520 6966 2079   start date if y
+0001ab70: 6f75 2077 616e 7420 746f 2072 6561 6420  ou want to read 
+0001ab80: 7468 6520 696e 7075 7420 7261 7374 6572  the input raster
+0001ab90: 2066 6f72 2061 2073 7065 6369 6669 6320   for a specific 
+0001aba0: 7065 7269 6f64 206f 6e6c 7920 616e 6420  period only and 
+0001abb0: 6e6f 7420 616c 6c20 7261 7374 6572 732c  not all rasters,
+0001abc0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0001abd0: 206e 6f74 2067 6976 656e 2061 6c6c 2072   not given all r
+0001abe0: 6173 7465 7273 2069 6e20 7468 6520 6769  asters in the gi
+0001abf0: 7665 6e20 7061 7468 2077 696c 6c20 6265  ven path will be
+0001ac00: 2072 6561 642e 0d0a 2020 2020 2020 2020   read...        
+0001ac10: 2020 2020 4869 6e74 3a0d 0a20 2020 2020      Hint:..     
+0001ac20: 2020 2020 2020 2020 2020 2054 6865 2064             The d
+0001ac30: 6174 6520 696e 2074 6865 2072 6173 7465  ate in the raste
+0001ac40: 7220 6669 6c65 206e 616d 6520 7368 6f75  r file name shou
+0001ac50: 6c64 2062 6520 7468 6520 6c61 7374 2073  ld be the last s
+0001ac60: 7472 696e 6720 6265 666f 7220 7468 6520  tring befor the 
+0001ac70: 6669 6c65 2065 7874 656e 7369 6f6e 0d0a  file extension..
+0001ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac90: 3e3e 3e20 2232 305f 4d53 5745 505f 5959  >>> "20_MSWEP_YY
+0001aca0: 5959 2e4d 4d2e 4444 2e74 6966 220d 0a20  YY.MM.DD.tif".. 
+0001acb0: 2020 2020 2020 2065 6e64 3a20 5b73 7472         end: [str
+0001acc0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+0001acd0: 6e64 2064 6174 6520 6966 2079 6f75 2077  nd date if you w
+0001ace0: 616e 7420 746f 2072 6561 6420 7468 6520  ant to read the 
+0001acf0: 696e 7075 7420 7465 6d70 6572 6174 7572  input temperatur
+0001ad00: 6520 666f 7220 6120 7370 6563 6966 6963  e for a specific
+0001ad10: 2070 6572 696f 6420 6f6e 6c79 2c0d 0a20   period only,.. 
+0001ad20: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0001ad30: 7420 6769 7665 6e20 616c 6c20 7261 7374  t given all rast
+0001ad40: 6572 7320 696e 2074 6865 2067 6976 656e  ers in the given
+0001ad50: 2070 6174 6820 7769 6c6c 2062 6520 7265   path will be re
+0001ad60: 6164 2e0d 0a20 2020 2020 2020 2020 2020  ad...           
+0001ad70: 2048 696e 743a 0d0a 2020 2020 2020 2020   Hint:..        
+0001ad80: 2020 2020 2020 2020 5468 6520 6461 7465          The date
+0001ad90: 2069 6e20 7468 6520 7261 7374 6572 2066   in the raster f
+0001ada0: 696c 6520 6e61 6d65 2073 686f 756c 6420  ile name should 
+0001adb0: 6265 2074 6865 206c 6173 7420 7374 7269  be the last stri
+0001adc0: 6e67 2062 6566 6f72 2074 6865 2066 696c  ng befor the fil
+0001add0: 6520 6578 7465 6e73 696f 6e0d 0a20 2020  e extension..   
+0001ade0: 2020 2020 2020 2020 2020 2020 203e 3e3e               >>>
+0001adf0: 2022 3230 5f4d 5357 4550 5f59 5959 592e   "20_MSWEP_YYYY.
+0001ae00: 4d4d 2e44 442e 7469 6622 0d0a 2020 2020  MM.DD.tif"..    
+0001ae10: 2020 2020 6672 6571 3a20 5b73 7472 5d0d      freq: [str].
+0001ae20: 0a20 2020 2020 2020 2020 2020 2066 7265  .            fre
+0001ae30: 7175 656e 6379 206f 6620 7468 6520 7261  quency of the ra
+0001ae40: 7374 6572 7320 2264 6169 6c79 222c 2048  sters "daily", H
+0001ae50: 6f75 726c 792c 206d 6f6e 7468 6c79 0d0a  ourly, monthly..
+0001ae60: 2020 2020 2020 2020 7365 7061 7261 746f          separato
+0001ae70: 723a 205b 7374 725d 0d0a 2020 2020 2020  r: [str]..      
+0001ae80: 2020 2020 2020 7365 7061 7261 746f 7220        separator 
+0001ae90: 6265 7477 6565 6e20 7468 6520 6f72 6465  between the orde
+0001aea0: 7220 696e 2074 6865 2062 6567 696e 6e69  r in the beginni
+0001aeb0: 6e67 206f 6620 7468 6520 7261 7374 6572  ng of the raster
+0001aec0: 2066 696c 6520 6e61 6d65 2061 6e64 2074   file name and t
+0001aed0: 6865 2072 6573 7420 6f66 2074 6865 2066  he rest of the f
+0001aee0: 696c 650d 0a20 2020 2020 2020 2020 2020  ile..           
+0001aef0: 206e 616d 652e 2044 6566 6175 6c74 2069   name. Default i
+0001af00: 7320 225f 222e 0d0a 2020 2020 2020 2020  s "_"...        
+0001af10: 6578 7465 6e73 696f 6e3a 205b 7374 725d  extension: [str]
+0001af20: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
+0001af30: 6520 6578 7465 6e73 696f 6e20 6f66 2074  e extension of t
+0001af40: 6865 2066 696c 6573 2079 6f75 2077 616e  he files you wan
+0001af50: 7420 746f 2072 6561 6420 6672 6f6d 2074  t to read from t
+0001af60: 6865 2067 6976 656e 2070 6174 682e 2044  he given path. D
+0001af70: 6566 6175 6c74 2069 7320 222e 7469 6622  efault is ".tif"
+0001af80: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
+0001af90: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+0001afa0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
+0001afb0: 7272 5f33 643a 205b 6e75 6d70 792e 6e64  rr_3d: [numpy.nd
+0001afc0: 6172 7261 795d 0d0a 2020 2020 2020 2020  array]..        
+0001afd0: 2020 2020 3364 2061 7272 6179 2063 6f6e      3d array con
+0001afe0: 7461 696e 7320 6172 7261 7973 2072 6561  tains arrays rea
+0001aff0: 6420 6672 6f6d 2061 6c6c 2072 6173 7465  d from all raste
+0001b000: 7273 2069 6e20 7468 6520 666f 6c64 6572  rs in the folder
+0001b010: 2e0d 0a0d 0a20 2020 2020 2020 2045 7861  .....        Exa
+0001b020: 6d70 6c65 0d0a 2020 2020 2020 2020 2d2d  mple..        --
+0001b030: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 203e  -----..        >
+0001b040: 3e3e 2066 726f 6d20 7079 7261 6d69 6473  >> from pyramids
+0001b050: 2e64 6174 6173 6574 2069 6d70 6f72 7420  .dataset import 
+0001b060: 4461 7461 6375 6265 0d0a 2020 2020 2020  Datacube..      
+0001b070: 2020 3e3e 3e20 7261 7374 6572 5f66 6f6c    >>> raster_fol
+0001b080: 6465 7220 3d20 2265 7861 6d70 6c65 732f  der = "examples/
+0001b090: 4749 532f 6461 7461 2f72 6173 7465 722d  GIS/data/raster-
+0001b0a0: 666f 6c64 6572 220d 0a20 2020 2020 2020  folder"..       
+0001b0b0: 203e 3e3e 2070 7265 6320 3d20 4461 7461   >>> prec = Data
+0001b0c0: 6375 6265 2e72 6561 645f 7365 7061 7261  cube.read_separa
+0001b0d0: 7465 5f66 696c 6573 2872 6173 7465 725f  te_files(raster_
+0001b0e0: 666f 6c64 6572 290d 0a0d 0a20 2020 2020  folder)....     
+0001b0f0: 2020 203e 3e3e 2069 6d70 6f72 7420 676c     >>> import gl
+0001b100: 6f62 0d0a 2020 2020 2020 2020 3e3e 3e20  ob..        >>> 
+0001b110: 7365 6172 6368 5f63 7269 7465 7269 6120  search_criteria 
+0001b120: 3d20 222a 2e74 6966 220d 0a20 2020 2020  = "*.tif"..     
+0001b130: 2020 203e 3e3e 2066 696c 655f 6c69 7374     >>> file_list
+0001b140: 203d 2067 6c6f 622e 676c 6f62 286f 732e   = glob.glob(os.
+0001b150: 7061 7468 2e6a 6f69 6e28 7261 7374 6572  path.join(raster
+0001b160: 5f66 6f6c 6465 722c 2073 6561 7263 685f  _folder, search_
+0001b170: 6372 6974 6572 6961 2929 0d0a 2020 2020  criteria))..    
+0001b180: 2020 2020 3e3e 3e20 7072 6563 203d 2044      >>> prec = D
+0001b190: 6174 6163 7562 652e 7265 6164 5f73 6570  atacube.read_sep
+0001b1a0: 6172 6174 655f 6669 6c65 7328 6669 6c65  arate_files(file
+0001b1b0: 5f6c 6973 742c 2077 6974 685f 6f72 6465  _list, with_orde
+0001b1c0: 723d 4661 6c73 6529 0d0a 2020 2020 2020  r=False)..      
+0001b1d0: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
+0001b1e0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+0001b1f0: 2870 6174 682c 2073 7472 2920 616e 6420  (path, str) and 
+0001b200: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
+0001b210: 6174 682c 206c 6973 7429 3a0d 0a20 2020  ath, list):..   
+0001b220: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0001b230: 7970 6545 7272 6f72 2866 2270 6174 6820  ypeError(f"path 
+0001b240: 696e 7075 7420 7368 6f75 6c64 2062 6520  input should be 
+0001b250: 7374 7269 6e67 2f6c 6973 7420 7479 7065  string/list type
+0001b260: 2c20 6769 7665 6e7b 7479 7065 2870 6174  , given{type(pat
+0001b270: 6829 7d22 290d 0a0d 0a20 2020 2020 2020  h)}")....       
+0001b280: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
+0001b290: 6174 682c 2073 7472 293a 0d0a 2020 2020  ath, str):..    
+0001b2a0: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
+0001b2b0: 7765 7468 6572 2074 6865 2070 6174 6820  wether the path 
+0001b2c0: 6578 6973 7420 6f72 206e 6f74 0d0a 2020  exist or not..  
+0001b2d0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001b2e0: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
+0001b2f0: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
+0001b300: 2020 2020 2020 2020 7261 6973 6520 4669          raise Fi
+0001b310: 6c65 4e6f 7446 6f75 6e64 4572 726f 7228  leNotFoundError(
+0001b320: 2254 6865 2070 6174 6820 796f 7520 6861  "The path you ha
+0001b330: 7665 2070 726f 7669 6465 6420 646f 6573  ve provided does
+0001b340: 206e 6f74 2065 7869 7374 2229 0d0a 2020   not exist")..  
+0001b350: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+0001b360: 6c69 7374 206f 6620 616c 6c20 6669 6c65  list of all file
+0001b370: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
+0001b380: 696c 6573 203d 206f 732e 6c69 7374 6469  iles = os.listdi
+0001b390: 7228 7061 7468 290d 0a20 2020 2020 2020  r(path)..       
+0001b3a0: 2020 2020 2066 696c 6573 203d 205b 6920       files = [i 
+0001b3b0: 666f 7220 6920 696e 2066 696c 6573 2069  for i in files i
+0001b3c0: 6620 692e 656e 6473 7769 7468 2865 7874  f i.endswith(ext
+0001b3d0: 656e 7369 6f6e 295d 0d0a 2020 2020 2020  ension)]..      
+0001b3e0: 2020 2020 2020 2320 6669 6c65 7320 3d20        # files = 
+0001b3f0: 676c 6f62 2e67 6c6f 6228 6f73 2e70 6174  glob.glob(os.pat
+0001b400: 682e 6a6f 696e 2870 6174 682c 2022 2a2e  h.join(path, "*.
+0001b410: 7469 6622 2929 0d0a 2020 2020 2020 2020  tif"))..        
+0001b420: 2020 2020 2320 6368 6563 6b20 7768 6574      # check whet
+0001b430: 6865 7220 7468 6572 6520 6172 6520 6669  her there are fi
+0001b440: 6c65 7320 6f72 206e 6f74 2069 6e73 6964  les or not insid
+0001b450: 6520 7468 6520 666f 6c64 6572 0d0a 2020  e the folder..  
+0001b460: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0001b470: 2866 696c 6573 2920 3c20 313a 0d0a 2020  (files) < 1:..  
+0001b480: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001b490: 6973 6520 4669 6c65 4e6f 7446 6f75 6e64  ise FileNotFound
+0001b4a0: 4572 726f 7228 2254 6865 2070 6174 6820  Error("The path 
+0001b4b0: 796f 7520 6861 7665 2070 726f 7669 6465  you have provide
+0001b4c0: 6420 6973 2065 6d70 7479 2229 0d0a 2020  d is empty")..  
+0001b4d0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0001b4e0: 2020 2020 2020 2020 2066 696c 6573 203d           files =
+0001b4f0: 2070 6174 685b 3a5d 0d0a 2020 2020 2020   path[:]..      
+0001b500: 2020 2320 746f 2073 6f72 7420 7468 6520    # to sort the 
+0001b510: 6669 6c65 7320 696e 2074 6865 2073 616d  files in the sam
+0001b520: 6520 6f72 6465 7220 6173 2074 6865 2066  e order as the f
+0001b530: 6972 7374 206e 756d 6265 7220 696e 2074  irst number in t
+0001b540: 6865 206e 616d 650d 0a20 2020 2020 2020  he name..       
+0001b550: 2069 6620 7769 7468 5f6f 7264 6572 3a0d   if with_order:.
+0001b560: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+0001b570: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001b580: 2020 2066 696c 6573 4e6f 203d 205b 696e     filesNo = [in
+0001b590: 7428 692e 7370 6c69 7428 7365 7061 7261  t(i.split(separa
+0001b5a0: 746f 7229 5b30 5d29 2066 6f72 2069 2069  tor)[0]) for i i
+0001b5b0: 6e20 6669 6c65 735d 0d0a 2020 2020 2020  n files]..      
+0001b5c0: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
+0001b5d0: 7565 4572 726f 723a 0d0a 2020 2020 2020  ueError:..      
+0001b5e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001b5f0: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
+0001b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b610: 2022 706c 6561 7365 2069 6e63 6c75 6465   "please include
+0001b620: 2061 206e 756d 6265 7220 6174 2074 6865   a number at the
+0001b630: 2062 6567 696e 6e69 6e67 206f 6620 7468   beginning of th
+0001b640: 6522 0d0a 2020 2020 2020 2020 2020 2020  e"..            
+0001b650: 2020 2020 2020 2020 2272 6173 7465 7273          "rasters
+0001b660: 206e 616d 6520 746f 2069 6e64 6963 6174   name to indicat
+0001b670: 6520 7468 6520 6f72 6465 7220 6f66 2074  e the order of t
+0001b680: 6865 2072 6173 7465 7273 2e20 746f 2064  he rasters. to d
+0001b690: 6f20 736f 2070 6c65 6173 6522 0d0a 2020  o so please"..  
+0001b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6b0: 2020 2275 7365 2074 6865 2049 6e70 7574    "use the Input
+0001b6c0: 732e 5265 6e61 6d65 4669 6c65 7320 6d65  s.RenameFiles me
+0001b6d0: 7468 6f64 2074 6f20 736f 6c76 6520 7468  thod to solve th
+0001b6e0: 6973 2069 7373 7565 2061 6e64 2064 6f6e  is issue and don
+0001b6f0: 2774 2022 0d0a 2020 2020 2020 2020 2020  't "..          
+0001b700: 2020 2020 2020 2020 2020 2269 6e63 6c75            "inclu
+0001b710: 6465 2061 6e79 206f 7468 6572 2066 696c  de any other fil
+0001b720: 6573 2069 6e20 7468 6520 666f 6c64 6572  es in the folder
+0001b730: 2077 6974 6820 7468 6520 7261 7374 6572   with the raster
+0001b740: 7322 0d0a 2020 2020 2020 2020 2020 2020  s"..            
+0001b750: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
+0001b760: 2020 2020 2066 696c 655f 7475 706c 6520       file_tuple 
+0001b770: 3d20 736f 7274 6564 287a 6970 2866 696c  = sorted(zip(fil
+0001b780: 6573 4e6f 2c20 6669 6c65 7329 290d 0a20  esNo, files)).. 
+0001b790: 2020 2020 2020 2020 2020 2066 696c 6573             files
+0001b7a0: 203d 205b 7820 666f 7220 5f2c 2078 2069   = [x for _, x i
+0001b7b0: 6e20 6669 6c65 5f74 7570 6c65 5d0d 0a0d  n file_tuple]...
+0001b7c0: 0a20 2020 2020 2020 2069 6620 7374 6172  .        if star
+0001b7d0: 7420 6973 206e 6f74 204e 6f6e 6520 6f72  t is not None or
+0001b7e0: 2065 6e64 2069 7320 6e6f 7420 4e6f 6e65   end is not None
+0001b7f0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0001b800: 7461 7274 203d 2064 742e 6461 7465 7469  tart = dt.dateti
+0001b810: 6d65 2e73 7472 7074 696d 6528 7374 6172  me.strptime(star
+0001b820: 742c 2066 6d74 290d 0a20 2020 2020 2020  t, fmt)..       
+0001b830: 2020 2020 2065 6e64 203d 2064 742e 6461       end = dt.da
+0001b840: 7465 7469 6d65 2e73 7472 7074 696d 6528  tetime.strptime(
+0001b850: 656e 642c 2066 6d74 290d 0a0d 0a20 2020  end, fmt)....   
+0001b860: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
+0001b870: 6865 2064 6174 6573 2066 6f72 2065 6163  he dates for eac
+0001b880: 6820 6669 6c65 0d0a 2020 2020 2020 2020  h file..        
+0001b890: 2020 2020 6461 7465 7320 3d20 6c69 7374      dates = list
+0001b8a0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0001b8b0: 666f 7220 692c 2066 696c 655f 6920 696e  for i, file_i in
+0001b8c0: 2065 6e75 6d65 7261 7465 2866 696c 6573   enumerate(files
+0001b8d0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0001b8e0: 2020 2020 6966 2066 7265 7120 3d3d 2022      if freq == "
+0001b8f0: 6461 696c 7922 3a0d 0a20 2020 2020 2020  daily":..       
+0001b900: 2020 2020 2020 2020 2020 2020 206c 203d               l =
+0001b910: 206c 656e 2866 696c 655f 6929 202d 2034   len(file_i) - 4
+0001b920: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b930: 2020 2020 2020 6461 7920 3d20 696e 7428        day = int(
+0001b940: 6669 6c65 5f69 5b6c 202d 2032 203a 206c  file_i[l - 2 : l
+0001b950: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0001b960: 2020 2020 2020 2020 6d6f 6e74 6820 3d20          month = 
+0001b970: 696e 7428 6669 6c65 5f69 5b6c 202d 2035  int(file_i[l - 5
+0001b980: 203a 206c 202d 2033 5d29 0d0a 2020 2020   : l - 3])..    
+0001b990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9a0: 7965 6172 203d 2069 6e74 2866 696c 655f  year = int(file_
+0001b9b0: 695b 6c20 2d20 3130 203a 206c 202d 2036  i[l - 10 : l - 6
+0001b9c0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0001b9d0: 2020 2020 2020 2020 6461 7465 732e 6170          dates.ap
+0001b9e0: 7065 6e64 2864 742e 6461 7465 7469 6d65  pend(dt.datetime
+0001b9f0: 2879 6561 722c 206d 6f6e 7468 2c20 6461  (year, month, da
+0001ba00: 7929 290d 0a20 2020 2020 2020 2020 2020  y))..           
+0001ba10: 2020 2020 2065 6c69 6620 6672 6571 203d       elif freq =
+0001ba20: 3d20 2268 6f75 726c 7922 3a0d 0a20 2020  = "hourly":..   
+0001ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba40: 2079 6561 7220 3d20 696e 7428 6669 6c65   year = int(file
+0001ba50: 5f69 2e73 706c 6974 2822 5f22 295b 2d34  _i.split("_")[-4
+0001ba60: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0001ba70: 2020 2020 2020 2020 6d6f 6e74 6820 3d20          month = 
+0001ba80: 696e 7428 6669 6c65 5f69 2e73 706c 6974  int(file_i.split
+0001ba90: 2822 5f22 295b 2d33 5d29 0d0a 2020 2020  ("_")[-3])..    
+0001baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bab0: 6461 7920 3d20 696e 7428 6669 6c65 5f69  day = int(file_i
+0001bac0: 2e73 706c 6974 2822 5f22 295b 2d32 5d29  .split("_")[-2])
+0001bad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001bae0: 2020 2020 2020 686f 7572 203d 2069 6e74        hour = int
+0001baf0: 2866 696c 655f 692e 7370 6c69 7428 225f  (file_i.split("_
+0001bb00: 2229 5b2d 315d 2e73 706c 6974 2822 2e22  ")[-1].split("."
+0001bb10: 295b 305d 290d 0a20 2020 2020 2020 2020  )[0])..         
+0001bb20: 2020 2020 2020 2020 2020 2064 6174 6573             dates
+0001bb30: 2e61 7070 656e 6428 6474 2e64 6174 6574  .append(dt.datet
+0001bb40: 696d 6528 7965 6172 2c20 6d6f 6e74 682c  ime(year, month,
+0001bb50: 2064 6179 2c20 686f 7572 2929 0d0a 0d0a   day, hour))....
+0001bb60: 2020 2020 2020 2020 2020 2020 7374 6172              star
+0001bb70: 7469 203d 2064 6174 6573 2e69 6e64 6578  ti = dates.index
+0001bb80: 2873 7461 7274 290d 0a20 2020 2020 2020  (start)..       
+0001bb90: 2020 2020 2065 6e64 6920 3d20 6461 7465       endi = date
+0001bba0: 732e 696e 6465 7828 656e 6429 202b 2031  s.index(end) + 1
+0001bbb0: 0d0a 2020 2020 2020 2020 2020 2020 6173  ..            as
+0001bbc0: 7365 7274 2061 6c6c 280d 0a20 2020 2020  sert all(..     
+0001bbd0: 2020 2020 2020 2020 2020 2066 696c 655f             file_
+0001bbe0: 692e 656e 6473 7769 7468 2822 2e74 6966  i.endswith(".tif
+0001bbf0: 2229 2066 6f72 2066 696c 655f 6920 696e  ") for file_i in
+0001bc00: 2066 696c 6573 5b73 7461 7274 693a 656e   files[starti:en
+0001bc10: 6469 5d0d 0a20 2020 2020 2020 2020 2020  di]..           
+0001bc20: 2029 2c20 2261 6c6c 2066 696c 6573 2069   ), "all files i
+0001bc30: 6e20 7468 6520 6769 7665 6e20 666f 6c64  n the given fold
+0001bc40: 6572 2073 686f 756c 6420 6861 7665 202e  er should have .
+0001bc50: 7469 6620 6578 7465 6e73 696f 6e22 0d0a  tif extension"..
+0001bc60: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0001bc70: 2020 2020 2020 2020 2020 2073 7461 7274             start
+0001bc80: 6920 3d20 300d 0a20 2020 2020 2020 2020  i = 0..         
+0001bc90: 2020 2065 6e64 6920 3d20 6c65 6e28 6669     endi = len(fi
+0001bca0: 6c65 7329 0d0a 2020 2020 2020 2020 2020  les)..          
+0001bcb0: 2020 2320 6368 6563 6b20 7468 6174 2066    # check that f
+0001bcc0: 6f6c 6465 7220 6f6e 6c79 2063 6f6e 7461  older only conta
+0001bcd0: 696e 7320 7261 7374 6572 730d 0a20 2020  ins rasters..   
+0001bce0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001bcf0: 616c 6c28 0d0a 2020 2020 2020 2020 2020  all(..          
+0001bd00: 2020 2020 2020 6669 6c65 5f69 2e65 6e64        file_i.end
+0001bd10: 7377 6974 6828 6578 7465 6e73 696f 6e29  swith(extension)
+0001bd20: 2066 6f72 2066 696c 655f 6920 696e 2066   for file_i in f
+0001bd30: 696c 6573 0d0a 2020 2020 2020 2020 2020  iles..          
+0001bd40: 2020 292c 2022 616c 6c20 6669 6c65 7320    ), "all files 
+0001bd50: 696e 2074 6865 2067 6976 656e 2066 6f6c  in the given fol
+0001bd60: 6465 7220 7368 6f75 6c64 2068 6176 6520  der should have 
+0001bd70: 2e74 6966 2065 7874 656e 7369 6f6e 220d  .tif extension".
+0001bd80: 0a0d 0a20 2020 2020 2020 2023 2066 696c  ...        # fil
+0001bd90: 6573 2074 6f20 6265 2072 6561 640d 0a20  es to be read.. 
+0001bda0: 2020 2020 2020 2066 696c 6573 203d 2066         files = f
+0001bdb0: 696c 6573 5b73 7461 7274 693a 656e 6469  iles[starti:endi
+0001bdc0: 5d0d 0a20 2020 2020 2020 2069 6620 6e6f  ]..        if no
+0001bdd0: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
+0001bde0: 682c 206c 6973 7429 3a0d 0a20 2020 2020  h, list):..     
+0001bdf0: 2020 2020 2020 2023 2061 6464 2074 6865         # add the
+0001be00: 2070 6174 6820 746f 2061 6c6c 2074 6865   path to all the
+0001be10: 2066 696c 6573 0d0a 2020 2020 2020 2020   files..        
+0001be20: 2020 2020 6669 6c65 7320 3d20 5b66 227b      files = [f"{
+0001be30: 7061 7468 7d2f 7b69 7d22 2066 6f72 2069  path}/{i}" for i
+0001be40: 2069 6e20 6669 6c65 735d 0d0a 2020 2020   in files]..    
+0001be50: 2020 2020 2320 6372 6561 7465 2061 2033      # create a 3
+0001be60: 6420 6172 7261 7920 7769 7468 2074 6865  d array with the
+0001be70: 2032 6420 6469 6d65 6e73 696f 6e20 6f66   2d dimension of
+0001be80: 2074 6865 2066 6972 7374 2072 6173 7465   the first raste
+0001be90: 7220 616e 6420 7468 6520 6c65 6e0d 0a20  r and the len.. 
+0001bea0: 2020 2020 2020 2023 206f 6620 7468 6520         # of the 
+0001beb0: 6e75 6d62 6572 206f 6620 7261 7374 6572  number of raster
+0001bec0: 7320 696e 2074 6865 2066 6f6c 6465 720d  s in the folder.
+0001bed0: 0a20 2020 2020 2020 2073 616d 706c 6520  .        sample 
+0001bee0: 3d20 4461 7461 7365 742e 7265 6164 5f66  = Dataset.read_f
+0001bef0: 696c 6528 6669 6c65 735b 305d 290d 0a0d  ile(files[0])...
+0001bf00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001bf10: 636c 7328 7361 6d70 6c65 2c20 6c65 6e28  cls(sample, len(
+0001bf20: 6669 6c65 7329 2c20 6669 6c65 7329 0d0a  files), files)..
+0001bf30: 0d0a 2020 2020 6465 6620 7265 6164 5f64  ..    def read_d
+0001bf40: 6174 6173 6574 2873 656c 662c 2062 616e  ataset(self, ban
+0001bf50: 643a 2069 6e74 203d 2030 293a 0d0a 2020  d: int = 0):..  
+0001bf60: 2020 2020 2020 2222 2252 6561 6420 6172        """Read ar
+0001bf70: 7261 792e 0d0a 0d0a 2020 2020 2020 2020  ray.....        
+0001bf80: 2020 2020 5265 6164 2076 616c 7565 7320      Read values 
+0001bf90: 666f 726d 2074 6865 2067 6976 656e 2062  form the given b
+0001bfa0: 616e 6473 2061 7320 4172 7261 7973 2066  ands as Arrays f
+0001bfb0: 6f72 2061 6c6c 2066 696c 6573 0d0a 0d0a  or all files....
+0001bfc0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0001bfd0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0001bfe0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0001bff0: 6261 6e64 3a20 5b69 6e74 5d0d 0a20 2020  band: [int]..   
+0001c000: 2020 2020 2020 2020 2069 6e64 6578 206f           index o
+0001c010: 6620 7468 6520 6261 6e64 2079 6f75 2077  f the band you w
+0001c020: 616e 7420 746f 2072 6561 6420 6465 6661  ant to read defa
+0001c030: 756c 7420 6973 2030 2e0d 0a0d 0a20 2020  ult is 0.....   
+0001c040: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+0001c050: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+0001c060: 2020 2020 2020 2041 7272 6179 0d0a 2020         Array..  
+0001c070: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0001c080: 2020 2023 2063 6865 636b 2074 6865 2067     # check the g
+0001c090: 6976 656e 2062 616e 6420 6e75 6d62 6572  iven band number
+0001c0a0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0001c0b0: 2068 6173 6174 7472 2873 656c 662c 2022   hasattr(self, "
+0001c0c0: 6261 7365 2229 3a0d 0a20 2020 2020 2020  base"):..       
+0001c0d0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0001c0e0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+0001c0f0: 2020 2020 2020 2020 2270 6c65 6173 6520          "please 
+0001c100: 7573 6520 7468 6520 7265 6164 5f73 6570  use the read_sep
+0001c110: 6172 6174 655f 6669 6c65 7320 6d65 7468  arate_files meth
+0001c120: 6f64 2074 6f20 6765 7420 7468 6520 6669  od to get the fi
+0001c130: 6c65 7320 2874 6966 662f 6173 6369 6929  les (tiff/ascii)
+0001c140: 2069 6e20 7468 6522 0d0a 2020 2020 2020   in the"..      
+0001c150: 2020 2020 2020 2020 2020 2264 6174 6173            "datas
+0001c160: 6574 2064 6972 6563 746f 7279 220d 0a20  et directory".. 
+0001c170: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+0001c180: 2020 2020 2020 6966 2062 616e 6420 3e20        if band > 
+0001c190: 7365 6c66 2e62 6173 652e 6261 6e64 5f63  self.base.band_c
+0001c1a0: 6f75 6e74 202d 2031 3a0d 0a20 2020 2020  ount - 1:..     
+0001c1b0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0001c1c0: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
+0001c1d0: 2020 2020 2020 2020 2020 6622 7468 6520            f"the 
+0001c1e0: 7261 7374 6572 2068 6173 206f 6e6c 7920  raster has only 
+0001c1f0: 7b73 656c 662e 6261 7365 2e62 616e 645f  {self.base.band_
+0001c200: 636f 756e 747d 2063 6865 636b 2074 6865  count} check the
+0001c210: 2067 6976 656e 2062 616e 6420 6e75 6d62   given band numb
+0001c220: 6572 220d 0a20 2020 2020 2020 2020 2020  er"..           
+0001c230: 2029 0d0a 2020 2020 2020 2020 2320 6669   )..        # fi
+0001c240: 6c6c 2074 6865 2061 7272 6179 2077 6974  ll the array wit
+0001c250: 6820 6e6f 5f64 6174 615f 7661 6c75 6520  h no_data_value 
+0001c260: 6461 7461 0d0a 2020 2020 2020 2020 7365  data..        se
+0001c270: 6c66 2e5f 6461 7461 203d 206e 702e 6f6e  lf._data = np.on
+0001c280: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
+0001c290: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+0001c2a0: 2020 2020 7365 6c66 2e74 696d 655f 6c65      self.time_le
+0001c2b0: 6e67 7468 2c0d 0a20 2020 2020 2020 2020  ngth,..         
+0001c2c0: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
+0001c2d0: 2e72 6f77 732c 0d0a 2020 2020 2020 2020  .rows,..        
+0001c2e0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+0001c2f0: 652e 636f 6c75 6d6e 732c 0d0a 2020 2020  e.columns,..    
+0001c300: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+0001c310: 2020 2029 0d0a 2020 2020 2020 2020 7365     )..        se
+0001c320: 6c66 2e5f 6461 7461 5b3a 2c20 3a2c 203a  lf._data[:, :, :
+0001c330: 5d20 3d20 6e70 2e6e 616e 0d0a 0d0a 2020  ] = np.nan....  
+0001c340: 2020 2020 2020 666f 7220 692c 2066 696c        for i, fil
+0001c350: 655f 6920 696e 2065 6e75 6d65 7261 7465  e_i in enumerate
+0001c360: 2873 656c 662e 6669 6c65 7329 3a0d 0a20  (self.files):.. 
+0001c370: 2020 2020 2020 2020 2020 2023 2072 6561             # rea
+0001c380: 6420 7468 6520 7469 6620 6669 6c65 0d0a  d the tif file..
+0001c390: 2020 2020 2020 2020 2020 2020 7261 7374              rast
+0001c3a0: 6572 5f69 203d 2067 6461 6c2e 4f70 656e  er_i = gdal.Open
+0001c3b0: 2866 227b 6669 6c65 5f69 7d22 290d 0a20  (f"{file_i}").. 
+0001c3c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001c3d0: 5f64 6174 615b 692c 203a 2c20 3a5d 203d  _data[i, :, :] =
+0001c3e0: 2072 6173 7465 725f 692e 4765 7452 6173   raster_i.GetRas
+0001c3f0: 7465 7242 616e 6428 6261 6e64 202b 2031  terBand(band + 1
+0001c400: 292e 5265 6164 4173 4172 7261 7928 290d  ).ReadAsArray().
+0001c410: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+0001c420: 0d0a 2020 2020 6465 6620 6461 7461 2873  ..    def data(s
+0001c430: 656c 6629 202d 3e20 6e70 2e6e 6461 7272  elf) -> np.ndarr
+0001c440: 6179 3a0d 0a20 2020 2020 2020 2022 2222  ay:..        """
+0001c450: 6461 7461 2061 7474 7269 6275 7465 2e0d  data attribute..
+0001c460: 0a0d 0a20 2020 2020 2020 202d 2054 6865  ...        - The
+0001c470: 2061 7474 7269 6275 7465 2077 6865 7265   attribute where
+0001c480: 2074 6865 2064 6174 6173 6574 2061 7272   the dataset arr
+0001c490: 6179 2069 7320 7374 6f72 6564 2e0d 0a20  ay is stored... 
+0001c4a0: 2020 2020 2020 202d 2074 6865 2033 4420         - the 3D 
+0001c4b0: 6e75 6d70 7920 6172 7261 792c 205b 6461  numpy array, [da
+0001c4c0: 7461 7365 7420 6c65 6e67 7468 2c20 726f  taset length, ro
+0001c4d0: 7773 2c20 636f 6c73 5d2c 205b 6461 7461  ws, cols], [data
+0001c4e0: 7365 7420 6c65 6e67 7468 2c20 6c6f 6e73  set length, lons
+0001c4f0: 2c20 6c61 7473 5d0d 0a20 2020 2020 2020  , lats]..       
+0001c500: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+0001c510: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
+0001c520: 662c 2022 5f64 6174 6122 293a 0d0a 2020  f, "_data"):..  
+0001c530: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001c540: 5661 6c75 6545 7272 6f72 2822 706c 6561  ValueError("plea
+0001c550: 7365 2075 7365 2074 6865 2072 6561 645f  se use the read_
+0001c560: 6461 7461 7365 7420 746f 2072 6561 6420  dataset to read 
+0001c570: 7468 6520 6461 7461 2066 6972 7374 2e22  the data first."
+0001c580: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
+0001c590: 7572 6e20 7365 6c66 2e5f 6461 7461 0d0a  urn self._data..
+0001c5a0: 0d0a 2020 2020 4064 6174 612e 7365 7474  ..    @data.sett
+0001c5b0: 6572 0d0a 2020 2020 6465 6620 6461 7461  er..    def data
+0001c5c0: 2873 656c 662c 2076 616c 293a 0d0a 2020  (self, val):..  
+0001c5d0: 2020 2020 2020 2222 2244 6174 6120 6174        """Data at
+0001c5e0: 7472 6962 7574 652e 0d0a 0d0a 2020 2020  tribute.....    
+0001c5f0: 2020 2020 2d20 7365 7474 696e 6720 7468      - setting th
+0001c600: 6520 6461 7461 2028 6172 7261 7929 2064  e data (array) d
+0001c610: 6f65 7320 6e6f 7420 616c 6c6f 7720 6469  oes not allow di
+0001c620: 6666 6572 656e 7420 6469 6d65 6e73 696f  fferent dimensio
+0001c630: 6e20 6672 6f6d 2074 6865 2064 696d 656e  n from the dimen
+0001c640: 7369 6f6e 2074 6861 7420 6861 7665 2062  sion that have b
+0001c650: 6565 6e0d 0a20 2020 2020 2020 2064 6566  een..        def
+0001c660: 696e 6564 2069 6e63 7265 6174 696e 6720  ined increating 
+0001c670: 7468 6520 6461 7461 7365 742e 0d0a 2020  the dataset...  
+0001c680: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0001c690: 2020 2023 2069 6620 7468 6520 6174 7472     # if the attr
+0001c6a0: 6962 7574 6520 6973 2064 6566 696e 6564  ibute is defined
+0001c6b0: 2062 6566 6f72 6520 6368 6563 6b20 7468   before check th
+0001c6c0: 6520 6469 6d65 6e73 696f 6e0d 0a20 2020  e dimension..   
+0001c6d0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
+0001c6e0: 7365 6c66 2c20 2264 6174 6122 293a 0d0a  self, "data"):..
+0001c6f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001c700: 656c 662e 5f64 6174 612e 7368 6170 6520  elf._data.shape 
+0001c710: 213d 2076 616c 2e73 6861 7065 3a0d 0a20  != val.shape:.. 
+0001c720: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001c730: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001c740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c750: 2020 2020 2020 6622 5468 6520 6469 6d65        f"The dime
+0001c760: 6e73 696f 6e20 6f66 2074 6865 206e 6577  nsion of the new
+0001c770: 2064 6174 613a 207b 7661 6c2e 7368 6170   data: {val.shap
+0001c780: 657d 2c20 6469 6666 6572 7320 6672 6f6d  e}, differs from
+0001c790: 2074 6865 2064 696d 656e 7369 6f6e 206f   the dimension o
+0001c7a0: 6620 7468 6520 220d 0a20 2020 2020 2020  f the "..       
+0001c7b0: 2020 2020 2020 2020 2020 2020 2066 226f               f"o
+0001c7c0: 7269 6769 6e61 6c20 6461 7461 7365 743a  riginal dataset:
+0001c7d0: 207b 7365 6c66 2e5f 6461 7461 2e73 6861   {self._data.sha
+0001c7e0: 7065 7d2c 2070 6c65 6173 6520 7265 6465  pe}, please rede
+0001c7f0: 6669 6e65 2074 6865 2062 6173 6520 4461  fine the base Da
+0001c800: 7461 7365 7420 616e 6420 220d 0a20 2020  taset and "..   
+0001c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c820: 2066 2264 6174 6173 6574 5f6c 656e 6774   f"dataset_lengt
+0001c830: 6820 6669 7273 7422 0d0a 2020 2020 2020  h first"..      
+0001c840: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
+0001c850: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
+0001c860: 6120 3d20 7661 6c0d 0a0d 0a20 2020 2040  a = val....    @
+0001c870: 6461 7461 2e64 656c 6574 6572 0d0a 2020  data.deleter..  
+0001c880: 2020 6465 6620 6461 7461 2873 656c 6629    def data(self)
+0001c890: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
+0001c8a0: 5f64 6174 6120 3d20 4e6f 6e65 0d0a 0d0a  _data = None....
+0001c8b0: 2020 2020 6465 6620 5f5f 6765 7469 7465      def __getite
+0001c8c0: 6d5f 5f28 7365 6c66 2c20 6b65 7929 3a0d  m__(self, key):.
+0001c8d0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0001c8e0: 6861 7361 7474 7228 7365 6c66 2c20 2264  hasattr(self, "d
+0001c8f0: 6174 6122 293a 0d0a 2020 2020 2020 2020  ata"):..        
+0001c900: 2020 2020 7261 6973 6520 4174 7472 6962      raise Attrib
+0001c910: 7574 6545 7272 6f72 2822 506c 6561 7365  uteError("Please
+0001c920: 2075 7365 2074 6865 2072 6561 645f 6461   use the read_da
+0001c930: 7461 7365 7420 6d65 7468 6f64 2074 2072  taset method t r
+0001c940: 6561 6420 7468 6520 6461 7461 2229 0d0a  ead the data")..
+0001c950: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001c960: 656c 662e 5f64 6174 615b 6b65 792c 203a  elf._data[key, :
+0001c970: 2c20 3a5d 0d0a 0d0a 2020 2020 6465 6620  , :]....    def 
+0001c980: 5f5f 7365 7469 7465 6d5f 5f28 7365 6c66  __setitem__(self
+0001c990: 2c20 6b65 792c 2076 616c 7565 3a20 6e70  , key, value: np
+0001c9a0: 2e6e 6461 7272 6179 293a 0d0a 2020 2020  .ndarray):..    
+0001c9b0: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
+0001c9c0: 7472 2873 656c 662c 2022 6461 7461 2229  tr(self, "data")
+0001c9d0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0001c9e0: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
+0001c9f0: 726f 7228 2250 6c65 6173 6520 7573 6520  ror("Please use 
+0001ca00: 7468 6520 7265 6164 5f64 6174 6173 6574  the read_dataset
+0001ca10: 206d 6574 686f 6420 7420 7265 6164 2074   method t read t
+0001ca20: 6865 2064 6174 6122 290d 0a20 2020 2020  he data")..     
+0001ca30: 2020 2073 656c 662e 5f64 6174 615b 6b65     self._data[ke
+0001ca40: 792c 203a 2c20 3a5d 203d 2076 616c 7565  y, :, :] = value
+0001ca50: 0d0a 0d0a 2020 2020 6465 6620 5f5f 6c65  ....    def __le
+0001ca60: 6e5f 5f28 7365 6c66 293a 0d0a 2020 2020  n__(self):..    
+0001ca70: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001ca80: 5f64 6174 612e 7368 6170 655b 305d 0d0a  _data.shape[0]..
+0001ca90: 0d0a 2020 2020 6465 6620 5f5f 6974 6572  ..    def __iter
+0001caa0: 5f5f 2873 656c 6629 3a0d 0a20 2020 2020  __(self):..     
+0001cab0: 2020 2072 6574 7572 6e20 6974 6572 2873     return iter(s
+0001cac0: 656c 662e 5f64 6174 615b 3a5d 290d 0a0d  elf._data[:])...
+0001cad0: 0a20 2020 2064 6566 2068 6561 6428 7365  .    def head(se
+0001cae0: 6c66 2c20 6e3a 2069 6e74 203d 2035 293a  lf, n: int = 5):
+0001caf0: 0d0a 2020 2020 2020 2020 2222 2246 6972  ..        """Fir
+0001cb00: 7374 2035 2044 6174 6173 6574 732e 2222  st 5 Datasets.""
+0001cb10: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+0001cb20: 6e20 7365 6c66 2e5f 6461 7461 5b3a 6e2c  n self._data[:n,
+0001cb30: 203a 2c20 3a5d 0d0a 0d0a 2020 2020 6465   :, :]....    de
+0001cb40: 6620 7461 696c 2873 656c 662c 206e 3a20  f tail(self, n: 
+0001cb50: 696e 7420 3d20 2d35 293a 0d0a 2020 2020  int = -5):..    
+0001cb60: 2020 2020 2222 224c 6173 7420 3520 4461      """Last 5 Da
+0001cb70: 7461 7365 7473 2e22 2222 0d0a 2020 2020  tasets."""..    
+0001cb80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001cb90: 5f64 6174 615b 6e3a 2c20 3a2c 203a 5d0d  _data[n:, :, :].
+0001cba0: 0a0d 0a20 2020 2064 6566 2066 6972 7374  ...    def first
+0001cbb0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+0001cbc0: 2022 2222 4669 7273 7420 4461 7461 7365   """First Datase
+0001cbd0: 742e 2222 220d 0a20 2020 2020 2020 2072  t."""..        r
+0001cbe0: 6574 7572 6e20 7365 6c66 2e5f 6461 7461  eturn self._data
+0001cbf0: 5b30 2c20 3a2c 203a 5d0d 0a0d 0a20 2020  [0, :, :]....   
+0001cc00: 2064 6566 206c 6173 7428 7365 6c66 293a   def last(self):
+0001cc10: 0d0a 2020 2020 2020 2020 2222 224c 6173  ..        """Las
+0001cc20: 7420 4461 7461 7365 742e 2222 220d 0a20  t Dataset.""".. 
+0001cc30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001cc40: 6c66 2e5f 6461 7461 5b2d 312c 203a 2c20  lf._data[-1, :, 
+0001cc50: 3a5d 0d0a 0d0a 2020 2020 6465 6620 696c  :]....    def il
+0001cc60: 6f63 2873 656c 662c 2069 293a 0d0a 2020  oc(self, i):..  
+0001cc70: 2020 2020 2020 2222 2269 6c6f 632e 0d0a        """iloc...
+0001cc80: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0001cc90: 4163 6365 7373 2064 6174 6173 6574 2061  Access dataset a
+0001cca0: 7272 6179 2075 7369 6e67 2069 6e64 6578  rray using index
+0001ccb0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+0001ccc0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0001ccd0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0001cce0: 2020 2020 2069 3a20 5b69 6e74 5d0d 0a20       i: [int].. 
+0001ccf0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+0001cd00: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+0001cd10: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+0001cd20: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4461  ----..        Da
+0001cd30: 7461 7365 743a 0d0a 2020 2020 2020 2020  taset:..        
+0001cd40: 2020 2020 4461 7461 7365 7420 6f62 6a65      Dataset obje
+0001cd50: 6374 2e0d 0a20 2020 2020 2020 2022 2222  ct...        """
+0001cd60: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0001cd70: 2068 6173 6174 7472 2873 656c 662c 2022   hasattr(self, "
+0001cd80: 6461 7461 2229 3a0d 0a20 2020 2020 2020  data"):..       
+0001cd90: 2020 2020 2072 6169 7365 2044 6174 6173       raise Datas
+0001cda0: 6574 4e6f 466f 756e 6445 7272 6f72 2822  etNoFoundError("
+0001cdb0: 706c 6561 7365 2072 6561 6420 7468 6520  please read the 
+0001cdc0: 6461 7461 7365 7420 6669 7273 7422 290d  dataset first").
+0001cdd0: 0a20 2020 2020 2020 2061 7272 203d 2073  .        arr = s
+0001cde0: 656c 662e 5f64 6174 615b 692c 203a 2c20  elf._data[i, :, 
+0001cdf0: 3a5d 0d0a 2020 2020 2020 2020 6473 7420  :]..        dst 
+0001ce00: 3d20 6764 616c 2e47 6574 4472 6976 6572  = gdal.GetDriver
+0001ce10: 4279 4e61 6d65 2822 4d45 4d22 292e 4372  ByName("MEM").Cr
+0001ce20: 6561 7465 436f 7079 2822 222c 2073 656c  eateCopy("", sel
+0001ce30: 662e 6261 7365 2e72 6173 7465 722c 2030  f.base.raster, 0
+0001ce40: 290d 0a20 2020 2020 2020 2064 7374 2e47  )..        dst.G
+0001ce50: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
+0001ce60: 5772 6974 6541 7272 6179 2861 7272 290d  WriteArray(arr).
+0001ce70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001ce80: 4461 7461 7365 7428 6473 7429 0d0a 0d0a  Dataset(dst)....
+0001ce90: 2020 2020 6465 6620 706c 6f74 2873 656c      def plot(sel
+0001cea0: 662c 2062 616e 643a 2069 6e74 203d 2030  f, band: int = 0
+0001ceb0: 2c20 6578 636c 7564 655f 7661 6c75 653a  , exclude_value:
+0001cec0: 2041 6e79 203d 204e 6f6e 652c 202a 2a6b   Any = None, **k
+0001ced0: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
+0001cee0: 2022 2222 5265 6164 2041 7272 6179 0d0a   """Read Array..
+0001cef0: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0001cf00: 7265 6164 2074 6865 2076 616c 7565 7320  read the values 
+0001cf10: 7374 6f72 6564 2069 6e20 6120 6769 7665  stored in a give
+0001cf20: 6e20 6261 6e64 2e0d 0a0d 0a20 2020 2020  n band.....     
+0001cf30: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0001cf40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001cf50: 2d0d 0a20 2020 2020 2020 2062 616e 6420  -..        band 
+0001cf60: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
+0001cf70: 2020 2020 2020 2020 2074 6865 2062 616e           the ban
+0001cf80: 6420 796f 7520 7761 6e74 2074 6f20 6765  d you want to ge
+0001cf90: 7420 6974 7320 6461 7461 2e20 4465 6661  t its data. Defa
+0001cfa0: 756c 7420 6973 2030 0d0a 2020 2020 2020  ult is 0..      
+0001cfb0: 2020 6578 636c 7564 655f 7661 6c75 653a    exclude_value:
+0001cfc0: 205b 416e 795d 0d0a 2020 2020 2020 2020   [Any]..        
+0001cfd0: 2020 2020 7661 6c75 6520 746f 2065 7865      value to exe
+0001cfe0: 636c 7564 6520 6672 6f6d 2074 6865 2070  clude from the p
+0001cff0: 6c6f 742e 2044 6566 6175 6c74 2069 7320  lot. Default is 
+0001d000: 4e6f 6e65 2e0d 0a20 2020 2020 2020 202a  None...        *
+0001d010: 2a6b 7761 7267 730d 0a20 2020 2020 2020  *kwargs..       
+0001d020: 2020 2020 2070 6f69 6e74 7320 3a20 5b61       points : [a
+0001d030: 7272 6179 5d0d 0a20 2020 2020 2020 2020  rray]..         
+0001d040: 2020 2020 2020 2033 2063 6f6c 756d 6e20         3 column 
+0001d050: 6172 7261 7920 7769 7468 2074 6865 2066  array with the f
+0001d060: 6972 7374 2063 6f6c 756d 6e20 6173 2074  irst column as t
+0001d070: 6865 2076 616c 7565 2079 6f75 2077 616e  he value you wan
+0001d080: 7420 746f 2064 6973 706c 6179 2066 6f72  t to display for
+0001d090: 2074 6865 2070 6f69 6e74 2c20 7468 6520   the point, the 
+0001d0a0: 7365 636f 6e64 2069 7320 7468 6520 726f  second is the ro
+0001d0b0: 7773 0d0a 2020 2020 2020 2020 2020 2020  ws..            
+0001d0c0: 2020 2020 696e 6465 7820 6f66 2074 6865      index of the
+0001d0d0: 2070 6f69 6e74 2069 6e20 7468 6520 6172   point in the ar
+0001d0e0: 7261 792c 2061 6e64 2074 6865 2074 6869  ray, and the thi
+0001d0f0: 7264 2063 6f6c 756d 6e20 6173 2074 6865  rd column as the
+0001d100: 2063 6f6c 756d 6e20 696e 6465 7820 696e   column index in
+0001d110: 2074 6865 2061 7272 6179 2e0d 0a20 2020   the array...   
+0001d120: 2020 2020 2020 2020 2020 2020 202d 2074               - t
+0001d130: 6865 2073 6563 6f6e 6420 616e 6420 7468  he second and th
+0001d140: 6972 6420 636f 6c75 6d6e 2074 656c 6c73  ird column tells
+0001d150: 2074 6865 206c 6f63 6174 696f 6e20 6f66   the location of
+0001d160: 2074 6865 2070 6f69 6e74 2069 6e20 7468   the point in th
+0001d170: 6520 6172 7261 792e 0d0a 2020 2020 2020  e array...      
+0001d180: 2020 2020 2020 706f 696e 745f 636f 6c6f        point_colo
+0001d190: 723a 205b 7374 725d 0d0a 2020 2020 2020  r: [str]..      
+0001d1a0: 2020 2020 2020 2020 2020 636f 6c6f 722e            color.
+0001d1b0: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+0001d1c0: 696e 745f 7369 7a65 3a20 5b41 6e79 5d0d  int_size: [Any].
+0001d1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d1e0: 2073 697a 6520 6f66 2074 6865 2070 6f69   size of the poi
+0001d1f0: 6e74 2e0d 0a20 2020 2020 2020 2020 2020  nt...           
+0001d200: 2070 6964 5f63 6f6c 6f72 3a20 5b73 7472   pid_color: [str
+0001d210: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0001d220: 2020 2074 6865 2063 6f6c 6f72 206f 6620     the color of 
+0001d230: 7468 6520 616e 6f74 6174 696f 6e20 6f66  the anotation of
+0001d240: 2074 6865 2070 6f69 6e74 2e20 4465 6661   the point. Defa
+0001d250: 756c 7420 6973 2062 6c75 652e 0d0a 2020  ult is blue...  
+0001d260: 2020 2020 2020 2020 2020 7069 645f 7369            pid_si
+0001d270: 7a65 3a20 5b41 6e79 5d0d 0a20 2020 2020  ze: [Any]..     
+0001d280: 2020 2020 2020 2020 2020 2073 697a 6520             size 
+0001d290: 6f66 2074 6865 2070 6f69 6e74 2061 6e6e  of the point ann
+0001d2a0: 6f74 6174 696f 6e2e 0d0a 2020 2020 2020  otation...      
+0001d2b0: 2020 2020 2020 6669 6773 697a 6520 3a20        figsize : 
+0001d2c0: 5b74 7570 6c65 5d2c 206f 7074 696f 6e61  [tuple], optiona
+0001d2d0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+0001d2e0: 2020 2066 6967 7572 6520 7369 7a65 2e20     figure size. 
+0001d2f0: 5468 6520 6465 6661 756c 7420 6973 2028  The default is (
+0001d300: 382c 3829 2e0d 0a20 2020 2020 2020 2020  8,8)...         
+0001d310: 2020 2074 6974 6c65 203a 205b 7374 725d     title : [str]
+0001d320: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0001d330: 2020 2020 2020 2020 2020 2020 7469 746c              titl
+0001d340: 6520 6f66 2074 6865 2070 6c6f 742e 2054  e of the plot. T
+0001d350: 6865 2064 6566 6175 6c74 2069 7320 2754  he default is 'T
+0001d360: 6f74 616c 2044 6973 6368 6172 6765 272e  otal Discharge'.
+0001d370: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
+0001d380: 746c 655f 7369 7a65 203a 205b 696e 7465  tle_size : [inte
+0001d390: 6765 725d 2c20 6f70 7469 6f6e 616c 0d0a  ger], optional..
+0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3b0: 7469 746c 6520 7369 7a65 2e20 5468 6520  title size. The 
+0001d3c0: 6465 6661 756c 7420 6973 2031 352e 0d0a  default is 15...
+0001d3d0: 2020 2020 2020 2020 2020 2020 6f72 6965              orie
+0001d3e0: 6e74 6174 696f 6e20 3a20 5b73 7472 696e  ntation : [strin
+0001d3f0: 675d 2c20 6f70 7469 6f6e 616c 0d0a 2020  g], optional..  
+0001d400: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+0001d410: 696e 7461 7469 6f6e 206f 6620 7468 6520  intation of the 
+0001d420: 636f 6c6f 7262 6172 2068 6f72 697a 6f6e  colorbar horizon
+0001d430: 7461 6c2f 7665 7274 6963 616c 2e20 5468  tal/vertical. Th
+0001d440: 6520 6465 6661 756c 7420 6973 2027 7665  e default is 've
+0001d450: 7274 6963 616c 272e 0d0a 2020 2020 2020  rtical'...      
+0001d460: 2020 2020 2020 726f 7461 7469 6f6e 203a        rotation :
+0001d470: 205b 6e75 6d62 6572 5d2c 206f 7074 696f   [number], optio
+0001d480: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0001d490: 2020 2020 2072 6f74 6174 696f 6e20 6f66       rotation of
+0001d4a0: 2074 6865 2063 6f6c 6f72 6261 7220 6c61   the colorbar la
+0001d4b0: 6265 6c2e 2054 6865 2064 6566 6175 6c74  bel. The default
+0001d4c0: 2069 7320 2d39 302e 0d0a 2020 2020 2020   is -90...      
+0001d4d0: 2020 2020 2020 6f72 6965 6e74 6174 696f        orientatio
+0001d4e0: 6e20 3a20 5b73 7472 696e 675d 2c20 6f70  n : [string], op
+0001d4f0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0001d500: 2020 2020 2020 2020 6f72 696e 7461 7469          orintati
+0001d510: 6f6e 206f 6620 7468 6520 636f 6c6f 7262  on of the colorb
+0001d520: 6172 2068 6f72 697a 6f6e 7461 6c2f 7665  ar horizontal/ve
+0001d530: 7274 6963 616c 2e20 5468 6520 6465 6661  rtical. The defa
+0001d540: 756c 7420 6973 2027 7665 7274 6963 616c  ult is 'vertical
+0001d550: 272e 0d0a 2020 2020 2020 2020 2020 2020  '...            
+0001d560: 6362 6172 5f6c 656e 6774 6820 3a20 5b66  cbar_length : [f
+0001d570: 6c6f 6174 5d2c 206f 7074 696f 6e61 6c0d  loat], optional.
+0001d580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d590: 2072 6174 696f 2074 6f20 636f 6e74 726f   ratio to contro
+0001d5a0: 6c20 7468 6520 6865 6967 6874 206f 6620  l the height of 
+0001d5b0: 7468 6520 636f 6c6f 7262 6172 2e20 5468  the colorbar. Th
+0001d5c0: 6520 6465 6661 756c 7420 6973 2030 2e37  e default is 0.7
+0001d5d0: 352e 0d0a 2020 2020 2020 2020 2020 2020  5...            
+0001d5e0: 7469 636b 735f 7370 6163 696e 6720 3a20  ticks_spacing : 
+0001d5f0: 5b69 6e74 6567 6572 5d2c 206f 7074 696f  [integer], optio
+0001d600: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0001d610: 2020 2020 2053 7061 6369 6e67 2069 6e20       Spacing in 
+0001d620: 7468 6520 636f 6c6f 7262 6172 2074 6963  the colorbar tic
+0001d630: 6b73 2e20 5468 6520 6465 6661 756c 7420  ks. The default 
+0001d640: 6973 2032 2e0d 0a20 2020 2020 2020 2020  is 2...         
+0001d650: 2020 2063 6261 725f 6c61 6265 6c5f 7369     cbar_label_si
+0001d660: 7a65 203a 2069 6e74 6567 6572 2c20 6f70  ze : integer, op
+0001d670: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0001d680: 2020 2020 2020 2020 7369 7a65 206f 6620          size of 
+0001d690: 7468 6520 636f 6c6f 7220 6261 7220 6c61  the color bar la
+0001d6a0: 6265 6c2e 2054 6865 2064 6566 6175 6c74  bel. The default
+0001d6b0: 2069 7320 3132 2e0d 0a20 2020 2020 2020   is 12...       
+0001d6c0: 2020 2020 2063 6261 725f 6c61 6265 6c20       cbar_label 
+0001d6d0: 3a20 7374 722c 206f 7074 696f 6e61 6c0d  : str, optional.
+0001d6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d6f0: 206c 6162 656c 206f 6620 7468 6520 636f   label of the co
+0001d700: 6c6f 7220 6261 722e 2054 6865 2064 6566  lor bar. The def
+0001d710: 6175 6c74 2069 7320 2744 6973 6368 6172  ault is 'Dischar
+0001d720: 6765 206d 332f 7327 2e0d 0a20 2020 2020  ge m3/s'...     
+0001d730: 2020 2020 2020 2063 6f6c 6f72 5f73 6361         color_sca
+0001d740: 6c65 203a 2069 6e74 6567 6572 2c20 6f70  le : integer, op
+0001d750: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0001d760: 2020 2020 2020 2020 7468 6572 6520 6172          there ar
+0001d770: 6520 3520 6f70 7469 6f6e 7320 746f 2063  e 5 options to c
+0001d780: 6861 6e67 6520 7468 6520 7363 616c 6520  hange the scale 
+0001d790: 6f66 2074 6865 2063 6f6c 6f72 732e 2054  of the colors. T
+0001d7a0: 6865 2064 6566 6175 6c74 2069 7320 312e  he default is 1.
+0001d7b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d7c0: 2020 312d 2063 6f6c 6f72 5f73 6361 6c65    1- color_scale
+0001d7d0: 2031 2069 7320 7468 6520 6e6f 726d 616c   1 is the normal
+0001d7e0: 2073 6361 6c65 0d0a 2020 2020 2020 2020   scale..        
+0001d7f0: 2020 2020 2020 2020 322d 2063 6f6c 6f72          2- color
+0001d800: 5f73 6361 6c65 2032 2069 7320 7468 6520  _scale 2 is the 
+0001d810: 706f 7765 7220 7363 616c 650d 0a20 2020  power scale..   
+0001d820: 2020 2020 2020 2020 2020 2020 2033 2d20               3- 
+0001d830: 636f 6c6f 725f 7363 616c 6520 3320 6973  color_scale 3 is
+0001d840: 2074 6865 2053 796d 4c6f 674e 6f72 6d20   the SymLogNorm 
+0001d850: 7363 616c 650d 0a20 2020 2020 2020 2020  scale..         
+0001d860: 2020 2020 2020 2034 2d20 636f 6c6f 725f         4- color_
+0001d870: 7363 616c 6520 3420 6973 2074 6865 2050  scale 4 is the P
+0001d880: 6f77 6572 4e6f 726d 2073 6361 6c65 0d0a  owerNorm scale..
+0001d890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8a0: 352d 2063 6f6c 6f72 5f73 6361 6c65 2035  5- color_scale 5
+0001d8b0: 2069 7320 7468 6520 426f 756e 6461 7279   is the Boundary
+0001d8c0: 4e6f 726d 2073 6361 6c65 0d0a 2020 2020  Norm scale..    
+0001d8d0: 2020 2020 2020 2020 2020 2020 2d2d 2d2d              ----
+0001d8e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001d8f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001d900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001d910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+0001d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d930: 6761 6d6d 6120 3a20 5b66 6c6f 6174 5d2c  gamma : [float],
+0001d940: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+0001d950: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0001d960: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
+0001d970: 6f70 7469 6f6e 2032 202e 2054 6865 2064  option 2 . The d
+0001d980: 6566 6175 6c74 2069 7320 312e 2f32 2e2e  efault is 1./2..
+0001d990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d9a0: 2020 6c69 6e65 5f74 6872 6573 686f 6c64    line_threshold
+0001d9b0: 203a 205b 666c 6f61 745d 2c20 6f70 7469   : [float], opti
+0001d9c0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+0001d9d0: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
+0001d9e0: 6e65 6564 6564 2066 6f72 206f 7074 696f  needed for optio
+0001d9f0: 6e20 332e 2054 6865 2064 6566 6175 6c74  n 3. The default
+0001da00: 2069 7320 302e 3030 3031 2e0d 0a20 2020   is 0.0001...   
+0001da10: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+0001da20: 655f 7363 616c 6520 3a20 5b66 6c6f 6174  e_scale : [float
+0001da30: 5d2c 206f 7074 696f 6e61 6c0d 0a20 2020  ], optional..   
+0001da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001da50: 2076 616c 7565 206e 6565 6465 6420 666f   value needed fo
+0001da60: 7220 6f70 7469 6f6e 2033 2e20 5468 6520  r option 3. The 
+0001da70: 6465 6661 756c 7420 6973 2030 2e30 3031  default is 0.001
+0001da80: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001da90: 2020 2062 6f75 6e64 733a 205b 4c69 7374     bounds: [List
+0001daa0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0001dab0: 2020 2020 2020 2061 206c 6973 7420 6f66         a list of
+0001dac0: 206e 756d 6265 7220 746f 2062 6520 7573   number to be us
+0001dad0: 6564 2061 7320 6120 6469 7363 7265 7465  ed as a discrete
+0001dae0: 2062 6f75 6e64 7320 666f 7220 7468 6520   bounds for the 
+0001daf0: 636f 6c6f 7220 7363 616c 6520 342e 4465  color scale 4.De
+0001db00: 6661 756c 7420 6973 204e 6f6e 652c 0d0a  fault is None,..
+0001db10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db20: 6d69 6470 6f69 6e74 203a 205b 666c 6f61  midpoint : [floa
+0001db30: 745d 2c20 6f70 7469 6f6e 616c 0d0a 2020  t], optional..  
+0001db40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db50: 2020 7661 6c75 6520 6e65 6564 6564 2066    value needed f
+0001db60: 6f72 206f 7074 696f 6e20 352e 2054 6865  or option 5. The
+0001db70: 2064 6566 6175 6c74 2069 7320 302e 0d0a   default is 0...
+0001db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001dba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001dbb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001dbc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001dbd0: 2d2d 0d0a 2020 2020 2020 2020 2020 2020  --..            
+0001dbe0: 636d 6170 203a 205b 7374 725d 2c20 6f70  cmap : [str], op
+0001dbf0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0001dc00: 2020 2020 2020 2020 636f 6c6f 7220 7374          color st
+0001dc10: 796c 652e 2054 6865 2064 6566 6175 6c74  yle. The default
+0001dc20: 2069 7320 2763 6f6f 6c77 6172 6d5f 7227   is 'coolwarm_r'
+0001dc30: 2e0d 0a20 2020 2020 2020 2020 2020 2064  ...            d
+0001dc40: 6973 706c 6179 5f63 656c 6c5f 7661 6c75  isplay_cell_valu
+0001dc50: 6520 3a20 5b62 6f6f 6c5d 0d0a 2020 2020  e : [bool]..    
+0001dc60: 2020 2020 2020 2020 2020 2020 5472 7565              True
+0001dc70: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
+0001dc80: 6469 7370 6c61 7920 7468 6520 7661 6c75  display the valu
+0001dc90: 6573 206f 6620 7468 6520 6365 6c6c 7320  es of the cells 
+0001dca0: 6173 2061 2074 6578 740d 0a20 2020 2020  as a text..     
+0001dcb0: 2020 2020 2020 206e 756d 5f73 697a 6520         num_size 
+0001dcc0: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
+0001dcd0: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0001dce0: 2020 2020 2073 697a 6520 6f66 2074 6865       size of the
+0001dcf0: 206e 756d 6265 7273 2070 6c6f 7474 6564   numbers plotted
+0001dd00: 2069 6e74 6f70 206f 6620 6561 6368 2063   intop of each c
+0001dd10: 656c 6c73 2e20 5468 6520 6465 6661 756c  ells. The defaul
+0001dd20: 7420 6973 2038 2e0d 0a20 2020 2020 2020  t is 8...       
+0001dd30: 2020 2020 2062 6163 6b67 726f 756e 645f       background_
+0001dd40: 636f 6c6f 725f 7468 7265 7368 6f6c 6420  color_threshold 
+0001dd50: 3a20 5b66 6c6f 6174 2f69 6e74 6567 6572  : [float/integer
+0001dd60: 5d2c 206f 7074 696f 6e61 6c0d 0a20 2020  ], optional..   
+0001dd70: 2020 2020 2020 2020 2020 2020 2074 6872               thr
+0001dd80: 6573 686f 6c64 2076 616c 7565 2069 6620  eshold value if 
+0001dd90: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+0001dda0: 2063 656c 6c20 6973 2067 7265 6174 6572   cell is greater
+0001ddb0: 2c20 7468 6520 706c 6f74 7465 640d 0a20  , the plotted.. 
+0001ddc0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001ddd0: 756d 6265 7273 2077 696c 6c20 6265 2062  umbers will be b
+0001dde0: 6c61 636b 2061 6e64 2069 6620 736d 616c  lack and if smal
+0001ddf0: 6c65 7220 7468 6520 706c 6f74 7465 6420  ler the plotted 
+0001de00: 6e75 6d62 6572 2077 696c 6c20 6265 2077  number will be w
+0001de10: 6869 7465 0d0a 2020 2020 2020 2020 2020  hite..          
+0001de20: 2020 2020 2020 6966 204e 6f6e 6520 6769        if None gi
+0001de30: 7665 6e20 7468 6520 6d61 7876 616c 7565  ven the maxvalue
+0001de40: 2f32 2077 696c 6c20 6265 2063 6f6e 7369  /2 will be consi
+0001de50: 6465 7265 642e 2054 6865 2064 6566 6175  dered. The defau
+0001de60: 6c74 2069 7320 4e6f 6e65 2e0d 0a0d 0a20  lt is None..... 
+0001de70: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+0001de80: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+0001de90: 0a20 2020 2020 2020 2061 7865 733a 205b  .        axes: [
+0001dea0: 6669 6775 7265 2061 7865 735d 2e0d 0a20  figure axes]... 
+0001deb0: 2020 2020 2020 2020 2020 2074 6865 2061             the a
+0001dec0: 7865 7320 6f66 2074 6865 206d 6174 706c  xes of the matpl
+0001ded0: 6f74 6c69 6220 6669 6775 7265 0d0a 2020  otlib figure..  
+0001dee0: 2020 2020 2020 6669 673a 205b 6d61 7470        fig: [matp
+0001def0: 6c6f 746c 6962 2066 6967 7572 6520 6f62  lotlib figure ob
+0001df00: 6a65 6374 5d0d 0a20 2020 2020 2020 2020  ject]..         
+0001df10: 2020 2074 6865 2066 6967 7572 6520 6f62     the figure ob
+0001df20: 6a65 6374 0d0a 2020 2020 2020 2020 2222  ject..        ""
+0001df30: 220d 0a20 2020 2020 2020 2069 6d70 6f72  "..        impor
+0001df40: 745f 636c 656f 7061 7472 6128 0d0a 2020  t_cleopatra(..  
+0001df50: 2020 2020 2020 2020 2020 2254 6865 2063            "The c
+0001df60: 7572 7265 6e74 2066 756e 6372 696f 6e20  urrent funcrion 
+0001df70: 7573 6573 2063 6c65 6f70 6174 7261 2070  uses cleopatra p
+0001df80: 6163 6b61 6765 2074 6f20 666f 7220 706c  ackage to for pl
+0001df90: 6f74 7469 6e67 2c20 706c 6561 7365 2069  otting, please i
+0001dfa0: 6e73 7461 6c6c 2069 7420 6d61 6e75 616c  nstall it manual
+0001dfb0: 6c79 2c20 666f 7220 6d6f 7265 2069 6e66  ly, for more inf
+0001dfc0: 6f20 220d 0a20 2020 2020 2020 2020 2020  o "..           
+0001dfd0: 2022 6368 6563 6b20 6874 7470 733a 2f2f   "check https://
+0001dfe0: 6769 7468 7562 2e63 6f6d 2f53 6572 6170  github.com/Serap
+0001dff0: 6965 756d 2d6f 662d 616c 6578 2f63 6c65  ieum-of-alex/cle
+0001e000: 6f70 6174 7261 220d 0a20 2020 2020 2020  opatra"..       
+0001e010: 2029 0d0a 2020 2020 2020 2020 6672 6f6d   )..        from
+0001e020: 2063 6c65 6f70 6174 7261 2e61 7272 6179   cleopatra.array
+0001e030: 2069 6d70 6f72 7420 4172 7261 790d 0a0d   import Array...
+0001e040: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+0001e050: 7365 6c66 2e64 6174 610d 0a0d 0a20 2020  self.data....   
+0001e060: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
+0001e070: 7565 203d 2028 0d0a 2020 2020 2020 2020  ue = (..        
+0001e080: 2020 2020 5b73 656c 662e 6261 7365 2e6e      [self.base.n
+0001e090: 6f5f 6461 7461 5f76 616c 7565 5b62 616e  o_data_value[ban
+0001e0a0: 645d 2c20 6578 636c 7564 655f 7661 6c75  d], exclude_valu
+0001e0b0: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
+0001e0c0: 6966 2065 7863 6c75 6465 5f76 616c 7565  if exclude_value
+0001e0d0: 2069 7320 6e6f 7420 4e6f 6e65 0d0a 2020   is not None..  
+0001e0e0: 2020 2020 2020 2020 2020 656c 7365 205b            else [
+0001e0f0: 7365 6c66 2e62 6173 652e 6e6f 5f64 6174  self.base.no_dat
+0001e100: 615f 7661 6c75 655b 6261 6e64 5d5d 0d0a  a_value[band]]..
+0001e110: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+0001e120: 2020 2020 2063 6c65 6f20 3d20 4172 7261       cleo = Arra
+0001e130: 7928 6461 7461 2c20 6578 636c 7564 655f  y(data, exclude_
+0001e140: 7661 6c75 653d 6578 636c 7564 655f 7661  value=exclude_va
+0001e150: 6c75 6529 0d0a 2020 2020 2020 2020 7469  lue)..        ti
+0001e160: 6d65 203d 206c 6973 7428 7261 6e67 6528  me = list(range(
+0001e170: 7365 6c66 2e74 696d 655f 6c65 6e67 7468  self.time_length
+0001e180: 2929 0d0a 2020 2020 2020 2020 616e 696d  ))..        anim
+0001e190: 203d 2063 6c65 6f2e 616e 696d 6174 6528   = cleo.animate(
+0001e1a0: 7469 6d65 2c20 2a2a 6b77 6172 6773 290d  time, **kwargs).
+0001e1b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001e1c0: 616e 696d 0d0a 0d0a 2020 2020 6465 6620  anim....    def 
+0001e1d0: 746f 5f66 696c 6528 7365 6c66 2c20 7061  to_file(self, pa
+0001e1e0: 7468 3a20 7374 722c 2064 7269 7665 723a  th: str, driver:
+0001e1f0: 2073 7472 203d 2022 6765 6f74 6966 6622   str = "geotiff"
+0001e200: 2c20 6261 6e64 3a20 696e 7420 3d20 3029  , band: int = 0)
+0001e210: 3a0d 0a20 2020 2020 2020 2022 2222 5361  :..        """Sa
+0001e220: 7665 2074 6f20 6765 6f74 6966 6620 666f  ve to geotiff fo
+0001e230: 726d 6174 2e0d 0a0d 0a20 2020 2020 2020  rmat.....       
+0001e240: 2020 2020 2073 6176 6552 6173 7465 7220       saveRaster 
+0001e250: 7361 7665 7320 6120 7261 7374 6572 2074  saves a raster t
+0001e260: 6f20 6120 7061 7468 0d0a 0d0a 2020 2020  o a path....    
+0001e270: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+0001e280: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001e290: 2d2d 0d0a 2020 2020 2020 2020 7061 7468  --..        path
+0001e2a0: 3a20 5b73 7472 696e 675d 0d0a 2020 2020  : [string]..    
+0001e2b0: 2020 2020 2020 2020 6120 7061 7468 2069          a path i
+0001e2c0: 6e63 6c75 646e 6720 7468 6520 6e61 6d65  ncludng the name
+0001e2d0: 206f 6620 7468 6520 7261 7374 6572 2061   of the raster a
+0001e2e0: 6e64 2065 7874 656e 7469 6f6e 2e0d 0a20  nd extention... 
+0001e2f0: 2020 2020 2020 2020 2020 203e 3e3e 2070             >>> p
+0001e300: 6174 6820 3d20 2264 6174 612f 6372 6f70  ath = "data/crop
+0001e310: 7065 642e 7469 6622 0d0a 2020 2020 2020  ped.tif"..      
+0001e320: 2020 6472 6976 6572 3a20 5b73 7472 5d0d    driver: [str].
+0001e330: 0a20 2020 2020 2020 2020 2020 2064 7269  .            dri
+0001e340: 7665 7220 3d20 2267 656f 7469 6666 222e  ver = "geotiff".
+0001e350: 0d0a 2020 2020 2020 2020 6261 6e64 3a20  ..        band: 
+0001e360: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
+0001e370: 2020 2062 616e 6420 696e 6465 782c 206e     band index, n
+0001e380: 6565 6465 6420 6f6e 6c79 2069 6e20 6361  eeded only in ca
+0001e390: 7365 206f 6620 6173 6369 6920 6472 6976  se of ascii driv
+0001e3a0: 6572 732e 2044 6566 6175 6c74 2069 7320  ers. Default is 
+0001e3b0: 312e 0d0a 0d0a 2020 2020 2020 2020 4578  1.....        Ex
+0001e3c0: 616d 706c 6573 0d0a 2020 2020 2020 2020  amples..        
+0001e3d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0001e3e0: 2020 3e3e 3e20 7261 7374 6572 5f6f 626a    >>> raster_obj
+0001e3f0: 203d 2044 6174 6173 6574 2e72 6561 645f   = Dataset.read_
+0001e400: 6669 6c65 2822 7061 7468 2f74 6f2f 6669  file("path/to/fi
+0001e410: 6c65 2f2a 2a2a 2e74 6966 2229 0d0a 2020  le/***.tif")..  
+0001e420: 2020 2020 2020 3e3e 3e20 6f75 7470 7574        >>> output
+0001e430: 5f70 6174 6820 3d20 2265 7861 6d70 6c65  _path = "example
+0001e440: 732f 4749 532f 6461 7461 2f73 6176 655f  s/GIS/data/save_
+0001e450: 7261 7374 6572 5f74 6573 742e 7469 6622  raster_test.tif"
+0001e460: 0d0a 2020 2020 2020 2020 3e3e 3e20 7261  ..        >>> ra
+0001e470: 7374 6572 5f6f 626a 2e74 6f5f 6669 6c65  ster_obj.to_file
+0001e480: 286f 7574 7075 745f 7061 7468 290d 0a20  (output_path).. 
+0001e490: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001e4a0: 2020 2020 6966 206e 6f74 2050 6174 6828      if not Path(
+0001e4b0: 7061 7468 292e 6578 6973 7473 2829 3a0d  path).exists():.
+0001e4c0: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
+0001e4d0: 6828 7061 7468 292e 6d6b 6469 7228 7061  h(path).mkdir(pa
+0001e4e0: 7265 6e74 733d 5472 7565 2c20 6578 6973  rents=True, exis
+0001e4f0: 745f 6f6b 3d54 7275 6529 0d0a 2020 2020  t_ok=True)..    
+0001e500: 2020 2020 6578 7420 3d20 4341 5441 4c4f      ext = CATALO
+0001e510: 472e 6765 745f 6578 7465 6e73 696f 6e28  G.get_extension(
+0001e520: 6472 6976 6572 290d 0a0d 0a20 2020 2020  driver)....     
+0001e530: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0001e540: 6528 7365 6c66 2e74 696d 655f 6c65 6e67  e(self.time_leng
+0001e550: 7468 293a 0d0a 2020 2020 2020 2020 2020  th):..          
+0001e560: 2020 7372 6320 3d20 7365 6c66 2e69 6c6f    src = self.ilo
+0001e570: 6328 6929 0d0a 2020 2020 2020 2020 2020  c(i)..          
+0001e580: 2020 7372 632e 746f 5f66 696c 6528 6622    src.to_file(f"
+0001e590: 7b70 6174 687d 2f7b 697d 2e7b 6578 747d  {path}/{i}.{ext}
+0001e5a0: 222c 2062 616e 643d 6261 6e64 290d 0a0d  ", band=band)...
+0001e5b0: 0a20 2020 2064 6566 2074 6f5f 6372 7328  .    def to_crs(
+0001e5c0: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
+0001e5d0: 0a20 2020 2020 2020 2074 6f5f 6570 7367  .        to_epsg
+0001e5e0: 3a20 696e 7420 3d20 3338 3537 2c0d 0a20  : int = 3857,.. 
+0001e5f0: 2020 2020 2020 206d 6574 686f 643a 2073         method: s
+0001e600: 7472 203d 2022 6e65 6172 6573 7420 6e65  tr = "nearest ne
+0001e610: 6962 6f75 7222 2c0d 0a20 2020 2020 2020  ibour",..       
+0001e620: 206d 6169 6e74 6169 6e5f 616c 6967 686d   maintain_alighm
+0001e630: 656e 743a 2069 6e74 203d 2046 616c 7365  ent: int = False
+0001e640: 2c0d 0a20 2020 2029 3a0d 0a20 2020 2020  ,..    ):..     
+0001e650: 2020 2022 2222 746f 5f65 7073 672e 0d0a     """to_epsg...
+0001e660: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0001e670: 746f 5f65 7073 6720 7265 7072 6f6a 6563  to_epsg reprojec
+0001e680: 7473 2061 2072 6173 7465 7220 746f 2061  ts a raster to a
+0001e690: 6e79 2070 726f 6a65 6374 696f 6e20 2864  ny projection (d
+0001e6a0: 6566 6175 6c74 2074 6865 2057 4753 3834  efault the WGS84
+0001e6b0: 2077 6562 206d 6572 6361 746f 7220 7072   web mercator pr
+0001e6c0: 6f6a 6563 7469 6f6e 2c0d 0a20 2020 2020  ojection,..     
+0001e6d0: 2020 2020 2020 2077 6974 686f 7574 2072         without r
+0001e6e0: 6573 616d 706c 696e 6729 2054 6865 2066  esampling) The f
+0001e6f0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
+0001e700: 6120 4744 414c 2069 6e2d 6d65 6d6f 7279  a GDAL in-memory
+0001e710: 2066 696c 6520 6f62 6a65 6374 2c20 7768   file object, wh
+0001e720: 6572 6520 796f 7520 6361 6e20 5265 6164  ere you can Read
+0001e730: 4173 4172 7261 7920 6574 632e 0d0a 0d0a  AsArray etc.....
+0001e740: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0001e750: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0001e760: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0001e770: 746f 5f65 7073 673a 205b 696e 7465 6765  to_epsg: [intege
+0001e780: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
+0001e790: 7265 6665 7265 6e63 6520 6e75 6d62 6572  reference number
+0001e7a0: 2074 6f20 7468 6520 6e65 7720 7072 6f6a   to the new proj
+0001e7b0: 6563 7469 6f6e 2028 6874 7470 733a 2f2f  ection (https://
+0001e7c0: 6570 7367 2e69 6f2f 290d 0a20 2020 2020  epsg.io/)..     
+0001e7d0: 2020 2020 2020 2028 6465 6661 756c 7420         (default 
+0001e7e0: 3338 3537 2074 6865 2072 6566 6572 656e  3857 the referen
+0001e7f0: 6365 206e 6f20 6f66 2057 4753 3834 2077  ce no of WGS84 w
+0001e800: 6562 206d 6572 6361 746f 7220 290d 0a20  eb mercator ).. 
+0001e810: 2020 2020 2020 206d 6574 686f 643a 205b         method: [
+0001e820: 5374 7269 6e67 5d0d 0a20 2020 2020 2020  String]..       
+0001e830: 2020 2020 2072 6573 616d 706c 696e 6720       resampling 
+0001e840: 7465 6368 6e69 7175 6520 6465 6661 756c  technique defaul
+0001e850: 7420 6973 2022 4e65 6172 6573 7422 0d0a  t is "Nearest"..
+0001e860: 2020 2020 2020 2020 2020 2020 6874 7470              http
+0001e870: 733a 2f2f 6769 7367 656f 6772 6170 6879  s://gisgeography
+0001e880: 2e63 6f6d 2f72 6173 7465 722d 7265 7361  .com/raster-resa
+0001e890: 6d70 6c69 6e67 2f0d 0a20 2020 2020 2020  mpling/..       
+0001e8a0: 2020 2020 2022 4e65 6172 6573 7422 2066       "Nearest" f
+0001e8b0: 6f72 206e 6561 7265 7374 206e 6569 6768  or nearest neigh
+0001e8c0: 626f 7572 2c22 6375 6269 6322 2066 6f72  bour,"cubic" for
+0001e8d0: 2063 7562 6963 2063 6f6e 766f 6c75 7469   cubic convoluti
+0001e8e0: 6f6e 2c0d 0a20 2020 2020 2020 2020 2020  on,..           
+0001e8f0: 2022 6269 6c69 6e65 6172 2220 666f 7220   "bilinear" for 
+0001e900: 6269 6c69 6e65 6172 0d0a 2020 2020 2020  bilinear..      
+0001e910: 2020 6d61 696e 7461 696e 5f61 6c69 6768    maintain_aligh
+0001e920: 6d65 6e74 203a 205b 626f 6f6c 5d0d 0a20  ment : [bool].. 
+0001e930: 2020 2020 2020 2020 2020 2054 7275 6520             True 
+0001e940: 746f 206d 6169 6e74 6169 6e20 7468 6520  to maintain the 
+0001e950: 6e75 6d62 6572 206f 6620 726f 7773 2061  number of rows a
+0001e960: 6e64 2063 6f6c 756d 6e73 206f 6620 7468  nd columns of th
+0001e970: 6520 7261 7374 6572 2074 6865 2073 616d  e raster the sam
+0001e980: 6520 6166 7465 7220 7265 7072 6f6a 6563  e after reprojec
+0001e990: 7469 6f6e 2e20 4465 6661 756c 7420 6973  tion. Default is
+0001e9a0: 2046 616c 7365 2e0d 0a0d 0a20 2020 2020   False.....     
+0001e9b0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0001e9c0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+0001e9d0: 2020 2020 2072 6173 7465 723a 0d0a 2020       raster:..  
+0001e9e0: 2020 2020 2020 2020 2020 6764 616c 2064            gdal d
+0001e9f0: 6174 6173 6574 2028 796f 7520 6361 6e20  ataset (you can 
+0001ea00: 7265 6164 2069 7420 6279 2052 6561 6441  read it by ReadA
+0001ea10: 7341 7272 6179 290d 0a0d 0a20 2020 2020  sArray)....     
+0001ea20: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
+0001ea30: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
+0001ea40: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0001ea50: 7079 7261 6d69 6473 2e64 6174 6173 6574  pyramids.dataset
+0001ea60: 2069 6d70 6f72 7420 4461 7461 7365 740d   import Dataset.
+0001ea70: 0a20 2020 2020 2020 203e 3e3e 2073 7263  .        >>> src
+0001ea80: 203d 2044 6174 6173 6574 2e72 6561 645f   = Dataset.read_
+0001ea90: 6669 6c65 2822 7061 7468 2f72 6173 7465  file("path/raste
+0001eaa0: 725f 6e61 6d65 2e74 6966 2229 0d0a 2020  r_name.tif")..  
+0001eab0: 2020 2020 2020 3e3e 3e20 7072 6f6a 6563        >>> projec
+0001eac0: 7465 645f 7261 7374 6572 203d 2073 7263  ted_raster = src
+0001ead0: 2e74 6f5f 6372 7328 746f 5f65 7073 673d  .to_crs(to_epsg=
+0001eae0: 3338 3537 290d 0a20 2020 2020 2020 2022  3857)..        "
+0001eaf0: 2222 0d0a 2020 2020 2020 2020 666f 7220  ""..        for 
+0001eb00: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
+0001eb10: 7469 6d65 5f6c 656e 6774 6829 3a0d 0a20  time_length):.. 
+0001eb20: 2020 2020 2020 2020 2020 2073 7263 203d             src =
+0001eb30: 2073 656c 662e 696c 6f63 2869 290d 0a20   self.iloc(i).. 
+0001eb40: 2020 2020 2020 2020 2020 2064 7374 203d             dst =
+0001eb50: 2073 7263 2e74 6f5f 6372 7328 0d0a 2020   src.to_crs(..  
+0001eb60: 2020 2020 2020 2020 2020 2020 2020 746f                to
+0001eb70: 5f65 7073 672c 206d 6574 686f 643d 6d65  _epsg, method=me
+0001eb80: 7468 6f64 2c20 6d61 696e 7461 696e 5f61  thod, maintain_a
+0001eb90: 6c69 6768 6d65 6e74 3d6d 6169 6e74 6169  lighment=maintai
+0001eba0: 6e5f 616c 6967 686d 656e 740d 0a20 2020  n_alighment..   
+0001ebb0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0001ebc0: 2020 2020 2020 2020 6172 7220 3d20 6473          arr = ds
+0001ebd0: 742e 7265 6164 5f61 7272 6179 2829 0d0a  t.read_array()..
+0001ebe0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0001ebf0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+0001ec00: 2020 2020 2020 2020 2320 6372 6561 7465          # create
+0001ec10: 2074 6865 2061 7272 6179 0d0a 2020 2020   the array..    
+0001ec20: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+0001ec30: 7920 3d20 280d 0a20 2020 2020 2020 2020  y = (..         
+0001ec40: 2020 2020 2020 2020 2020 206e 702e 6f6e             np.on
+0001ec50: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
+0001ec60: 2020 2020 2020 2020 2020 2020 2028 0d0a               (..
+0001ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001ec90: 2e74 696d 655f 6c65 6e67 7468 2c0d 0a20  .time_length,.. 
+0001eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecb0: 2020 2020 2020 2020 2020 2061 7272 2e73             arr.s
+0001ecc0: 6861 7065 5b30 5d2c 0d0a 2020 2020 2020  hape[0],..      
+0001ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ece0: 2020 2020 2020 6172 722e 7368 6170 655b        arr.shape[
+0001ecf0: 315d 2c0d 0a20 2020 2020 2020 2020 2020  1],..           
+0001ed00: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+0001ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed20: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+0001ed30: 2020 2020 2020 2020 2020 202a 206e 702e             * np.
+0001ed40: 6e61 6e0d 0a20 2020 2020 2020 2020 2020  nan..           
+0001ed50: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0001ed60: 2020 2020 6172 7261 795b 692c 203a 2c20      array[i, :, 
+0001ed70: 3a5d 203d 2061 7272 0d0a 0d0a 2020 2020  :] = arr....    
+0001ed80: 2020 2020 7365 6c66 2e5f 6461 7461 203d      self._data =
+0001ed90: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
+0001eda0: 2320 7573 6520 7468 6520 6c61 7374 2073  # use the last s
+0001edb0: 7263 2061 730d 0a20 2020 2020 2020 2073  rc as..        s
+0001edc0: 656c 662e 5f62 6173 6520 3d20 6473 740d  elf._base = dst.
+0001edd0: 0a0d 0a20 2020 2064 6566 2063 726f 7028  ...    def crop(
+0001ede0: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
+0001edf0: 0a20 2020 2020 2020 206d 6173 6b3a 2055  .        mask: U
+0001ee00: 6e69 6f6e 5b44 6174 6173 6574 2c20 7374  nion[Dataset, st
+0001ee10: 725d 2c0d 0a20 2020 2029 202d 3e20 4e6f  r],..    ) -> No
+0001ee20: 6e65 3a0d 0a20 2020 2020 2020 2022 2222  ne:..        """
+0001ee30: 6372 6f70 416c 6967 6e65 6446 6f6c 6465  cropAlignedFolde
+0001ee40: 722e 0d0a 0d0a 2020 2020 2020 2020 2020  r.....          
+0001ee50: 2020 6372 6f70 416c 6967 6e65 6446 6f6c    cropAlignedFol
+0001ee60: 6465 7220 6d61 7463 6865 7320 7468 6520  der matches the 
+0001ee70: 6c6f 6361 7469 6f6e 206f 6620 6e6f 6461  location of noda
+0001ee80: 7461 2076 616c 7565 2066 726f 6d20 7372  ta value from sr
+0001ee90: 6320 7261 7374 6572 2074 6f20 6473 740d  c raster to dst.
+0001eea0: 0a20 2020 2020 2020 2020 2020 2072 6173  .            ras
+0001eeb0: 7465 722c 204d 6173 6b20 6973 2077 6865  ter, Mask is whe
+0001eec0: 7265 2074 6865 204e 6f44 6174 6176 616c  re the NoDataval
+0001eed0: 7565 2077 696c 6c20 6265 2074 616b 656e  ue will be taken
+0001eee0: 2061 6e64 2074 6865 206c 6f63 6174 696f   and the locatio
+0001eef0: 6e20 6f66 0d0a 2020 2020 2020 2020 2020  n of..          
+0001ef00: 2020 7468 6973 2076 616c 7565 2073 7263    this value src
+0001ef10: 5f64 6972 2069 7320 7061 7468 2074 6f20  _dir is path to 
+0001ef20: 7468 6520 666f 6c64 6572 2077 6865 7265  the folder where
+0001ef30: 2072 6173 7465 7273 2065 7869 7374 2077   rasters exist w
+0001ef40: 6865 7265 2077 650d 0a20 2020 2020 2020  here we..       
+0001ef50: 2020 2020 206e 6565 6420 746f 2070 7574       need to put
+0001ef60: 2074 6865 204e 6f44 6174 6156 616c 7565   the NoDataValue
+0001ef70: 206f 6620 7468 6520 6d61 736b 2069 6e20   of the mask in 
+0001ef80: 5261 7374 6572 4220 6174 2074 6865 2073  RasterB at the s
+0001ef90: 616d 6520 6c6f 6361 7469 6f6e 730d 0a0d  ame locations...
+0001efa0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0001efb0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0001efc0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001efd0: 206d 6173 6b20 3a20 5b73 7472 2f44 6174   mask : [str/Dat
+0001efe0: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
+0001eff0: 2020 2070 6174 682f 4461 7461 7365 7420     path/Dataset 
+0001f000: 6f62 6a65 6374 206f 6620 7468 6520 6d61  object of the ma
+0001f010: 736b 2072 6173 7465 7220 746f 2063 726f  sk raster to cro
+0001f020: 7020 7468 6520 7261 7374 6572 7320 2874  p the rasters (t
+0001f030: 6f20 6765 7420 7468 6520 4e6f 4461 7461  o get the NoData
+0001f040: 2076 616c 7565 0d0a 2020 2020 2020 2020   value..        
+0001f050: 2020 2020 616e 6420 6974 206c 6f63 6174      and it locat
+0001f060: 696f 6e20 696e 2074 6865 2061 7272 6179  ion in the array
+0001f070: 2920 4d61 736b 2073 686f 756c 6420 696e  ) Mask should in
+0001f080: 636c 7564 6520 7468 6520 6e61 6d65 206f  clude the name o
+0001f090: 6620 7468 6520 7261 7374 6572 2061 6e64  f the raster and
+0001f0a0: 2074 6865 0d0a 2020 2020 2020 2020 2020   the..          
+0001f0b0: 2020 6578 7465 6e73 696f 6e20 6c69 6b65    extension like
+0001f0c0: 2022 6461 7461 2f64 656d 2e74 6966 222c   "data/dem.tif",
+0001f0d0: 206f 7220 796f 7520 6361 6e20 7265 6164   or you can read
+0001f0e0: 2074 6865 206d 6173 6b20 7261 7374 6572   the mask raster
+0001f0f0: 2075 7369 6e67 2067 6461 6c20 616e 6420   using gdal and 
+0001f100: 7573 650d 0a20 2020 2020 2020 2020 2020  use..           
+0001f110: 2069 7320 7468 6520 6669 7273 7420 7061   is the first pa
+0001f120: 7261 6d65 7465 7220 746f 2074 6865 2066  rameter to the f
+0001f130: 756e 6374 696f 6e2e 0d0a 0d0a 2020 2020  unction.....    
+0001f140: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0001f150: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0001f160: 2020 2020 2020 6e65 7720 7261 7374 6572        new raster
+0001f170: 7320 6861 7665 2074 6865 2076 616c 7565  s have the value
+0001f180: 7320 6672 6f6d 2072 6173 7465 7273 2069  s from rasters i
+0001f190: 6e20 425f 696e 7075 745f 7061 7468 2077  n B_input_path w
+0001f1a0: 6974 6820 7468 6520 4e6f 4461 7461 5661  ith the NoDataVa
+0001f1b0: 6c75 6520 696e 2074 6865 2073 616d 650d  lue in the same.
+0001f1c0: 0a20 2020 2020 2020 206c 6f63 6174 696f  .        locatio
+0001f1d0: 6e73 206c 696b 6520 7261 7374 6572 2041  ns like raster A
+0001f1e0: 2e0d 0a0d 0a20 2020 2020 2020 2045 7861  .....        Exa
+0001f1f0: 6d70 6c65 730d 0a20 2020 2020 2020 202d  mples..        -
+0001f200: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001f210: 203e 3e3e 2064 656d 5f70 6174 6820 3d20   >>> dem_path = 
+0001f220: 2265 7861 6d70 6c65 732f 4749 532f 6461  "examples/GIS/da
+0001f230: 7461 2f61 6363 3430 3030 2e74 6966 220d  ta/acc4000.tif".
+0001f240: 0a20 2020 2020 2020 203e 3e3e 2073 7263  .        >>> src
+0001f250: 5f70 6174 6820 3d20 2265 7861 6d70 6c65  _path = "example
+0001f260: 732f 4749 532f 6461 7461 2f61 6c69 676e  s/GIS/data/align
+0001f270: 6564 5f72 6173 7465 7273 2f22 0d0a 2020  ed_rasters/"..  
+0001f280: 2020 2020 2020 3e3e 3e20 6f75 745f 7061        >>> out_pa
+0001f290: 7468 203d 2022 6578 616d 706c 6573 2f47  th = "examples/G
+0001f2a0: 4953 2f64 6174 612f 6372 6f70 5f61 6c69  IS/data/crop_ali
+0001f2b0: 676e 6564 5f66 6f6c 6465 722f 220d 0a20  gned_folder/".. 
+0001f2c0: 2020 2020 2020 203e 3e3e 2044 6174 6163         >>> Datac
+0001f2d0: 7562 652e 6372 6f70 2864 656d 5f70 6174  ube.crop(dem_pat
+0001f2e0: 682c 2073 7263 5f70 6174 682c 206f 7574  h, src_path, out
+0001f2f0: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
+0001f300: 2222 220d 0a20 2020 2020 2020 2066 6f72  """..        for
+0001f310: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
+0001f320: 2e74 696d 655f 6c65 6e67 7468 293a 0d0a  .time_length):..
+0001f330: 2020 2020 2020 2020 2020 2020 7372 6320              src 
+0001f340: 3d20 7365 6c66 2e69 6c6f 6328 6929 0d0a  = self.iloc(i)..
+0001f350: 2020 2020 2020 2020 2020 2020 6473 7420              dst 
+0001f360: 3d20 7372 632e 6372 6f70 286d 6173 6b29  = src.crop(mask)
+0001f370: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+0001f380: 7220 3d20 6473 742e 7265 6164 5f61 7272  r = dst.read_arr
+0001f390: 6179 2829 0d0a 2020 2020 2020 2020 2020  ay()..          
+0001f3a0: 2020 6966 2069 203d 3d20 303a 0d0a 2020    if i == 0:..  
+0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001f3c0: 6372 6561 7465 2074 6865 2061 7272 6179  create the array
+0001f3d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f3e0: 2020 6172 7261 7920 3d20 280d 0a20 2020    array = (..   
+0001f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f400: 206e 702e 6f6e 6573 280d 0a20 2020 2020   np.ones(..     
+0001f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f420: 2020 2028 0d0a 2020 2020 2020 2020 2020     (..          
+0001f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f440: 2020 7365 6c66 2e74 696d 655f 6c65 6e67    self.time_leng
+0001f450: 7468 2c0d 0a20 2020 2020 2020 2020 2020  th,..           
+0001f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f470: 2061 7272 2e73 6861 7065 5b30 5d2c 0d0a   arr.shape[0],..
+0001f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f490: 2020 2020 2020 2020 2020 2020 6172 722e              arr.
+0001f4a0: 7368 6170 655b 315d 2c0d 0a20 2020 2020  shape[1],..     
+0001f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4c0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+0001f4d0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+0001f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4f0: 202a 206e 702e 6e61 6e0d 0a20 2020 2020   * np.nan..     
+0001f500: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+0001f510: 2020 2020 2020 2020 2020 6172 7261 795b            array[
+0001f520: 692c 203a 2c20 3a5d 203d 2061 7272 0d0a  i, :, :] = arr..
+0001f530: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+0001f540: 6461 7461 203d 2061 7272 6179 0d0a 2020  data = array..  
+0001f550: 2020 2020 2020 2320 7573 6520 7468 6520        # use the 
+0001f560: 6c61 7374 2073 7263 2061 730d 0a20 2020  last src as..   
+0001f570: 2020 2020 2073 656c 662e 5f62 6173 6520       self._base 
+0001f580: 3d20 6473 740d 0a0d 0a20 2020 2023 2023  = dst....    # #
+0001f590: 2054 4f44 4f3a 206d 6572 6765 2052 6570   TODO: merge Rep
+0001f5a0: 726f 6a65 6374 4461 7461 7365 7420 616e  rojectDataset an
+0001f5b0: 6420 5072 6f6a 6563 7452 6173 7465 7220  d ProjectRaster 
+0001f5c0: 7468 6579 2061 7265 2061 6c6d 6f73 7420  they are almost 
+0001f5d0: 7468 6520 7361 6d65 0d0a 2020 2020 2320  the same..    # 
+0001f5e0: 2320 544f 444f 3a20 7374 696c 6c20 6e65  # TODO: still ne
+0001f5f0: 6564 7320 746f 2062 6520 7465 7374 6564  eds to be tested
+0001f600: 0d0a 2020 2020 2320 4073 7461 7469 636d  ..    # @staticm
+0001f610: 6574 686f 640d 0a20 2020 2023 2064 6566  ethod..    # def
+0001f620: 2074 6f5f 6570 7367 280d 0a20 2020 2023   to_epsg(..    #
+0001f630: 2020 2020 2020 2020 2073 7263 3a20 6764           src: gd
+0001f640: 616c 2e44 6174 6163 7562 652c 0d0a 2020  al.Datacube,..  
+0001f650: 2020 2320 2020 2020 2020 2020 746f 5f65    #         to_e
+0001f660: 7073 673a 2069 6e74 203d 2033 3835 372c  psg: int = 3857,
+0001f670: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001f680: 6365 6c6c 5f73 697a 653a 2069 6e74 203d  cell_size: int =
+0001f690: 205b 5d2c 0d0a 2020 2020 2320 2020 2020   [],..    #     
+0001f6a0: 2020 2020 6d65 7468 6f64 3a20 7374 7220      method: str 
+0001f6b0: 3d20 224e 6561 7265 7374 222c 0d0a 2020  = "Nearest",..  
+0001f6c0: 2020 230d 0a20 2020 2023 2029 202d 3e20    #..    # ) -> 
+0001f6d0: 6764 616c 2e44 6174 6163 7562 653a 0d0a  gdal.Datacube:..
+0001f6e0: 2020 2020 2320 2020 2020 2222 2274 6f5f      #     """to_
+0001f6f0: 6570 7367 2e0d 0a20 2020 2023 0d0a 2020  epsg...    #..  
+0001f700: 2020 2320 2020 2020 2020 2020 2d20 746f    #         - to
+0001f710: 5f65 7073 6720 7265 7072 6f6a 6563 7473  _epsg reprojects
+0001f720: 2061 6e64 2072 6573 616d 706c 6573 2061   and resamples a
+0001f730: 2066 6f6c 6465 7220 6f66 2072 6173 7465   folder of raste
+0001f740: 7273 2074 6f20 616e 7920 7072 6f6a 6563  rs to any projec
+0001f750: 7469 6f6e 0d0a 2020 2020 2320 2020 2020  tion..    #     
+0001f760: 2020 2020 2864 6566 6175 6c74 2074 6865      (default the
+0001f770: 2057 4753 3834 2077 6562 206d 6572 6361   WGS84 web merca
+0001f780: 746f 7220 7072 6f6a 6563 7469 6f6e 2c20  tor projection, 
+0001f790: 7769 7468 6f75 7420 7265 7361 6d70 6c69  without resampli
+0001f7a0: 6e67 290d 0a20 2020 2023 0d0a 2020 2020  ng)..    #..    
+0001f7b0: 2320 2020 2020 5061 7261 6d65 7465 7273  #     Parameters
+0001f7c0: 0d0a 2020 2020 2320 2020 2020 2d2d 2d2d  ..    #     ----
+0001f7d0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2320 2020  ------..    #   
+0001f7e0: 2020 7372 633a 205b 6764 616c 2064 6174    src: [gdal dat
+0001f7f0: 6173 6574 5d0d 0a20 2020 2023 2020 2020  aset]..    #    
+0001f800: 2020 2020 2067 6461 6c20 6461 7461 7365       gdal datase
+0001f810: 7420 6f62 6a65 6374 2028 7372 633d 6764  t object (src=gd
+0001f820: 616c 2e4f 7065 6e28 2264 656d 2e74 6966  al.Open("dem.tif
+0001f830: 2229 290d 0a20 2020 2023 2020 2020 2074  "))..    #     t
+0001f840: 6f5f 6570 7367 3a20 5b69 6e74 6567 6572  o_epsg: [integer
+0001f850: 5d0d 0a20 2020 2023 2020 2020 2020 2020  ]..    #        
+0001f860: 2020 7265 6665 7265 6e63 6520 6e75 6d62    reference numb
+0001f870: 6572 2074 6f20 7468 6520 6e65 7720 7072  er to the new pr
+0001f880: 6f6a 6563 7469 6f6e 2028 6874 7470 733a  ojection (https:
+0001f890: 2f2f 6570 7367 2e69 6f2f 290d 0a20 2020  //epsg.io/)..   
+0001f8a0: 2023 2020 2020 2020 2020 2028 6465 6661   #         (defa
+0001f8b0: 756c 7420 3338 3537 2074 6865 2072 6566  ult 3857 the ref
+0001f8c0: 6572 656e 6365 206e 6f20 6f66 2057 4753  erence no of WGS
+0001f8d0: 3834 2077 6562 206d 6572 6361 746f 7220  84 web mercator 
+0001f8e0: 290d 0a20 2020 2023 2020 2020 2063 656c  )..    #     cel
+0001f8f0: 6c5f 7369 7a65 3a20 5b69 6e74 6567 6572  l_size: [integer
+0001f900: 5d0d 0a20 2020 2023 2020 2020 2020 2020  ]..    #        
+0001f910: 2020 6e75 6d62 6572 2074 6f20 7265 7361    number to resa
+0001f920: 6d70 6c65 2074 6865 2072 6173 7465 7220  mple the raster 
+0001f930: 6365 6c6c 2073 697a 6520 746f 2061 206e  cell size to a n
+0001f940: 6577 2063 656c 6c20 7369 7a65 0d0a 2020  ew cell size..  
+0001f950: 2020 2320 2020 2020 2020 2020 2864 6566    #         (def
+0001f960: 6175 6c74 2065 6d70 7479 2073 6f20 7261  ault empty so ra
+0001f970: 7374 6572 2077 696c 6c20 6e6f 7420 6265  ster will not be
+0001f980: 2072 6573 616d 706c 6564 290d 0a20 2020   resampled)..   
+0001f990: 2023 2020 2020 206d 6574 686f 643a 205b   #     method: [
+0001f9a0: 5374 7269 6e67 5d0d 0a20 2020 2023 2020  String]..    #  
+0001f9b0: 2020 2020 2020 2072 6573 616d 706c 696e         resamplin
+0001f9c0: 6720 7465 6368 6e69 7175 6520 6465 6661  g technique defa
+0001f9d0: 756c 7420 6973 2022 4e65 6172 6573 7422  ult is "Nearest"
+0001f9e0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001f9f0: 6874 7470 733a 2f2f 6769 7367 656f 6772  https://gisgeogr
+0001fa00: 6170 6879 2e63 6f6d 2f72 6173 7465 722d  aphy.com/raster-
+0001fa10: 7265 7361 6d70 6c69 6e67 2f0d 0a20 2020  resampling/..   
+0001fa20: 2023 2020 2020 2020 2020 2022 4e65 6172   #         "Near
+0001fa30: 6573 7422 2066 6f72 206e 6561 7265 7374  est" for nearest
+0001fa40: 206e 6569 6768 626f 7572 2c22 6375 6269   neighbour,"cubi
+0001fa50: 6322 2066 6f72 2063 7562 6963 2063 6f6e  c" for cubic con
+0001fa60: 766f 6c75 7469 6f6e 2c0d 0a20 2020 2023  volution,..    #
+0001fa70: 2020 2020 2020 2020 2022 6269 6c69 6e65           "biline
+0001fa80: 6172 2220 666f 7220 6269 6c69 6e65 6172  ar" for bilinear
+0001fa90: 0d0a 2020 2020 230d 0a20 2020 2023 2020  ..    #..    #  
+0001faa0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0001fab0: 2320 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20  #     -------.. 
+0001fac0: 2020 2023 2020 2020 2072 6173 7465 723a     #     raster:
+0001fad0: 205b 6764 616c 2044 6174 6163 7562 655d   [gdal Datacube]
+0001fae0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001faf0: 2061 2047 4441 4c20 696e 2d6d 656d 6f72   a GDAL in-memor
+0001fb00: 7920 6669 6c65 206f 626a 6563 742c 2077  y file object, w
+0001fb10: 6865 7265 2079 6f75 2063 616e 2052 6561  here you can Rea
+0001fb20: 6441 7341 7272 6179 2065 7463 2e0d 0a20  dAsArray etc... 
+0001fb30: 2020 2023 2020 2020 2022 2222 0d0a 2020     #     """..  
+0001fb40: 2020 2320 2020 2020 6966 206e 6f74 2069    #     if not i
+0001fb50: 7369 6e73 7461 6e63 6528 7372 632c 2067  sinstance(src, g
+0001fb60: 6461 6c2e 4461 7461 6375 6265 293a 0d0a  dal.Datacube):..
+0001fb70: 2020 2020 2320 2020 2020 2020 2020 7261      #         ra
+0001fb80: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
+0001fb90: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+0001fba0: 2020 2273 7263 2073 686f 756c 6420 6265    "src should be
+0001fbb0: 2072 6561 6420 7573 696e 6720 6764 616c   read using gdal
+0001fbc0: 2028 6764 616c 2064 6174 6173 6574 2070   (gdal dataset p
+0001fbd0: 6c65 6173 6520 7265 6164 2069 7420 7573  lease read it us
+0001fbe0: 696e 6720 6764 616c 220d 0a20 2020 2023  ing gdal"..    #
+0001fbf0: 2020 2020 2020 2020 2020 2020 2066 2220               f" 
+0001fc00: 6c69 6272 6172 7929 2067 6976 656e 207b  library) given {
+0001fc10: 7479 7065 2873 7263 297d 220d 0a20 2020  type(src)}"..   
+0001fc20: 2023 2020 2020 2020 2020 2029 0d0a 2020   #         )..  
+0001fc30: 2020 2320 2020 2020 6966 206e 6f74 2069    #     if not i
+0001fc40: 7369 6e73 7461 6e63 6528 746f 5f65 7073  sinstance(to_eps
+0001fc50: 672c 2069 6e74 293a 0d0a 2020 2020 2320  g, int):..    # 
+0001fc60: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0001fc70: 7065 4572 726f 7228 0d0a 2020 2020 2320  peError(..    # 
+0001fc80: 2020 2020 2020 2020 2020 2020 2270 6c65              "ple
+0001fc90: 6173 6520 656e 7465 7220 636f 7272 6563  ase enter correc
+0001fca0: 7420 696e 7465 6765 7220 6e75 6d62 6572  t integer number
+0001fcb0: 2066 6f72 2074 6f5f 6570 7367 206d 6f72   for to_epsg mor
+0001fcc0: 6520 696e 666f 726d 6174 696f 6e20 220d  e information ".
+0001fcd0: 0a20 2020 2023 2020 2020 2020 2020 2020  .    #          
+0001fce0: 2020 2066 2268 7474 7073 3a2f 2f65 7073     f"https://eps
+0001fcf0: 672e 696f 2f2c 2067 6976 656e 207b 7479  g.io/, given {ty
+0001fd00: 7065 2874 6f5f 6570 7367 297d 220d 0a20  pe(to_epsg)}".. 
+0001fd10: 2020 2023 2020 2020 2020 2020 2029 0d0a     #         )..
+0001fd20: 2020 2020 2320 2020 2020 6966 206e 6f74      #     if not
+0001fd30: 2069 7369 6e73 7461 6e63 6528 6d65 7468   isinstance(meth
+0001fd40: 6f64 2c20 7374 7229 3a0d 0a20 2020 2023  od, str):..    #
+0001fd50: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0001fd60: 7970 6545 7272 6f72 280d 0a20 2020 2023  ypeError(..    #
+0001fd70: 2020 2020 2020 2020 2020 2020 2022 706c               "pl
+0001fd80: 6561 7365 2065 6e74 6572 2063 6f72 7265  ease enter corre
+0001fd90: 6374 206d 6574 686f 6420 6d6f 7265 2069  ct method more i
+0001fda0: 6e66 6f72 6d61 7469 6f6e 2073 6565 2022  nformation see "
+0001fdb0: 2022 646f 636d 656e 7461 7469 6f6e 2022   "docmentation "
+0001fdc0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001fdd0: 290d 0a20 2020 2023 0d0a 2020 2020 2320  )..    #..    # 
+0001fde0: 2020 2020 6966 2063 656c 6c5f 7369 7a65      if cell_size
+0001fdf0: 3a0d 0a20 2020 2023 2020 2020 2020 2020  :..    #        
+0001fe00: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
+0001fe10: 6365 2863 656c 6c5f 7369 7a65 2c20 696e  ce(cell_size, in
+0001fe20: 7429 206f 7220 6973 696e 7374 616e 6365  t) or isinstance
+0001fe30: 280d 0a20 2020 2023 2020 2020 2020 2020  (..    #        
+0001fe40: 2020 2020 2063 656c 6c5f 7369 7a65 2c20       cell_size, 
+0001fe50: 666c 6f61 740d 0a20 2020 2023 2020 2020  float..    #    
+0001fe60: 2020 2020 2029 2c20 2270 6c65 6173 6520       ), "please 
+0001fe70: 656e 7465 7220 616e 2069 6e74 6567 6572  enter an integer
+0001fe80: 206f 7220 666c 6f61 7420 6365 6c6c 2073   or float cell s
+0001fe90: 697a 6522 0d0a 2020 2020 230d 0a20 2020  ize"..    #..   
+0001fea0: 2023 2020 2020 2069 6620 6d65 7468 6f64   #     if method
+0001feb0: 203d 3d20 224e 6561 7265 7374 223a 0d0a   == "Nearest":..
+0001fec0: 2020 2020 2320 2020 2020 2020 2020 6d65      #         me
+0001fed0: 7468 6f64 203d 2067 6461 6c2e 4752 415f  thod = gdal.GRA_
+0001fee0: 4e65 6172 6573 744e 6569 6768 626f 7572  NearestNeighbour
+0001fef0: 0d0a 2020 2020 2320 2020 2020 656c 6966  ..    #     elif
+0001ff00: 206d 6574 686f 6420 3d3d 2022 6375 6269   method == "cubi
+0001ff10: 6322 3a0d 0a20 2020 2023 2020 2020 2020  c":..    #      
+0001ff20: 2020 206d 6574 686f 6420 3d20 6764 616c     method = gdal
+0001ff30: 2e47 5241 5f43 7562 6963 0d0a 2020 2020  .GRA_Cubic..    
+0001ff40: 2320 2020 2020 656c 6966 206d 6574 686f  #     elif metho
+0001ff50: 6420 3d3d 2022 6269 6c69 6e65 6172 223a  d == "bilinear":
+0001ff60: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001ff70: 6d65 7468 6f64 203d 2067 6461 6c2e 4752  method = gdal.GR
+0001ff80: 415f 4269 6c69 6e65 6172 0d0a 2020 2020  A_Bilinear..    
+0001ff90: 230d 0a20 2020 2023 2020 2020 2073 7263  #..    #     src
+0001ffa0: 5f70 726f 6a20 3d20 7372 632e 4765 7450  _proj = src.GetP
+0001ffb0: 726f 6a65 6374 696f 6e28 290d 0a20 2020  rojection()..   
+0001ffc0: 2023 2020 2020 2073 7263 5f67 7420 3d20   #     src_gt = 
+0001ffd0: 7372 632e 4765 7447 656f 5472 616e 7366  src.GetGeoTransf
+0001ffe0: 6f72 6d28 290d 0a20 2020 2023 2020 2020  orm()..    #    
+0001fff0: 2073 7263 5f78 203d 2073 7263 2e52 6173   src_x = src.Ras
+00020000: 7465 7258 5369 7a65 0d0a 2020 2020 2320  terXSize..    # 
+00020010: 2020 2020 7372 635f 7920 3d20 7372 632e      src_y = src.
+00020020: 5261 7374 6572 5953 697a 650d 0a20 2020  RasterYSize..   
+00020030: 2023 2020 2020 2064 7479 7065 203d 2073   #     dtype = s
+00020040: 7263 2e47 6574 5261 7374 6572 4261 6e64  rc.GetRasterBand
+00020050: 2831 292e 4461 7461 5479 7065 0d0a 2020  (1).DataType..  
+00020060: 2020 2320 2020 2020 2320 7370 6174 6961    #     # spatia
+00020070: 6c20 7265 660d 0a20 2020 2023 2020 2020  l ref..    #    
+00020080: 2073 7263 5f73 7220 3d20 6f73 722e 5370   src_sr = osr.Sp
+00020090: 6174 6961 6c52 6566 6572 656e 6365 2877  atialReference(w
+000200a0: 6b74 3d73 7263 5f70 726f 6a29 0d0a 2020  kt=src_proj)..  
+000200b0: 2020 2320 2020 2020 7372 635f 6570 7367    #     src_epsg
+000200c0: 203d 2073 7263 5f73 722e 4765 7441 7474   = src_sr.GetAtt
+000200d0: 7256 616c 7565 2822 4155 5448 4f52 4954  rValue("AUTHORIT
+000200e0: 5922 2c20 3129 0d0a 2020 2020 230d 0a20  Y", 1)..    #.. 
+000200f0: 2020 2023 2020 2020 2023 2064 6973 7469     #     # disti
+00020100: 6e61 7469 6f6e 0d0a 2020 2020 2320 2020  nation..    #   
+00020110: 2020 2320 7370 6174 6961 6c20 7265 660d    # spatial ref.
+00020120: 0a20 2020 2023 2020 2020 2064 7374 5f65  .    #     dst_e
+00020130: 7073 6720 3d20 6f73 722e 5370 6174 6961  psg = osr.Spatia
+00020140: 6c52 6566 6572 656e 6365 2829 0d0a 2020  lReference()..  
+00020150: 2020 2320 2020 2020 6473 745f 6570 7367    #     dst_epsg
+00020160: 2e49 6d70 6f72 7446 726f 6d45 5053 4728  .ImportFromEPSG(
+00020170: 746f 5f65 7073 6729 0d0a 2020 2020 2320  to_epsg)..    # 
+00020180: 2020 2020 2320 7472 616e 7366 6f72 6d61      # transforma
+00020190: 7469 6f6e 2066 6163 746f 7273 0d0a 2020  tion factors..  
+000201a0: 2020 2320 2020 2020 7478 203d 206f 7372    #     tx = osr
+000201b0: 2e43 6f6f 7264 696e 6174 6554 7261 6e73  .CoordinateTrans
+000201c0: 666f 726d 6174 696f 6e28 7372 635f 7372  formation(src_sr
+000201d0: 2c20 6473 745f 6570 7367 290d 0a20 2020  , dst_epsg)..   
+000201e0: 2023 0d0a 2020 2020 2320 2020 2020 2320   #..    #     # 
+000201f0: 696e 6361 7365 2074 6865 2073 6f75 7263  incase the sourc
+00020200: 6520 6372 7320 6973 2047 4353 2061 6e64  e crs is GCS and
+00020210: 206c 6f6e 6769 7475 6465 2069 7320 696e   longitude is in
+00020220: 2074 6865 2077 6573 7420 6865 6d69 7370   the west hemisp
+00020230: 6865 7265 2067 6461 6c0d 0a20 2020 2023  here gdal..    #
+00020240: 2020 2020 2023 2072 6561 6473 206c 6f6e       # reads lon
+00020250: 6769 7475 6465 2066 726f 6e20 3020 746f  gitude fron 0 to
+00020260: 2033 3630 2061 6e64 2074 7261 6e73 666f   360 and transfo
+00020270: 726d 6174 696f 6e20 6661 6374 6f72 2077  rmation factor w
+00020280: 6f6e 7420 776f 726b 2077 6974 6820 7661  ont work with va
+00020290: 6c65 7573 0d0a 2020 2020 2320 2020 2020  leus..    #     
+000202a0: 2320 6772 6561 7465 7220 7468 616e 2031  # greater than 1
+000202b0: 3830 0d0a 2020 2020 2320 2020 2020 6966  80..    #     if
+000202c0: 2073 7263 5f65 7073 6720 3d3d 2022 3433   src_epsg == "43
+000202d0: 3236 2220 616e 6420 7372 635f 6774 5b30  26" and src_gt[0
+000202e0: 5d20 3e20 3138 303a 0d0a 2020 2020 2320  ] > 180:..    # 
+000202f0: 2020 2020 2020 2020 6c6e 675f 6e65 7720          lng_new 
+00020300: 3d20 7372 635f 6774 5b30 5d20 2d20 3336  = src_gt[0] - 36
+00020310: 300d 0a20 2020 2023 2020 2020 2020 2020  0..    #        
+00020320: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
+00020330: 2072 6967 6874 2075 7070 6572 2063 6f72   right upper cor
+00020340: 6e65 7220 706f 696e 740d 0a20 2020 2023  ner point..    #
+00020350: 2020 2020 2020 2020 2028 756c 782c 2075           (ulx, u
+00020360: 6c79 2c20 756c 7a29 203d 2074 782e 5472  ly, ulz) = tx.Tr
+00020370: 616e 7366 6f72 6d50 6f69 6e74 286c 6e67  ansformPoint(lng
+00020380: 5f6e 6577 2c20 7372 635f 6774 5b33 5d29  _new, src_gt[3])
+00020390: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+000203a0: 2320 7472 616e 7366 6f72 6d20 7468 6520  # transform the 
+000203b0: 7269 6768 7420 6c6f 7765 7220 636f 726e  right lower corn
+000203c0: 6572 2070 6f69 6e74 0d0a 2020 2020 2320  er point..    # 
+000203d0: 2020 2020 2020 2020 286c 7278 2c20 6c72          (lrx, lr
+000203e0: 792c 206c 727a 2920 3d20 7478 2e54 7261  y, lrz) = tx.Tra
+000203f0: 6e73 666f 726d 506f 696e 7428 0d0a 2020  nsformPoint(..  
+00020400: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+00020410: 6c6e 675f 6e65 7720 2b20 7372 635f 6774  lng_new + src_gt
+00020420: 5b31 5d20 2a20 7372 635f 782c 2073 7263  [1] * src_x, src
+00020430: 5f67 745b 335d 202b 2073 7263 5f67 745b  _gt[3] + src_gt[
+00020440: 355d 202a 2073 7263 5f79 0d0a 2020 2020  5] * src_y..    
+00020450: 2320 2020 2020 2020 2020 290d 0a20 2020  #         )..   
+00020460: 2023 2020 2020 2065 6c73 653a 0d0a 2020   #     else:..  
+00020470: 2020 2320 2020 2020 2020 2020 2320 7472    #         # tr
+00020480: 616e 7366 6f72 6d20 7468 6520 7269 6768  ansform the righ
+00020490: 7420 7570 7065 7220 636f 726e 6572 2070  t upper corner p
+000204a0: 6f69 6e74 0d0a 2020 2020 2320 2020 2020  oint..    #     
+000204b0: 2020 2020 2875 6c78 2c20 756c 792c 2075      (ulx, uly, u
+000204c0: 6c7a 2920 3d20 7478 2e54 7261 6e73 666f  lz) = tx.Transfo
+000204d0: 726d 506f 696e 7428 7372 635f 6774 5b30  rmPoint(src_gt[0
+000204e0: 5d2c 2073 7263 5f67 745b 335d 290d 0a20  ], src_gt[3]).. 
+000204f0: 2020 2023 2020 2020 2020 2020 2023 2074     #         # t
+00020500: 7261 6e73 666f 726d 2074 6865 2072 6967  ransform the rig
+00020510: 6874 206c 6f77 6572 2063 6f72 6e65 7220  ht lower corner 
+00020520: 706f 696e 740d 0a20 2020 2023 2020 2020  point..    #    
+00020530: 2020 2020 2028 6c72 782c 206c 7279 2c20       (lrx, lry, 
+00020540: 6c72 7a29 203d 2074 782e 5472 616e 7366  lrz) = tx.Transf
+00020550: 6f72 6d50 6f69 6e74 280d 0a20 2020 2023  ormPoint(..    #
+00020560: 2020 2020 2020 2020 2020 2020 2073 7263               src
+00020570: 5f67 745b 305d 202b 2073 7263 5f67 745b  _gt[0] + src_gt[
+00020580: 315d 202a 2073 7263 5f78 2c20 7372 635f  1] * src_x, src_
+00020590: 6774 5b33 5d20 2b20 7372 635f 6774 5b35  gt[3] + src_gt[5
+000205a0: 5d20 2a20 7372 635f 790d 0a20 2020 2023  ] * src_y..    #
+000205b0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+000205c0: 230d 0a20 2020 2023 2020 2020 2069 6620  #..    #     if 
+000205d0: 6e6f 7420 6365 6c6c 5f73 697a 653a 0d0a  not cell_size:..
+000205e0: 2020 2020 2320 2020 2020 2020 2020 2320      #         # 
+000205f0: 7468 6520 7265 7375 6c74 2072 6173 7465  the result raste
+00020600: 7220 6861 7320 7468 6520 7361 6d65 2070  r has the same p
+00020610: 6978 6365 6c20 7369 7a65 2061 7320 7468  ixcel size as th
+00020620: 6520 736f 7572 6365 0d0a 2020 2020 2320  e source..    # 
+00020630: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
+00020640: 6966 2074 6865 2063 6f6f 7264 696e 6174  if the coordinat
+00020650: 6520 7379 7374 656d 2069 7320 4743 5320  e system is GCS 
+00020660: 636f 6e76 6572 7420 7468 6520 6469 7374  convert the dist
+00020670: 616e 6365 2066 726f 6d20 616e 6775 6c61  ance from angula
+00020680: 7220 746f 206d 6574 7269 630d 0a20 2020  r to metric..   
+00020690: 2023 2020 2020 2020 2020 2069 6620 7372   #         if sr
+000206a0: 635f 6570 7367 203d 3d20 2234 3332 3622  c_epsg == "4326"
+000206b0: 3a0d 0a20 2020 2023 2020 2020 2020 2020  :..    #        
+000206c0: 2020 2020 2063 6f6f 7264 735f 3120 3d20       coords_1 = 
+000206d0: 2873 7263 5f67 745b 335d 2c20 7372 635f  (src_gt[3], src_
+000206e0: 6774 5b30 5d29 0d0a 2020 2020 2320 2020  gt[0])..    #   
+000206f0: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
+00020700: 5f32 203d 2028 7372 635f 6774 5b33 5d2c  _2 = (src_gt[3],
+00020710: 2073 7263 5f67 745b 305d 202b 2073 7263   src_gt[0] + src
+00020720: 5f67 745b 315d 290d 0a20 2020 2023 2020  _gt[1])..    #  
+00020730: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+00020740: 2020 2020 2020 2020 7069 7865 6c5f 7370          pixel_sp
+00020750: 6163 696e 673d 6765 6f70 792e 6469 7374  acing=geopy.dist
+00020760: 616e 6365 2e76 696e 6365 6e74 7928 636f  ance.vincenty(co
+00020770: 6f72 6473 5f31 2c20 636f 6f72 6473 5f32  ords_1, coords_2
+00020780: 292e 6d0d 0a20 2020 2023 2020 2020 2020  ).m..    #      
+00020790: 2020 2020 2020 2070 6978 656c 5f73 7061         pixel_spa
+000207a0: 6369 6e67 203d 2046 6561 7475 7265 436f  cing = FeatureCo
+000207b0: 6c6c 6563 7469 6f6e 2e47 4353 4469 7374  llection.GCSDist
+000207c0: 616e 6365 2863 6f6f 7264 735f 312c 2063  ance(coords_1, c
+000207d0: 6f6f 7264 735f 3229 0d0a 2020 2020 2320  oords_2)..    # 
+000207e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000207f0: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00020800: 2070 6978 656c 5f73 7061 6369 6e67 203d   pixel_spacing =
+00020810: 2073 7263 5f67 745b 315d 0d0a 2020 2020   src_gt[1]..    
+00020820: 2320 2020 2020 656c 7365 3a0d 0a20 2020  #     else:..   
+00020830: 2023 2020 2020 2020 2020 2023 2069 6620   #         # if 
+00020840: 7372 635f 6570 7367 2e47 6574 4174 7472  src_epsg.GetAttr
+00020850: 5661 6c75 6528 2741 5554 484f 5249 5459  Value('AUTHORITY
+00020860: 272c 2031 2920 213d 2022 3433 3236 223a  ', 1) != "4326":
+00020870: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+00020880: 2320 2020 2020 6173 7365 7274 2028 6365  #     assert (ce
+00020890: 6c6c 5f73 697a 6520 3e20 3129 2c20 2270  ll_size > 1), "p
+000208a0: 6c65 6173 6520 656e 7465 7220 6365 6c6c  lease enter cell
+000208b0: 2073 697a 6520 6772 6561 7465 7220 7468   size greater th
+000208c0: 616e 2031 220d 0a20 2020 2023 2020 2020  an 1"..    #    
+000208d0: 2020 2020 2023 2069 6620 7468 6520 7573       # if the us
+000208e0: 6572 2069 6e70 7574 2061 2063 656c 6c20  er input a cell 
+000208f0: 7369 7a65 2072 6573 616d 706c 6520 7468  size resample th
+00020900: 6520 7261 7374 6572 0d0a 2020 2020 2320  e raster..    # 
+00020910: 2020 2020 2020 2020 7069 7865 6c5f 7370          pixel_sp
+00020920: 6163 696e 6720 3d20 6365 6c6c 5f73 697a  acing = cell_siz
+00020930: 650d 0a20 2020 2023 0d0a 2020 2020 2320  e..    #..    # 
+00020940: 2020 2020 2320 6372 6561 7465 2061 206e      # create a n
+00020950: 6577 2072 6173 7465 720d 0a20 2020 2023  ew raster..    #
+00020960: 2020 2020 2063 6f6c 7320 3d20 696e 7428       cols = int(
+00020970: 6e70 2e72 6f75 6e64 2861 6273 286c 7278  np.round(abs(lrx
+00020980: 202d 2075 6c78 2920 2f20 7069 7865 6c5f   - ulx) / pixel_
+00020990: 7370 6163 696e 6729 290d 0a20 2020 2023  spacing))..    #
+000209a0: 2020 2020 2072 6f77 7320 3d20 696e 7428       rows = int(
+000209b0: 6e70 2e72 6f75 6e64 2861 6273 2875 6c79  np.round(abs(uly
+000209c0: 202d 206c 7279 2920 2f20 7069 7865 6c5f   - lry) / pixel_
+000209d0: 7370 6163 696e 6729 290d 0a20 2020 2023  spacing))..    #
+000209e0: 2020 2020 2064 7374 203d 2044 6174 6173       dst = Datas
+000209f0: 6574 2e5f 6372 6561 7465 5f64 6174 6173  et._create_datas
+00020a00: 6574 2863 6f6c 732c 2072 6f77 732c 2031  et(cols, rows, 1
+00020a10: 2c20 6474 7970 652c 2064 7269 7665 723d  , dtype, driver=
+00020a20: 224d 454d 2229 0d0a 2020 2020 230d 0a20  "MEM")..    #.. 
+00020a30: 2020 2023 2020 2020 2023 206e 6577 2067     #     # new g
+00020a40: 656f 7472 616e 7366 6f72 6d0d 0a20 2020  eotransform..   
+00020a50: 2023 2020 2020 206e 6577 5f67 656f 203d   #     new_geo =
+00020a60: 2028 756c 782c 2070 6978 656c 5f73 7061   (ulx, pixel_spa
+00020a70: 6369 6e67 2c20 7372 635f 6774 5b32 5d2c  cing, src_gt[2],
+00020a80: 2075 6c79 2c20 7372 635f 6774 5b34 5d2c   uly, src_gt[4],
+00020a90: 202d 7069 7865 6c5f 7370 6163 696e 6729   -pixel_spacing)
+00020aa0: 0d0a 2020 2020 2320 2020 2020 2320 7365  ..    #     # se
+00020ab0: 7420 7468 6520 6765 6f74 7261 6e73 666f  t the geotransfo
+00020ac0: 726d 0d0a 2020 2020 2320 2020 2020 6473  rm..    #     ds
+00020ad0: 742e 5365 7447 656f 5472 616e 7366 6f72  t.SetGeoTransfor
+00020ae0: 6d28 6e65 775f 6765 6f29 0d0a 2020 2020  m(new_geo)..    
+00020af0: 2320 2020 2020 2320 7365 7420 7468 6520  #     # set the 
+00020b00: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
+00020b10: 2320 2020 2020 6473 742e 5365 7450 726f  #     dst.SetPro
+00020b20: 6a65 6374 696f 6e28 6473 745f 6570 7367  jection(dst_epsg
+00020b30: 2e45 7870 6f72 7454 6f57 6b74 2829 290d  .ExportToWkt()).
+00020b40: 0a20 2020 2023 2020 2020 2023 2073 6574  .    #     # set
+00020b50: 2074 6865 206e 6f20 6461 7461 2076 616c   the no data val
+00020b60: 7565 0d0a 2020 2020 2320 2020 2020 6e6f  ue..    #     no
+00020b70: 5f64 6174 615f 7661 6c75 6520 3d20 7372  _data_value = sr
+00020b80: 632e 4765 7452 6173 7465 7242 616e 6428  c.GetRasterBand(
+00020b90: 3129 2e47 6574 4e6f 4461 7461 5661 6c75  1).GetNoDataValu
+00020ba0: 6528 290d 0a20 2020 2023 2020 2020 2064  e()..    #     d
+00020bb0: 7374 203d 2044 6174 6173 6574 2e5f 7365  st = Dataset._se
+00020bc0: 745f 6e6f 5f64 6174 615f 7661 6c75 6528  t_no_data_value(
+00020bd0: 6473 742c 206e 6f5f 6461 7461 5f76 616c  dst, no_data_val
+00020be0: 7565 290d 0a20 2020 2023 2020 2020 2023  ue)..    #     #
+00020bf0: 2070 6572 666f 726d 2074 6865 2070 726f   perform the pro
+00020c00: 6a65 6374 696f 6e20 2620 7265 7361 6d70  jection & resamp
+00020c10: 6c69 6e67 0d0a 2020 2020 2320 2020 2020  ling..    #     
+00020c20: 6764 616c 2e52 6570 726f 6a65 6374 496d  gdal.ReprojectIm
+00020c30: 6167 6528 0d0a 2020 2020 2320 2020 2020  age(..    #     
+00020c40: 2020 2020 7372 632c 2064 7374 2c20 7372      src, dst, sr
+00020c50: 635f 7372 2e45 7870 6f72 7454 6f57 6b74  c_sr.ExportToWkt
+00020c60: 2829 2c20 6473 745f 6570 7367 2e45 7870  (), dst_epsg.Exp
+00020c70: 6f72 7454 6f57 6b74 2829 2c20 6d65 7468  ortToWkt(), meth
+00020c80: 6f64 0d0a 2020 2020 2320 2020 2020 290d  od..    #     ).
+00020c90: 0a20 2020 2023 0d0a 2020 2020 2320 2020  .    #..    #   
+00020ca0: 2020 7265 7475 726e 2064 7374 0d0a 0d0a    return dst....
+00020cb0: 2020 2020 6465 6620 616c 6967 6e28 7365      def align(se
+00020cc0: 6c66 2c20 616c 6967 6e6d 656e 745f 7372  lf, alignment_sr
+00020cd0: 633a 2044 6174 6173 6574 293a 0d0a 2020  c: Dataset):..  
+00020ce0: 2020 2020 2020 2222 226d 6174 6368 4461        """matchDa
+00020cf0: 7461 416c 6967 6e6d 656e 742e 0d0a 0d0a  taAlignment.....
+00020d00: 2020 2020 2020 2020 7468 6973 2066 756e          this fun
+00020d10: 6374 696f 6e20 6d61 7463 6865 7320 7468  ction matches th
+00020d20: 6520 636f 6f72 6469 6e61 7465 2073 7973  e coordinate sys
+00020d30: 7465 6d20 616e 6420 7468 6520 6e75 6d62  tem and the numb
+00020d40: 6572 206f 6620 6f66 2072 6f77 7320 2620  er of of rows & 
+00020d50: 636f 6c75 6d6e 730d 0a20 2020 2020 2020  columns..       
+00020d60: 2062 6574 7765 656e 2074 776f 2072 6173   between two ras
+00020d70: 7465 7273 0d0a 2020 2020 2020 2020 5261  ters..        Ra
+00020d80: 7374 6572 2041 2069 7320 7468 6520 736f  ster A is the so
+00020d90: 7572 6365 206f 6620 7468 6520 636f 6f72  urce of the coor
+00020da0: 6469 6e61 7465 2073 7973 7465 6d2c 206e  dinate system, n
+00020db0: 6f20 6f66 2072 6f77 7320 616e 6420 6e6f  o of rows and no
+00020dc0: 206f 6620 636f 6c75 6d6e 7320 2620 6365   of columns & ce
+00020dd0: 6c6c 2073 697a 650d 0a20 2020 2020 2020  ll size..       
+00020de0: 2072 6173 7465 7273 5f64 6972 2069 7320   rasters_dir is 
+00020df0: 7061 7468 2074 6f20 7468 6520 666f 6c64  path to the fold
+00020e00: 6572 2077 6865 7265 2052 6173 7465 7220  er where Raster 
+00020e10: 4220 6578 6973 7420 7768 6572 6520 2052  B exist where  R
+00020e20: 6173 7465 7220 4220 6973 0d0a 2020 2020  aster B is..    
+00020e30: 2020 2020 7468 6520 736f 7572 6365 206f      the source o
+00020e40: 6620 6461 7461 2076 616c 7565 7320 696e  f data values in
+00020e50: 2063 656c 6c73 0d0a 2020 2020 2020 2020   cells..        
+00020e60: 7468 6520 7265 7375 6c74 2077 696c 6c20  the result will 
+00020e70: 6265 2061 2072 6173 7465 7220 7769 7468  be a raster with
+00020e80: 2074 6865 2073 616d 6520 7374 7275 6374   the same struct
+00020e90: 7572 6520 6c69 6b65 2052 6173 7465 7241  ure like RasterA
+00020ea0: 2062 7574 2077 6974 680d 0a20 2020 2020   but with..     
+00020eb0: 2020 2076 616c 7565 7320 6672 6f6d 2052     values from R
+00020ec0: 6173 7465 7242 2075 7369 6e67 204e 6561  asterB using Nea
+00020ed0: 7265 7374 204e 6569 6768 626f 7572 2069  rest Neighbour i
+00020ee0: 6e74 6572 706f 6c61 7469 6f6e 2061 6c67  nterpolation alg
+00020ef0: 6f72 6974 686d 0d0a 0d0a 2020 2020 2020  orithm....      
+00020f00: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00020f10: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00020f20: 0d0a 2020 2020 2020 2020 616c 6967 6e6d  ..        alignm
+00020f30: 656e 745f 7372 633a 205b 5374 7269 6e67  ent_src: [String
+00020f40: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
+00020f50: 6174 6820 746f 2074 6865 2073 7061 7469  ath to the spati
+00020f60: 616c 2069 6e66 6f72 6d61 7469 6f6e 2073  al information s
+00020f70: 6f75 7263 6520 7261 7374 6572 2074 6f20  ource raster to 
+00020f80: 6765 7420 7468 6520 7370 6174 6961 6c20  get the spatial 
+00020f90: 696e 666f 726d 6174 696f 6e0d 0a20 2020  information..   
+00020fa0: 2020 2020 2020 2020 2028 636f 6f72 6469           (coordi
+00020fb0: 6e61 7465 2073 7973 7465 6d2c 206e 6f20  nate system, no 
+00020fc0: 6f66 2072 6f77 7320 2620 636f 6c75 6d6e  of rows & column
+00020fd0: 7329 2061 6c69 676e 6d65 6e74 5f73 7263  s) alignment_src
+00020fe0: 2073 686f 756c 6420 696e 636c 7564 6520   should include 
+00020ff0: 7468 6520 6e61 6d65 206f 6620 7468 6520  the name of the 
+00021000: 7261 7374 6572 0d0a 2020 2020 2020 2020  raster..        
+00021010: 2020 2020 616e 6420 7468 6520 6578 7465      and the exte
+00021020: 6e73 696f 6e20 6c69 6b65 2022 6461 7461  nsion like "data
+00021030: 2f64 656d 2e74 6966 220d 0a0d 0a20 2020  /dem.tif"....   
+00021040: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00021050: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00021060: 2020 2020 2020 206e 6577 2072 6173 7465         new raste
+00021070: 7273 3a0d 0a20 2020 2020 2020 2020 2020  rs:..           
+00021080: 20d9 8c52 6173 7465 7273 2068 6176 6520   ..Rasters have 
+00021090: 7468 6520 7661 6c75 6573 2066 726f 6d20  the values from 
+000210a0: 7261 7374 6572 7320 696e 2072 6173 7465  rasters in raste
+000210b0: 7273 5f64 6972 2077 6974 6820 7468 6520  rs_dir with the 
+000210c0: 7361 6d65 0d0a 2020 2020 2020 2020 2020  same..          
+000210d0: 2020 6365 6c6c 2073 697a 652c 206e 6f20    cell size, no 
+000210e0: 6f66 2072 6f77 7320 2620 636f 6c75 6d6e  of rows & column
+000210f0: 732c 2063 6f6f 7264 696e 6174 6520 7379  s, coordinate sy
+00021100: 7374 656d 2061 6e64 2061 6c69 676e 6d65  stem and alignme
+00021110: 6e74 206c 696b 6520 7261 7374 6572 2041  nt like raster A
+00021120: 0d0a 0d0a 2020 2020 2020 2020 4578 616d  ....        Exam
+00021130: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
+00021140: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00021150: 3e3e 3e20 6465 6d5f 7061 7468 203d 2022  >>> dem_path = "
+00021160: 3031 4749 532f 696e 7075 7473 2f34 3030  01GIS/inputs/400
+00021170: 302f 6163 6334 3030 302e 7469 6622 0d0a  0/acc4000.tif"..
+00021180: 2020 2020 2020 2020 3e3e 3e20 7072 6563          >>> prec
+00021190: 5f69 6e5f 7061 7468 203d 2022 3032 5072  _in_path = "02Pr
+000211a0: 6563 6970 6974 6174 696f 6e2f 4348 4952  ecipitation/CHIR
+000211b0: 5053 2f44 6169 6c79 2f22 0d0a 2020 2020  PS/Daily/"..    
+000211c0: 2020 2020 3e3e 3e20 7072 6563 5f6f 7574      >>> prec_out
+000211d0: 5f70 6174 6820 3d20 2230 3250 7265 6369  _path = "02Preci
+000211e0: 7069 7461 7469 6f6e 2f34 6b6d 2f22 0d0a  pitation/4km/"..
+000211f0: 2020 2020 2020 2020 3e3e 3e20 4461 7461          >>> Data
+00021200: 7365 742e 616c 6967 6e28 6465 6d5f 7061  set.align(dem_pa
+00021210: 7468 2c70 7265 635f 696e 5f70 6174 682c  th,prec_in_path,
+00021220: 7072 6563 5f6f 7574 5f70 6174 6829 0d0a  prec_out_path)..
+00021230: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00021240: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00021250: 7374 616e 6365 2861 6c69 676e 6d65 6e74  stance(alignment
+00021260: 5f73 7263 2c20 4461 7461 7365 7429 3a0d  _src, Dataset):.
+00021270: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00021280: 7365 2054 7970 6545 7272 6f72 2822 616c  se TypeError("al
+00021290: 6967 6e6d 656e 745f 7372 6320 696e 7075  ignment_src inpu
+000212a0: 7420 7368 6f75 6c64 2062 6520 6120 4461  t should be a Da
+000212b0: 7461 7365 7420 6f62 6a65 6374 2229 0d0a  taset object")..
+000212c0: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+000212d0: 696e 2072 616e 6765 2873 656c 662e 7469  in range(self.ti
+000212e0: 6d65 5f6c 656e 6774 6829 3a0d 0a20 2020  me_length):..   
+000212f0: 2020 2020 2020 2020 2073 7263 203d 2073           src = s
+00021300: 656c 662e 696c 6f63 2869 290d 0a20 2020  elf.iloc(i)..   
+00021310: 2020 2020 2020 2020 2064 7374 203d 2073           dst = s
+00021320: 7263 2e61 6c69 676e 2861 6c69 676e 6d65  rc.align(alignme
+00021330: 6e74 5f73 7263 290d 0a20 2020 2020 2020  nt_src)..       
+00021340: 2020 2020 2061 7272 203d 2064 7374 2e72       arr = dst.r
+00021350: 6561 645f 6172 7261 7928 290d 0a20 2020  ead_array()..   
+00021360: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
+00021370: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+00021380: 2020 2020 2023 2063 7265 6174 6520 7468       # create th
+00021390: 6520 6172 7261 790d 0a20 2020 2020 2020  e array..       
+000213a0: 2020 2020 2020 2020 2061 7272 6179 203d           array =
+000213b0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+000213c0: 2020 2020 2020 2020 6e70 2e6f 6e65 7328          np.ones(
+000213d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000213e0: 2020 2020 2020 2020 2020 280d 0a20 2020            (..   
+000213f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021400: 2020 2020 2020 2020 2073 656c 662e 7469           self.ti
+00021410: 6d65 5f6c 656e 6774 682c 0d0a 2020 2020  me_length,..    
+00021420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021430: 2020 2020 2020 2020 6172 722e 7368 6170          arr.shap
+00021440: 655b 305d 2c0d 0a20 2020 2020 2020 2020  e[0],..         
+00021450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021460: 2020 2061 7272 2e73 6861 7065 5b31 5d2c     arr.shape[1],
+00021470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021480: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00021490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214a0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+000214b0: 2020 2020 2020 2020 2a20 6e70 2e6e 616e          * np.nan
+000214c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000214d0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+000214e0: 2061 7272 6179 5b69 2c20 3a2c 203a 5d20   array[i, :, :] 
+000214f0: 3d20 6172 720d 0a0d 0a20 2020 2020 2020  = arr....       
+00021500: 2073 656c 662e 5f64 6174 6120 3d20 6172   self._data = ar
+00021510: 7261 790d 0a20 2020 2020 2020 2023 2075  ray..        # u
+00021520: 7365 2074 6865 206c 6173 7420 7372 6320  se the last src 
+00021530: 6173 0d0a 2020 2020 2020 2020 7365 6c66  as..        self
+00021540: 2e5f 6261 7365 203d 2064 7374 0d0a 0d0a  ._base = dst....
+00021550: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00021560: 640d 0a20 2020 2064 6566 206d 6572 6765  d..    def merge
+00021570: 280d 0a20 2020 2020 2020 2073 7263 3a20  (..        src: 
+00021580: 4c69 7374 5b73 7472 5d2c 0d0a 2020 2020  List[str],..    
+00021590: 2020 2020 6473 743a 2073 7472 2c0d 0a20      dst: str,.. 
+000215a0: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
+000215b0: 616c 7565 3a20 556e 696f 6e5b 666c 6f61  alue: Union[floa
+000215c0: 742c 2069 6e74 2c20 7374 725d 203d 2022  t, int, str] = "
+000215d0: 3022 2c0d 0a20 2020 2020 2020 2069 6e69  0",..        ini
+000215e0: 743a 2055 6e69 6f6e 5b66 6c6f 6174 2c20  t: Union[float, 
+000215f0: 696e 742c 2073 7472 5d20 3d20 226e 616e  int, str] = "nan
+00021600: 222c 0d0a 2020 2020 2020 2020 6e3a 2055  ",..        n: U
+00021610: 6e69 6f6e 5b66 6c6f 6174 2c20 696e 742c  nion[float, int,
+00021620: 2073 7472 5d20 3d20 226e 616e 222c 0d0a   str] = "nan",..
+00021630: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+00021640: 2222 226d 6572 6765 2e0d 0a0d 0a20 2020  """merge.....   
+00021650: 2020 2020 2020 2020 206d 6572 6765 7320           merges 
+00021660: 6772 6f75 7020 6f66 2072 6173 7465 7273  group of rasters
+00021670: 2069 6e74 6f20 6f6e 6520 7261 7374 6572   into one raster
+00021680: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00021690: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+000216a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000216b0: 2020 2020 7372 633a 204c 6973 745b 7374      src: List[st
+000216c0: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
+000216d0: 6c69 7374 206f 6620 7468 6520 7061 7468  list of the path
+000216e0: 2074 6f20 616c 6c20 696e 7075 7420 7261   to all input ra
+000216f0: 7374 6572 0d0a 2020 2020 2020 2020 6473  ster..        ds
+00021700: 743a 205b 7374 725d 0d0a 2020 2020 2020  t: [str]..      
+00021710: 2020 2020 2020 7061 7468 2074 6f20 7468        path to th
+00021720: 6520 6f75 7470 7574 2072 6173 7465 720d  e output raster.
+00021730: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
+00021740: 5f76 616c 7565 3a20 5b66 6c6f 6174 2f69  _value: [float/i
+00021750: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
+00021760: 2041 7373 6967 6e20 6120 7370 6563 6966   Assign a specif
+00021770: 6965 6420 6e6f 6461 7461 2076 616c 7565  ied nodata value
+00021780: 2074 6f20 6f75 7470 7574 2062 616e 6473   to output bands
+00021790: 2e0d 0a20 2020 2020 2020 2069 6e69 743a  ...        init:
+000217a0: 205b 666c 6f61 742f 696e 745d 0d0a 2020   [float/int]..  
+000217b0: 2020 2020 2020 2020 2020 5072 652d 696e            Pre-in
+000217c0: 6974 6961 6c69 7a65 2074 6865 206f 7574  itialize the out
+000217d0: 7075 7420 696d 6167 6520 6261 6e64 7320  put image bands 
+000217e0: 7769 7468 2074 6865 7365 2076 616c 7565  with these value
+000217f0: 732e 2048 6f77 6576 6572 2c20 6974 2069  s. However, it i
+00021800: 7320 6e6f 7420 6d61 726b 6564 2061 7320  s not marked as 
+00021810: 7468 6520 6e6f 6461 7461 2076 616c 7565  the nodata value
+00021820: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+00021830: 2074 6865 206f 7574 7075 7420 6669 6c65   the output file
+00021840: 2e20 4966 206f 6e6c 7920 6f6e 6520 7661  . If only one va
+00021850: 6c75 6520 6973 2067 6976 656e 2c20 7468  lue is given, th
+00021860: 6520 7361 6d65 2076 616c 7565 2069 7320  e same value is 
+00021870: 7573 6564 2069 6e20 616c 6c20 7468 6520  used in all the 
+00021880: 6261 6e64 732e 0d0a 2020 2020 2020 2020  bands...        
+00021890: 6e3a 205b 666c 6f61 742f 696e 745d 0d0a  n: [float/int]..
+000218a0: 2020 2020 2020 2020 2020 2020 4967 6e6f              Igno
+000218b0: 7265 2070 6978 656c 7320 6672 6f6d 2066  re pixels from f
+000218c0: 696c 6573 2062 6569 6e67 206d 6572 6765  iles being merge
+000218d0: 6420 696e 2077 6974 6820 7468 6973 2070  d in with this p
+000218e0: 6978 656c 2076 616c 7565 2e0d 0a0d 0a20  ixel value..... 
+000218f0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+00021900: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00021910: 0a20 2020 2020 2020 204e 6f6e 650d 0a20  .        None.. 
+00021920: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00021930: 2020 2020 2320 7275 6e20 7468 6520 636f      # run the co
+00021940: 6d6d 616e 640d 0a20 2020 2020 2020 2023  mmand..        #
+00021950: 2063 6d64 203d 2022 6764 616c 5f6d 6572   cmd = "gdal_mer
+00021960: 6765 2e70 7920 2d6f 206d 6572 6765 645f  ge.py -o merged_
+00021970: 696d 6167 655f 312e 7469 6622 0d0a 2020  image_1.tif"..  
+00021980: 2020 2020 2020 2320 7375 6270 726f 6365        # subproce
+00021990: 7373 2e63 616c 6c28 636d 642e 7370 6c69  ss.call(cmd.spli
+000219a0: 7428 2920 2b20 6669 6c65 5f6c 6973 7429  t() + file_list)
+000219b0: 0d0a 2020 2020 2020 2020 2320 7672 7420  ..        # vrt 
+000219c0: 3d20 6764 616c 2e42 7569 6c64 5652 5428  = gdal.BuildVRT(
+000219d0: 226d 6572 6765 642e 7672 7422 2c20 6669  "merged.vrt", fi
+000219e0: 6c65 5f6c 6973 7429 0d0a 2020 2020 2020  le_list)..      
+000219f0: 2020 2320 7372 6320 3d20 6764 616c 2e54    # src = gdal.T
+00021a00: 7261 6e73 6c61 7465 2822 6d65 7267 6564  ranslate("merged
+00021a10: 5f69 6d61 6765 2e74 6966 222c 2076 7274  _image.tif", vrt
+00021a20: 290d 0a0d 0a20 2020 2020 2020 2070 6172  )....        par
+00021a30: 616d 6574 6572 7320 3d20 280d 0a20 2020  ameters = (..   
+00021a40: 2020 2020 2020 2020 205b 2222 2c20 222d           ["", "-
+00021a50: 6f22 2c20 6473 745d 0d0a 2020 2020 2020  o", dst]..      
+00021a60: 2020 2020 2020 2b20 7372 630d 0a20 2020        + src..   
+00021a70: 2020 2020 2020 2020 202b 205b 0d0a 2020           + [..  
+00021a80: 2020 2020 2020 2020 2020 2020 2020 222d                "-
+00021a90: 636f 222c 0d0a 2020 2020 2020 2020 2020  co",..          
+00021aa0: 2020 2020 2020 2243 4f4d 5052 4553 533d        "COMPRESS=
+00021ab0: 4c5a 5722 2c0d 0a20 2020 2020 2020 2020  LZW",..         
+00021ac0: 2020 2020 2020 2022 2d69 6e69 7422 2c0d         "-init",.
+00021ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021ae0: 2073 7472 2869 6e69 7429 2c0d 0a20 2020   str(init),..   
+00021af0: 2020 2020 2020 2020 2020 2020 2022 2d61               "-a
+00021b00: 5f6e 6f64 6174 6122 2c0d 0a20 2020 2020  _nodata",..     
+00021b10: 2020 2020 2020 2020 2020 2073 7472 286e             str(n
+00021b20: 6f5f 6461 7461 5f76 616c 7565 292c 0d0a  o_data_value),..
+00021b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b40: 222d 6e22 2c0d 0a20 2020 2020 2020 2020  "-n",..         
+00021b50: 2020 2020 2020 2073 7472 286e 292c 0d0a         str(n),..
+00021b60: 2020 2020 2020 2020 2020 2020 5d0d 0a20              ].. 
+00021b70: 2020 2020 2020 2029 2020 2320 272d 7365         )  # '-se
+00021b80: 7061 7261 7465 270d 0a20 2020 2020 2020  parate'..       
+00021b90: 2067 6461 6c5f 6d65 7267 652e 6d61 696e   gdal_merge.main
+00021ba0: 2870 6172 616d 6574 6572 7329 0d0a 0d0a  (parameters)....
+00021bb0: 2020 2020 6465 6620 6170 706c 7928 7365      def apply(se
+00021bc0: 6c66 2c20 7566 756e 633a 2043 616c 6c61  lf, ufunc: Calla
+00021bd0: 626c 6529 3a0d 0a20 2020 2020 2020 2022  ble):..        "
+00021be0: 2222 666f 6c64 6572 4361 6c63 756c 6174  ""folderCalculat
+00021bf0: 6f72 2e0d 0a0d 0a20 2020 2020 2020 2074  or.....        t
+00021c00: 6869 7320 6675 6e63 7469 6f6e 206d 6174  his function mat
+00021c10: 6368 6573 2074 6865 206c 6f63 6174 696f  ches the locatio
+00021c20: 6e20 6f66 206e 6f64 6174 6120 7661 6c75  n of nodata valu
+00021c30: 6520 6672 6f6d 2073 7263 2072 6173 7465  e from src raste
+00021c40: 7220 746f 2064 7374 0d0a 2020 2020 2020  r to dst..      
+00021c50: 2020 7261 7374 6572 0d0a 2020 2020 2020    raster..      
+00021c60: 2020 4461 7461 7365 7420 4120 6973 2077    Dataset A is w
+00021c70: 6865 7265 2074 6865 204e 6f44 6174 6176  here the NoDatav
+00021c80: 616c 7565 2077 696c 6c20 6265 2074 616b  alue will be tak
+00021c90: 656e 2061 6e64 2074 6865 206c 6f63 6174  en and the locat
+00021ca0: 696f 6e20 6f66 2074 6869 7320 7661 6c75  ion of this valu
+00021cb0: 650d 0a20 2020 2020 2020 2042 5f69 6e70  e..        B_inp
+00021cc0: 7574 5f70 6174 6820 6973 2070 6174 6820  ut_path is path 
+00021cd0: 746f 2074 6865 2066 6f6c 6465 7220 7768  to the folder wh
+00021ce0: 6572 6520 4461 7461 7365 7420 4220 6578  ere Dataset B ex
+00021cf0: 6973 7420 7768 6572 6520 2077 6520 6e65  ist where  we ne
+00021d00: 6564 2074 6f20 7075 740d 0a20 2020 2020  ed to put..     
+00021d10: 2020 2074 6865 204e 6f44 6174 6156 616c     the NoDataVal
+00021d20: 7565 206f 6620 5261 7374 6572 4120 696e  ue of RasterA in
+00021d30: 2052 6173 7465 7242 2061 7420 7468 6520   RasterB at the 
+00021d40: 7361 6d65 206c 6f63 6174 696f 6e73 0d0a  same locations..
+00021d50: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00021d60: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00021d70: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00021d80: 2020 7566 756e 633a 205b 6675 6e63 7469    ufunc: [functi
+00021d90: 6f6e 5d0d 0a20 2020 2020 2020 2020 2020  on]..           
+00021da0: 2063 616c 6c61 626c 6520 756e 6976 6572   callable univer
+00021db0: 7361 6c20 6675 6e63 7469 6f6e 2075 6675  sal function ufu
+00021dc0: 6e63 2028 6275 696c 7469 6e20 6f72 2075  nc (builtin or u
+00021dd0: 7365 7220 6465 6669 6e65 6429 0d0a 2020  ser defined)..  
+00021de0: 2020 2020 2020 2020 2020 6874 7470 733a            https:
+00021df0: 2f2f 6e75 6d70 792e 6f72 672f 646f 632f  //numpy.org/doc/
+00021e00: 7374 6162 6c65 2f72 6566 6572 656e 6365  stable/reference
+00021e10: 2f75 6675 6e63 732e 6874 6d6c 0d0a 2020  /ufuncs.html..  
+00021e20: 2020 2020 2020 2020 2020 2d20 746f 2063            - to c
+00021e30: 7265 6174 6520 6120 7566 756e 6320 6672  reate a ufunc fr
+00021e40: 6f6d 2061 206e 6f72 6d61 6c20 6675 6e63  om a normal func
+00021e50: 7469 6f6e 2028 6874 7470 733a 2f2f 6e75  tion (https://nu
+00021e60: 6d70 792e 6f72 672f 646f 632f 7374 6162  mpy.org/doc/stab
+00021e70: 6c65 2f72 6566 6572 656e 6365 2f67 656e  le/reference/gen
+00021e80: 6572 6174 6564 2f6e 756d 7079 2e66 726f  erated/numpy.fro
+00021e90: 6d70 7966 756e 632e 6874 6d6c 290d 0a0d  mpyfunc.html)...
+00021ea0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00021eb0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00021ec0: 2d0d 0a20 2020 2020 2020 206e 6577 2072  -..        new r
+00021ed0: 6173 7465 7273 2077 696c 6c20 6265 2073  asters will be s
+00021ee0: 6176 6564 2074 6f20 7468 6520 7361 7665  aved to the save
+00021ef0: 5f74 6f0d 0a0d 0a20 2020 2020 2020 2045  _to....        E
+00021f00: 7861 6d70 6c65 730d 0a20 2020 2020 2020  xamples..       
+00021f10: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
+00021f20: 2020 203e 3e3e 2064 6566 2066 756e 6328     >>> def func(
+00021f30: 7661 6c29 3a0d 0a20 2020 2020 2020 203e  val):..        >
+00021f40: 3e3e 2020 2020 7265 7475 726e 2076 616c  >>    return val
+00021f50: 2532 0d0a 2020 2020 2020 2020 3e3e 3e20  %2..        >>> 
+00021f60: 7566 756e 6320 3d20 6e70 2e66 726f 6d70  ufunc = np.fromp
+00021f70: 7966 756e 6328 6675 6e63 2c20 312c 2031  yfunc(func, 1, 1
+00021f80: 290d 0a20 2020 2020 2020 203e 3e3e 2064  )..        >>> d
+00021f90: 6174 6173 6574 2e61 7070 6c79 2875 6675  ataset.apply(ufu
+00021fa0: 6e63 290d 0a20 2020 2020 2020 2022 2222  nc)..        """
+00021fb0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00021fc0: 2063 616c 6c61 626c 6528 7566 756e 6329   callable(ufunc)
+00021fd0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00021fe0: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+00021ff0: 7365 636f 6e64 2061 7267 756d 656e 7420  second argument 
+00022000: 7368 6f75 6c64 2062 6520 6120 6675 6e63  should be a func
+00022010: 7469 6f6e 2229 0d0a 2020 2020 2020 2020  tion")..        
+00022020: 6172 7220 3d20 7365 6c66 2e64 6174 610d  arr = self.data.
+00022030: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
+00022040: 5f76 616c 7565 203d 2073 656c 662e 6261  _value = self.ba
+00022050: 7365 2e6e 6f5f 6461 7461 5f76 616c 7565  se.no_data_value
+00022060: 5b30 5d0d 0a20 2020 2020 2020 2023 2065  [0]..        # e
+00022070: 7865 6375 7465 2074 6865 2066 756e 6374  xecute the funct
+00022080: 696f 6e20 6f6e 2065 6163 6820 7261 7374  ion on each rast
+00022090: 6572 0d0a 2020 2020 2020 2020 6172 725b  er..        arr[
+000220a0: 7e6e 702e 6973 636c 6f73 6528 6172 722c  ~np.isclose(arr,
+000220b0: 206e 6f5f 6461 7461 5f76 616c 7565 2c20   no_data_value, 
+000220c0: 7274 6f6c 3d30 2e30 3031 295d 203d 2075  rtol=0.001)] = u
+000220d0: 6675 6e63 280d 0a20 2020 2020 2020 2020  func(..         
+000220e0: 2020 2061 7272 5b7e 6e70 2e69 7363 6c6f     arr[~np.isclo
+000220f0: 7365 2861 7272 2c20 6e6f 5f64 6174 615f  se(arr, no_data_
+00022100: 7661 6c75 652c 2072 746f 6c3d 302e 3030  value, rtol=0.00
+00022110: 3129 5d0d 0a20 2020 2020 2020 2029 0d0a  1)]..        )..
+00022120: 0d0a 2020 2020 6465 6620 6f76 6572 6c61  ..    def overla
+00022130: 7928 0d0a 2020 2020 2020 2020 7365 6c66  y(..        self
+00022140: 2c0d 0a20 2020 2020 2020 2063 6c61 7373  ,..        class
+00022150: 6573 5f6d 6170 2c0d 0a20 2020 2020 2020  es_map,..       
+00022160: 2065 7863 6c75 6465 5f76 616c 7565 3a20   exclude_value: 
+00022170: 556e 696f 6e5b 666c 6f61 742c 2069 6e74  Union[float, int
+00022180: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2029  ] = None,..    )
+00022190: 202d 3e20 4469 6374 5b4c 6973 745b 666c   -> Dict[List[fl
+000221a0: 6f61 745d 2c20 4c69 7374 5b66 6c6f 6174  oat], List[float
+000221b0: 5d5d 3a0d 0a20 2020 2020 2020 2022 2222  ]]:..        """
+000221c0: 7468 6973 2066 756e 6374 696f 6e20 6973  this function is
+000221d0: 2077 7269 7474 656e 2074 6f20 6578 7472   written to extr
+000221e0: 6163 7420 616e 6420 7265 7475 726e 2061  act and return a
+000221f0: 206c 6973 7420 6f66 2061 6c6c 2074 6865   list of all the
+00022200: 2076 616c 7565 7320 696e 2061 6e20 4153   values in an AS
+00022210: 4349 4920 6669 6c65 2e0d 0a0d 0a20 2020  CII file.....   
+00022220: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00022230: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00022240: 2d2d 2d0d 0a20 2020 2020 2020 2063 6c61  ---..        cla
+00022250: 7373 6573 5f6d 6170 3a20 5b44 6174 6173  sses_map: [Datas
+00022260: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
+00022270: 2044 6174 6173 6574 204f 626a 6563 7420   Dataset Object 
+00022280: 6670 7220 7468 6520 7261 7374 6572 2074  fpr the raster t
+00022290: 6861 7420 6861 7665 2063 6c61 7373 6573  hat have classes
+000222a0: 2079 6f75 2077 616e 7420 746f 206f 7665   you want to ove
+000222b0: 726c 6179 2077 6974 6820 7468 6520 7261  rlay with the ra
+000222c0: 7374 6572 2e0d 0a20 2020 2020 2020 2065  ster...        e
+000222d0: 7863 6c75 6465 5f76 616c 7565 3a20 5b4e  xclude_value: [N
+000222e0: 756d 6572 6963 5d0d 0a20 2020 2020 2020  umeric]..       
+000222f0: 2020 2020 2076 616c 7565 7320 796f 7520       values you 
+00022300: 7761 6e74 2074 6f20 6578 636c 7564 6520  want to exclude 
+00022310: 6672 6f6d 2065 7874 7261 6374 6564 2076  from extracted v
+00022320: 616c 7565 732e 0d0a 0d0a 2020 2020 2020  alues.....      
+00022330: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00022340: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00022350: 2020 2020 4469 6374 696f 6e61 7279 3a0d      Dictionary:.
+00022360: 0a20 2020 2020 2020 2020 2020 2064 6963  .            dic
+00022370: 746f 6e61 7279 2077 6974 6820 6120 6c69  tonary with a li
+00022380: 7374 206f 6620 7661 6c75 6573 2069 6e20  st of values in 
+00022390: 7468 6520 6261 7365 6d61 7020 6173 206b  the basemap as k
+000223a0: 6579 7320 616e 6420 666f 7220 6561 6368  eys and for each
+000223b0: 206b 6579 2061 206c 6973 7420 6f66 2061   key a list of a
+000223c0: 6c6c 2074 6865 2069 6e74 6572 7365 6374  ll the intersect
+000223d0: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
+000223e0: 7661 6c75 6573 2069 6e20 7468 6520 6d61  values in the ma
+000223f0: 7073 2066 726f 6d20 7468 6520 7061 7468  ps from the path
+00022400: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00022410: 2020 2020 2020 2020 7661 6c75 6573 203d          values =
+00022420: 207b 7d0d 0a20 2020 2020 2020 2066 6f72   {}..        for
+00022430: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
+00022440: 2e74 696d 655f 6c65 6e67 7468 293a 0d0a  .time_length):..
+00022450: 2020 2020 2020 2020 2020 2020 7372 6320              src 
+00022460: 3d20 7365 6c66 2e69 6c6f 6328 6929 0d0a  = self.iloc(i)..
+00022470: 2020 2020 2020 2020 2020 2020 6469 6374              dict
+00022480: 5f69 203d 2073 7263 2e6f 7665 726c 6179  _i = src.overlay
+00022490: 2863 6c61 7373 6573 5f6d 6170 2c20 6578  (classes_map, ex
+000224a0: 636c 7564 655f 7661 6c75 6529 0d0a 0d0a  clude_value)....
+000224b0: 2020 2020 2020 2020 2020 2020 2320 7468              # th
+000224c0: 6573 6520 6172 6520 7468 6520 6465 7374  ese are the dest
+000224d0: 696e 6374 2076 616c 7565 7320 6672 6f6d  inct values from
+000224e0: 2074 6865 2042 6173 654d 6170 2077 6869   the BaseMap whi
+000224f0: 6368 2061 7265 206b 6579 7320 696e 2074  ch are keys in t
+00022500: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
+00022510: 2320 4578 7472 6163 7465 6456 616c 7565  # ExtractedValue
+00022520: 7369 2064 6963 7420 7769 7468 2065 6163  si dict with eac
+00022530: 6820 6f6e 6520 6861 7669 6e67 2061 206c  h one having a l
+00022540: 6973 7420 6f66 2076 616c 7565 730d 0a20  ist of values.. 
+00022550: 2020 2020 2020 2020 2020 2063 6c61 7373             class
+00022560: 6573 203d 206c 6973 7428 6469 6374 5f69  es = list(dict_i
+00022570: 2e6b 6579 7328 2929 0d0a 0d0a 2020 2020  .keys())....    
+00022580: 2020 2020 2020 2020 666f 7220 636c 6173          for clas
+00022590: 735f 6920 696e 2063 6c61 7373 6573 3a0d  s_i in classes:.
+000225a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000225b0: 2069 6620 636c 6173 735f 6920 6e6f 7420   if class_i not 
+000225c0: 696e 2076 616c 7565 732e 6b65 7973 2829  in values.keys()
+000225d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000225e0: 2020 2020 2020 2076 616c 7565 735b 636c         values[cl
+000225f0: 6173 735f 695d 203d 206c 6973 7428 290d  ass_i] = list().
+00022600: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00022610: 2020 2076 616c 7565 735b 636c 6173 735f     values[class_
+00022620: 695d 203d 2076 616c 7565 735b 636c 6173  i] = values[clas
+00022630: 735f 695d 202b 2064 6963 745f 695b 636c  s_i] + dict_i[cl
+00022640: 6173 735f 695d 0d0a 0d0a 2020 2020 2020  ass_i]....      
+00022650: 2020 7265 7475 726e 2076 616c 7565 730d    return values.
+00022660: 0a0d 0a20 2020 2023 2040 7374 6174 6963  ...    # @static
+00022670: 6d65 7468 6f64 0d0a 2020 2020 2320 6465  method..    # de
+00022680: 6620 7265 6164 4e43 280d 0a20 2020 2023  f readNC(..    #
+00022690: 2020 2020 2020 2020 2070 6174 682c 0d0a           path,..
+000226a0: 2020 2020 2320 2020 2020 2020 2020 7361      #         sa
+000226b0: 7665 5f74 6f3a 2073 7472 2c0d 0a20 2020  ve_to: str,..   
+000226c0: 2023 2020 2020 2020 2020 2073 6570 6172   #         separ
+000226d0: 6174 6f72 3a20 7374 7220 3d20 225f 222c  ator: str = "_",
+000226e0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+000226f0: 7469 6d65 5f76 6172 5f6e 616d 653a 2073  time_var_name: s
+00022700: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
+00022710: 2320 2020 2020 2020 2020 7072 6566 6978  #         prefix
+00022720: 3a20 7374 7220 3d20 4e6f 6e65 2c0d 0a20  : str = None,.. 
+00022730: 2020 2023 2029 3a0d 0a20 2020 2023 0d0a     # ):..    #..
+00022740: 2020 2020 2320 2020 2020 6966 2069 7369      #     if isi
+00022750: 6e73 7461 6e63 6528 7061 7468 2c20 7374  nstance(path, st
+00022760: 7229 3a0d 0a20 2020 2023 2020 2020 2020  r):..    #      
+00022770: 2020 206e 6320 3d20 6e65 7443 4446 342e     nc = netCDF4.
+00022780: 4461 7461 6375 6265 2870 6174 6829 0d0a  Datacube(path)..
+00022790: 2020 2020 2320 2020 2020 656c 6966 2069      #     elif i
+000227a0: 7369 6e73 7461 6e63 6528 7061 7468 2c20  sinstance(path, 
+000227b0: 6c69 7374 293a 0d0a 2020 2020 2320 2020  list):..    #   
+000227c0: 2020 2020 2020 6e63 203d 206e 6574 4344        nc = netCD
+000227d0: 4634 2e4d 4644 6174 6173 6574 2870 6174  F4.MFDataset(pat
+000227e0: 6829 0d0a 2020 2020 2320 2020 2020 656c  h)..    #     el
+000227f0: 7365 3a0d 0a20 2020 2023 2020 2020 2020  se:..    #      
+00022800: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00022810: 6f72 280d 0a20 2020 2023 2020 2020 2020  or(..    #      
+00022820: 2020 2020 2020 2022 4669 7273 7420 7061         "First pa
+00022830: 7261 6d65 7465 7220 746f 2074 6865 206e  rameter to the n
+00022840: 6374 6f54 6966 6620 6675 6e63 7469 6f6e  ctoTiff function
+00022850: 2073 686f 756c 6420 6265 2065 6974 6865   should be eithe
+00022860: 7220 7374 7220 6f72 206c 6973 7422 0d0a  r str or list"..
+00022870: 2020 2020 2320 2020 2020 2020 2020 290d      #         ).
+00022880: 0a20 2020 2023 0d0a 2020 2020 2320 2020  .    #..    #   
+00022890: 2020 2320 6765 7420 7468 6520 7661 7269    # get the vari
+000228a0: 6162 6c65 0d0a 2020 2020 2320 2020 2020  able..    #     
+000228b0: 5661 7220 3d20 6c69 7374 286e 632e 7375  Var = list(nc.su
+000228c0: 6273 6574 732e 6b65 7973 2829 295b 2d31  bsets.keys())[-1
+000228d0: 5d0d 0a20 2020 2023 2020 2020 2023 2065  ]..    #     # e
+000228e0: 7874 7261 6374 2074 6865 2064 6174 610d  xtract the data.
+000228f0: 0a20 2020 2023 2020 2020 2064 6174 6173  .    #     datas
+00022900: 6574 203d 206e 635b 5661 725d 0d0a 2020  et = nc[Var]..  
+00022910: 2020 2320 2020 2020 2320 6765 7420 7468    #     # get th
+00022920: 6520 6465 7461 696c 7320 6f66 2074 6865  e details of the
+00022930: 2066 696c 650d 0a20 2020 2023 2020 2020   file..    #    
+00022940: 2067 656f 2c20 6570 7367 2c20 5f2c 205f   geo, epsg, _, _
+00022950: 2c20 7469 6d65 5f6c 656e 2c20 7469 6d65  , time_len, time
+00022960: 5f76 6172 2c20 6e6f 5f64 6174 615f 7661  _var, no_data_va
+00022970: 6c75 652c 2064 6174 6174 7970 6520 3d20  lue, datatype = 
+00022980: 4e43 2e67 6574 4e43 4465 7461 696c 7328  NC.getNCDetails(
+00022990: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+000229a0: 6e63 2c20 7469 6d65 5f76 6172 5f6e 616d  nc, time_var_nam
+000229b0: 653d 7469 6d65 5f76 6172 5f6e 616d 650d  e=time_var_name.
+000229c0: 0a20 2020 2023 2020 2020 2029 0d0a 2020  .    #     )..  
+000229d0: 2020 2320 2020 2020 7072 696e 7428 2273    #     print("s
+000229e0: 7373 2229 0d0a                           ss")..
```

### Comparing `pyramids-gis-0.4.0/pyramids/errors.py` & `pyramids-gis-0.4.1/pyramids/_errors.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.0/pyramids/featurecollection.py` & `pyramids-gis-0.4.1/pyramids/featurecollection.py`

 * *Files 0% similar despite different names*

```diff
@@ -19,16 +19,16 @@
 from osgeo import ogr, osr, gdal
 from osgeo.ogr import DataSource
 from pyproj import Proj, transform
 from shapely.geometry import Point, Polygon, LineString
 from shapely.geometry.multipolygon import MultiPolygon
 from shapely.geometry.multipoint import MultiPoint
 from shapely.geometry.multilinestring import MultiLineString
-from pyramids.utils import Catalog
-from pyramids.errors import DriverNotExistError
+from pyramids._utils import Catalog
+from pyramids._errors import DriverNotExistError
 
 CATALOG = Catalog(raster_driver=False)
 
 
 class FeatureCollection:
     """FeatureCollection.
```

### Comparing `pyramids-gis-0.4.0/pyramids/gdal_drivers.yaml` & `pyramids-gis-0.4.1/pyramids/gdal_drivers.yaml`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.0/pyramids/io.py` & `pyramids-gis-0.4.1/pyramids/_io.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,14 +1,15 @@
 import os
 import zipfile
 import gzip
 import numpy as np
 import warnings
 from osgeo import gdal
-from pyramids.errors import FileFormatNoSupported
+
+from pyramids._errors import FileFormatNoSupported
 
 gdal.UseExceptions()
 
 COMPRESSED_FILES_EXTENSIONS = [".zip", ".gz", ".tar"]
 DOES_NOT_SUPPORT_INTERNAL = [".gz"]
 
 
@@ -23,29 +24,29 @@
 def _is_tar(path: str):
     return path.endswith(".tar") or path.__contains__(".tar")
 
 
 def _get_zip_path(path: str, file_i: int = 0):
     """Get Zip Path.
 
-        - check if the given path contains a .zip in it
-        - if the path contains a zip but does not end with zip (xxxx.zip/1.asc), so the path contains the
-        internal path inside the zip file, so just add the prefix
-        - anything else get the list of the files inside the zip and return the full path to first file.
-
-    Parameters
-    ----------
-    path: [str]
-        path to the zip file.
-    file_i: [int]
-        index to the file inside the compressed file you want to read.
-
-    Returns
-    -------
-    str path to gdal to read the zipped file.
+            - check if the given path contains a .zip in it
+            - if the path contains a zip but does not end with zip (xxxx.zip/1.asc), so the path contains the
+    4        internal path inside the zip file, so just add the prefix
+            - anything else get the list of the files inside the zip and return the full path to first file.
+
+        Parameters
+        ----------
+        path: [str]
+            path to the zip file.
+        file_i: [int]
+            index to the file inside the compressed file you want to read.
+
+        Returns
+        -------
+        str path to gdal to read the zipped file.
     """
     # get list of files inside the compressed file
     if path.__contains__(".zip") and not path.endswith(".zip"):
         vsi_path = f"/vsizip/{path}"
     else:
         zfile = zipfile.ZipFile(path)
         file_list = zfile.namelist()
@@ -199,21 +200,23 @@
             path.endswith(i) for i in DOES_NOT_SUPPORT_INTERNAL
         ):
             raise FileFormatNoSupported(
                 "File format is not supported, if you provided a gzip/7z compressed file with multiple internal "
                 "files. Currently it is not supported to read gzip/7z files with multiple compressed internal "
                 "files"
             )
+        elif str(e).__contains__(" No such file or directory"):
+            raise FileNotFoundError(f"{path} you entered does not exist")
         else:
             raise e
-    if src is None:
-        raise ValueError(
-            f"The raster path: {path} you enter gives a None gdal Object check the read premission, maybe "
-            f"the raster is being used by other software"
-        )
+    # if src is None:
+    #     raise ValueError(
+    #         f"The raster path: {path} you enter gives a None gdal Object check the read premission, maybe "
+    #         f"the raster is being used by other software"
+    #     )
     return src
 
 
 def stringSpace(inp):
     return str(inp) + "  "
```

### Comparing `pyramids-gis-0.4.0/pyramids/ogr_drivers.yaml` & `pyramids-gis-0.4.1/pyramids/ogr_drivers.yaml`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.0/pyramids/utils.py` & `pyramids-gis-0.4.1/pyramids/_utils.py`

 * *Files 18% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 """Utility module"""
 import yaml
 import datetime as dt
 import numpy as np
 from osgeo import gdal, gdal_array, ogr
 from osgeo.gdal import Dataset
-from pyramids.errors import OptionalPackageDoesNontExist
+from pyramids._errors import OptionalPackageDoesNontExist, DriverNotExistError
 from pyramids import __path__
 
 # from urllib.parse import urlparse as parse_url
 
 # mapping between gdal type and ogr field type
 GDAL_OGR_DATA_TYPES = {
     gdal.GDT_Unknown: ogr.OFTInteger,
@@ -161,14 +161,60 @@
         return self.catalog.get(driver)
 
     def get_gdal_name(self, driver: str):
         """Get GDAL name"""
         driver = self.get_driver(driver)
         return driver.get("GDAL Name")
 
+    def get_driver_name_by_extension(self, extension: str):
+        """Get driver by extension.
+
+        Parameters
+        ----------
+        extension: [str]
+            extenstion of the file.
+
+        Returns
+        -------
+        str:
+            Driver name.
+        """
+        try:
+            key = next(
+                key
+                for key, value in self.catalog.items()
+                if value.get("extension") is not None
+                and value.get("extension") == extension
+            )
+        except StopIteration:
+            raise DriverNotExistError(
+                f"The given extension: {extension} is not associated with any driver in the "
+                "driver catalog, if this driver is supported by gdal please open and issue to "
+                "asking for youe extension to be added to the catalog"
+                "https://github.com/Serapieum-of-alex/pyramids/issues/new?assignees=&labels=&template=feature_request.md&title=add%20extension"
+            )
+
+        return key
+
+    def get_driver_by_extension(self, extension):
+        """Get driver by extension.
+
+        Parameters
+        ----------
+        extension: [str]
+            extenstion of the file.
+
+        Returns
+        -------
+        Dict:
+            Driver dictionary
+        """
+        diver_name = self.get_driver_name_by_extension(extension)
+        return self.get_driver(diver_name)
+
     def exists(self, driver: str):
         """check if the driver exist in the catalog"""
         return driver in self.catalog.keys()
 
     def get_extension(self, driver: str):
         """Get driver extension."""
         driver = self.get_driver(driver)
```

### Comparing `pyramids-gis-0.4.0/pyramids_gis.egg-info/PKG-INFO` & `pyramids-gis-0.4.1/pyramids_gis.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyramids-gis
-Version: 0.4.0
+Version: 0.4.1
 Summary: GIS utility package
 Home-page: https://github.com/MAfarrag/pyramids
 Author: Mostafa Farrag
 Author-email: moah.farag@gmail.come
 License: GNU General Public License v3
 Keywords: GIS,gdal
 Classifier: Development Status :: 5 - Production/Stable
@@ -33,27 +33,27 @@
 ![GitHub last commit](https://img.shields.io/github/last-commit/MAfarrag/pyramids)
 ![GitHub forks](https://img.shields.io/github/forks/MAfarrag/pyramids?style=social)
 ![GitHub Repo stars](https://img.shields.io/github/stars/MAfarrag/pyramids?style=social)
 [![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graph/badge.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
 [![Codacy Badge](https://app.codacy.com/project/badge/Grade/5e3aa4d0acc843d1a91caf33545ecf03)](https://www.codacy.com/gh/Serapieum-of-alex/pyramids/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Serapieum-of-alex/pyramids&amp;utm_campaign=Badge_Grade)
 
 
-![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.2.1?include_prereleases&style=plastic)
+![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.4.1?include_prereleases&style=plastic)
 ![GitHub last commit](https://img.shields.io/github/last-commit/mafarrag/pyramids)
 
 Current release info
 ====================
 
 | Name                                                                                                                 | Downloads                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Version                                                                                                                                                                                                                                                                                                                                                 | Platforms |
 |----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --- |
 | [![Conda Recipe](https://img.shields.io/badge/recipe-pyramids-green.svg)](https://anaconda.org/conda-forge/pyramids) | [![Conda Downloads](https://img.shields.io/conda/dn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![Downloads](https://pepy.tech/badge/pyramids-gis)](https://pepy.tech/project/pyramids-gis) [![Downloads](https://pepy.tech/badge/pyramids-gis/month)](https://pepy.tech/project/pyramids-gis)  [![Downloads](https://pepy.tech/badge/pyramids-gis/week)](https://pepy.tech/project/pyramids-gis)  ![PyPI - Downloads](https://img.shields.io/pypi/dd/pyramids-gis?color=blue&style=flat-square) | [![Conda Version](https://img.shields.io/conda/vn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![PyPI version](https://badge.fury.io/py/pyramids-gis.svg)](https://badge.fury.io/py/pyramids-gis)  | [![Conda Platforms](https://img.shields.io/conda/pn/conda-forge/pyramids.svg)](https://anaconda.org/conda-forge/pyramids) [![Join the chat at https://gitter.im/Hapi-Nile/Hapi](https://badges.gitter.im/Hapi-Nile/Hapi.svg)](https://gitter.im/Hapi-Nile/Hapi?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge) |
 
 pyramids - GIS utility package
 =====================================================================
-**pyramids** is a GIS utility package using gdal, rasterio, ....
+**pyramids** is a GIS utility package using gdal, ....
 
 pyramids
 
 Main Features
 -------------
   - GIS modules to enable the modeler to fully prepare the meteorological inputs and do all the preprocessing
     needed to build the model (align rasters with the DEM), in addition to various methods to manipulate and
@@ -68,15 +68,15 @@
 
 Installing pyramids
 ===============
 
 Installing `pyramids` from the `conda-forge` channel can be achieved by:
 
 ```
-conda install -c conda-forge pyramids=0.3.3
+conda install -c conda-forge pyramids=0.4.1
 ```
 
 It is possible to list all of the versions of `pyramids` available on your platform with:
 
 ```
 conda search pyramids --channel conda-forge
 ```
@@ -86,15 +86,15 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.4.0
+pip install pyramids-gis==0.4.1
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
@@ -166,7 +166,17 @@
 * Add class for multiple Dataset "DataCube".
 * Link both Dataset and FeatureCollection to convert between raster and vector data types.
 * Remove rasterio and netcdf from dependencies and depend only on gdal.
 * Test read rasters/netcdf from virtual file systems (aws, compressed)
 * Add dunder methods for all classes.
 * add plotting functionality and cleopatra (plotting package) as an optional package.
 * remove loops and replace it with ufunc from numpy.
+
+0.4.1 (2023-04-23)
+------------------
+* adjust all spatial operation functions to work with multi-band rasters.
+* use gdal exceptions to capture runtime error of not finding the the file.
+* add cluster method to dataset class.
+* time_stamp attribute returns None if there is no time_stamp.
+* restructure the no_data_value related functions.
+* plot function can plot rgb imagr for multi-band rasters.
+* to_file detect the driver type from the extension in the path.
```

### Comparing `pyramids-gis-0.4.0/setup.py` & `pyramids-gis-0.4.1/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -7,15 +7,15 @@
     history = history_file.read()
 
 requirements = [line.strip() for line in open("requirements.txt").readlines()]
 requirements_dev = [line.strip() for line in open("requirements-dev.txt").readlines()]
 
 setup(
     name="pyramids-gis",
-    version="0.4.0",
+    version="0.4.1",
     description="GIS utility package",
     author="Mostafa Farrag",
     author_email="moah.farag@gmail.come",
     url="https://github.com/MAfarrag/pyramids",
     keywords=["GIS", "gdal"],
     long_description=readme + "\n\n" + history,
     repository="https://github.com/MAfarrag/pyramids",
```

### Comparing `pyramids-gis-0.4.0/tests/test_io.py` & `pyramids-gis-0.4.1/tests/test_io.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 import os
 from typing import List
 
 import pytest
 from osgeo import gdal
-from pyramids.errors import FileFormatNoSupported
-from pyramids.io import _parse_path, extract_from_gz, read_file
+from pyramids._errors import FileFormatNoSupported
+from pyramids._io import _parse_path, extract_from_gz, read_file
 
 
 class TestParsePath:
     def test_one_compressed_zip_file(
         self,
         one_compressed_file_zip: str,
         multiple_compressed_file_zip_content: List[str],
```

### Comparing `pyramids-gis-0.4.0/tests/test_utils.py` & `pyramids-gis-0.4.1/tests/test_utils.py`

 * *Files 17% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 import numpy as np
 from osgeo import gdal
 
-from pyramids.utils import numpy_to_gdal_dtype, Catalog
+from pyramids._errors import DriverNotExistError
+from pyramids._utils import numpy_to_gdal_dtype, Catalog
 
 
 def test_numpy_to_gdal_dtype(arr: np.ndarray):
     gdal_type = numpy_to_gdal_dtype(arr)
     assert gdal_type is gdal.GDT_Float32
 
 
@@ -15,14 +16,23 @@
         assert hasattr(catalog, "catalog")
 
     def test_get_driver(self):
         catalog = Catalog()
         driver = catalog.get_driver("memory")
         assert isinstance(driver, dict)
 
+    def test_get_driver_by_ext(self):
+        catalog = Catalog()
+        driver = catalog.get_driver_by_extension("nc")
+        assert driver.get("GDAL Name") == "netCDF"
+        try:
+            catalog.get_driver_by_extension("mm")
+        except DriverNotExistError:
+            pass
+
     def test_get_gdal_name(self):
         catalog = Catalog()
         name = catalog.get_gdal_name("memory")
         assert name == "MEM"
 
     def test_exists(self):
         catalog = Catalog()
```

