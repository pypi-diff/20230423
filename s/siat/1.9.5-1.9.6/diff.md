# Comparing `tmp/siat-1.9.5-py3-none-any.whl.zip` & `tmp/siat-1.9.6-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 1126842 bytes, number of entries: 117
+Zip file size: 1127443 bytes, number of entries: 117
 -rw-rw-rw-  2.0 fat      840 b- defN 23-Apr-10 11:29 siat/__init__.py
 -rw-rw-rw-  2.0 fat     2130 b- defN 23-Apr-10 11:29 siat/allin.py
 -rw-rw-rw-  2.0 fat      747 b- defN 23-Apr-10 11:29 siat/alpha_vantage_test.py
 -rw-rw-rw-  2.0 fat    28555 b- defN 23-Apr-10 11:29 siat/assets_liquidity.py
 -rw-rw-rw-  2.0 fat     1285 b- defN 23-Apr-10 11:29 siat/assets_liquidity_test.py
 -rw-rw-rw-  2.0 fat    10110 b- defN 23-Apr-10 11:29 siat/barrons_scraping_test.py
 -rw-rw-rw-  2.0 fat    36597 b- defN 23-Apr-10 11:29 siat/beta_adjustment.py
@@ -31,16 +31,16 @@
 -rw-rw-rw-  2.0 fat     2944 b- defN 23-Apr-10 11:29 siat/esg_test.py
 -rw-rw-rw-  2.0 fat    47177 b- defN 23-Apr-10 11:29 siat/fama_french.py
 -rw-rw-rw-  2.0 fat     4678 b- defN 23-Apr-10 11:29 siat/fama_french_test.py
 -rw-rw-rw-  2.0 fat    40695 b- defN 23-Apr-10 11:29 siat/financial_base.py
 -rw-rw-rw-  2.0 fat    21528 b- defN 23-Apr-10 11:29 siat/financial_statements.py
 -rw-rw-rw-  2.0 fat      716 b- defN 23-Apr-10 11:29 siat/financial_statements_test.py
 -rw-rw-rw-  2.0 fat    76676 b- defN 23-Apr-10 11:29 siat/financials.py
--rw-rw-rw-  2.0 fat   148161 b- defN 23-Apr-21 14:04 siat/financials_china.py
--rw-rw-rw-  2.0 fat    57998 b- defN 23-Apr-10 11:29 siat/financials_china2.py
+-rw-rw-rw-  2.0 fat   149838 b- defN 23-Apr-23 04:43 siat/financials_china.py
+-rw-rw-rw-  2.0 fat    59255 b- defN 23-Apr-23 05:25 siat/financials_china2.py
 -rw-rw-rw-  2.0 fat     2722 b- defN 23-Apr-10 11:29 siat/financials_china2_test.py
 -rw-rw-rw-  2.0 fat     3507 b- defN 23-Apr-10 11:29 siat/financials_china2_test2.py
 -rw-rw-rw-  2.0 fat     3118 b- defN 23-Apr-10 11:29 siat/financials_china2_test3.py
 -rw-rw-rw-  2.0 fat    17549 b- defN 23-Apr-10 11:29 siat/financials_china_test.py
 -rw-rw-rw-  2.0 fat     5924 b- defN 23-Apr-19 09:54 siat/financials_china_test2.py
 -rw-rw-rw-  2.0 fat     5924 b- defN 23-Apr-19 09:55 siat/financials_china_test2_fin_indicator.py
 -rw-rw-rw-  2.0 fat    23829 b- defN 23-Apr-10 11:29 siat/financials_test.py
@@ -75,15 +75,15 @@
 -rw-rw-rw-  2.0 fat     1552 b- defN 23-Apr-10 11:29 siat/quandl_test.py
 -rw-rw-rw-  2.0 fat    49073 b- defN 23-Apr-10 11:29 siat/risk_adjusted_return.py
 -rw-rw-rw-  2.0 fat     3416 b- defN 23-Apr-10 11:29 siat/risk_adjusted_return_test.py
 -rw-rw-rw-  2.0 fat    75061 b- defN 23-Apr-10 11:29 siat/risk_evaluation.py
 -rw-rw-rw-  2.0 fat     3731 b- defN 23-Apr-10 11:29 siat/risk_evaluation_test.py
 -rw-rw-rw-  2.0 fat    12304 b- defN 23-Apr-10 11:29 siat/risk_free_rate.py
 -rw-rw-rw-  2.0 fat     4285 b- defN 23-Apr-10 11:29 siat/risk_free_rate_test.py
--rw-rw-rw-  2.0 fat    99793 b- defN 23-Apr-11 14:03 siat/sector_china.py
+-rw-rw-rw-  2.0 fat    99980 b- defN 23-Apr-23 00:56 siat/sector_china.py
 -rw-rw-rw-  2.0 fat     5843 b- defN 23-Apr-11 14:17 siat/sector_china_test.py
 -rw-rw-rw-  2.0 fat    29148 b- defN 23-Apr-10 11:29 siat/security_price.py
 -rw-rw-rw-  2.0 fat    71984 b- defN 23-Apr-10 11:29 siat/security_prices.py
 -rw-rw-rw-  2.0 fat    10779 b- defN 23-Apr-10 11:29 siat/security_prices_test.py
 -rw-rw-rw-  2.0 fat     1335 b- defN 23-Apr-10 11:29 siat/setup.py
 -rw-rw-rw-  2.0 fat     1418 b- defN 23-Apr-10 11:29 siat/shenwan index history test.py
 -rw-rw-rw-  2.0 fat   117254 b- defN 23-Apr-10 11:29 siat/stock.py
@@ -108,12 +108,12 @@
 -rw-rw-rw-  2.0 fat   118133 b- defN 23-Apr-10 11:29 siat/translate-20230206.py
 -rw-rw-rw-  2.0 fat   121657 b- defN 23-Apr-10 11:29 siat/translate-20230215.py
 -rw-rw-rw-  2.0 fat   124748 b- defN 23-Apr-19 09:58 siat/translate.py
 -rw-rw-rw-  2.0 fat     3936 b- defN 23-Apr-10 11:29 siat/universal_test.py
 -rw-rw-rw-  2.0 fat    51268 b- defN 23-Apr-10 11:29 siat/valuation_china.py
 -rw-rw-rw-  2.0 fat     1571 b- defN 23-Apr-10 11:29 siat/valuation_market_china_test.py
 -rw-rw-rw-  2.0 fat    14859 b- defN 23-Apr-10 11:29 siat/var_model_validation.py
--rw-rw-rw-  2.0 fat     1399 b- defN 23-Apr-21 14:09 siat-1.9.5.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-Apr-21 14:09 siat-1.9.5.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        5 b- defN 23-Apr-21 14:09 siat-1.9.5.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     9353 b- defN 23-Apr-21 14:09 siat-1.9.5.dist-info/RECORD
-117 files, 4430474 bytes uncompressed, 1112572 bytes compressed:  74.9%
+-rw-rw-rw-  2.0 fat     1399 b- defN 23-Apr-23 05:33 siat-1.9.6.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-Apr-23 05:33 siat-1.9.6.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        5 b- defN 23-Apr-23 05:33 siat-1.9.6.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     9353 b- defN 23-Apr-23 05:33 siat-1.9.6.dist-info/RECORD
+117 files, 4433595 bytes uncompressed, 1113173 bytes compressed:  74.9%
```

## zipnote {}

```diff
@@ -333,20 +333,20 @@
 
 Filename: siat/valuation_market_china_test.py
 Comment: 
 
 Filename: siat/var_model_validation.py
 Comment: 
 
-Filename: siat-1.9.5.dist-info/METADATA
+Filename: siat-1.9.6.dist-info/METADATA
 Comment: 
 
-Filename: siat-1.9.5.dist-info/WHEEL
+Filename: siat-1.9.6.dist-info/WHEEL
 Comment: 
 
-Filename: siat-1.9.5.dist-info/top_level.txt
+Filename: siat-1.9.6.dist-info/top_level.txt
 Comment: 
 
-Filename: siat-1.9.5.dist-info/RECORD
+Filename: siat-1.9.6.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## siat/financials_china.py

```diff
@@ -46,14 +46,15 @@
 import akshare as ak
 
 STOCK_SUFFIX_CHINA=['SS','SZ','BJ','NQ']
 #==============================================================================
 #==============================================================================
 if __name__=='__main__':
     ticker="000002.SZ"
+    ticker='002415.SZ'
     akfs=get_fin_stmt_ak(ticker)
     
 def get_fin_stmt_ak(ticker):
     """
     从akshare获取财务报表数据，合成df，限于中国A股
     获取的项目：所有原始项目
     注意：抓取所有的报表，不过滤日期
@@ -92,29 +93,35 @@
     if len(fis)==0:
         print("  #Warning(get_fin_stmt_ak): zero record of income statements found for",ticker)
         return None        
     if len(fcf)==0:
         print("  #Warning(get_fin_stmt_ak): zero record of cash flow found for",ticker)
         return None  
         
-    #去掉重复项、排序、重建索引
-    fbs1=fbs.drop_duplicates(subset=['报表日期'],keep='first')
-    fbs1.sort_values(by=['报表日期'],ascending=True,inplace=True)
-    fbs1['date']=pd.to_datetime(fbs1['报表日期'])
+    # 报告日/报表日期
+    rptdate=list(fbs)[0]    #报告日
+    
+    fbs1=fbs.drop_duplicates(subset=[rptdate],keep='first')
+    fbs1.sort_values(by=[rptdate],ascending=True,inplace=True)
+    fbs1['date']=pd.to_datetime(fbs1[rptdate])
     fbs1.set_index('date',inplace=True)
     
-    fis1=fis.drop_duplicates(subset=['报表日期'],keep='first')
-    fis1.sort_values(by=['报表日期'],ascending=True,inplace=True)
-    fis1['date']=pd.to_datetime(fis1['报表日期'])
+    fis1=fis.drop_duplicates(subset=[rptdate],keep='first')
+    fis1.sort_values(by=[rptdate],ascending=True,inplace=True)
+    fis1['date']=pd.to_datetime(fis1[rptdate])
     fis1.set_index('date',inplace=True)
     
-    fcf1=fcf.drop_duplicates(subset=['报表日期'],keep='first')
-    fcf1.sort_values(by=['报表日期'],ascending=True,inplace=True)
-    fcf1['date']=pd.to_datetime(fcf1['报表日期'])
+    dropcollist=['报告日','数据源','公告日期','更新日期']
+    fis1.drop(labels=dropcollist,axis=1,inplace=True)
+    
+    fcf1=fcf.drop_duplicates(subset=[rptdate],keep='first')
+    fcf1.sort_values(by=[rptdate],ascending=True,inplace=True)
+    fcf1['date']=pd.to_datetime(fcf1[rptdate])
     fcf1.set_index('date',inplace=True)
+    fcf1.drop(labels=dropcollist,axis=1,inplace=True)
 
     #合成：内连接
     fs1=pd.merge(fbs1,fis1,how='inner',left_index=True,right_index=True)
     fs2=pd.merge(fs1,fcf1,how='inner',left_index=True,right_index=True)
     
     if len(fs2) == 0:
         print("  #Warning(get_fin_stmt_ak): zero reports found for",ticker)
@@ -138,20 +145,23 @@
     fs3=fs2.fillna('0')
     
     #数据清洗：转换数值类型
     for i in fs3.columns:
         try:
             fs3[i]=fs3[i].astype('float')
         except:
-            continue
+            pass
     
     fs3['ticker']=ticker
     fs3['endDate']=fs3.index.strftime('%Y-%m-%d')
     
-    return fs3
+    # 删除重复的列
+    fs4=fs3.T.drop_duplicates(keep='first').T
+    
+    return fs4
 
 """
 ['流动资产', '货币资金', '交易性金融资产', '衍生金融资产', '应收票据及应收账款',
  '应收票据', '应收账款', '应收款项融资', '预付款项', '其他应收款(合计)', '应收利息',
  '应收股利', '其他应收款', '买入返售金融资产', '存货', '划分为持有待售的资产',
  '一年内到期的非流动资产', '待摊费用', '待处理流动资产损益', '其他流动资产',
  '流动资产合计',
@@ -3365,56 +3375,66 @@
               ['流动比率%','速动比率%','保守速动比率%','现金比率%','资产负债率%',
                '权益乘数','权益乘数(含少数股权的净资产)','产权比率%',],
               }
 
     # 注释
     notesdict={'常用指标': \
                '\n注：\n'+ \
-               '1. 毛利率=毛利 / 营业(总)收入 ×100%，毛利=营业(总)收入-营业(总)成本 \n'+ \
-               '2. 销售净利率=净利润 / 营业(总)收入 ×100% \n'+ \
-               '3. 期间费用率=期间费用 / 营业(总)收入 ×100%，期间费用包括管理费用，销售费用和财务费用。 \n', \
+               '1. 毛利率=毛利润 / 营业(总)收入 ×100% \n'+ \
+               '2. 毛利润=营业(总)收入-营业(总)成本 \n'+ \
+               '3. 销售净利率=净利润 / 营业(总)收入 ×100% \n'+ \
+               '4. 期间费用率=期间费用 / 营业(总)收入 ×100%，期间费用包括管理费用，销售费用和财务费用。 \n', \
               
               '每股指标': \
                '\n注：\n'+ \
                '1. 稀释每股指标:假设企业所有发行在外的稀释性潜在普通股期间内均转换为普通股，导致普通股股数增加 \n'+ \
                '2. 潜在普通股：指赋予其持有者在报告期或以后期间享有取得普通股权利的金融工具或者其他合同，例如公司可转债、认股权证、股份期权等 \n'+ \
-               '3. 摊薄每股指标：使用扣非后净利润计算，而非净利润，扣非后净利润可持续性更强，可能大于、小于或等于净利润 \n'+ \
-               '4. 调整后的每股净资产：考虑了净资产的流动性和变现能力，更加稳健，缩小了报表的粉饰空间 \n'+ \
-               '5. 调整后的每股净资产=（年度末股东权益-三年以上的应收款项净额-待摊费用-长期待摊费用）/年度末普通股股份总数 \n'+ \
+               '3. 摊薄每股指标：使用期末数值计算，而非期初期末均值，其结果更能反应期末情况，可能大于、小于或等于每股指标 \n'+ \
+               '4. 调整后每股净资产的意义：考虑了净资产的流动性和变现能力，更加具有谨慎性或稳健性 \n'+ \
+               '5. 调整后每股净资产=（年度末股东权益-三年以上的应收款项净额-待摊费用-长期待摊费用）/年度末普通股股份总数 \n'+ \
                '6. 应收款项净额：包括应收帐款、其他应收款、预付帐款、应收股利、应收利息、应收补贴款 \n'+ \
-               '7. 未分配利润：指企业实现的净利润经过弥补亏损、提取盈余公积和向投资者分配利润后留存在企业的、历年结存的利润 \n'+ \
-               '8. 留存收益：指企业从历年实现的利润中提取或形成的留存于企业的内部积累，包括盈余公积和未分配利润两类 \n'+ \
-               '9. 法定盈余公积：指企业按照公司法等法律规定的比例从净利润中提取的盈余公积 \n'+ \
-               '10.任意盈余公积：指企业经股东大会或类似机构批准按照规定的比例从净利润中提取的盈余公积。任意盈余公积的提取比例由企业自行确定 \n'+ \
-               '11.资本公积金：指直接由资本原因形成的公积金，如发行股份溢价、资产重估增值、接受捐赠等，用于转增股本，不得用于弥补亏损 \n'+ \
-               '12.自由现金流=企业经营活动现金流-资本性支出，用来衡量实际持有的在不影响企业生存时可回报股东(债务人）的最大现金额。 \n', \
+               '7. 留存收益：指企业从历年实现的利润中提取或形成的留存于企业的内部积累，包括盈余公积和未分配利润两类 \n'+ \
+               '8. 盈余公积：指从税后利润中提取的、存留于企业内部、具有特定用途的收益积累，包括法定盈余公积和任意盈余公积 \n'+ \
+               '9. 盈余公积的用途：可用于企业职工福利设施的支出、弥补亏损、扩大生产经营、转增资本（或股本）或派送新股等 \n'+ \
+               '10.法定盈余公积：指企业按照公司法等法律规定的比例(例如10%)从净利润中提取的盈余公积 \n'+ \
+               '11.任意盈余公积：指企业经股东大会或类似机构批准按照规定的比例从净利润中提取的盈余公积，其提取比例由企业自行确定 \n'+ \
+               '12.未分配利润：指企业实现的净利润经过弥补亏损、提取盈余公积和向投资者分配利润后留存在企业的、历年结存的利润 \n'+ \
+               '13.资本公积金：指直接由资本原因形成的公积金，如发行股份溢价、资产重估增值、接受捐赠等，用于转增股本，不得用于弥补亏损 \n'+ \
+               '14.自由现金流=企业经营活动现金流-资本性支出，用来衡量实际持有的在不影响企业生存时可回报股东(债权人）的最大现金额 \n'+ \
+               '15.(企业)自由现金流可以理解为归属于股东与债权人的最大现金流，而股东(股权)自由现金流则是归属于股东的最大现金流。 \n', \
 
               '营运能力': \
                '\n注：\n'+ \
-               '1. 指标周转率/周转次数：营业(总)收入 / 指标的起初期末均值，一般来说越大越好 \n'+ \
-               '2. 指标周转天数：360/周转率(或周转次数)，一般来说越小越好 \n'+ \
-               '3. 注意：本表部分指标不适用于金融行业。 \n', \
+               '1. 指标周转率/周转次数：营业(总)收入 / 指标的起初期末均值，从企业自身角度来说越大越好，但若涉及供应商则可能相反 \n'+ \
+               '2. 指标周转天数：360/周转率(或周转次数)，从企业自身角度来说越小越好，但若涉及供应商则可能相反 \n'+ \
+               '3. 注意：本表指标主要针对非金融行业，部分指标不适用于金融行业。 \n', \
               
               '盈利能力': 
                '\n注：\n'+ \
-               '1. 营业利润率=营业利润 / 营业(总)收入 x100% \n'+ \
-               '2. 营业利润=营业(总)收入-营业(总)成本-营业税金及附加-期间费用-资产减值损失+公允价值变动损益+投资损益 \n'+ \
-               '3. 营业利润率是在不考虑营业外收支和所得税费用的情况下，反映企业经营业务创造利润能力，比毛利率更能反映企业的盈利能力 \n'+ \
-               '4. 成本费用利润率=利润总额 / 成本费用总额 ×100%，反映企业付出一单位成本可以获取多少利润，即企业获取利润的效率 \n'+ \
-               '5. 利润总额=营业利润+营业外收入-营业外支出 \n'+ \
-               '6. 成本费用总额=营业成本+营业税金及附加+期间费用+资产减值损失 \n'+ \
-               '7. 少数股东损益：指公司合并报表的子公司中其它非控股股东享有的损益，需要在利润表中予以扣除 \n'+ \
-               '8. 总资产净利率_平均(含少数股东损益)：即在扣除少数股东损益之前的总资产净利率 \n'+ \
-               '9. 总资产报酬率=息税前利润 / 总资产期初期末均值 ×100%，即（利润总额+利息支出） / 平均总资产 ×100% \n'+ \
-               '10.投入资本回报率(ROIC，Return Of Invested Capital)=息税前利润(EBIT) x (1-税率) / 投入资本 x100%， \n'+ \
-               '11.息税前利润(EBIT)=营业收入–营业成本–营业费用+营业外收入支出(或是税前净利+利息费用)， \n'+ \
-               '12.投入资本（Invested Capital）=流动资产–流动负债+不动产与厂房设备净额+无形资产及商誉， \n'+ \
-               '13.总资本回报率(收益率)（Return of Total Capital）=(利润总额+借入资本利息) / 总资本 x100%， \n'+ \
-               '14.总资本回报率(收益率)反映企业总资本的收益能力，从经营者的立场观察，自有资本和借入资本没有区分的必要 \n'+ \
-               '15.在借入资本利息中，除去利息支出、贴现费用、企业借债利息外，还应包括公司债券折价摊销数额在内。 \n', 
+               '1. 毛利润=营业(总)收入-营业(总)成本 \n'+ \
+               '2. 营业利润=毛利润-营业税金及附加-期间费用-资产减值损失+公允价值变动损益+投资损益 \n'+ \
+               '3. 营业利润率=营业利润 / 营业(总)收入 x100% \n'+ \
+               '4. 营业利润率的意义：在不考虑营业外收支和所得税费用时，反映企业经营业务创造利润能力，比毛利率更能反映企业的盈利能力 \n'+ \
+               '5. 成本费用利润率=利润总额 / 成本费用总额 ×100%，反映企业付出一单位成本可以获取多少利润，即企业获取利润的效率 \n'+ \
+               '6. 利润总额=营业利润+营业外收入-营业外支出 \n'+ \
+               '7. 成本费用总额=营业成本+营业税金及附加+期间费用+资产减值损失 \n'+ \
+               '8. 总资产净利率：这里默认使用总资产期初期末平均值，=净利润 / 总资产期初期末平均值 \n'+ \
+               '9. 总资产净利率_平均(含少数股东损益)：即在扣除少数股东损益之前的总资产净利率 \n'+ \
+               '10.少数股东损益：指公司合并报表的子公司中其它非控股股东享有的损益 \n'+ \
+               '11.总资产报酬率=息税前利润 / 总资产期初期末均值 ×100%，即（利润总额+利息支出） / 平均总资产 ×100% \n'+ \
+               '12.总资本回报率(收益率)（Return of Total Capital）=(利润总额+借入资本利息) / 总资本 x100%， \n'+ \
+               '13.总资本回报率(收益率)反映企业总资本的收益能力，从经营者的立场观察，自有资本和借入资本没有区分的必要 \n'+ \
+               '14.在借入资本利息中，除去利息支出、贴现费用、企业借债利息外，还应包括公司债券折价摊销数额在内 \n'+ \
+               '15.息前税后总资产报酬率=息前税后利润 / 总资产期初期末均值 ×100% \n'+ \
+               '16.净资产收益率(ROE)=净利润 / 净资产期初期末均值 ×100% \n'+ \
+               '17.摊薄净资产收益率=净利润 / 净资产期末数值 ×100%，强调期末情况 \n'+ \
+               '18.投入资本回报率(ROIC，Return Of Invested Capital)=息税前利润(EBIT) x (1-税率) / 投入资本 x100% \n'+ \
+               '19.息税前利润(EBIT)=营业收入–营业成本–营业费用+营业外收入支出(或是税前净利+利息费用) \n'+ \
+               '20.投入资本（Invested Capital）=流动资产–流动负债+不动产与厂房设备净额+无形资产及商誉，注意与总资本不同 \n'+ \
+               '21.投入资本回报率的意义：更多地从投资而非财务角度看，每单位投资的资本所能赚取息税前利润的多少。 \n', \
               
               '收益质量':
                '\n注：\n'+ \
                '1. 销售成本率=营业(总)成本 / 营业(总)收入 x100%，=1-毛利润 \n'+ \
                '2. 成本费用率=(营业(总)成本+期间费用) / 营业(总)收入 x100%，=销售成本率+期间费用率，可评价企业对成本费用的控制能力 \n'+ \
                '3. 期间费用率=期间费用 / 营业(总)收入 x100% \n',
               
@@ -3424,16 +3444,16 @@
                '2. 归属母公司净利润：简称归母净利润，指企业合并报表中归属控股公司(母公司)的利润，不包括归属子公司中非控股股东的利润。 \n',
               
               '财务风险':
                '\n注：\n'+ \
                '1. 保守速动比率：又称超速动比率，=(现金+短期证券投资+应收账款净额) / 流动负债，比速动比能够更好地评价企业短期偿债能力 \n'+ \
                '2. 应收账款净额:指应收账款和其他应收款减去备抵坏账的净额，实质即为信誉高客户的应收款净额 \n'+ \
                '3. 产权比率(equity ratio)=负债总额 / 所有者权益总额(净资产) x100%，从一个方面说明企业长期偿债能力，越高越弱 \n'+ \
-               '4. 注意：本表部分指标不适用于金融行业。 \n\n'+ \
-               '*** 注意：表中数字并非基于财报期末数字计算，而是直接来源于财经网站和上市公司财报摘要（基于期初期末均值调整）。',
+               '4. 说明：本表指标主要针对非金融普通企业，部分指标不完全适用于金融行业。 \n\n'+ \
+               '*** 注意：财报比率中有的使用期末数字计算，有的则采用期初期末均值，结果可能出现一定差异，但不影响同一指标的可比性。',
               }        
         
     # 一只股票情形：多日期
     if len(tickers_found) == 1:
         ticker1=tickers[0]
         titletxt="\n===== 上市公司财务报表摘要："+codetranslate(ticker1)+" ====="    
         print(titletxt)
```

## siat/financials_china2.py

```diff
@@ -57,82 +57,90 @@
                             '三、营业利润':'营业利润',
                             '四、利润总额':'利润总额',
                             '归属于母公司所有者的净利润':'归母净利润',
                             '减：所得税费用':'所得税费用',    
                             '处置固定资产、无形资产和其他长期资产的损失':'资产处置损失',
                             '减：营业外支出':'营业外支出',
                             
-                            '经营活动产生现金流量净额':'经营活动现金流净额',
+                           #'经营活动产生现金流量净额':'经营活动现金流净额',
+                            '经营活动产生的现金流量净额':'经营活动现金流净额',
                             '经营活动现金流入小计':'经营活动现金流入',
                             '经营活动现金流出小计':'经营活动现金流出',
                             '投资活动产生的现金流量净额':'投资活动现金流净额',
                             '投资活动现金流入小计':'投资活动现金流入',
                             '投资活动现金流出小计':'投资活动现金流出',
                             '筹资活动产生的现金流量净额':'筹资活动现金流净额',
                             '筹资活动现金流入小计':'筹资活动现金流入',
                             '筹资活动现金流出小计':'筹资活动现金流出',
-                            '四、汇率变动对现金及现金等价物的影响':'汇率对现金流的影响',
-                            '现金及现金等价物的净增加额':'现金流量净增加额',
+                            '汇率变动对现金及现金等价物的影响':'汇率对现金流的影响',
+                            '现金及现金等价物净增加额':'现金流量净增加额',
                             '基本每股收益(元/股)':'基本每股收益',
                             '稀释每股收益(元/股)':'稀释每股收益',
                             
                                 },inplace=True)
         
         #计算指标
-        dfs['应收账款占比%']=round(dfs['应收账款']/dfs['资产总计']*100,2)
-        dfs['存货占比%']=round(dfs['存货']/dfs['资产总计']*100,2)
-        dfs['流动比率%']=round(dfs['流动资产合计']/dfs['流动负债合计']*100,2)
-        dfs['速动资产合计']=dfs['流动资产合计']-dfs['存货']
-        dfs['速动比率%']=round(dfs['速动资产合计']/dfs['流动负债合计']*100,2)
-        dfs['资产负债率%']=round(dfs['负债合计']/dfs['资产总计']*100,2)
-
-        dfs['毛利润']=dfs['营业总收入']-dfs['营业成本']
-        dfs['毛利润率%']=round(dfs['毛利润']/dfs['营业总收入']*100,2)
-        dfs['营业利润率%']=round(dfs['营业利润']/dfs['营业总收入']*100,2)
-        dfs['销售费用率%']=round(dfs['销售费用']/dfs['营业总收入']*100,2)
-        dfs['管理费用率%']=round(dfs['管理费用']/dfs['营业总收入']*100,2)
-        dfs['研发费用率%']=round(dfs['研发费用']/dfs['营业总收入']*100,2)
-        dfs['营业外收支']=dfs['营业外收入']-dfs['营业外支出']
+        #dfs['应收账款占比%']=round(dfs['应收账款']/dfs['资产总计']*100,2)
+        dfs['应收账款占比%']=dfs.apply(lambda x:round(x['应收账款']/x['资产总计']*100,2),axis=1)
+        
+        #dfs['存货占比%']=round(dfs['存货']/dfs['资产总计']*100,2)
+        dfs['存货占比%']=dfs.apply(lambda x:round(x['存货']/x['资产总计']*100,2),axis=1)
+        
+        dfs['流动比率%']=dfs.apply(lambda x:round(x['流动资产合计']/x['流动负债合计']*100,2),axis=1)
+        dfs['速动资产合计']=dfs.apply(lambda x:x['流动资产合计']-x['存货'],axis=1)
+        dfs['速动比率%']=dfs.apply(lambda x:round(x['速动资产合计']/x['流动负债合计']*100,2),axis=1)
+        dfs['资产负债率%']=dfs.apply(lambda x:round(x['负债合计']/x['资产总计']*100,2),axis=1)
+
+        dfs['毛利润']=dfs.apply(lambda x:x['营业总收入']-x['营业成本'],axis=1)
+        dfs['毛利润率%']=dfs.apply(lambda x:round(x['毛利润']/x['营业总收入']*100,2),axis=1)
+        dfs['营业利润率%']=dfs.apply(lambda x:round(x['营业利润']/x['营业总收入']*100,2),axis=1)
+        dfs['销售费用率%']=dfs.apply(lambda x:round(x['销售费用']/x['营业总收入']*100,2),axis=1)
+        dfs['管理费用率%']=dfs.apply(lambda x:round(x['管理费用']/x['营业总收入']*100,2),axis=1)
+        try:
+            dfs['研发费用率%']=dfs.apply(lambda x:round(x['研发费用']/x['营业总收入']*100,2),axis=1)
+        except:
+            dfs['研发费用率%']='-'
+        dfs['营业外收支']=dfs.apply(lambda x:x['营业外收入']-x['营业外支出'],axis=1)
         dfs['税前利润']=dfs['利润总额']
-        dfs['税前利润率%']=round(dfs['利润总额']/dfs['营业总收入']*100,2)
-        dfs['实际所得税率%']=round(dfs['所得税费用']/dfs['利润总额']*100,2)
-        dfs['净利润率%']=round(dfs['净利润']/dfs['营业总收入']*100,2)
-        
-        dfs['流通股股数']=round(dfs['净利润']/dfs['基本每股收益'],0)
-        dfs['短期现金偿债能力%']=round(dfs['经营活动现金流净额']/dfs['流动负债合计']*100,2)
-        dfs['长期现金偿债能力%']=round(dfs['经营活动现金流净额']/dfs['负债合计']*100,2)
-        dfs['现金支付股利能力(元)']=round(dfs['经营活动现金流净额']/dfs['流通股股数'],2)
-        dfs['现金综合支付能力%']=round(dfs['经营活动现金流净额']/dfs['所有者权益合计']*100,2)
-        dfs['销售现金比率%']=round(dfs['经营活动现金流入']/dfs['营业总收入']*100,2)
-        dfs['盈利现金比率%']=round(dfs['经营活动现金流净额']/dfs['净利润'],2)
-        dfs['资产现金回收率%']=round(dfs['经营活动现金流净额']/dfs['资产总计']*100,2)
-        dfs['现金流入流出比率%']=round(dfs['经营活动现金流入']/dfs['经营活动现金流出']*100,2)
-        
-        dfs['现金购销比率%']=round(dfs['购买商品、接受劳务支付的现金']/dfs['销售商品、提供劳务收到的现金']*100,2)
-        dfs['营业现金回笼率%']=round(dfs['销售商品、提供劳务收到的现金']/dfs['营业总收入']*100,2)
-        dfs['支付给职工的现金比率%']=round(dfs['支付给职工以及为职工支付的现金']/dfs['销售商品、提供劳务收到的现金']*100,2)
+        dfs['税前利润率%']=dfs.apply(lambda x:round(x['利润总额']/x['营业总收入']*100,2),axis=1)
+        dfs['实际所得税率%']=dfs.apply(lambda x:round(x['所得税费用']/x['利润总额']*100,2),axis=1)
+        dfs['净利润率%']=dfs.apply(lambda x:round(x['净利润']/x['营业总收入']*100,2),axis=1)
+        
+        dfs['流通股股数']=dfs.apply(lambda x:round(x['净利润']/x['基本每股收益'],0),axis=1)
+        dfs['短期现金偿债能力%']=dfs.apply(lambda x:round(x['经营活动现金流净额']/x['流动负债合计']*100,2),axis=1)
+        dfs['长期现金偿债能力%']=dfs.apply(lambda x:round(x['经营活动现金流净额']/x['负债合计']*100,2),axis=1)
+        dfs['现金支付股利能力(元)']=dfs.apply(lambda x:round(x['经营活动现金流净额']/x['流通股股数'],2),axis=1)
+        dfs['现金综合支付能力%']=dfs.apply(lambda x:round(x['经营活动现金流净额']/x['所有者权益合计']*100,2),axis=1)
+        dfs['销售现金比率%']=dfs.apply(lambda x:round(x['经营活动现金流入']/x['营业总收入']*100,2),axis=1)
+        dfs['盈利现金比率%']=dfs.apply(lambda x:round(x['经营活动现金流净额']/x['净利润'],2),axis=1)
+        dfs['资产现金回收率%']=dfs.apply(lambda x:round(x['经营活动现金流净额']/x['资产总计']*100,2),axis=1)
+        dfs['现金流入流出比率%']=dfs.apply(lambda x:round(x['经营活动现金流入']/x['经营活动现金流出']*100,2),axis=1)
+        
+        dfs['现金购销比率%']=dfs.apply(lambda x:round(x['购买商品、接受劳务支付的现金']/x['销售商品、提供劳务收到的现金']*100,2),axis=1)
+        dfs['营业现金回笼率%']=dfs.apply(lambda x:round(x['销售商品、提供劳务收到的现金']/x['营业总收入']*100,2),axis=1)
+        dfs['支付给职工的现金比率%']=dfs.apply(lambda x:round(x['支付给职工以及为职工支付的现金']/x['销售商品、提供劳务收到的现金']*100,2),axis=1)
         
         # 自定义财务比率
         
-        
         #获取字段列表,增加期初项目
         col_list=list(dfs)
+        
         for c in col_list:
             #print(c)
             dfs[c+"_期初"]=dfs[c].shift(1)
         #给字段排序，便于检查对比
         col_list_qc=list(dfs)
         col_list2=sorted(col_list_qc)
         dfs2=dfs[col_list2]
         
         #合成
         df=df.append(dfs2)
 
     #删除空值行：谨慎！！！
-    df.dropna(inplace=True)
+    #df.dropna(inplace=True)
     
     #删除多余的列，修改列名
     del df['ticker_期初']
     df.rename(columns={'endDate_期初':'endDate_上期'},inplace=True)
     
     #标注股票简称,去掉其中的(A股)字样
     df["股票简称"]=df['ticker'].apply(lambda x: codetranslate(x).replace("(A股)",''))
@@ -1224,16 +1232,21 @@
     title_txt=title_head+"主要项目及其变动趋势"
     items1=["营业总收入","营业总成本","营业成本","毛利润","营业利润","营业外收支","税前利润","所得税费用","净利润","归母净利润"]
     dfp1=fs_item_analysis_1(df,ticker,fsdate,items1,title_txt)
     
     #成本变动趋势
     title_txt=title_head+"主要成本费用及其变动趋势"
     print('')
+    """
+    items2=["营业总成本","营业成本","营业税金及附加","销售费用","管理费用","研发费用",
+            "应付利息","公允价值变动损失","非流动资产处置损失",
+            "资产减值损失","营业外支出"]
+    """
     items2=["营业总成本","营业成本","营业税金及附加","销售费用","管理费用","研发费用",
-            "应付利息","公允价值变动损失","资产处置损失",
+            "应付利息","非流动资产处置损失",
             "资产减值损失","营业外支出"]
     dfp2=fs_item_analysis_1(df,ticker,'2021-12-31',items2,title_txt)
     
     #占比变动分析：近三年
     title_txt=title_head+"营业总成本占营业总收入比例情况"
     fsdates1=fsdates[:3]
     items3=["营业总成本","营业总收入"]
```

## siat/sector_china.py

```diff
@@ -2052,29 +2052,31 @@
         cdf1=cdf.head(top)
     else:
         cdf1=cdf.tail(-top)
     cdf1['最新权重']=cdf1['最新权重'].apply(lambda x: round(x,2))
     cdf1['证券代码']=cdf1['证券代码'].apply(lambda x: x+'.SS' if x[:1] in ['6'] else (x+'.SZ' if x[:1] in ['0','3'] else x+'.BJ' ))
         
     clist=list(cdf1['证券代码'])
+    """
     clist1=[]
     for c in clist:
         first=c[:1]
         if first == '6':
             clist1=clist1+[c+'.SS']
         else:
             clist1=clist1+[c+'.SZ']
-    
+    """
     if printout:
         title_txt="申万行业指数成分股排名与权重："+industry_sw_name(industry)+'指数('+industry+')'
         import datetime as dt; today=str(dt.date.today())
         footnote="*** 数据来源：sina/EM，"+str(today)
         df_directprint(cdf1,title_txt,footnote)        
     
-    return clist1,cdf1
+    #return clist1,cdf1
+    return clist,cdf1
     
 if __name__=='__main__':
     clist,cdf=industry_stock_sw(industry='801005',top=10)
     clist,cdf=industry_stock_sw(industry='850831',top=-10)
 #==============================================================================
 if __name__ =="__main__":
     
@@ -2435,15 +2437,19 @@
     df['序号']=df.index+1
     
     df_print=df[['序号','证券名称','证券代码','初始权重','行业名称','行业代码']]
     
     if printout:
         alignlist=['center']+['center']*(len(list(df_print))-1)
         
-        print("\n*** 混合行业投资组合的成分股：初始等权重\n")
+        if len(industries) > 1:
+            print("\n*** 混合行业投资组合的成分股：初始等权重\n")
+        else:
+            print("\n*** 单一行业投资组合的成分股：初始等权重\n")
+            
         print(df_print.to_markdown(index=False,tablefmt='plain',colalign=alignlist))
         import datetime; today=datetime.date.today()
         print("\n*** 数据来源：申万宏源，统计日期："+str(today))
     
     # 生成成分股字典
     stock_dict=df.set_index(['证券代码'])['初始权重'].to_dict()
```

## Comparing `siat-1.9.5.dist-info/METADATA` & `siat-1.9.6.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: siat
-Version: 1.9.5
+Version: 1.9.6
 Summary: Securities Investment Analysis Tools (siat)
 Home-page: https://pypi.org/project/siat/
 Author: Prof. WANG Dehong, Business School, BFSU (北京外国语大学 国际商学院 王德宏 教授)
 Author-email: wdehong2000@163.com
 License: Copyright (C) WANG Dehong, 2023. For educational purpose only!
 Platform: UNKNOWN
 Requires-Dist: pandas-datareader
```

## Comparing `siat-1.9.5.dist-info/RECORD` & `siat-1.9.6.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -30,16 +30,16 @@
 siat/esg_test.py,sha256=Z9m6GUt8O7oHZSEG9aDYpGdvvrv2AiRJdHTiU6jqmZ0,2944
 siat/fama_french.py,sha256=qDpsZOj0BLuzXXdNwJ1IPhDyNVAnTJFHqn80Hkp85ZI,47177
 siat/fama_french_test.py,sha256=M4O23lBKsJxhWHRluwCb3l7HSEn3OFTjzGMpehcevRg,4678
 siat/financial_base.py,sha256=YxNVfhbgLQ4stLojI9nklB4sdQNuROcILcO3M2uz4Gs,40695
 siat/financial_statements.py,sha256=KDUl9b92EV5IseLLnEmG3czDHAaay2SWM2MpzZXPHpk,21528
 siat/financial_statements_test.py,sha256=FLhx8JD-tVVWSBGux6AMz1jioXX4U4bp9DmgFHYXb_w,716
 siat/financials.py,sha256=4b0fJAu1Mm5aX_zCIvF01CzzBokrprQpIk1N3za1FNA,76676
-siat/financials_china.py,sha256=bm4oc533Y-eV2y4V328zKrKYFDBLTFeGhIjlH4PqNZ0,148161
-siat/financials_china2.py,sha256=32--MBk7PBOSg7DUyxfjN63ZPEkmAsrYfuTHAenOphA,57998
+siat/financials_china.py,sha256=QLHbnRRq-n9uU32OUZ-Q8KUR2m6UiwyERmyx7kEcOmA,149838
+siat/financials_china2.py,sha256=qQ64qVKlh_hPARezaLBVRclwEQ7XFkdSp-HupvUXI5k,59255
 siat/financials_china2_test.py,sha256=Erz5k4LyOplBBvYls2MypuqHpVNJ3daiLdyeJezNPu0,2722
 siat/financials_china2_test2.py,sha256=C8CuYTMHN4Mhp-sTu-Bmg0zMXRCaYV6ezGDoYartRYQ,3507
 siat/financials_china2_test3.py,sha256=UXYSA80DNSPRhHpovc2MA9JkpILWMAQaRatbWCHBNPs,3118
 siat/financials_china_test.py,sha256=QS1SD_mXx4uH1Lg3gl2PmwLrvkLqkRs3e4x7SyFI_Xk,17549
 siat/financials_china_test2.py,sha256=WkNlVW_0hGegdw1rzg4BP_dKR-smdyUp9Fr00K7mPZY,5924
 siat/financials_china_test2_fin_indicator.py,sha256=WkNlVW_0hGegdw1rzg4BP_dKR-smdyUp9Fr00K7mPZY,5924
 siat/financials_test.py,sha256=HJ3CPo_Xckz2wXi3AEP6ZNWCF1Duc1pLi0Y10USiImc,23829
@@ -74,15 +74,15 @@
 siat/quandl_test.py,sha256=EcPoXnLuqzPl5dKyVEZi3j3PJZFpsnU_iNPhLWC9p-A,1552
 siat/risk_adjusted_return.py,sha256=8vyjOCap9xEvWIpJnBEsDm8Ba3CD9QrEXy2qFG6zvVk,49073
 siat/risk_adjusted_return_test.py,sha256=m_VHL5AtT74cJv5i7taTeTfnkX48y0AFJk5phawyYWg,3416
 siat/risk_evaluation.py,sha256=lCDqCaSEppH0MFPFg-P14IYcF3IJqILbPfDmzf_AfcY,75061
 siat/risk_evaluation_test.py,sha256=YEXM96gKzTfwN4U61AS4Rr1tV7KgUvn4rRC6f3iMw9s,3731
 siat/risk_free_rate.py,sha256=r62zCl1qbI4lJU17GsgM-OmVx9oo3dltXeZVCNd6Uxg,12304
 siat/risk_free_rate_test.py,sha256=CpmhUf8aEAEZeNu4gvWP2Mz2dLoIgBX5bI41vfUBEr8,4285
-siat/sector_china.py,sha256=xhwTpupB-QrBHVrk_GZD00w3U3WPcnsqIYKhdHG8kRQ,99793
+siat/sector_china.py,sha256=P8R1fdeDy-CjS3SaHTN2V_tEqMod8a4zmiLCSQhPQiQ,99980
 siat/sector_china_test.py,sha256=1wq7ef8Bb_L8F0h0W6FvyBrIcBTEbrTV7hljtpj49U4,5843
 siat/security_price.py,sha256=ibrdUJyt_n0c8oKRbVStE1_ptmWkzy4YIHjpc_fGiPQ,29148
 siat/security_prices.py,sha256=Xl7EHz16qCUIzuPGpEi-g-tLGQKk3MqHmic556-Vs7U,71984
 siat/security_prices_test.py,sha256=OEphoJ87NPKoNow1QA8EU_5MUYrJF-qKoWKNapVfZNI,10779
 siat/setup.py,sha256=up65rQGLmTBkhtaMLowjoQXYmIsnycnm4g1SYmeQS6o,1335
 siat/shenwan index history test.py,sha256=JCVAzOSEldHalhSFa3pqD8JI_8_djPMQOxpkuYU-Esg,1418
 siat/stock.py,sha256=kW_R_CW9WbR0bzwwUlFwvWh0oJE3zA8gfKw_AJUWfCo,117254
@@ -107,11 +107,11 @@
 siat/translate-20230206.py,sha256=-vtI125WyaJhmPotOpDAmclt_XnYVaWU9ByLWZ6FyYE,118133
 siat/translate-20230215.py,sha256=TJgtPE3n8IjljmZ4Pefy8dmHoNdFF-1zpML6BhA9FKE,121657
 siat/translate.py,sha256=Ed3H3G1BiMaWL1iKGiiE4YP92tgj23xhlIdsU42Uqlk,124748
 siat/universal_test.py,sha256=CDAOffW1Rvs-TcNN5giWVvHMlch1w4dp-w5SIV9jXL0,3936
 siat/valuation_china.py,sha256=J78FTnwyzOjNENq30MXaQdby6EtcBZi3AMeUKhGtuok,51268
 siat/valuation_market_china_test.py,sha256=gbJ0ioauuo4koTPH6WKUkqcXiQPafnbhU5eKJ6lpdLA,1571
 siat/var_model_validation.py,sha256=zB_Skk_tmzIR15l6oAW3am4HBGVIG-eZ8gJhCdXZ8Qw,14859
-siat-1.9.5.dist-info/METADATA,sha256=THfCa4K9pKEO6Xz8Nq8rM7xgk1rk4Q6k_Czx0oWX704,1399
-siat-1.9.5.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-siat-1.9.5.dist-info/top_level.txt,sha256=r1cVyL7AIKqeAmEJjNR8FMT20OmEzufDstC2gv3NvEY,5
-siat-1.9.5.dist-info/RECORD,,
+siat-1.9.6.dist-info/METADATA,sha256=mREEMPH_eNRaCbTSuUMvgnhCCVc-2Abm-GcPdu4v6jE,1399
+siat-1.9.6.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
+siat-1.9.6.dist-info/top_level.txt,sha256=r1cVyL7AIKqeAmEJjNR8FMT20OmEzufDstC2gv3NvEY,5
+siat-1.9.6.dist-info/RECORD,,
```

